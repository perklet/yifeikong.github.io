<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>Yifei Kong</title><link>/</link><description></description><lastBuildDate>Sun, 17 Feb 2019 14:15:00 +0800</lastBuildDate><item><title>Rust çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†æ¦‚è¿°</title><link>/posts/rust-de-sheng-ming-zhou-qi-guan-li-gai-shu.html</link><description>&lt;p&gt;å‘¨æœ«èŠ±äº›æ—¶é—´æŠŠ Rust ç”Ÿå‘½å‘¨æœŸåˆç¿»äº†ä¸€éï¼Œç»ˆäºèƒ½å†™å‡ºä¸€ä¸ªå¯ä»¥ç¼–è¯‘é€šè¿‡çš„ç¨‹åºäº†ğŸ˜ã€‚Rust è™½ç„¶å­¦ä¹ æ›²çº¿æ¯”è¾ƒé™¡å³­ï¼Œä½†æ˜¯æŒæ¡ä¹‹åå°±å‘ç°è¿™ä¹ˆè®¾è®¡ç¡®å®æ˜¯æœ‰é“ç†çš„ï¼Œå°¤å…¶æ˜¯å¯¹äºç¼–å†™æ­£ç¡®çš„ C++ ç¨‹åºä¹Ÿå¾ˆæœ‰å¸®åŠ©ã€‚&lt;/p&gt;
&lt;h1&gt;å¯å˜ä¸ä¸å¯å˜&lt;/h1&gt;
&lt;p&gt;Rust ä¸­ä½¿ç”¨ let æ¥ç»‘å®šä¸€ä¸ªå˜é‡ï¼Œé»˜è®¤æ˜¯ä¸å¯å˜çš„ã€‚ä¹Ÿå°±æ˜¯è¯´é»˜è®¤å°±ç›¸å½“äº C++ ä¸­ const å˜é‡ã€‚ä½†æ˜¯å®é™…ä¸Š C++ ä¸­çš„ const ä¹Ÿåªæ˜¯åªè¯»è€Œå·²ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;let x = 5;
x = 6;  // éæ³•
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœæƒ³è¦æ›´æ”¹ä¸€ä¸ªå˜é‡çš„å€¼ï¼Œåœ¨å£°æ˜çš„æ—¶å€™ï¼Œåº”è¯¥åŠ ä¸Š mutï¼ˆæ¯æ¬¡å†™ let mut çš„æ—¶å€™ï¼Œæˆ‘å¿ƒé‡Œéƒ½æ˜¯è¯»ä½œâ€œè®©TMçš„â€ï¼‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;let mut = 5;
x = 6
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;copy å’Œ move è¯­ä¹‰&lt;/h1&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Feb 2019 05:44:00 +0800</pubDate><guid isPermaLink="false">tag:None,2019-02-17:/posts/rust-de-sheng-ming-zhou-qi-guan-li-gai-shu.html</guid><category>Rust</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>äº‘æ—¶ä»£çš„ä¸ªäººå­˜å‚¨æ­å»º</title><link>/posts/yun-shi-dai-de-ge-ren-cun-chu-da-jian.html</link><description>&lt;p&gt;æ˜¨å¤©æƒ³ç”¨ iPad ä¸Šçš„ GoodReader çœ‹ä¸€æœ¬ä¹¦ï¼Œä½†æ˜¯ä» iCloud åŒæ­¥çš„æ—¶å€™å‡ºäº†äº›é—®é¢˜ï¼Œè¿›åº¦å§‹ç»ˆä¸ºé›¶ã€‚ç”±äºå›½å†…ç³Ÿç³•çš„ç½‘ç»œç¯å¢ƒï¼Œè¿™ç§åŒæ­¥å¤±è´¥çš„é—®é¢˜æ—¶æœ‰å‘ç”Ÿã€‚è™½ç„¶å¯ä»¥ç›´æ¥é€šè¿‡ WiFi æŠŠä¹¦ä»ç”µè„‘ä¸Šä¼ è¿‡æ¥ï¼Œä½†æ˜¯å› ä¸ºå¶å°”éœ€è¦åœ¨å¦ä¸€ä¸ª iPad ä¸ŠæŸ¥çœ‹ï¼Œä¸ºäº†åŒæ­¥è¿›åº¦ï¼Œè¿˜æ˜¯æœ€ç»ˆå†³å®šè¿˜æ˜¯è‡ªå·±æ­å»ºä¸€å¥—äº‘å­˜å‚¨è®¾æ–½ã€‚&lt;/p&gt;
&lt;h1&gt;ftp ä¸ webdav&lt;/h1&gt;
&lt;p&gt;ftp åè®®æœ‰è¯¸å¤šé—®é¢˜ï¼Œç°åœ¨ç”¨çš„å·²ç»å¾ˆå°‘äº†ã€‚WebDav åè®®åŸºäº HTTPï¼Œç›¸æ¯” FTP æœ‰ä¸å°‘æœ‰ç‚¹ï¼Œå¯ä»¥å‚è§æ–‡ç« 1ã€‚å¦å¤–ä¸å°‘å¼€æºçš„ç½‘ç›˜å®¢æˆ·ç«¯ä¹Ÿæ”¯æŒ webdavã€‚NextCloud æ”¯æŒ webdavï¼Œåé¢ä¼šè®²åˆ°&lt;/p&gt;
&lt;h1&gt;sftp å’Œ sshfs&lt;/h1&gt;
&lt;p&gt;sftp åˆ™å’Œ ftp æ˜¯å®Œå…¨ç‹¬ç«‹çš„ä¸¤ä¸ªä¸œè¥¿ï¼Œè™½ç„¶æœ€ç»ˆç›®çš„æ˜¯ä¸€æ ·çš„ã€‚å¥½æ¯”æµ·è±šå’Œé²¨é±¼éƒ½æ˜¯åœ¨æµ·é‡Œçš„ç”Ÿç‰©ï¼Œä½†æ˜¯ä¸€ä¸ªæ˜¯å“ºä¹³åŠ¨ç‰©ï¼Œè€Œä¸€ä¸ªæ˜¯é±¼ç±»ã€‚sftp åŸºäº ssh åè®®ã€‚&lt;/p&gt;
&lt;p&gt;sshfs ç›¸æ¯” sftp åˆ™æ›´è¿‘äº†ä¸€æ­¥ï¼Œé€šè¿‡ sftp æŠŠè¿œç¨‹çš„æ–‡ä»¶ç³»ç»Ÿç›´æ¥æ˜ å°„åˆ°æœ¬åœ°ï¼Œä»è€Œæ— ç¼è¡”æ¥ã€‚&lt;/p&gt;
&lt;h2&gt;æ­å»º&lt;/h2&gt;
&lt;p&gt;sftp ç›´æ¥åŸºäº linux çš„ç”¨æˆ·å’Œæ–‡ä»¶æƒé™ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;h3&gt;æ·»åŠ ç›¸åº”çš„ç”¨æˆ·å’Œåˆ†ç»„ï¼Œä»¥ç”¨æˆ·å sftpï¼Œåˆ†ç»„å ftpaccess ä¸ºä¾‹ã€‚&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% sudo groupadd ftpaccess&lt;/span&gt;
&lt;span class="c"&gt;% sudo useradd -m sftp -g ftpaccess -s /usr/sbin/nologin&lt;/span&gt;
&lt;span class="c"&gt;% sudo passwd sftp  # æ›´æ”¹å¯†ç &lt;/span&gt;
&lt;span class="c"&gt;% sudo mkdir /var/sftp&lt;/span&gt;
&lt;span class="c"&gt;% sudo chown root /var/sftp  # è¿™ä¸€æ­¥éå¸¸å‘ï¼Œåˆ‡è®°ä¸å¯çœç•¥ï¼Œåé¢è®²ä¸ºä»€ä¹ˆ&lt;/span&gt;
&lt;span class="c"&gt;% sudo mkdir -p /var/sftp/files&lt;/span&gt;
&lt;span class="c"&gt;% sudo chown sftp:ftpaccess /var/sftp/files&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä¿®æ”¹ /etc/ssh/sshd_config æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;æ³¨é‡Šæ‰è¿™ä¸€è¡Œ &lt;code&gt;Subsystem sftp /usr/lib/openssh/sftp-server&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç„¶ååœ¨æ–‡ä»¶çš„ç»“å°¾æ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Subsystem sftp internal-sftp
Match group ftpaccess
ChrootDirectory /var/sftp  # è¿™é‡Œå¯ä»¥éšä¾¿æŒ‡å®šä½ æƒ³è¦çš„é¡¶çº§ç›®å½•
X11Forwarding no
AllowTcpForwarding no
ForceCommand internal-sftp
PasswordAuthentication yes
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ssh çš„å®‰å…¨é…ç½®è¦æ±‚ ChrootDirectory æœ¬èº«å¿…é¡»æ˜¯ root æ‰€æœ‰çš„ï¼Œæ‰€ä»¥ç™»å½•éƒ½çš„æ ¹ç›®å½•æˆ‘ä»¬æ˜¯ä¸å¯å†™çš„ï¼Œä½†æ˜¯å¯ä»¥åœ¨æ–°å»ºçš„ç›®å½•ä¸­è¯»å†™ã€‚&lt;/p&gt;
&lt;h3&gt;é‡å¯ ssh æœåŠ¡&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% sudo systemctl restart ssh&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯é“¾æ¥å•¦~ å¦‚æœéœ€è¦ä½¿ç”¨ publickey ç™»å½•çš„è¯ï¼Œåªéœ€è¦åƒæ™®é€šçš„ç”¨æˆ·ä¸€æ ·ï¼ŒæŠŠæ–‡ä»¶ä¼ åˆ° ~sftp çš„å¯¹åº”ç›®å½•å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h3&gt;ä½¿ç”¨ sshfs mount åˆ°æœ¬åœ°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% brew install sshfs&lt;/span&gt;
&lt;span class="c"&gt;% brew cask install osxfuse&lt;/span&gt;
&lt;span class="c"&gt;% sshfs -o allow_other,defer_permissions -o volname=sftp_files sftp@your.example.com:/files $HOME/sftp_files&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tKfTcly1g09iu47ttpj30i207cabm.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;nextcloud&lt;/h1&gt;
&lt;p&gt;æœªå®Œå¾…ç»­&lt;/p&gt;
&lt;h1&gt;å‚è€ƒèµ„æ–™&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/11216884/which-file-access-is-the-best-webdav-or-ftp&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/osxfuse/osxfuse/wiki/SSHFS"&gt;SSHFS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://askubuntu.com/questions/420652/how-to-setup-a-restricted-sftp-server-on-ubuntu"&gt;æ­å»º sftp æœåŠ¡å™¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.minstrel.org.uk/papers/sftp/builtin/"&gt;sftp çš„ä¸€ä¸ªå‘&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 16 Feb 2019 22:27:00 +0800</pubDate><guid isPermaLink="false">tag:None,2019-02-16:/posts/yun-shi-dai-de-ge-ren-cun-chu-da-jian.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>kubernetes åˆæ¢â€”â€”åœ¨ Master èŠ‚ç‚¹éƒ¨ç½² Pod</title><link>/posts/kubernetes-chu-tan-zai-master-jie-dian-bu-shu-pod.html</link><description>&lt;p&gt;è™½ç„¶ K8S æœ¬èº«ä¸å»ºè®®åœ¨ Master èŠ‚ç‚¹ä¸­éƒ¨ç½² Podï¼Œä½†æ˜¯å®é™…ä¸Šä¹Ÿæ˜¯å¯ä»¥çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;kubectl taint nodes --all node-role.kubernetes.io/master-
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™è¡Œå‘½ä»¤çš„æ„æ€æ˜¯ç§»é™¤æ‰€æœ‰èŠ‚ç‚¹çš„ master taintï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ master èŠ‚ç‚¹éƒ¨ç½² pod å•¦~&lt;/p&gt;
&lt;h1&gt;åŸç†è§£é‡Šâ€”â€”taint å’Œ toleration&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://www.ibm.com/support/knowledgecenter/en/SSCKRH_1.0.1/platform/install_pod_scheduling.html&lt;/li&gt;
&lt;li&gt;https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 12 Feb 2019 19:57:00 +0800</pubDate><guid isPermaLink="false">tag:None,2019-02-12:/posts/kubernetes-chu-tan-zai-master-jie-dian-bu-shu-pod.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>æ•…éšœæ’æŸ¥è®°å½•</title><link>/posts/gu-zhang-pai-cha-ji-lu.html</link><description>&lt;p&gt;Case 1ï¼š&lt;/p&gt;
&lt;p&gt;CPU å’Œå†…å­˜éƒ½è¢«æ‰“æ»¡äº†ï¼ŒåŒæ—¶å‘ç°ç¡¬ç›˜ IO ä¹Ÿå¾ˆé«˜ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ps -eo pid,ppid,cmd,%mem,mem,%cpu --sort=-%mem | head -n 50
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‘ç° kswapd0 å¶å°”ä¼šå ç”¨å¾ˆé«˜çš„ CPUï¼Œè€Œè¿™ä¸ªè¿›ç¨‹æ˜¯åœ¨å†…å­˜æ»¡çš„æ—¶å€™è´Ÿè´£åœ¨å†…å­˜å’Œ swap ä¹‹é—´äº¤æ¢ã€‚ä¹Ÿå°±æ˜¯é—®é¢˜çš„æ ¹æºæ˜¯å†…å­˜æ»¡äº†ï¼Œè€Œ kswapd0 å¼€å§‹åœ¨å†…å­˜å’Œ swap ä¹‹é—´åå¤è¯»å†™æ–‡ä»¶ï¼Œå¯¼è‡´ CPU å’Œ IO ä¹Ÿæ¶¨äº†èµ·æ¥ï¼Œè¿™æ—¶å€™åº”è¯¥æ‰¾åˆ°å†…å­˜æš´æ¶¨çš„æ ¹æºï¼Œè¿›è€Œè§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;[1] https://askubuntu.com/questions/259739/kswapd0-is-taking-a-lot-of-cpu&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 25 Jan 2019 18:03:00 +0800</pubDate><guid isPermaLink="false">tag:None,2019-01-25:/posts/gu-zhang-pai-cha-ji-lu.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>GitHub ä¸Šçš„é¡¶çº§é¡¹ç›®éƒ½æ˜¯åšä»€ä¹ˆçš„ï¼Ÿï¼ˆä¸€ï¼‰</title><link>/posts/github-shang-de-ding-ji-xiang-mu-du-shi-zuo-shi-yao-de-yi.html</link><description>&lt;p&gt;å‰ä¸€é˜µçœ‹åˆ°åŒäº‹åœ¨ç”¨ä¸€ä¸ªåå« AirFlow çš„å·¥å…·ï¼Œè€Œæˆ‘ç«Ÿç„¶ç´ æœªè€³é—»ï¼Œä¸€ç•ªæœç´¢ä¹‹åå‘ç°è¿™ä¸ªå·¥å…·æ˜¯ Apache çš„é¡¶çº§é¡¹ç›®ï¼Œè€Œä¸”åœ¨ GitHub ä¸Šæœ‰ 1w+ çš„ Starã€‚éœ‡æƒŠä¹‹ä½™ï¼Œæ„Ÿè§‰æœ‰å¿…è¦æŠŠ GitHub ä¸Šå¸¸ç”¨å·¥å…·æ‹ä¸€éï¼Œä»¥é¿å…ä»¥åå‘ç”Ÿé‡å¤é€ è½®å­çš„æƒ…å†µã€‚è®¡åˆ’æ˜¯æŠŠ GitHub ä¸Š 5k+ Star çš„é¡¹ç›®éƒ½çŸ¥é“æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œæ¯å‘¨çœ‹ 50 ä¸ªï¼Œæ•°æ®æ¥æºæ˜¯è¿™é‡Œï¼šhttps://gitstar-ranking.com/repositoriesã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯æœ¬å‘¨çš„è®°å½•ï¼š&lt;/p&gt;
&lt;h1&gt;æ•™ç¨‹èµ„æºç±»&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;freeCodeCamp/freeCodeCamp 292180&lt;/p&gt;
&lt;p&gt;å…è´¹ä»£ç è®­ç»ƒè¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;EbookFoundation / free-programming-books 114236&lt;/p&gt;
&lt;p&gt;å…è´¹ç¼–ç¨‹å›¾ä¹¦&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;sindresorhus / awesome&lt;/p&gt;
&lt;p&gt;awesome åˆ—è¡¨çš„åˆ—è¡¨ã€‚è¿™ä¸ªé¡¹ç›®èµ·æºäºæŸä¸ªäººåšäº†ä¸€ä¸ª awesome-php çš„ php ä¼˜è´¨èµ„æºåˆ—è¡¨ï¼Œç„¶åå¤§å®¶å°±åšäº† awesome-pythonï¼Œawesome-vue ç­‰å„ç§åˆ—è¡¨ï¼Œè¿™ä¸ªé¡¹ç›®åˆæŠŠå„ç§ awesome åˆ—è¡¨æ”¶é›†äº†èµ·æ¥ã€‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CyC2018 / CS-Notes&lt;/p&gt;
&lt;p&gt;å›½äººç¼–å†™çš„è®¡ç®—æœºåŸºç¡€æ•™ç¨‹ï¼Œä¸­æ–‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;jwasham / coding-interview-university&lt;/p&gt;
&lt;p&gt;é¢è¯•è€ƒç‚¹æ€»ç»“&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;h5bp / Front-end-Developer-Interview-Questions&lt;/p&gt;
&lt;p&gt;å‰ç«¯å·¥ç¨‹å¸ˆé¢è¯•é—®é¢˜&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;vinta/awesome-python&lt;/p&gt;
&lt;p&gt;å‰é¢æåˆ°çš„ awesome ç³»åˆ—åˆ—è¡¨ï¼Œä¸åœ¨èµ˜è¿°&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;airbnb / javascript&lt;/p&gt;
&lt;p&gt;Airbnb çš„ js ç¼–ç è§„èŒƒï¼Œå€¼å¾—å‚è€ƒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;github / gitignore&lt;/p&gt;
&lt;p&gt;GitHub æä¾›çš„å„ç§é¡¹ç›®çš„ gitignore æ–‡ä»¶æ¨¡æ¿ï¼Œçœäº†è‡ªå·±å†™äº†&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;getify / You-Dont-Know-JS&lt;/p&gt;
&lt;p&gt;å‰ç«¯ï¼ˆJSï¼‰çš„ä¸€äº›å‘çš„æ€»ç»“&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;vuejs/awesome-vue&lt;/p&gt;
&lt;p&gt;awesome ç³»åˆ—ï¼Œä¸å†èµ˜è¿°&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;å‰ç«¯ UI æ¡†æ¶/åº“&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;twbs/bootstrap&lt;/p&gt;
&lt;p&gt;Twitter æ¨å‡ºçš„å‰ç«¯ UI æ¡†æ¶ï¼Œæœ‰ç½‘æ ¼ç³»ç»Ÿå’Œå„ç§ç»„ä»¶ï¼Œæ›¾ç»å¸¸å¹´åœ¨ GitHub ä¸Šæ’åç¬¬ä¸€ï¼Œå¯ä»¥è¯´æ˜¯åç«¯å·¥ç¨‹å¸ˆç”»ç•Œé¢çš„åˆ©å™¨ã€‚&lt;/p&gt;
&lt;p&gt;ç«å“ï¼šSemantic UI, pure-css&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;FontAwesome/Font-Awesome&lt;/p&gt;
&lt;p&gt;å­—ä½“å’Œå›¾æ ‡åº“ï¼Œå¯ä»¥ä½¿ç”¨ SVG å’Œå­—ä½“ç­‰ç­‰å¤šç§æ ¼å¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ant-design/ant-design&lt;/p&gt;
&lt;p&gt;èš‚èšé‡‘æœå‡ºçš„ react ç»„ä»¶åº“ï¼Œå‰ä¸€é˜µå¤§åé¼é¼çš„â€œåœ£è¯å½©è›‹â€å°±æ˜¯è¿™ä¸ªåº“æå¾—ã€‚ä¸»è¦æä¾› React çš„ç»„ä»¶åº“ï¼Œç”¨äºä¼ä¸šä¸­åç«¯çš„åå°çš„å»ºè®¾ã€‚å…³äº React/Vue å’Œå‰ç«¯çš„ç»„ä»¶åŒ–æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„è¯é¢˜ï¼Œå¯ä»¥æŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚&lt;/p&gt;
&lt;p&gt;å’Œ Bootstrap ç­‰çš„åŒºåˆ«åœ¨äºï¼ŒBootstrap æ›´åå‘äº UI æ–¹é¢ï¼Œæ˜¯ CSS æ¡†æ¶ï¼Œè€Œ antd åˆ™æ˜¯å®Œæ•´çš„åŒ…æ‹¬ UI å’ŒåŠŸèƒ½åœ¨å†…çš„ React ç»„ä»¶ã€‚å¯ä»¥ç†è§£ä¸º Bootstrap åªåšäº†â€œçš®â€ï¼Œè€Œ antd æ˜¯ â€œçš®â€ + â€œéª¨â€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Semantic-Org/Sematic-UI&lt;/p&gt;
&lt;p&gt;å’Œ Bootstrap ç±»ä¼¼çš„ä¸€ä¸ªç»„ä»¶åº“ã€‚Semantic UI æ›´å¼ºè°ƒä½¿ç”¨è¯­ä¹‰åŒ–çš„ class æ¥å®šä¹‰æ ·å¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;google / material-design-icons&lt;/p&gt;
&lt;p&gt;Google æ¨å‡ºçš„ Material é£æ ¼å›¾æ ‡åº“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;daneden/animate.css&lt;/p&gt;
&lt;p&gt;CSS åŠ¨ç”»æ•ˆæœåº“&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;å¤§å‰ç«¯æ¡†æ¶å’Œåº“&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;vuejs/vue&lt;/p&gt;
&lt;p&gt;Vue æ˜¯å›½äººæ¨å‡ºçš„ä¸€ä¸ªå‰ç«¯æ¡†æ¶ï¼Œå¯ä»¥é€šè¿‡å†™ä¸åŒçš„ Vue ç»„ä»¶æ¥ç»„æˆä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ï¼Œæ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ã€‚å’Œ React ä¸€æ ·ï¼ŒVue ä¹Ÿä½¿ç”¨äº† Virtual-DOM æŠ€æœ¯æ¥æé«˜æ€§èƒ½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;facebook/react&lt;/p&gt;
&lt;p&gt;facebook æ¨å‡ºçš„ä¸€ä¸ªå‰ç«¯æ¡†æ¶ï¼Œç‰¹ç‚¹æ˜¯æ¯ä¸ªç»„ä»¶çš„ HTML/JS/CSS ç»„åˆåœ¨ä¸€èµ·ï¼Œä½¿ç”¨ Virtual-DOM æ¸²æŸ“ã€‚åœ¨ React å‡ºç°ä¹‹å‰ï¼Œå‰ç«¯æ¡†æ¶æ™®éé‡‡ç”¨äº†åç«¯å¹¿æ³›ä½¿ç”¨çš„ MVC æ¨¡å¼ï¼Œå¼ºè°ƒ HTML/JS/CSS ä¸‰è€…è¦åˆ†ç¦»ï¼Œè€Œ React åˆ™åå…¶é“è€Œè¡Œä¹‹ï¼Œå¼ºè°ƒä»ç»„ä»¶æ„å»ºï¼Œå¯ä»¥ React çš„å‡ºç°æ˜¯å‰ç«¯ç•Œçš„ä¸€åœºé©å‘½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;facebook/react-native&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ React çš„è¯­æ³•æ¥æ„å»º native appï¼Œæ³¨æ„è¿™é‡Œå¹¶ä¸æ˜¯ä½¿ç”¨ä¸€ä¸ª iOS æˆ–è€… Android çš„ WebView ä¸­åµŒå¥—äº†ä¸€ä¸ª webappï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ JS æ¥æ“ä½œåŸç”Ÿç»„ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;angular/angular.js&lt;/p&gt;
&lt;p&gt;Google æ¨å‡ºçš„å‰ç«¯æ¡†æ¶ï¼Œæ²¡ç”¨è¿‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;reactjs/redux&lt;/p&gt;
&lt;p&gt;react.js çš„ä¸€ä¸ªç»„ä»¶ï¼Œç”¨æ¥ç®¡ç†æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;meteor/meteor&lt;/p&gt;
&lt;p&gt;å‰å‡ å¹´ç«è¿‡ä¸€é˜µï¼Œå·ç§°è¦ç»Ÿä¸€å‰åç«¯ï¼Œç„¶è€Œæˆ‘ä»æ¥æ²¡ææ˜ç™½åˆ°åº•æ˜¯å¹²å•¥çš„ï¼Œå¦‚ä»Šçƒ­åº¦å·²ç»å¤§å‡äº†ã€‚HN ä¸Šç”šè‡³ç›´æ¥æœ‰äººé—® &lt;a href="https://news.ycombinator.com/item?id=16782266"&gt;Is meteor.js dead?&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;webpack/webpack&lt;/p&gt;
&lt;p&gt;ç”¨äºæ‰“åŒ…å‰ç«¯èµ„æº&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;chartjs/Chart.js&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;electron&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨å‰ç«¯çš„å·¥å…·é“¾æ¥ç¼–å†™æ¡Œé¢åº”ç”¨ï¼ŒåŒæ—¶èƒ½å¤Ÿè·¨å¹³å°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;jquery&lt;/p&gt;
&lt;p&gt;è€ç‰Œçš„è·¨æµè§ˆå™¨å…¼å®¹åº“ã€‚éšç€æµè§ˆå™¨çš„å‘å±•ï¼Œç°åœ¨ä½¿ç”¨ jquery çš„è¶Šæ¥è¶Šå°‘äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;create-react-app&lt;/p&gt;
&lt;p&gt;ç”¨æ¥æ„é€  react app çš„è¾…åŠ©å·¥å…·ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;d3.js&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;åç«¯å·¥å…·&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;elasticsearch&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Java ç¼–å†™çš„ä¸€ä¸ªæœç´¢å·¥å…·ï¼Œè¦å®ç°å…¨æ–‡æœç´¢çš„è¯ï¼Œé€‰æ‹© ES å°±å¯¹äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;moby&lt;/p&gt;
&lt;p&gt;Docker çš„å†…æ ¸&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;åº“&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ReactiveX/RxJava&lt;/p&gt;
&lt;p&gt;TODO ä¸€ç§ç¼–ç¨‹æ¨¡å¼ï¼Œç°åœ¨è¿˜ä¸æ˜¯å¾ˆäº†è§£ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;æœºå™¨å­¦ä¹ &lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;TensorFlow&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;è¯­è¨€&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Microsoft/TypeScript&lt;/p&gt;
&lt;p&gt;å¾®è½¯æ¨å‡ºçš„ä¸€ä¸ª JavaScript çš„è¶…é›†ã€‚æˆ‘ä»¬çŸ¥é“ JavaScript æ˜¯ä¸€ä¸ªåŠ¨æ€å¼±ç±»å‹çš„è¯­è¨€ï¼Œè¿™ç§ç‰¹æ€§åœ¨å°é¡¹ç›®ä¸Šå¾ˆæ–¹ä¾¿ï¼Œç„¶è€Œéšç€å‰ç«¯é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œå¼ºç±»å‹å¯¹äºç¨‹åºæ­£ç¡®æ€§çš„ä¿è¯å°±æ˜¾å¾—è¶Šæ¥è¶Šé‡è¦äº†ã€‚TypeScript é‡ç‚¹å°±åœ¨äºå¢å¼ºäº†ç±»å‹ï¼Œç”šè‡³åå­—éƒ½å« TypeScriptã€‚&lt;/p&gt;
&lt;p&gt;å¼ºç±»å‹çš„è¯­è¨€æ˜¯è¿‘å¹´æ¥è¯­è¨€çš„å‘å±•è¶‹åŠ¿ï¼Œæ–°è¯­è¨€è¯¸å¦‚ Rustã€Goã€Swift éƒ½æ˜¯å¼ºç±»å‹çš„è¯­è¨€ã€‚è€Œä¸€äº›è€è¯­è¨€ï¼Œæ¯”å¦‚ Python ä¹ŸåŠ å…¥äº† Type Hint çš„åŠŸèƒ½æ¥å¢å¼ºç±»å‹æ”¯æŒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Apple/swift&lt;/p&gt;
&lt;p&gt;Apple æ¨å‡ºçš„æ–°è¯­è¨€ï¼Œç”¨æ¥ä»£æ›¿ Obj-Cã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;golang&lt;/p&gt;
&lt;p&gt;Google æ¨å‡ºçš„ç¼–ç¨‹è¯­è¨€ã€‚ç‰¹ç‚¹æ˜¯é€šè¿‡ Goroutine æ”¯æŒé«˜å¹¶å‘ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;nodejs&lt;/p&gt;
&lt;p&gt;å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ jsã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;é€šç”¨å·¥å…·ç±»&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;hakimel / reveal.js&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ js æ¥åš PPT çš„ä¸€ä¸ªæ¡†æ¶æˆ–è€…è¯´å·¥å…·&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;GoogleChrome/puppeteer&lt;/p&gt;
&lt;p&gt;Google æ¨å‡ºçš„æ“ä½œ Chrome æµè§ˆå™¨çš„ node.js APIã€‚å¯ä»¥ç”¨åœ¨è‡ªåŠ¨åŒ–æµ‹è¯•å’Œçˆ¬è™«çš„é¢†åŸŸã€‚å®˜æ–¹ API çš„æ¨å‡ºåŸºæœ¬ä¸Šæ„å‘³ç€ç¬¬ä¸‰æ–¹å·¥å…·å·²ç»å¤±å»æ„ä¹‰äº†ã€‚æ¯”å¦‚è¯´ Phantom.js ç›´æ¥å®£å¸ƒåœæ­¢ç»´æŠ¤äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;atom&lt;/p&gt;
&lt;p&gt;GitHub æ¨å‡ºçš„ä¸€ä¸ªä»£ç ç¼–è¾‘å™¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;oh-my-zsh&lt;/p&gt;
&lt;p&gt;zsh çš„å¢å¼ºç»„ä»¶é›†ï¼Œå¯ä»¥è®©ä½ çš„ shell å¼‚å¸¸å¼ºå¤§å‘¢ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;vscode&lt;/p&gt;
&lt;p&gt;å¾®è½¯æ¨å‡ºçš„ä»£ç ç¼–è¾‘å·¥å…·ï¼Œç›®å‰å æ®äº†å¸‚åœºä¼˜åŠ¿åœ°ä½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;Web æ¡†æ¶&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;rails&lt;/p&gt;
&lt;p&gt;Ruby çš„ä¸€ä¸ª MVC æ¨¡å¼çš„ web æ¡†æ¶ï¼Œå½“å¹´å¯è°“å¤§çº¢å¤§ç´«ï¼Œç°åœ¨ä¼¼ä¹çƒ­åº¦æœ‰æ‰€è¡°å‡äº†ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¤§å®¶éƒ½ä¸å†™ Web åº”ç”¨äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;expressjs&lt;/p&gt;
&lt;p&gt;Node.js çš„ä¸€ä¸ª Web æ¡†æ¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;socket.io&lt;/p&gt;
&lt;p&gt;å®ç° WebSocket çš„ä¸€ä¸ªåº“ï¼Œä½¿ç”¨ node.js ç¼–å†™ã€‚WebSocket æ˜¯åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å®ç°å…¨åŒå·¥é€šä¿¡çš„ä¸€ä¸ªåè®®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;laravel&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ¯”è¾ƒç°ä»£çš„ PHP MVC web æ¡†æ¶ï¼Œä¸è¿‡ PHP è¿™å‡ å¹´çš„çƒ­åº¦è¡°å‡ä¹Ÿå¾ˆå‰å®³ï¼Œå¥½å¤šæ PHP çš„éƒ½ç›´æ¥è½¬ Go äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;å†…æ ¸&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;linux&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¸ç”¨è¯´äº†å§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 25 Jan 2019 03:29:00 +0800</pubDate><guid isPermaLink="false">tag:None,2019-01-25:/posts/github-shang-de-ding-ji-xiang-mu-du-shi-zuo-shi-yao-de-yi.html</guid><category>åº“</category><category>è®¡ç®—æœº</category></item><item><title>kubernetes åˆæ¢â€”â€”æœåŠ¡æ²»ç†</title><link>/posts/kubernetes-chu-tan-fu-wu-zhi-li.html</link><description>&lt;p&gt;æœåŠ¡æ²»ç†æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ç§æ˜¯ç›´æ¥åœ¨æœåŠ¡ä¸­é›†æˆç†”æ–­é™çº§ç­‰æ“ä½œ&lt;/li&gt;
&lt;li&gt;ä¸€ç§æ˜¯ä½¿ç”¨ sidecar æ¨¡å¼ï¼Œæœ‰å…¬å…±ç»„ä»¶æ¥å¤„ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«å¦‚å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tNc79ly1fzbu3a41c3j30gw09jabr.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;å‚è€ƒèµ„æ–™&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://mp.weixin.qq.com/s/1zAxecTzeZToaWFymeY-sw"&gt;Service Mesh çš„æœ¬è´¨ã€ä»·å€¼å’Œåº”ç”¨æ¢ç´¢ &lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.kubernetes.org.cn/2350.html"&gt;Istio, K8S çš„å¾®æœåŠ¡æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://blog.csdn.net/aa1215018028/article/details/81700796"&gt;å¾®æœåŠ¡ä¹‹ç†”æ–­ã€é™çº§ã€é™æµ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mp.weixin.qq.com/s?__biz=MzI1NzYzODk4OQ==&amp;amp;mid=2247484925&amp;amp;idx=1&amp;amp;sn=5c15ba98fb03a2a0d9c823136f34e162"&gt;å¾®æœåŠ¡åŒ–ä¹‹æœåŠ¡æ‹†åˆ†ä¸æœåŠ¡å‘ç°&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 18 Jan 2019 21:33:00 +0800</pubDate><guid isPermaLink="false">tag:None,2019-01-18:/posts/kubernetes-chu-tan-fu-wu-zhi-li.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>ä½¿ç”¨ cProfile å’Œç«ç„°å›¾è°ƒä¼˜ Python ç¨‹åºæ€§èƒ½</title><link>/posts/shi-yong-cprofile-he-huo-yan-tu-diao-you-python-cheng-xu-xing-neng.html</link><description>&lt;p&gt;æœ¬æ¥æƒ³åä¸‹æ¥å†™ç¯‡ 2018 å¹´çš„æ€»ç»“ï¼Œä»”ç»†æƒ³æƒ³è¿™ä¸€å¹´å‘ç”Ÿçš„äº‹æƒ…å¤ªå¤šäº†ï¼Œè¿˜æ˜¯å†™ç¯‡æŠ€æœ¯æ–‡ç« å§ã€‚&lt;/p&gt;
&lt;p&gt;å‰å‡ å¤©è°ƒè¯•ç¨‹åºï¼Œå‘ç° QPS æ€»æ˜¯å¡åœ¨ 20 å·¦å³ä¸Šä¸å»ã€‚å¼€å§‹ä»¥ä¸ºæ˜¯ IO é—®é¢˜ï¼Œå°±å¤šå¼€äº†äº›å¹¶å‘ï¼Œç„¶å¹¶åµï¼Œè¿™æ‰æƒ³åˆ°å¯èƒ½æ˜¯ CPU çš„é—®é¢˜ã€‚çœ‹äº†çœ‹ç›‘æ§ï¼Œå‘ç°ç¨‹åºæŸä¸€æ­¥çš„å»¶è¿Ÿåœ¨ 400ms å·¦å³ï¼Œè€Œä¸”è¿™ä¸€æ­¥æ˜¯ CPU å¯†é›†çš„ã€‚å½“æ—¶å¼€äº† 4 å°åŒæ ¸çš„æœºå™¨ï¼š(1s / 400ms) * 2 * 4 = 20 å•Šã€‚çœ‹æ¥éœ€è¦ä¼˜åŒ–ä¸‹è¿™ä¸€æ­¥çš„ä»£ç äº†ï¼Œé‚£ä¹ˆç¬¬ä¸€æ­¥å°±æ˜¯æ‰¾åˆ°å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNbRwly1fyqb4f5jhij30yc0pwtej.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æµ‹é‡ç¨‹åºçš„æ€§èƒ½ä¹‹å‰å¹¶æ²¡æœ‰å®é™…åšè¿‡ï¼ŒGoogle äº†ä¸€ç•ªï¼Œæ„Ÿè§‰æ ‡å‡†åº“çš„ cProfile ä¼¼ä¹å€¼å¾—ä¸€è¯•ã€‚&lt;/p&gt;
&lt;p&gt;è¦æµ‹é‡çš„ä»£ç é€»è¾‘ä¹Ÿå¾ˆç®€å•ï¼Œä½¿ç”¨ lxml è§£æ HTMLï¼Œç„¶åæå–ä¸€äº›å­—æ®µå‡ºæ¥ï¼Œè¿™äº›åŸºæœ¬éƒ½æ˜¯è°ƒç”¨çš„ C åº“äº†ï¼Œè§£æçš„ç®—æ³•ä¹Ÿä¸åœ¨ Python ä¸­ã€‚çœ‹èµ·æ¥ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆèƒ½æ”¹è¿›çš„åœ°æ–¹ï¼Œä¸ç®¡æ€æ ·ï¼Œè¿˜æ˜¯å…ˆè·‘ä¸€ä¸‹å§ã€‚&lt;/p&gt;
&lt;p&gt;cProfile æœ‰å¤šç§è°ƒç”¨æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ä»å‘½ä»¤è¡Œè°ƒç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python -m cProfile -s tottime your_program.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­çš„ &lt;code&gt;-s&lt;/code&gt; çš„æ„æ€æ˜¯ sortã€‚å¸¸ç”¨çš„ sort ç±»å‹æœ‰ä¸¤ä¸ªï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;tottimeï¼ŒæŒ‡çš„æ˜¯å‡½æ•°æœ¬èº«çš„è¿è¡Œæ—¶é—´ï¼Œæ‰£é™¤äº†å­å‡½æ•°çš„è¿è¡Œæ—¶é—´&lt;/li&gt;
&lt;li&gt;cumtimeï¼ŒæŒ‡çš„æ˜¯å‡½æ•°çš„ç´¯è®¡è¿è¡Œæ—¶é—´ï¼ŒåŒ…å«äº†å­å‡½æ•°çš„è¿è¡Œæ—¶é—´&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¦è·å¾—å¯¹ç¨‹åºæ€§èƒ½çš„å…¨é¢ç†è§£ï¼Œç»å¸¸éœ€è¦ä¸¤ä¸ªæŒ‡æ ‡éƒ½çœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œæ–¹å¼è°ƒç”¨ï¼Œå› ä¸ºæˆ‘çš„ä»£ç ä¸­è¿˜éœ€è¦ä¸€äº›æ¯”è¾ƒç¹é‡çš„é…ç½®åŠ è½½ï¼Œå¦‚æœæŠŠè¿™éƒ¨åˆ†æ—¶é—´ç®—è¿›å»äº†ï¼Œå¤šå°‘æœ‰äº›å¹²æ‰°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ä»£ç ä¸­è°ƒç”¨ cProfileã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ cProfile çš„ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;cProfile&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;pstats&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;io&lt;/span&gt;

&lt;span class="n"&gt;pr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cProfile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Profile&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;pr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;enable&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;extractor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extract&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;crawl_doc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;composition&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;PageComposition&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;pr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;disable&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StringIO&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;sortby&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cumtime&amp;quot;&lt;/span&gt;  &lt;span class="c1"&gt;# ä»…é€‚ç”¨äº 3.6, 3.7 æŠŠè¿™é‡Œæ”¹æˆå¸¸é‡äº†&lt;/span&gt;
&lt;span class="n"&gt;ps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pstats&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Stats&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_stats&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sortby&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ps&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;print_stats&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getvalue&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æŠŠéœ€è¦ profile çš„ä»£ç æ”¾åˆ° pr.enable å’Œ pr.disable ä¸­é—´å°±å¥½äº†ã€‚æ³¨æ„è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº† cumtime æ’åºï¼Œä¹Ÿå°±æ˜¯ç´¯è®¡è¿è¡Œæ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNbRwly1fyqc3j79mvj31o80lanbu.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ€»çš„è¿è¡Œæ—¶é—´æ˜¯ 200msï¼Œè€Œå…¶ä¸­çº¢æ¡†å†…çš„éƒ¨åˆ†å°±å äº† 100ms! å¦‚æœèƒ½å¤Ÿä¼˜åŒ–è°ƒçš„è¯ï¼Œæ€§èƒ½ä¸€ä¸‹å­å°±èƒ½æé«˜ä¸€å€ã€‚çº¢æ¡†å†…çš„ä»£ç æ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“è§£æä¸€ä¸ª html æ–‡æ¡£ï¼Œç¬¬ä¸€æ­¥æ˜¯å»ºç«‹ DOM æ ‘ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä»å…¶ä¸­æŠ½å–ä¸€äº›é“¾æ¥ã€‚åœ¨ç½‘é¡µä¸­ï¼Œé“¾æ¥ä¸ä¸€å®šæ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯èƒ½æ˜¯ &lt;code&gt;/images/2018-12-31-xxx.jpg&lt;/code&gt; è¿™æ ·çš„ç›¸å¯¹è·¯å¾„ã€‚lxml åº“å¸®æˆ‘ä»¬åšäº†ä¸€ä¸ªè´´å¿ƒçš„é»˜è®¤å€¼ï¼Œé‚£å°±æ˜¯åœ¨æ„é€  DOM æ ‘çš„æ—¶å€™ï¼Œæ ¹æ®ä¼ å…¥çš„ url æ¥å§é¡µé¢ä¸­çš„æ‰€æœ‰ url éƒ½é‡å†™æˆç»å¯¹è·¯å¾„ã€‚çœ‹èµ·æ¥è¿™æ˜¯ä¸ªå¾ˆè´´å¿ƒçš„åŠŸèƒ½ï¼Œä½†æ˜¯åœ¨è¿™é‡Œå´æˆäº†æ€§èƒ½ç“¶é¢ˆã€‚ä¸ºä»€ä¹ˆå¾ˆè€—æ—¶å‘¢ï¼Ÿå¤§æ¦‚æ˜¯å› ä¸ºéœ€è¦éå†æ•´ä¸ª DOM æ ‘ï¼Œé‡å†™æ‰€æœ‰çš„é“¾æ¥å§ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæŠ½å–ä¹‹åçš„é“¾æ¥è¿˜åŸæˆç»å¯¹è·¯å¾„å°±å¥½äº†ï¼Œè€Œä¸æ˜¯äº‹å…ˆæŠŠæ‰€æœ‰é“¾æ¥éƒ½é‡å†™ä¸€éã€‚æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬ç›´æ¥å»æ‰è¿™ä¸ªåŠŸèƒ½å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ä»£ç ä¹‹åï¼Œå†æ¬¡è¿è¡Œ profile è„šæœ¬ï¼Œæ—¶é•¿å˜æˆäº† 100msï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNbRwly1fyqcamiop3j31ly08sjwy.jpg"&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™æˆ‘ä»¬æ¥ç€çœ‹ï¼Œç¨‹åºä¸­ä¸‹ä¸€ä¸ªæ¯”è¾ƒå¤§å¤´çš„æ—¶é—´å ç”¨ï¼šjsonfinder å’Œ json decode/encodeã€‚&lt;/p&gt;
&lt;p&gt;jsonfinder æ˜¯ä¸€ä¸ªæœ‰æ„æ€çš„åº“ï¼Œå®ƒè‡ªåŠ¨ä» HTML ä¸­æŸ¥æ‰¾ json å­—ç¬¦ä¸²å¹¶å°è¯•è§£æï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¹Ÿä¸å¤ªå‡†ã€‚ç»å¸¸ä¸ºäº†æ‰¾åˆ°ç‰¹å®šçš„å€¼ï¼Œè¿˜æ˜¯éœ€è¦ä½¿ç”¨æ­£åˆ™ã€‚é‚£ä¹ˆå¯¹äºè¿™ä¸ªå¯æœ‰å¯æ— çš„åŠŸèƒ½ï¼Œæ€§èƒ½æœ‰è¿™ä¹ˆå·®ï¼Œè¿˜æ˜¯åˆ æ‰å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡åˆ ä»£ç ï¼Œç°åœ¨æ€§èƒ½å·²ç»æ˜¯åŸæ¥çš„å››å€äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™å‘ç°ä»£ç é‡Œé¢æœ‰æ­£åˆ™è¿˜æŒºèŠ±è´¹æ—¶é—´çš„ï¼Œä¸è¿‡è¿˜å¥½ï¼Œæš‚æ—¶å…ˆä¸ç®¡äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNbRwly1fyqcja5bj5j31oi0kydva.jpg"&gt;&lt;/p&gt;
&lt;p&gt;åˆšåˆšéƒ½æ˜¯åªè¿è¡Œäº†ä¸€éï¼Œæµ‹é‡ç»“æœéš¾å…æœ‰éšæœºæ€§ï¼Œå¿…å®šæœ‰å¤±åé¢‡ï¼Œå®é™…ä¸Šåº”è¯¥ä½¿ç”¨å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œæˆåƒä¸Šä¸‡æ¬¡çš„è·‘ï¼Œæ‰èƒ½å¾—åˆ°ä¸€ä¸ªæ¯”è¾ƒå‡†ç¡®åœ°ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢è¿™ä¸ªå°æ­¥éª¤åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆå¯ä»¥ä¼˜åŒ–çš„äº†ï¼Œä¸‹é¢æˆ‘ä»¬æŠŠä¼˜åŒ–ç›®æ ‡æ‰©å¤§ä¸€ç‚¹ï¼Œå¹¶æŠŠæ¬¡æ•°å…ˆå®šä¸º100.&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ç§å›¾æ˜¯æŒ‰ç…§ tottime æ¥æ’åºçš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tNbRwly1fyqclx98l2j31lg0gu7ei.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„å…¶ä¸­æœ€è€—æ—¶çš„æ­¥éª¤æ˜¯ parseUnicodeDocï¼Œä¹Ÿå°±æ˜¯å»ºæ ‘äº†ï¼Œè¿™æ˜¯ç¬¦åˆé¢„æœŸçš„ï¼Œç„¶è€Œæ—è¾¹çš„ ncalls ä¸€æ å´ä¸å¤ªå¯¹åŠ²äº†ã€‚æˆ‘ä»¬æ˜æ˜åªè¿è¡Œäº† 100 æ¬¡ï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªå‡½æ•°è°ƒç”¨äº† 300 æ¬¡å‘¢ï¼Ÿæ˜¾ç„¶ä»£ç ä¸­æœ‰é‡å¤å»ºæ ‘çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯æœ‰éšè—çš„ bugã€‚è¿™ç§åœ°æ–¹ä¸ç»è¿‡ profile å¾ˆéš¾æµ®ç°å‡ºæ¥ï¼Œå› ä¸ºç¨‹åºæœ¬èº«çš„é€»è¾‘æ˜¯å¯¹çš„ï¼Œåªæ˜¯æ¯”è¾ƒè€—æ—¶è€Œå·²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tNbRwly1fyqcrdtifcj31lw0j2woi.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ä¼˜åŒ–ä¹‹åï¼Œç»ˆäºå˜æˆäº† 100. ä» cProfile çš„è¡¨æ ¼ç°åœ¨å·²ç»çœ‹ä¸å‡ºä»€ä¹ˆç»“æœæ¥äº†ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ç«ç„°å›¾ï¼Œå¯è§†åŒ–å¾€å¾€èƒ½è®©æˆ‘ä»¬æ›´å®¹æ˜“æ³¨è§†åˆ°æ€§èƒ½ç“¶é¢ˆã€‚ï¼ˆä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ç”¨ç«ç„°å›¾å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¥ä¸ºå¾ˆéº»çƒ¦ã€‚ã€‚å®é™…å¾ˆç®€å•ï¼‰&lt;/p&gt;
&lt;p&gt;Python ä¸­æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹åŒ…(è§å‚è€ƒæ–‡çŒ®)å¯ä»¥ç›´æ¥ä» cProfile çš„ç»“æœç”Ÿæˆç«ç„°å›¾:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨åŸæœ‰çš„ä»£ç ä¸­åŠ ä¸Šä¸€å¥: &lt;code&gt;pr.dump_stats("pipeline.prof")&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è°ƒç”¨è¯¥å·¥å…·ï¼š&lt;code&gt;flameprof  pipeline.prof &amp;gt; pipeline.svg&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç„¶åæ‰“å¼€ SVG æ–‡ä»¶å°±å¯ä»¥äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tNbRwly1fyqcvj3ah8j30ys0jm42r.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ç«ç„°çš„å®½åº¦ä»£è¡¨äº†è¿è¡Œçš„æ—¶é•¿ï¼Œæˆ‘ä»¬ç°åœ¨çš„ä¼˜åŒ–ç›®æ ‡å°±æ˜¯è¿™äº›è€—æ—¶æ¯”è¾ƒé•¿çš„æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å¤§å…¶ä¸­ mysql çš„è®¿é—®å äº†ç»å¯¹çš„å¤§å¤´ï¼ŒæŒ‰ç†è¯´è·‘100æ¬¡çš„è¯ï¼Œä¸åº”è¯¥æ¯æ¬¡éƒ½èŠ±è´¹æ—¶é—´åœ¨å»ºç«‹è¿æ¥ä¸Šå•Šï¼Œè¿™é‡Œä¸€å®šæœ‰é—®é¢˜ã€‚ç»è¿‡æ’æŸ¥å‘ç°åœ¨æŸå¤„é“¾æ¥æ˜¯ä½¿ç”¨äº† &lt;code&gt;close_old_connections&lt;/code&gt; æ¥ä¿è¯ä¸ä¼šæŠ›å‡ºæ•°æ®åº“æ–­å¼€çš„å¼‚å¸¸ï¼Œè¿™è¿˜æ˜¯åœ¨å¤´æ¡å¸¦æ¥çš„ä¹ æƒ¯ã€‚ã€‚close_old_connections çš„åŠŸèƒ½æ˜¯å…³é—­å·²ç»å¤±æ•ˆçš„é“¾æ¥ï¼Œçœ‹æ¥æˆ‘çš„ç†è§£è¿˜æ˜¯æœ‰è¯¯çš„ã€‚å…ˆæŠŠè¿™å—åˆ æ‰ï¼Œæœ€ç»ˆè§£å†³åº”è¯¥æ˜¯è¿™å—æ”¾åˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œç»Ÿä¸€å­˜å…¥æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;p&gt;å»æ‰ä¹‹åï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tNbRwly1fyqd1728dwj30xd0cvwgn.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨çš„å¤§å¤´åˆå˜æˆ lxml çš„ï¼ŒåˆåŠ¨äº†ä¼˜åŒ–å®ƒçš„å¿ƒæ€ï¼Œlxml æ˜¯ libxml2 çš„ä¸€ä¸ª Python bindingï¼ŒæŸ¥äº†ä¸‹åº”è¯¥æ˜¯æœ€å¿«çš„ html parser äº†ï¼Œè¿™å—çœŸçš„æ²¡æœ‰ä»€ä¹ˆä¼˜åŒ–ç©ºé—´ã€‚ç›¯äº†ä¸€ä¼šå„¿ï¼Œçœ¼ç›æœ€ç»ˆçœ‹åˆ°äº†ä¸€ä¸ªå°è§’è½ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tNbRwly1fyqd351qyvj309v04omxm.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ­£åˆ™åŒ¹é…å±…ç„¶å ç”¨äº† 8% çš„è¿è¡Œæ—¶é—´ï¼Œå¤ªä¸åƒè¯äº†ã€‚è€æ—©ä¹‹å‰å°±å¬è¯´ Python çš„æ ‡å‡†åº“æ­£åˆ™æ€§èƒ½ä¸è¡Œï¼Œç°åœ¨æ‰å‘ç°åŸæ¥æ˜¯çœŸçš„æŒºå·®åŠ²çš„ã€‚Python æ ‡å‡†åº“çš„ re æ¨¡å—é‡‡ç”¨çš„æ˜¯ PCRE çš„å¤„ç†æ–¹å¼ï¼Œè€Œé‡‡ç”¨ NFA çš„å¤„ç†æ–¹å¼çš„æ­£åˆ™è¦å¿«å¾ˆå¤šï¼Œè¿™å—è¿˜éœ€è¦å†çœ‹ä¸€ä¸‹ã€‚ä¸è¿‡çœ¼ä¸‹å€’æ˜¯å¯ä»¥ç›´æ¥æ¢ä¸€ä¸ªåº“æ¥è§£å†³ã€‚regex æ¨¡å—æ˜¯ re æ¨¡å—çš„ä¸€ä¸ª drop-in replacement. &lt;/p&gt;
&lt;p&gt;&lt;code&gt;pip install regex&lt;/code&gt; and &lt;code&gt;import regex as re&lt;/code&gt;ï¼Œå°±æå®šäº†&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNbRwly1fyqd8orglej30xi0dh410.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ­£åˆ™é‚£å—ç›´æ¥æ¶ˆå¤±äº†ã€‚æå‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚æ—¶é—´ä¸æ—©äº†ï¼Œå½“å¤©çš„ä¼˜åŒ–å°±åˆ°æ­¤ç»“æŸäº†ã€‚ä¸Šçº¿ä¹‹åï¼Œç§¯å‹ä¸€ä¸‹å­å°±ä¸‹å»äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNbRwly1fyqda1lv19j30sw0jmt9v.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;åè®°&lt;/h1&gt;
&lt;p&gt;è¦æƒ³è°ƒè¯•çš„æ—¶å€™æ–¹ä¾¿ï¼Œåœ¨å†™ä»£ç çš„æ—¶å€™å°±è¦æ³¨æ„ï¼Œå°½é‡ä½¿è‡ªå·±çš„ä»£ç  mock-friendly ä¸€ç‚¹ã€‚å¦‚æœéœ€è¦å¼•å…¥å¤–éƒ¨çš„æ•°æ®åº“ã€æœåŠ¡ã€APIç­‰ç­‰å„ç§èµ„æºï¼Œæœ€å¥½æœ‰ä¸€ä¸ªå¼€å…³æˆ–è€…é€‰é¡¹èƒ½å¤Ÿä¸åŠ è½½å¤–éƒ¨èµ„æºï¼Œæˆ–è€…è‡³å°‘èƒ½å¤Ÿå¾ˆæ–¹ä¾¿åœ° mock è¿™äº›å¤–éƒ¨æœåŠ¡ï¼Œè¿™æ ·æ–¹ä¾¿å¯¹æ¯ä¸€ä¸ªå°å•å…ƒè¿›è¡Œ profileã€‚&lt;/p&gt;
&lt;p&gt;æ€»æœ‰äººåæ§½ Python çš„æ€§èƒ½ä½ä¸‹ï¼Œä½†æ˜¯ Python æœ¬æ¥å°±ä¸æ˜¯åšè®¡ç®—ä»»åŠ¡çš„å‘€ï¼ŒPython æ˜¯ä¸€é—¨èƒ¶æ°´è¯­è¨€ï¼Œæ˜¯ç”¨æ¥å†™ä¸šåŠ¡é€»è¾‘çš„ï¼Œè€Œä¸æ˜¯ç”¨æ¥å†™CPUå¯†é›†çš„ç®—æ³•çš„ã€‚äº‹å®ä¸Šå¤æ‚çš„è§£æä¸€èˆ¬éƒ½ä¼šç”¨ C++ è¿™ç§ç¡¬æ ¸è¯­è¨€æ¥å†™äº†ï¼Œæ¯”å¦‚ numpy TensorFlow lxmlã€‚å¤§å¤šæ•°ç¨‹åºå‘˜ä¸€å¤© 90% çš„å·¥ä½œé™¤äº†å’Œäº§å“ç»ç†æ’•é€¼ä»¥å¤–ï¼Œä¹Ÿå°±æ˜¯åœ¨å†™ CRUDï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨è¿™äº›åŒ…ã€‚æ‰€ä»¥ç“¶é¢ˆä¸€èˆ¬åœ¨ IO ä¸Šè€Œä¸åœ¨ CPU ä¸Šï¼Œè€Œè§£å†³ IO çš„ç“¶é¢ˆæ‰‹æ®µå°±å¤šäº†ï¼ŒPython ä¸­è‡³å°‘æœ‰ å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹ã€AsyncIOã€Gevent ç­‰å¤šç§æ–¹æ³•ã€‚ä¸è¿‡æ–¹æ³•å¤šå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªå¼Šç«¯ï¼Œè¿™å‡ ç§æ–¹æ³•å¯ä»¥è¯´æ˜¯åŸºæœ¬äº’ä¸å…¼å®¹ï¼Œå¯¹å„ç§ç¬¬ä¸‰æ–¹åº“çš„æ”¯æŒä¹Ÿå‚å·®ä¸é½ã€‚è€Œ Go åœ¨è¿™æ–¹é¢å°±åšåœ°å¾ˆå¥½äº†ï¼Œè¯­è¨€ç›´æ¥å†…ç½®äº† go å…³é”®å­—ï¼Œç”šè‡³éƒ½ä¸æ”¯æŒå¤šçº¿ç¨‹ã€‚æ‰€æœ‰çš„åº“éƒ½æ˜¯æ”¯æŒä¸€ä¸ªç»Ÿä¸€çš„å¹¶å‘æ¨¡å‹ï¼Œå¯¹äºä½¿ç”¨è€…æ¥è¯´æ›´ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;Zen of Python ä¸­æœ‰ä¸€å¥ï¼šThere should be one way -- preferably only one way -- to do a thing. è¿™ç‚¹ä¸Š Python æœ¬èº«æ²¡æœ‰åšåˆ°ï¼Œåå€’æ˜¯ Go å®è·µåœ°éå¸¸å¥½ã€‚&lt;/p&gt;
&lt;p&gt;æ‰¯è¿œäº†ï¼Œç¨‹åºçš„ç“¶é¢ˆå…¶å®ä¸å¤–ä¹CPUã€å†…å­˜å’Œ IO ä¸‰ä¸ªæ–¹é¢ï¼Œè€Œ cProfile å’Œç«ç„°å›¾æ˜¯åˆ¤æ–­ CPU ç“¶é¢ˆçš„ä¸€æŠŠåˆ©å™¨ã€‚&lt;/p&gt;
&lt;p&gt;åé¢è¿˜å‘ç°äº†ä¸€äº›æ€§èƒ½ç“¶é¢ˆï¼Œä¹Ÿåˆ—åœ¨è¿™é‡Œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;yaml çš„ååºåˆ—åŒ–æ—¶é—´è¿‡é•¿ã€‚è§£å†³æ–¹æ³•æ˜¯æ·»åŠ äº†ä¸€ä¸ª Expiring LRU Cacheï¼Œä¸è¦æ¯æ¬¡éƒ½å»åŠ è½½ï¼Œå½“ç„¶ç‰ºç‰²çš„æ˜¯ä¸€ç‚¹ç‚¹å†…å­˜ï¼Œä»¥åŠå½“è§„åˆ™å˜æ›´æ—¶ä¼šæœ‰ä¸€äº›å»¶è¿Ÿï¼Œä¸è¿‡éƒ½æ˜¯å¯ä»¥æ¥å—çš„ã€‚ä¹‹å‰æ—©å°±å¬äººè¯´ Thrift çš„åºåˆ—åŒ–æ€§èƒ½ç›¸æ¯” Protobuf å¤ªä½ï¼Œç°åœ¨æƒ³æƒ³åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿˜çœŸæ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„æ€§èƒ½ç“¶é¢ˆå•Šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å­˜å‚¨ä½¿ç”¨äº† 360 çš„ pikaï¼Œpika å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªåŸºäº rocksdb çš„ç¡¬ç›˜ç‰ˆ redisã€‚æœ€å¼€å§‹çš„æ—¶å€™æ²¡å¤šæƒ³ï¼Œéšä¾¿æ‰¾äº†å°æœºå™¨æ­äº†èµ·å¼€ï¼ŒæŠŠä¸Šé¢çš„é—®é¢˜è§£å†³ä¹‹åï¼Œpika çš„å»¶è¿Ÿå¾ˆå¿«å¤§äº†èµ·æ¥ï¼Œæœºå™¨çš„ç›‘æ§ä¹Ÿæ˜¾ç¤º IO åŸºæœ¬è¢«æ‰“æ»¡äº†ã€‚è¿™æ—¶å€™æ‰å‘ç°åŸæ¥è¿™å°æœºå™¨æ²¡æœ‰ç”¨ SSDï¼Œæœæ–­æ¢äº† SSD é—®é¢˜åŸºæœ¬è§£å†³äº†ã€‚å¦‚æœå†æœ‰é—®é¢˜å¯èƒ½å°±éœ€è¦é›†ç¾¤äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ€§èƒ½è¿™ä¸ªé—®é¢˜å…¶å®æ˜¯å…¸å‹çš„æœ¨æ¡¶ç†è®ºçš„åœºæ™¯ï¼Œç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½æ˜¯ç”±æœ€å·®çš„ä¸€å—å†³å®šçš„ã€‚æ‰€ä»¥ä¹Ÿæ˜¯ä¸€ä¸ªä¸æ–­è¿­ä»£çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ç¥å¤§å®¶æ–°å¹´å¿«ä¹~&lt;/p&gt;
&lt;h1&gt;å‚è€ƒæ–‡çŒ®&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://toucantoco.com/en/tech-blog/tech/python-performance-optimization&lt;/li&gt;
&lt;li&gt;https://docs.python.org/3.6/library/profile.html&lt;/li&gt;
&lt;li&gt;https://medium.com/build-smarter/blazing-fast-python-40a2b25b0495&lt;/li&gt;
&lt;li&gt;https://swtch.com/~rsc/regexp/regexp1.html&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 28 Dec 2018 00:17:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-12-28:/posts/shi-yong-cprofile-he-huo-yan-tu-diao-you-python-cheng-xu-xing-neng.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>ä½¿ç”¨ Nomad ç¼–æ’æœåŠ¡</title><link>/posts/shi-yong-nomad-bian-pai-fu-wu.html</link><description>&lt;p&gt;2019-01-02 æ›´æ–°ï¼šç›¸å¯¹äº Kubernetes æ¥è¯´ï¼ŒNomad è¿˜æ˜¯å¤ªç®€é™‹äº†ï¼Œå¼ƒå‘&lt;/p&gt;
&lt;p&gt;Nomad æ˜¯ HashiCorp å‡ºå“çš„ä¸€ä¸ªå®¹å™¨ç¼–æ’æœåŠ¡ï¼Œç›¸è¾ƒäºé‡é‡çº§çš„ Kubernetes æ¥è¯´ï¼ŒNomad çš„ç‰¹ç‚¹åœ¨äº&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è½»é‡çº§ï¼Œåªæœ‰ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€‚K8s çš„å®‰è£…å¯èƒ½å°±è¦èŠ±ä¸ŠåŠå¤©ï¼Œåœ¨å›½å†…è¿˜æœ‰ä¸‡æ¶çš„é˜²ç«å¢™é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;æ¦‚å¿µä¹Ÿæ¯”è¾ƒæ¸…æ™°ï¼Œä¸“æ³¨äºä»»åŠ¡çš„è°ƒåº¦çš„ç¼–æ’ï¼Œè€Œä¸åƒ Kubernetes ä¸€æ ·å¼•å…¥äº†å„ç§äº”èŠ±å…«é—¨çš„æ¦‚å¿µã€‚&lt;/li&gt;
&lt;li&gt;é™¤äº†ç¼–æ’å®¹å™¨ä¹‹å¤–ï¼ŒNomad è¿˜å¯ä»¥ç›´æ¥ç¼–æ’æ™®é€šåº”ç”¨ï¼Œä½¿ç”¨ cgroups å®‰å…¨è¿è¡Œåº”ç”¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;ä»å®˜ç½‘ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¤åˆ¶åˆ° /usr/local/bin å°±å¥½äº†ï¼Œä¸å†èµ˜è¿°&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo nomad agent -dev

$ nomad node status
ID        DC   Name   Class   Drain  Eligibility  Status
171a583b  dc1  nomad  &amp;lt;none&amp;gt;  &lt;span class="nb"&gt;false&lt;/span&gt;  eligible     ready

$ nomad server members
Name          Address    Port  Status  Leader  Protocol  Build  Datacenter  Region
nomad.global  &lt;span class="m"&gt;127&lt;/span&gt;.0.0.1  &lt;span class="m"&gt;4648&lt;/span&gt;  alive   &lt;span class="nb"&gt;true&lt;/span&gt;    &lt;span class="m"&gt;2&lt;/span&gt;         &lt;span class="m"&gt;0&lt;/span&gt;.7.0  dc1         global
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Job&lt;/h1&gt;
&lt;p&gt;Nomad çš„è°ƒåº¦å•å…ƒç§°ä½œ Jobï¼ŒJob åˆ†ä¸ºäº†ä¸‰ç§ç±»å‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Batchï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡æ‰¹å¤„ç†ï¼Œç¨‹åºè¿è¡Œä¹‹åå°±ç»“æŸäº†ã€‚ä¸è¿‡ä¹Ÿå¯ä»¥é€šè¿‡ cron å­—æ®µæŒ‡å®šä»»åŠ¡å®šæœŸè¿è¡Œ&lt;/li&gt;
&lt;li&gt;Serviceï¼Œç¨‹åºæ˜¯ä¸€ä¸ªå¸¸é©»å†…å­˜çš„æœåŠ¡ï¼Œå¦‚æœé€€å‡ºä¹‹åï¼ŒNomad ä¼šæŒ‰ç…§ç»™å®šçš„ç­–ç•¥é‡å¯&lt;/li&gt;
&lt;li&gt;Systemï¼Œåœ¨æ¯ä¸€ä¸ª Nomad èŠ‚ç‚¹ä¸Šéƒ½éœ€è¦è¿è¡Œçš„æœåŠ¡&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Job å¯ä»¥ä½¿ç”¨ HCL æ–‡ä»¶æ¥å®šä¹‰ï¼ŒHCL æ–‡ä»¶åœ¨è¯­ä¹‰ä¸Šå’Œ JSON æ˜¯ç­‰ä»·çš„ï¼Œåªä¸è¿‡æ˜¯çœå»äº†ä¸€äº›å¤šä½™çš„å¼•å·é€—å·ä¹‹ç±»çš„ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ JSON æ–‡ä»¶æ¥å®šä¹‰ã€‚&lt;/p&gt;
&lt;h2&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„ Job&lt;/h2&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªç©ºç™½çš„ job æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nomad job init
Example job file written to example.nomad
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‰“å¼€ç”Ÿæˆçš„ example.nomad æ–‡ä»¶ï¼Œæˆ‘ä»¬çœ‹åˆ°ç”Ÿæˆäº†ä¸€å¤§æ¨é…ç½®ï¼Œé»˜è®¤å®šä¹‰äº†ä¸€ä¸ª redis æœåŠ¡å™¨çš„ jobã€‚Job ä¸­åŒ…å«äº† Groupï¼ŒGroup ä¸­åŒ…å«äº† Taskï¼Œtask å¯ä»¥è®¤ä¸ºæ˜¯æˆ‘ä»¬æœ€ç»ˆéœ€è¦è¿è¡ŒæœåŠ¡çš„é‚£ä¸ªå‘½ä»¤ã€‚æ¯”å¦‚è¿™é‡Œå°±æ˜¯å®šä¹‰äº†è¿è¡Œ redis:3.2 è¿™ä¸ª docker é•œåƒã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;task &amp;quot;redis&amp;quot; {
  # The &amp;quot;driver&amp;quot; parameter specifies the task driver that should be used to
  # run the task.
  driver = &amp;quot;docker&amp;quot;

  # The &amp;quot;config&amp;quot; stanza specifies the driver configuration, which is passed
  # directly to the driver to start the task. The details of configurations
  # are specific to each driver, so please see specific driver
  # documentation for more information.
  config {
    image = &amp;quot;redis:3.2&amp;quot;
    port_map {
      db = 6379
    }
  }
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å¯ä»¥è¿è¡Œä¸€ä¸‹è¿™ä¸ª job&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % nomad job run example.nomad
==&amp;gt; Monitoring evaluation &amp;quot;4f5559e0&amp;quot;
    Evaluation triggered by job &amp;quot;example&amp;quot;
    Allocation &amp;quot;98959767&amp;quot; created: node &amp;quot;ecf9f7cd&amp;quot;, group &amp;quot;cache&amp;quot;
    Evaluation within deployment: &amp;quot;e66e0957&amp;quot;
    Evaluation status changed: &amp;quot;pending&amp;quot; -&amp;gt; &amp;quot;complete&amp;quot;
==&amp;gt; Evaluation &amp;quot;4f5559e0&amp;quot; finished with status &amp;quot;complete&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åæŸ¥çœ‹ä¸€ä¸‹ job çš„è¿è¡ŒçŠ¶æ€ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nomad status example
...
Allocations
ID        Node ID   Task Group  Version  Desired  Status   Created  Modified
8ba85cef  171a583b  cache       &lt;span class="m"&gt;0&lt;/span&gt;        run      running  5m ago   5m ago
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨æœ€ä¸‹é¢ä¸€è¡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° Allocation çš„çŠ¶æ€ã€‚Allocation å¯ä»¥ç†è§£ä¸ºä¸€ä¸ª Job çš„ä¸€ä¸ªå®ä¾‹åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å†æŸ¥çœ‹è¿™ä¸ª Alloc çš„çŠ¶æ€ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nomad alloc status 8ba85cef
...
Recent Events:
Time                   Type        Description
&lt;span class="m"&gt;10&lt;/span&gt;/31/17 &lt;span class="m"&gt;22&lt;/span&gt;:58:49 UTC  Started     Task started by client
&lt;span class="m"&gt;10&lt;/span&gt;/31/17 &lt;span class="m"&gt;22&lt;/span&gt;:58:40 UTC  Driver      Downloading image redis:3.2
&lt;span class="m"&gt;10&lt;/span&gt;/31/17 &lt;span class="m"&gt;22&lt;/span&gt;:58:40 UTC  Task Setup  Building Task Directory
&lt;span class="m"&gt;10&lt;/span&gt;/31/17 &lt;span class="m"&gt;22&lt;/span&gt;:58:40 UTC  Received    Task received by client
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æŸ¥çœ‹ Alloc çš„æ—¥å¿—&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nomad alloc logs 8ba85cef redis
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä¿®æ”¹ Job&lt;/h2&gt;
&lt;p&gt;æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ª Job ä¸­ cache task group éœ€è¦è¿è¡Œçš„å‰¯æœ¬æ•°é‡æ”¹ä¸º 3&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;count = 3
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ nomad job plan æ¥ dry run ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nomad job plan example.nomad

+/- Job: &lt;span class="s2"&gt;&amp;quot;example&amp;quot;&lt;/span&gt;
+/- Task Group: &lt;span class="s2"&gt;&amp;quot;cache&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt; create, &lt;span class="m"&gt;1&lt;/span&gt; in-place update&lt;span class="o"&gt;)&lt;/span&gt;
  +/- Count: &lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="s2"&gt;&amp;quot;3&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;forces create&lt;span class="o"&gt;)&lt;/span&gt;
      Task: &lt;span class="s2"&gt;&amp;quot;redis&amp;quot;&lt;/span&gt;
...
Job Modify Index: &lt;span class="m"&gt;7&lt;/span&gt;
To submit the job with version verification run:

nomad job run -check-index &lt;span class="m"&gt;7&lt;/span&gt; example.nomad
...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„åˆ°å…¶ä¸­è¿”å›äº†ä¸€ä¸ª check-index è¿™ä¸ªæ˜¯ä¸ºäº†é¿å…åŒæ—¶æ›´æ”¹åŒä¸€ä¸ª job é€ æˆå†²çªã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nomad job run -check-index &lt;span class="m"&gt;7&lt;/span&gt; example.nomad
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;é›†ç¾¤&lt;/h1&gt;
&lt;p&gt;åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å½“ç„¶åº”è¯¥ä½¿ç”¨é›†ç¾¤æ¨¡å¼ï¼Œè€Œä¸æ˜¯å•æœºã€‚nomad å¯ä»¥ç›´æ¥åˆ©ç”¨ consul æ¥å®ç° bootstrap é›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡ç«¯é…ç½®ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# /etc/nomad.d/server.hcl

data_dir = &amp;quot;/etc/nomad.d&amp;quot;

server {
  enabled          = true
  bootstrap_expect = 3
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯åŠ¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nomad agent -config&lt;span class="o"&gt;=&lt;/span&gt;/etc/nomad.d/server.hcl
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®¢æˆ·ç«¯é…ç½®ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# /etc/nomad.d/client.hcl

datacenter = &amp;quot;dc1&amp;quot;
data_dir   = &amp;quot;/etc/nomad.d&amp;quot;

client {
  enabled = true
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯åŠ¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nomad agent -config&lt;span class="o"&gt;=&lt;/span&gt;/etc/nomad.d/client.hcl
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 22 Nov 2018 22:57:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-11-22:/posts/shi-yong-nomad-bian-pai-fu-wu.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Python Redis å®¢æˆ·ç«¯è¿æ¥æ± è§£æ</title><link>/posts/python-redis-ke-hu-duan-lian-jie-chi-jie-xi.html</link><description>&lt;p&gt;Python Redis çš„å®¢æˆ·ç«¯ä½¿ç”¨äº†é“¾æ¥æ± æœºåˆ¶ï¼Œé€šè¿‡å¤ç”¨é“¾æ¥å¯ä»¥å‡ä½æœåŠ¡å™¨çš„å‹åŠ›å¹¶åœ¨å¤±è´¥æ—¶é‡è¯•ã€‚è¿æ¥æ± å…¶å®æ˜¯ä¸€ç§å¾ˆé€šç”¨çš„æœºåˆ¶ï¼Œåœ¨å®ç°å®¢æˆ·ç«¯æ˜¯æ˜¯ä¸€ä¸ªç»å¸¸éœ€è¦ï¼ˆæˆ–è®¸å…¶å®ä¸éœ€è¦ï¼‰é‡å¤å‘æ˜çš„è½®å­ã€‚&lt;/p&gt;
&lt;p&gt;Redis å®¢æˆ·ç«¯ä¸€å…±æ¶‰åŠåˆ°äº†ä¸‰ä¸ªç±»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Connectionï¼Œè¡¨ç¤ºä¸€ä¸ªåˆ°æœåŠ¡å™¨çš„é“¾æ¥&lt;/li&gt;
&lt;li&gt;ConnectionPoolï¼Œé“¾æ¥æ± &lt;/li&gt;
&lt;li&gt;Redisï¼Œä½¿ç”¨è¿æ¥æ± ï¼Œå¹¶åœ¨å¤±è´¥æ—¶é‡è¯•&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Connection ç±»è§£æ&lt;/h1&gt;
&lt;p&gt;Connection ç±»ä¸»è¦è´Ÿè´£å»ºç«‹å’Œ Redis æœåŠ¡å™¨çš„ä¸€ä¸ª Socket é“¾æ¥ï¼Œå¹¶ä¸”æ²Ÿé€šç›¸å…³ä¿¡æ¯ã€‚ä¸‹é¢çš„ä»£ç æ˜¯ Connection ç±»å’Œ socket å¤„ç†ç›¸å…³çš„ä»£ç ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__del__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;disconnect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;Exception&lt;/span&gt;:
            &lt;span class="kt"&gt;pass&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;        è¿æ¥ Redis æœåŠ¡å™¨&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;self._sock&lt;/span&gt;:
            &lt;span class="kt"&gt;return&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_connect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;socket.timeout&lt;/span&gt;:
            &lt;span class="kt"&gt;raise&lt;/span&gt; &lt;span class="nx"&gt;TimeoutError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Timeout connecting to server&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;socket.error&lt;/span&gt;:
            &lt;span class="kt"&gt;e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;sys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;exc_info&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="nx"&gt;raise&lt;/span&gt; &lt;span class="nx"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_error_message&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;sock&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;on_connect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;RedisError&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;clean&lt;/span&gt; &lt;span class="nx"&gt;up&lt;/span&gt; &lt;span class="nx"&gt;after&lt;/span&gt; &lt;span class="nx"&gt;any&lt;/span&gt; &lt;span class="nx"&gt;error&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;on_connect&lt;/span&gt;
            &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;disconnect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="nx"&gt;raise&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;run&lt;/span&gt; &lt;span class="nx"&gt;any&lt;/span&gt; &lt;span class="nx"&gt;user&lt;/span&gt; &lt;span class="nx"&gt;callbacks&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="nx"&gt;right&lt;/span&gt; &lt;span class="nx"&gt;now&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="nx"&gt;only&lt;/span&gt; &lt;span class="nx"&gt;internal&lt;/span&gt; &lt;span class="nx"&gt;callback&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;is&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nx"&gt;pubsub&lt;/span&gt; &lt;span class="nx"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;pattern&lt;/span&gt; &lt;span class="nx"&gt;resubscription&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nx"&gt;callback&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;self._connect_callbacks&lt;/span&gt;:
            &lt;span class="kt"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;_connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;        å»ºç«‹é“¾æ¥çš„å…·ä½“è¿‡ç¨‹, ä¸»è¦æ˜¯ socket æ“ä½œ&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;disconnect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;        å…³é—­é“¾æ¥&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_parser&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;on_disconnect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_sock&lt;/span&gt; &lt;span class="nx"&gt;is&lt;/span&gt; &lt;span class="nx"&gt;None&lt;/span&gt;:
            &lt;span class="kt"&gt;return&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_sock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;shutdown&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;SHUT_RDWR&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_sock&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;socket.error&lt;/span&gt;:
            &lt;span class="kt"&gt;pass&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;None&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;send_packed_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;command&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;not&lt;/span&gt; &lt;span class="nx"&gt;self._sock&lt;/span&gt;:
            &lt;span class="kt"&gt;self.connect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="err"&gt;ã€‚ã€‚ã€‚&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å‘é€å‘½ä»¤åˆ°æœåŠ¡å™¨&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼ŒConnection ç±»ä¸»è¦æ˜¯åœ¨ socket ä¸Šçš„ä¸€å±‚è–„è–„å°è£…ã€‚å½“ç„¶ï¼Œè¿™ä¸ª Connection ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;h1&gt;ConnectionPool ç±»è§£æ&lt;/h1&gt;
&lt;p&gt;redis.py çš„ä»£ç ä¸­ ConnectionPool åˆ†äº†ä¸¤ä¸ªç±»ï¼ŒåŸºç±» ConnectionPoolï¼Œè¿˜æœ‰ä¸€ä¸ªå­ç±» BlockingConnectionPoolã€‚è¿™é‡Œæˆ‘æ„Ÿåˆ°æœ‰äº›ä¸è§£ï¼Œæ—¢ç„¶åªæœ‰ä¸€ä¸ªå­ç±»ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿˜è¦åˆ†æˆä¸¤ä¸ªç±»å‘¢ï¼Ÿå¯èƒ½æ˜¯å¼€å§‹æ—¶å€™è§„åˆ’äº†å¥½å‡ ä¸ªå­ç±»ï¼Œæœ€ååªå®ç°äº†ä¸€ä¸ªå§â€¦â€¦&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ BlockingConnection ç±»ä¸åªæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿˜æ˜¯è¿›ç¨‹å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;ConnectionPool&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;connection_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;max_connections&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;connection_kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;max_connections&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;max_connections&lt;/span&gt; &lt;span class="nx"&gt;or&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;not&lt;/span&gt; &lt;span class="nx"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;max_connections&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kr"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kr"&gt;long&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="nx"&gt;or&lt;/span&gt; &lt;span class="nx"&gt;max_connections&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;0&lt;/span&gt;:
            &lt;span class="kt"&gt;raise&lt;/span&gt; &lt;span class="nx"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;max_connections&amp;quot; must be a positive integer&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connection_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;connection_class&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connection_kwargs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;connection_kwargs&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;max_connections&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;max_connections&lt;/span&gt;

        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;è°ƒç”¨&lt;/span&gt; &lt;span class="nx"&gt;reset&lt;/span&gt; &lt;span class="err"&gt;åˆå§‹åŒ–ä¸€äº›å±æ€§&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;é€šè¿‡&lt;/span&gt; &lt;span class="nx"&gt;pid&lt;/span&gt; &lt;span class="err"&gt;æ£€æŸ¥å®ç°è¿›ç¨‹å®‰å…¨&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_created_connections&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_available_connections&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;ç›´æ¥ä½¿ç”¨ä¸€ä¸ª&lt;/span&gt; &lt;span class="nx"&gt;list&lt;/span&gt; &lt;span class="err"&gt;æ¥å­˜æ”¾è¿æ¥&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_in_use_connections&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;set&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_check_lock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;threading&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Lock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;_checkpid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¦‚æœå½“å‰çš„&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="err"&gt;æ˜¯&lt;/span&gt; &lt;span class="nx"&gt;fork&lt;/span&gt; &lt;span class="err"&gt;æ¥çš„ï¼Œç›´æ¥å…³é—­é“¾æ¥&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="nx"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="kd"&gt;with&lt;/span&gt; &lt;span class="nx"&gt;self._check_lock&lt;/span&gt;:
                &lt;span class="kt"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nx"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¦ä¸€ä¸ªçº¿ç¨‹å·²ç»æ£€æŸ¥äº†ï¼Œç›´æ¥è¿”å›&lt;/span&gt;
                    &lt;span class="k"&gt;return&lt;/span&gt;
                &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;disconnect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
                &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;get_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;command_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;ä»è¿æ¥æ± ä¸­å–ä¸€ä¸ªè¿æ¥ï¼Œæ³¨æ„è¿™é‡Œæ˜¯å¼¹å‡ºï¼Œä¹Ÿå°±æ˜¯åŒä¸€ä¸ªé“¾æ¥åªæœ‰ä¸€ä¸ªç”¨æˆ·ä½¿ç”¨&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_checkpid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_available_connections&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;IndexError&lt;/span&gt;:
            &lt;span class="kt"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;make_connection&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_in_use_connections&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;make_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_created_connections&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="nx"&gt;self.max_connections&lt;/span&gt;:
            &lt;span class="kt"&gt;raise&lt;/span&gt; &lt;span class="nx"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Too many connections&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_created_connections&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connection_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connection_kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;release&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;ä½¿ç”¨å®Œæ¯•è¿æ¥åéœ€è¦æ˜¾å¼è°ƒç”¨&lt;/span&gt; &lt;span class="nx"&gt;release&lt;/span&gt; &lt;span class="err"&gt;æŠŠè¿æ¥å½’è¿˜åˆ°è¿æ¥æ± ä¸­ã€‚&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_checkpid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="nx"&gt;self.pid&lt;/span&gt;:
            &lt;span class="kt"&gt;return&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_in_use_connections&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_available_connections&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;disconnect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;æ–­å¼€æ‰€æœ‰è¿æ¥&lt;/span&gt;
        &lt;span class="nx"&gt;all_conns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;chain&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_available_connections&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                          &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_in_use_connections&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;all_conns&lt;/span&gt;:
            &lt;span class="kt"&gt;connection.disconnect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;BlockingConnectionPool&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ConnectionPool&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;    è¿™ä¸ªè¿æ¥æ± çš„å®ç°æ˜¯çº¿ç¨‹å®‰å…¨çš„&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;max_connections&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="nx"&gt;connection_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;queue_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;LifoQueue&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;connection_kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;

        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;queue_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;queue_class&lt;/span&gt;  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥å­˜æ”¾è¿æ¥&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;timeout&lt;/span&gt;  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¢åŠ äº†è¶…æ—¶åŠŸèƒ½&lt;/span&gt;
        &lt;span class="kr"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;BlockingConnectionPool&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="nx"&gt;connection_class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;connection_class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nx"&gt;max_connections&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;max_connections&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;connection_kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_check_lock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;threading&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Lock&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;é¦–å…ˆåœ¨é˜Ÿåˆ—ä¸­å¡«æ»¡&lt;/span&gt; &lt;span class="nx"&gt;None&lt;/span&gt;&lt;span class="err"&gt;ï¼Œåé¢ä¼šç”¨åˆ°ï¼Œè¿™é‡Œå¾ˆå…³é”®&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pool&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;queue_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;max_connections&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nx"&gt;True&lt;/span&gt;:
            &lt;span class="kt"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pool&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;put_nowait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;Full&lt;/span&gt;:
                &lt;span class="kt"&gt;break&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;Keep&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="nx"&gt;list&lt;/span&gt; &lt;span class="nx"&gt;of&lt;/span&gt; &lt;span class="nx"&gt;actual&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="nx"&gt;instances&lt;/span&gt; &lt;span class="nx"&gt;so&lt;/span&gt; &lt;span class="nx"&gt;that&lt;/span&gt; &lt;span class="nx"&gt;we&lt;/span&gt; &lt;span class="nx"&gt;can&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;disconnect&lt;/span&gt; &lt;span class="nx"&gt;them&lt;/span&gt; &lt;span class="nx"&gt;later&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_connections&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;make_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;åˆ›å»ºä¸€ä¸ªé“¾æ¥ï¼Œè²Œä¼¼å’Œä¸Šé¢çš„å‡½æ•°æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ã€‚&lt;/span&gt;
        &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connection_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connection_kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_connections&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;get_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;command_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;        è·å–ä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œæœ€é•¿ç­‰å¾… timeout ç§’&lt;/span&gt;

&lt;span class="s2"&gt;        å¦‚æœæˆ‘ä»¬è¯»å–åˆ°çš„æ–°è¿æ¥æ˜¯ None çš„è¯ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ã€‚å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ LIFO é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯æ ˆï¼Œ&lt;/span&gt;
&lt;span class="s2"&gt;        æ‰€ä»¥æˆ‘ä»¬ä¼˜å…ˆå¾—åˆ°çš„æ˜¯å·²ç»åˆ›å»ºçš„é“¾æ¥ï¼Œè€Œä¸æ˜¯æœ€å¼€å§‹æ”¾è¿›å»çš„ Noneã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬åªæœ‰åœ¨éœ€è¦çš„æ—¶å€™æ‰ä¼šåˆ›å»º&lt;/span&gt;
&lt;span class="s2"&gt;        æ–°çš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´è¿æ¥æ•°é‡æ˜¯æŒ‰éœ€å¢é•¿çš„ã€‚&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;ç¡®ä¿æ²¡æœ‰æ›´æ¢è¿›ç¨‹&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_checkpid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å°è¯•è·å–ä¸€ä¸ªè¿æ¥ï¼Œå¦‚æœåœ¨&lt;/span&gt; &lt;span class="nx"&gt;timeout&lt;/span&gt; &lt;span class="err"&gt;æ—¶é—´å†…å¤±è´¥çš„è¯ï¼ŒæŠ›å‡º&lt;/span&gt; &lt;span class="nx"&gt;ConnectionError&lt;/span&gt;
        &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;None&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pool&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;block&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;timeout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;Empty&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªé”™è¯¯å¹¶ä¸ä¼šè¢«&lt;/span&gt; &lt;span class="nx"&gt;redis&lt;/span&gt; &lt;span class="err"&gt;æ•è·ï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±å¤„ç†&lt;/span&gt;
            &lt;span class="nx"&gt;raise&lt;/span&gt; &lt;span class="nx"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;No connection available.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¦‚æœçœŸçš„æ²¡æœ‰è¿æ¥å¯ç”¨äº†ï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="nx"&gt;is&lt;/span&gt; &lt;span class="nx"&gt;None&lt;/span&gt;:
            &lt;span class="kt"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;make_connection&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;release&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;é‡Šæ”¾è¿æ¥åˆ°è¿æ¥æ± &lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_checkpid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="nx"&gt;self.pid&lt;/span&gt;:
            &lt;span class="kt"&gt;return&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;Put&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="nx"&gt;back&lt;/span&gt; &lt;span class="nx"&gt;into&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="nx"&gt;pool&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pool&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;put_nowait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="nx"&gt;Full&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;perhaps&lt;/span&gt; &lt;span class="nx"&gt;the&lt;/span&gt; &lt;span class="nx"&gt;pool&lt;/span&gt; &lt;span class="nx"&gt;has&lt;/span&gt; &lt;span class="nx"&gt;been&lt;/span&gt; &lt;span class="nx"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="nx"&gt;after&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="nx"&gt;fork&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="nx"&gt;regardless&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;we&lt;/span&gt; &lt;span class="nx"&gt;don&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nx"&gt;t&lt;/span&gt; &lt;span class="nx"&gt;want&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;
            &lt;span class="nx"&gt;pass&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;disconnect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;é‡Šæ”¾æ‰€æœ‰çš„è¿æ¥&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;self._connections&lt;/span&gt;:
            &lt;span class="kt"&gt;connection.disconnect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;redis.Redis ç±»è§£æ&lt;/h1&gt;
&lt;p&gt;Redis ç±»ä¸­ä½¿ç”¨äº† ConnectionPoolï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼åˆ›å»ºçš„è¯ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ã€‚æ‰€ä»¥æ¯æ¬¡ä½ åœ¨ä½¿ç”¨ Redis çš„æ—¶å€™ï¼Œå…¶å®å·²ç»åœ¨ä½¿ç”¨çº¿ç¨‹æ± äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;Redis&lt;/span&gt;:
    &lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;not&lt;/span&gt; &lt;span class="nx"&gt;connection_pool&lt;/span&gt;:
            &lt;span class="kt"&gt;connection_pool&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;ConnectionPool&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connection_pool&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;connection_pool&lt;/span&gt;
    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;execute_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;æ‰§è¡Œæ¯æ¡å‘½ä»¤éƒ½ä¼šè°ƒç”¨è¯¥æ–¹æ³•&lt;/span&gt;
        &lt;span class="nx"&gt;pool&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connection_pool&lt;/span&gt;
        &lt;span class="nx"&gt;command_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¼¹å‡ºä¸€ä¸ªè¿æ¥&lt;/span&gt;
        &lt;span class="nx"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;pool&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;command_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å°è¯•è°ƒç”¨&lt;/span&gt; &lt;span class="nx"&gt;redis&lt;/span&gt;
            &lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;send_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;parse_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;command_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;TimeoutError&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="kr"&gt;as&lt;/span&gt; &lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¦‚æœæ˜¯è¿æ¥é—®é¢˜ï¼Œå…³é—­æœ‰é—®é¢˜çš„è¿æ¥ï¼Œä¸‹é¢å†æ¬¡ä½¿ç”¨è¿™ä¸ªè¿æ¥çš„æ—¶å€™ä¼šé‡æ–°è¿æ¥ã€‚&lt;/span&gt;
            &lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;disconnect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;not&lt;/span&gt; &lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;retry_on_timeout&lt;/span&gt; &lt;span class="nx"&gt;and&lt;/span&gt; &lt;span class="nx"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;TimeoutError&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                &lt;span class="nx"&gt;raise&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å†æ¬¡å°è¯•è°ƒç”¨&lt;/span&gt; &lt;span class="nx"&gt;redis&lt;/span&gt;
            &lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;send_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;parse_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;command_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;ä¸ç®¡æ€æ ·éƒ½è¦æŠŠè¿™ä¸ªè¿æ¥å½’è¿˜åˆ°è¿æ¥æ± &lt;/span&gt;
            &lt;span class="nx"&gt;pool&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;release&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 21 Nov 2018 22:47:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-11-21:/posts/python-redis-ke-hu-duan-lian-jie-chi-jie-xi.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>HAR æ ¼å¼è§£æ</title><link>/posts/har-ge-shi-jie-xi.html</link><description>&lt;p&gt;HAR(HTTP Archive) æ–‡ä»¶æ˜¯ä¸€ç§å¸¸è§çš„ç”¨æ¥ä¿å­˜ HTTP è¯·æ±‚å’Œå“åº”çš„æ ¼å¼ã€‚æœ¬è´¨ä¸Šï¼ŒHAR æ–‡ä»¶å…¶å®å°±æ˜¯ä¸€ä¸ª JSON æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ª HAR Entry éƒ½å¯ä»¥æœ‰ä»¥ä¸‹è®°å½•å­˜åœ¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;log&lt;/li&gt;
&lt;li&gt;creator&lt;/li&gt;
&lt;li&gt;browser&lt;/li&gt;
&lt;li&gt;pages&lt;ul&gt;
&lt;li&gt;pageTimings&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;entries&lt;ul&gt;
&lt;li&gt;request&lt;ul&gt;
&lt;li&gt;queryString&lt;/li&gt;
&lt;li&gt;postData&lt;/li&gt;
&lt;li&gt;params&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;response&lt;ul&gt;
&lt;li&gt;cookies&lt;/li&gt;
&lt;li&gt;headers&lt;/li&gt;
&lt;li&gt;content&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;cache&lt;/li&gt;
&lt;li&gt;timings&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;log&lt;/h1&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯ä¸€ä¸ª HAR æ–‡ä»¶çš„æ ¹å­—æ®µï¼Œå…¶ä»–å­—æ®µéƒ½æ˜¯è¯¥å­—æ®µçš„å­å­—æ®µ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;{
    &amp;quot;log&amp;quot;: {
        &amp;quot;version&amp;quot; : &amp;quot;1.2&amp;quot;,
        &amp;quot;creator&amp;quot; : {},
        &amp;quot;browser&amp;quot; : {},
        &amp;quot;pages&amp;quot;: [],
        &amp;quot;entries&amp;quot;: [],
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;creator&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;creator&amp;quot;: {
    &amp;quot;name&amp;quot;: &amp;quot;Firebug&amp;quot;,
    &amp;quot;version&amp;quot;: &amp;quot;1.6&amp;quot;,
    &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;browser&lt;/h1&gt;
&lt;p&gt;åŒ creator ç»“æ„å®Œå…¨ä¸€æ ·&lt;/p&gt;
&lt;h1&gt;pages&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;pages&amp;quot;: [
    {
        &amp;quot;startedDateTime&amp;quot;: &amp;quot;2009-04-16T12:07:25.123+01:00&amp;quot;,
        &amp;quot;id&amp;quot;: &amp;quot;page_0&amp;quot;,
        &amp;quot;title&amp;quot;: &amp;quot;Test Page&amp;quot;,
        &amp;quot;pageTimings&amp;quot;: {...},
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    }
]
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;pageTimings&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;pageTimings&amp;quot;: {
    &amp;quot;onContentLoad&amp;quot;: 1720,
    &amp;quot;onLoad&amp;quot;: 2500,
    &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;entries&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;entries&amp;quot;: [
    {
        &amp;quot;pageref&amp;quot;: &amp;quot;page_0&amp;quot;,
        &amp;quot;startedDateTime&amp;quot;: &amp;quot;2009-04-16T12:07:23.596Z&amp;quot;,
        &amp;quot;time&amp;quot;: 50,
        &amp;quot;request&amp;quot;: {...},
        &amp;quot;response&amp;quot;: {...},
        &amp;quot;cache&amp;quot;: {...},
        &amp;quot;timings&amp;quot;: {},
        &amp;quot;serverIPAddress&amp;quot;: &amp;quot;10.0.0.1&amp;quot;,
        &amp;quot;connection&amp;quot;: &amp;quot;52492&amp;quot;,
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    }
]
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;request&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;request&amp;quot;: {
    &amp;quot;method&amp;quot;: &amp;quot;GET&amp;quot;,
    &amp;quot;url&amp;quot;: &amp;quot;http://www.example.com/path/?param=value&amp;quot;,
    &amp;quot;httpVersion&amp;quot;: &amp;quot;HTTP/1.1&amp;quot;,
    &amp;quot;cookies&amp;quot;: [],
    &amp;quot;headers&amp;quot;: [],
    &amp;quot;queryString&amp;quot; : [],
    &amp;quot;postData&amp;quot; : {},
    &amp;quot;headersSize&amp;quot; : 150,
    &amp;quot;bodySize&amp;quot; : 0,
    &amp;quot;comment&amp;quot; : &amp;quot;&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;queryString&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;queryString&amp;quot;: [
    {
        &amp;quot;name&amp;quot;: &amp;quot;param1&amp;quot;,
        &amp;quot;value&amp;quot;: &amp;quot;value1&amp;quot;,
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    },
    {
        &amp;quot;name&amp;quot;: &amp;quot;param1&amp;quot;,
        &amp;quot;value&amp;quot;: &amp;quot;value1&amp;quot;,
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    }
]
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;postData&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;postData&amp;quot;: {
    &amp;quot;mimeType&amp;quot;: &amp;quot;multipart/form-data&amp;quot;,
    &amp;quot;params&amp;quot;: [],
    &amp;quot;text&amp;quot; : &amp;quot;plain posted data&amp;quot;,
    &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;params&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;params&amp;quot;: [
    {
        &amp;quot;name&amp;quot;: &amp;quot;paramName&amp;quot;,
        &amp;quot;value&amp;quot;: &amp;quot;paramValue&amp;quot;,
        &amp;quot;fileName&amp;quot;: &amp;quot;example.pdf&amp;quot;,
        &amp;quot;contentType&amp;quot;: &amp;quot;application/pdf&amp;quot;,
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    }
]
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;response&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;response&amp;quot;: {
    &amp;quot;status&amp;quot;: 200,
    &amp;quot;statusText&amp;quot;: &amp;quot;OK&amp;quot;,
    &amp;quot;httpVersion&amp;quot;: &amp;quot;HTTP/1.1&amp;quot;,
    &amp;quot;cookies&amp;quot;: [],
    &amp;quot;headers&amp;quot;: [],
    &amp;quot;content&amp;quot;: {},
    &amp;quot;redirectURL&amp;quot;: &amp;quot;&amp;quot;,
    &amp;quot;headersSize&amp;quot; : 160,
    &amp;quot;bodySize&amp;quot; : 850,
    &amp;quot;comment&amp;quot; : &amp;quot;&amp;quot;
 }
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;content&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;content&amp;quot;: {
    &amp;quot;size&amp;quot;: 33,
    &amp;quot;compression&amp;quot;: 0,
    &amp;quot;mimeType&amp;quot;: &amp;quot;text/html; charset=utf-8&amp;quot;,
    &amp;quot;text&amp;quot;: &amp;quot;\n&amp;quot;,
    &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;cookies&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;cookies&amp;quot;: [
    {
        &amp;quot;name&amp;quot;: &amp;quot;TestCookie&amp;quot;,
        &amp;quot;value&amp;quot;: &amp;quot;Cookie Value&amp;quot;,
        &amp;quot;path&amp;quot;: &amp;quot;/&amp;quot;,
        &amp;quot;domain&amp;quot;: &amp;quot;www.janodvarko.cz&amp;quot;,
        &amp;quot;expires&amp;quot;: &amp;quot;2009-07-24T19:20:30.123+02:00&amp;quot;,
        &amp;quot;httpOnly&amp;quot;: false,
        &amp;quot;secure&amp;quot;: false,
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    }
]
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;headers&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;headers&amp;quot;: [
    {
        &amp;quot;name&amp;quot;: &amp;quot;Accept-Encoding&amp;quot;,
        &amp;quot;value&amp;quot;: &amp;quot;gzip,deflate&amp;quot;,
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    },
    {
        &amp;quot;name&amp;quot;: &amp;quot;Accept-Language&amp;quot;,
        &amp;quot;value&amp;quot;: &amp;quot;en-us,en;q=0.5&amp;quot;,
        &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
    }
]
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;cache&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;cache&amp;quot;: {
    &amp;quot;beforeRequest&amp;quot;: {},
    &amp;quot;afterRequest&amp;quot;: {},
    &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;beforeRequest&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;beforeRequest&amp;quot;: {
    &amp;quot;expires&amp;quot;: &amp;quot;2009-04-16T15:50:36&amp;quot;,
    &amp;quot;lastAccess&amp;quot;: &amp;quot;2009-16-02T15:50:34&amp;quot;,
    &amp;quot;eTag&amp;quot;: &amp;quot;&amp;quot;,
    &amp;quot;hitCount&amp;quot;: 0,
    &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;timings&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;timings&amp;quot;: {
    &amp;quot;blocked&amp;quot;: 0,
    &amp;quot;dns&amp;quot;: -1,
    &amp;quot;connect&amp;quot;: 15,
    &amp;quot;send&amp;quot;: 20,
    &amp;quot;wait&amp;quot;: 38,
    &amp;quot;receive&amp;quot;: 12,
    &amp;quot;ssl&amp;quot;: -1,
    &amp;quot;comment&amp;quot;: &amp;quot;&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å‚è€ƒèµ„æ–™&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;http://www.softwareishard.com/blog/har-12-spec/#response&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 15 Nov 2018 20:29:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-11-15:/posts/har-ge-shi-jie-xi.html</guid><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>Python ç¯å¢ƒå˜é‡çš„ä¸€ä¸ªå‘</title><link>/posts/python-huan-jing-bian-liang-de-yi-ge-keng.html</link><description>&lt;p&gt;Python ä¸­å¯ä»¥ä½¿ç”¨ os.environ æ“ä½œç¯å¢ƒå˜é‡ï¼Œå‰å‡ å¤©çœ‹åˆ°äº†å…¶ä»–å‡ ä¸ªå‡½æ•° os.getenv å’Œ os.putenvã€‚ç„¶è€Œ os.putenv æ˜¯ä¸€ä¸ªå¤§å‘ï¼Œos.putenv ä¹‹åï¼Œåœ¨åé¢çš„ os.getenv ä¸­å¹¶ä¸èƒ½è¯»å‡ºæ¥ã€‚å›§&lt;/p&gt;
&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://mail.python.org/pipermail/python-list/2013-June/650294.html&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 13 Nov 2018 19:26:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-11-13:/posts/python-huan-jing-bian-liang-de-yi-ge-keng.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>ç½‘é¡µæ›´æ–°ä¸é‡æŠ“ç­–ç•¥</title><link>/posts/wang-ye-geng-xin-yu-zhong-zhua-ce-lue.html</link><description>&lt;p&gt;æˆ‘ä»¬çŸ¥é“ç½‘é¡µæ€»æ˜¯ä¼šæ›´æ–°çš„ã€‚åœ¨å¤§è§„æ¨¡çš„ç½‘ç»œçˆ¬å–ä¸­ï¼Œä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜æ˜¯é‡æŠ“ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™å»é‡æ–°è®¿é—®åŒä¸€ä¸ªç½‘é¡µå·²è·å¾—æ›´æ–°ã€‚è¦è·å¾—è¿™ä¸ªé—®é¢˜çš„è§£ï¼Œéœ€è¦æ»¡è¶³å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°½å¯èƒ½åœ°å°‘è®¿é—®ï¼Œä»¥å‡å°‘è‡ªèº«å’Œå¯¹æ–¹ç«™ç‚¹çš„èµ„æºå ç”¨&lt;/li&gt;
&lt;li&gt;å°½å¯èƒ½å¿«çš„æ›´æ–°ï¼Œä»¥ä¾¿è·å¾—æœ€æ–°ç»“æœ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªæ¡ä»¶å‡ ä¹æ˜¯å¯¹ç«‹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ‰¾åˆ°ä¸€ç§ç®—æ³•ï¼Œå¹¶è·å¾—ä¸€ä¸ªå°½å¯èƒ½ä¼˜çš„æŠ˜è¡·ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨æ³Šæ¾è¿‡ç¨‹ï¼šhttps://stackoverflow.com/questions/10331738/strategy-for-how-to-crawl-index-frequently-updated-webpages&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 13 Nov 2018 00:56:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-11-13:/posts/wang-ye-geng-xin-yu-zhong-zhua-ce-lue.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>å¦‚ä½•è°ƒè¯• Python çš„ Core Dump</title><link>/posts/ru-he-diao-shi-python-de-core-dump.html</link><description>&lt;p&gt;å¦‚æœéœ€è¦è®°å½• Core Dump çš„åŸå› ï¼Œé¦–å…ˆéœ€è¦ä½¿ç”¨ faulthandler å‚æ•°å¯åŠ¨ Python&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python -X faulthandler main.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‡º core ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ gdb è°ƒè¯•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gdb python core
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/2663841/python-tracing-a-segmentation-fault/2664232#2664232&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 12 Nov 2018 18:47:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-11-12:/posts/ru-he-diao-shi-python-de-core-dump.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Linux ä¸‹åˆ†åŒºå¹¶æŒ‚è½½ç£ç›˜</title><link>/posts/linux-xia-fen-qu-bing-gua-zai-ci-pan.html</link><description>&lt;h1&gt;åˆ†åŒº&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;parted -s -a optimal /dev/sda mklabel gpt -- mkpart primary ext4 1 -1s
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkfs.ext4 /dev/sda1
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æŸ¥çœ‹åˆ†åŒºç»“æœ&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;parted -l
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å¤åˆ¶æ•°æ®&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆæŒ‚è½½åˆ°ä¸´æ—¶åˆ†åŒº&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mount /dev/sdb1 /mnt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æŠŠä¹‹å‰çš„æ•°æ®è€ƒè¿›å»&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# rsync -av /home/* /mnt/
OR
# cp -aR /home/* /mnt/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ ¡éªŒæ•°æ®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gh"&gt;diff -r /home /mnt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åˆ é™¤è€æ•°æ®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rm -rf /home/*
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;umount /mnt
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æŒ‚è½½&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mount /dev/sdb1 /home
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å†™å…¥åˆ° fstab ä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;blkid /dev/sdb1

/dev/sdb1: UUID=&amp;quot;e087e709-20f9-42a4-a4dc-d74544c490a6&amp;quot; TYPE=&amp;quot;ext4&amp;quot; PARTLABEL=&amp;quot;primary&amp;quot; PARTUUID=&amp;quot;52d77e5c-0b20-4a68-ada4-881851b2ca99&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ /etc/fstab ä¸­å¢åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;UUID=e087e709-20f9-42a4-a4dc-d74544c490a6   /home   ext4   defaults   0   2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¯ä¸€åˆ—çš„å«ä¹‰å¦‚ä¸‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    UUID â€“ specifies the block device, you can alternatively use the device file /dev/sdb1.
    /home â€“ this is the mount point.
    etx4 â€“ describes the filesystem type on the device/partition.
    defaults â€“ mount options, (here this value means rw, suid, dev, exec, auto, nouser, and async).
    0 â€“ used by dump tool, 0 meaning donâ€™t dump if filesystem is not present.
    2 â€“ used by fsck tool for discovering filesystem check order, this value means check this device after root filesystem.
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;è°ƒæ•´åˆ†åŒºå¤§å°&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆä½¿ç”¨ parted æ‰“å¼€å¯¹åº”çš„ç£ç›˜&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;tiger@iZ8vbe91kz7sqlvkjdu8p6Z:~$ sudo parted
GNU Parted 3.2
Using /dev/vda
Welcome to GNU Parted! Type &amp;#39;help&amp;#39; to view a list of commands.
(parted) select /dev/vdc
Using /dev/vdc
(parted) resizepart
Partition number? 1
Warning: Partition /dev/vdc1 is being used. Are you sure you want to continue?
Yes/No? yes
End?  [107GB]? 1100G
(parted) print
Model: Virtio Block Device (virtblk)
Disk /dev/vdc: 1100GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos
Disk Flags:

Number  Start   End     Size    Type     File system  Flags
 1      1049kB  1100GB  1100GB  primary  ext4
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åä½¿ç”¨ resize2fs é‡æ–°è°ƒæ•´åˆ†åŒºå¤§å°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;resize2fs /dev/vdb1
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://www.tecmint.com/move-home-directory-to-new-partition-disk-in-linux/&lt;/li&gt;
&lt;li&gt;https://www.tecmint.com/parted-command-to-create-resize-rescue-linux-disk-partitions/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 01 Nov 2018 23:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-11-01:/posts/linux-xia-fen-qu-bing-gua-zai-ci-pan.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Linux ä¸­çš„ Process Group å’Œ Session</title><link>/posts/linux-zhong-de-process-group-he-session.html</link><description>&lt;p&gt;ä½¿ç”¨äº†è¿™ä¹ˆå¤šå¹´çš„ Ubuntu, è‡ªä»¥ä¸º Linux ä¸‹è¿›ç¨‹çš„æ¦‚å¿µå·²ç»å¾ˆç†Ÿæ‚‰äº†, ç„¶è€Œå‘ç°è¿›ç¨‹ç»„(Process Group)å’Œä¼šè¯(Session)ä¸¤ä¸ªæ¦‚å¿µæ—¥å¸¸å¹¶ä¸ä¼šæ¥è§¦å¾ˆå¤š, å¹³æ—¶ä¹Ÿæ²¡æœ‰æ³¨æ„, å¯¼è‡´ä»Šå¤©é‡åˆ°ä¸€ä¸ªé—®é¢˜è¿˜æƒ³äº†åŠå¤©æ‰æƒ³æ˜ç™½.&lt;/p&gt;
&lt;p&gt;çœ‹äº†ä¸€äº›è®²è¿›ç¨‹æ§åˆ¶çš„ä¹¦å’Œæ–‡ç« , æ„Ÿè§‰éƒ½æ¯”è¾ƒè€äº†, ä¸å°‘éƒ½è¿˜åœ¨è®² double fork çš„åŸç†åŠæ„ä¹‰, è€Œç°å®æ˜¯ systemd å·²ç»æ¥ç®¡äº†å‡ ä¹æ•´ä¸ª Linux ä¸–ç•Œ, double fork è¿™ç§ä¸œè¥¿çœŸçš„ä¸åº”è¯¥å­˜åœ¨äº†, è‡³å°‘åœ¨æ–°çš„ç¨‹åºä¸­ä¸åº”è¯¥å†ä½¿ç”¨äº†, æ‰€ä»¥æœ‰äº†è¿™ç¯‡æ–‡ç« .&lt;/p&gt;
&lt;h1&gt;å¼•å­--é—®é¢˜&lt;/h1&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“åœ¨å‘½ä»¤è¡Œè¿è¡Œçš„å‰å°å‘½ä»¤, å¯ä»¥éšæ—¶é€šè¿‡ Ctrl-C å…³é—­æ‰. åŸç†å¾ˆç®€å•, å½“æˆ‘ä»¬æŒ‰ä¸‹ Ctrl-C çš„æ—¶å€™, shell è¿›ç¨‹ä¼šå‘å‰å°è¿›ç¨‹å‘é€ä¸€ä¸ª SIGINT ä¿¡å·, è¿›ç¨‹æ”¶åˆ° SIGINT çš„é»˜è®¤æ“ä½œå°±æ˜¯é€€å‡º. æŒ‰ç…§è¿™ä¸ªæ€è·¯å‡ºå‘, åœ¨ fork ä¹‹å, å¦‚æœæŒ‰ä¸‹ Ctrl-C åº”è¯¥åªæœ‰ä¸»è¿›ç¨‹ä¼šå…³é—­, è€Œå­è¿›ç¨‹åº”è¯¥ç»§ç»­è¿è¡Œ, å®é™…ä¸Šå¹¶ä¸æ˜¯è¿™æ ·çš„, ä¸¤ä¸ªè¿›ç¨‹éƒ½æ”¶åˆ°äº† SIGINT ä¿¡å·.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;child&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;child process&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;KeyboardInterrupt&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;child sigint&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;main process&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;KeyboardInterrupt&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;main sigint&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="n"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fork&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“æˆ‘ä»¬æŒ‰ä¸‹ Ctrl-C çš„æ—¶å€™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;main process
child process
main process
child process
^Cchild sigint
main sigint
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ä¸Šè¿°è¯´æ³•å¹¶ä¸æ˜¯å®Œå…¨æ­£ç¡®çš„. å®é™…ä¸Š, SIGINT å¹¶ä¸åªä¼šå‘é€ç»™å‰å°è¿›ç¨‹, è€Œæ˜¯å‘é€ç»™&lt;strong&gt;å‰å°è¿›ç¨‹ç»„&lt;/strong&gt;ä¸­çš„æ¯ä¸€ä¸ªè¿›ç¨‹. é‚£ä¹ˆä»€ä¹ˆæ˜¯è¿›ç¨‹ç»„å‘¢?&lt;/p&gt;
&lt;h1&gt;è¿›ç¨‹ -- Process&lt;/h1&gt;
&lt;p&gt;è¦è¯´è¿›ç¨‹ç»„, æˆ‘ä»¬é¦–å…ˆæ¥å›å¿†ä¸€ä¸‹è¿›ç¨‹çš„æ¦‚å¿µ. è¿›ç¨‹å¯ä»¥ç†è§£ä¸º "è¿›è¡Œä¸­çš„ç¨‹åº", åœ¨ Linux ä¸Šå¯ä»¥é€šè¿‡ fork æ¥åˆ›å»ºæ–°çš„è¿›ç¨‹, ç„¶åå¯ä»¥ä½¿ç”¨ exec æ¥åœ¨å­è¿›ç¨‹æˆ–è€…çˆ¶è¿›ç¨‹ä¸­æ‰§è¡Œæ–°çš„ç¨‹åº.&lt;/p&gt;
&lt;h2&gt;è¿›ç¨‹é€€å‡ºçš„æƒ…å†µ&lt;/h2&gt;
&lt;p&gt;å½“ä¸€ä¸ªè¿›ç¨‹çš„å­è¿›ç¨‹é€€å‡ºçš„æ—¶å€™, çˆ¶è¿›ç¨‹æœ‰ä¹‰åŠ¡å¯¹å­è¿›ç¨‹çš„çŠ¶æ€è¿›è¡Œå›æ”¶(wait). å­è¿›ç¨‹é€€å‡ºçš„æ—¶å€™, çˆ¶è¿›ç¨‹ä¼šæ”¶åˆ° SIGCHLD ä¿¡å·. å¦‚æœå­è¿›ç¨‹é€€å‡ºäº†, è€Œçˆ¶è¿›ç¨‹åˆè¿˜æ²¡æœ‰è¿›è¡Œå›æ”¶, é‚£ä¹ˆåœ¨è¿™æ®µæ—¶é—´å†…, è¿™ä¸ªå­è¿›ç¨‹è¢«ç§°ä¸ºåƒµå°¸è¿›ç¨‹(zombie process), åƒµå°¸è¿›ç¨‹ä¼šæŒç»­å ç”¨ä¸€éƒ¨åˆ†ç³»ç»Ÿèµ„æº, æ‰€ä»¥æœ€å¥½è¿˜æ˜¯å°½å¿«å›æ”¶. å¦‚æœçˆ¶è¿›ç¨‹æ²¡æœ‰è¿›è¡Œå›æ”¶, ä¹Ÿé€€å‡ºäº†, pid=1 çš„ init è¿›ç¨‹ä¼šæ¥ç®¡åƒµå°¸çŠ¶æ€çš„å­è¿›ç¨‹å¹¶è¿›è¡Œå›æ”¶.&lt;/p&gt;
&lt;p&gt;å½“ä¸€ä¸ªè¿›ç¨‹çš„çˆ¶è¿›ç¨‹é€€å‡ºæ—¶, è¿™ä¸ªè¿›ç¨‹è¢«ç§°ä¸ºå­¤å„¿è¿›ç¨‹(orphaned process), å­è¿›ç¨‹ä¼šè¢« init è¿›ç¨‹æ¥ç®¡, ä¹Ÿå°±æ˜¯è¯´, å­è¿›ç¨‹çš„ ppid ä¼šå˜æˆ 1. ä½†æ˜¯, é»˜è®¤æƒ…å†µä¸‹, å­è¿›ç¨‹å¹¶ä¸ä¼šæ”¶åˆ°ä»»ä½•ä¿¡å·. ä¸è¿‡, å¯ä»¥ä½¿ç”¨ prctl ç³»ç»Ÿè°ƒç”¨æ¥è®¾ç½®åœ¨çˆ¶è¿›ç¨‹é€€å‡ºçš„æ—¶å€™, å­è¿›ç¨‹æ”¶åˆ°ä»€ä¹ˆä¿¡å·.&lt;/p&gt;
&lt;h1&gt;è¿›ç¨‹ç»„ -- Process Group&lt;/h1&gt;
&lt;p&gt;é¡¾åæ€ä¹‰å°±æ˜¯ä¸€ç»„è¿›ç¨‹. è¿›ç¨‹ç»„çš„ id (pgid) å°±æ˜¯è¿›ç¨‹ç»„ç»„é•¿(group leader)çš„ pid. å½“ä¸€ä¸ªè¿›ç¨‹ fork çš„æ—¶å€™, å­è¿›ç¨‹é»˜è®¤æ˜¯å’Œçˆ¶è¿›ç¨‹åœ¨åŒä¸€ä¸ªè¿›ç¨‹ç»„çš„. ä» shell ä¸­å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹çš„æ—¶å€™, shell ä¼šç»™è¿™ä¸ªè¿›ç¨‹è®¾ç½®ä¸ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ç»„. å¦‚æœä½¿ç”¨äº† pipe, é‚£ä¹ˆ shell ä¼šå°†è¿™äº›è¿›ç¨‹æ”¾å…¥åŒä¸€ä¸ªè¿›ç¨‹ç»„, æ¯”å¦‚ &lt;code&gt;cat hello | less&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯, å½“è¿›ç¨‹ç»„çš„ leader é€€å‡ºçš„æ—¶å€™, è¿›ç¨‹ç»„çš„å…¶ä»–è¿›ç¨‹å¹¶ä¸ä¼šå—å½±å“, ç³»ç»Ÿä¸ä¼šç»™å­¤å„¿è¿›ç¨‹å‘é€ä»»ä½•ä¿¡å·. ä¸€ä¸ªè¿›ç¨‹ç»„åœ¨æœ€åä¸€ä¸ªè¿›ç¨‹é€€å‡ºæ—¶æ¶ˆå¤±.&lt;/p&gt;
&lt;h2&gt;ç›¸å…³å‡½æ•°&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;getpgid(pid) - è·å¾—æŒ‡å®š pid å¯¹åº”çš„ pgid
setpgid(pid, pgid) - è®¾å®šæŒ‡å®šè¿›ç¨‹çš„ pgid
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­å¯ä»¥ç”¨ 0 æ¥è¡¨ç¤ºå½“å‰è¿›ç¨‹, å¦‚æœè®¾ç½®å½“å‰è¿›ç¨‹çš„ pgid ä¸ºè‡ªå·±çš„ pid, ä¹Ÿå°±æ˜¯é’¦ç‚¹è‡ªå·±ä¸º group leader, é‚£ä¹ˆå°±ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è¿›ç¨‹ç»„.&lt;/p&gt;
&lt;h2&gt;ç›¸å…³å‘½ä»¤&lt;/h2&gt;
&lt;p&gt;kill å‘½ä»¤ç”¨æ¥ç»™ pid å‘é€ä¿¡å·, ä¸€èˆ¬å‘½ä»¤å½¢å¼æ˜¯ &lt;code&gt;kill -SIG PID&lt;/code&gt;, å¯ä»¥åœ¨PIDå‚æ•°å‰é¢åŠ ä¸Š &lt;code&gt;-&lt;/code&gt; è¡¨ç¤ºä¸€ä¸ª Process Group, è€Œä¸æ˜¯ Process. æ¯”å¦‚:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;kill -TERM -6379  # å‘ 6379 è¿›ç¨‹ç»„å‘é€ TERM ä¿¡å·
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å›åˆ°é—®é¢˜&lt;/h1&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å¯ä»¥å†æ€è€ƒä¸€ä¸‹åˆšå¼€å§‹çš„é—®é¢˜, ä¸ºä»€ä¹ˆæŒ‰ Ctrl-C çš„æ—¶å€™, çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹éƒ½ä¼šæ”¶åˆ° SIGINT ä¿¡å·å‘¢? ç­”æ¡ˆä¹‹å‰è¯´äº†:å®é™…ä¸Š, SIGINT å¹¶ä¸åªä¼šå‘é€ç»™å‰å°è¿›ç¨‹, è€Œæ˜¯å‘é€ç»™å‰å°è¿›ç¨‹ç»„ä¸­çš„æ¯ä¸€ä¸ªè¿›ç¨‹. è€Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å½“å‰æ‰€åœ¨çš„ç»„æ­£æ˜¯å‰å°è¿›ç¨‹ç»„.&lt;/p&gt;
&lt;p&gt;å‰å°è¿›ç¨‹ç»„æ˜¯ä¸€ä¸ª session ä¸­åœ¨å‰å°è¿è¡Œçš„é‚£ä¸€ç»„è¿›ç¨‹, é‚£ä¹ˆä»€ä¹ˆåˆæ˜¯ session å‘¢?&lt;/p&gt;
&lt;h1&gt;ä¼šè¯ -- session&lt;/h1&gt;
&lt;p&gt;session æ˜¯ä¸€ä¸ªæ›´å¤§çš„æ¦‚å¿µ, ä¸€ä¸ª session ä¸­å¯ä»¥åŒ…å«å¤šä¸ª process group.&lt;/p&gt;
&lt;p&gt;ä»–ä»¬çš„å…³ç³»æ˜¯è¿™æ ·çš„:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;+--------------------------------------------------------------+
|                                                              |
|      pg1             pg2             pg3            pg4      |
|    +------+       +-------+        +-----+        +------+   |
|    | bash |       | sleep |        | cat |        | jobs |   |
|    +------+       +-------+        +-----+        +------+   |
| session leader                     | wc  |                   |
|                                    +-----+                   |
|                                                              |
+--------------------------------------------------------------+
                            session
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å’Œ process group ä¸€æ ·, æ¯ä¸ª session ä¹Ÿæœ‰ä¸€ä¸ª leader, session leader å°±æ˜¯ è¿™ä¸ªè¿›ç¨‹çš„ pid. session çš„æœ¬æ„æ˜¯ç”¨æ¥ä½œä¸šæ§åˆ¶, æ¯ä¸ªç”¨æˆ·ç™»å½•çš„æ—¶å€™éƒ½ä¼šåˆ›å»ºè‡ªå·±çš„ session. ä¸€èˆ¬æ¥è¯´åœ¨ shell ä¸­, session leader å°±æ˜¯ shell æœ¬èº«.&lt;/p&gt;
&lt;h2&gt;ç›¸å…³å‡½æ•°&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;getsid(pid) - è·å¾—æŒ‡å®š pid å¯¹åº”çš„ sid
setsid() - åˆ›å»ºæ–°çš„session
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯, setsid ä¸èƒ½ç”± group leader è¿›ç¨‹æ¥è°ƒç”¨, å› ä¸ºè¿™æ ·ä¼šå¯¼è‡´åŒä¸€ä¸ª group ä¸­çš„è¿›ç¨‹å±äºä¸åŒçš„ session, æ‰€ä»¥ POSIX æ ‡å‡†ç›´æ¥ç¦æ­¢äº†è¿™ä¹ˆåš.&lt;/p&gt;
&lt;h2&gt;session é€€å‡º&lt;/h2&gt;
&lt;p&gt;å½“ä¸€ä¸ªsession leader é€€å‡ºæ—¶, å…¶ä»–è¿›ç¨‹ä¸ä¼šå—åˆ°ä»»ä½•å½±å“, ä½†æ˜¯å› ä¸º session leader é€€å‡ºå¯èƒ½é€ æˆ orphaned process group, å› æ­¤åœ¨shellä¸­, &lt;strong&gt;ä¸€èˆ¬æƒ…å†µä¸‹ä¼šé€ æˆè¿›ç¨‹é€€å‡ºçš„æƒ…å†µ&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;Orphaned Process Group&lt;/h2&gt;
&lt;p&gt;å½“ä¸€ä¸ª group leader é€€å‡ºçš„æ—¶å€™, æœ¬èº«å¹¶ä¸ä¼šå¯¹è¿›ç¨‹ç»„é€ æˆä»»ä½•å½±å“, ä¹Ÿä¸ä¼šæ”¶åˆ°ä»»ä½•ä¿¡å·. ä½†æ˜¯, å½“ä¸€ä¸ªè¿›ç¨‹ç»„å˜æˆå­¤å„¿è¿›ç¨‹ç»„(orphaned process group)çš„æ—¶å€™, å¯èƒ½ä¼šæ”¶åˆ°ä¸€äº›ä¿¡å·.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å­¤å„¿è¿›ç¨‹ç»„&lt;/p&gt;
&lt;p&gt;A process group is called orphaned when the parent of every member is either in the process group or outside the session. In particular, the process group of the session leader is always orphaned.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªè¿›ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹éƒ½åœ¨ç»„å†…æˆ–è€…éƒ½æ˜¯å…¶ä»– session çš„è¿›ç¨‹(æ¯”å¦‚ init)çš„æ—¶å€™, è¿™ä¸ªè¿›ç¨‹ç»„è¢«ç§°ä¸ºå­¤å„¿è¿›ç¨‹ç»„. æ˜¾ç„¶, æ¯ä¸ªè¿›ç¨‹çš„é€€å‡ºæˆ–è€…ç§»å‡ºè¿›ç¨‹ç»„éƒ½å¯èƒ½é€ æˆè¿›ç¨‹ç»„å˜æˆå­¤å„¿è¿›ç¨‹ç»„. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœè¿™æ—¶å€™è¿›ç¨‹ç»„ä¸­çš„æŸä¸ªè¿›ç¨‹çš„çŠ¶æ€æ˜¯ STOP, é‚£ä¹ˆå†…æ ¸ä¼šå‘è¯¥è¿›ç¨‹ç»„çš„æ‰€æœ‰è¿›ç¨‹å‘é€ SIGHUP, å¹¶ç´§æ¥ç€å‘é€ SIGCONT ä¿¡å·.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯, session leader æœ¬èº«å°±æ˜¯ä¸€ä¸ªå­¤å„¿è¿›ç¨‹ç»„äº†, æ‰€ä»¥é€€å‡ºçš„æ—¶å€™ä¸ä¼šç»™æœ¬ç»„çš„è¿›ç¨‹å‘ä¿¡å·, ä¸‹é¢è¦ç”¨åˆ°.&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆå†…æ ¸è¦è¿™ä¹ˆåšå‘¢?&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬æƒ…å†µä¸‹, shell è¿›ç¨‹æ˜¯å½“å‰ session çš„ leader, å½“æˆ‘ä»¬è¿è¡Œæ¯ä¸ªå‘½ä»¤çš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Process Group, å¦‚æœè¿™æ—¶å€™æŸä¸ªå­¤å„¿è¿›ç¨‹ç»„ä¸­æœ‰è¿›ç¨‹æ˜¯ STOP çŠ¶æ€çš„, é‚£ä¹ˆå¯èƒ½å°±å†ä¹Ÿæ²¡æœ‰æœºä¼šè¿è¡Œäº†, æ‰€ä»¥ç³»ç»Ÿé¦–å…ˆå‘é€ SIGHUP ä¿¡å·é€€å‡º, å¦‚æœæœ‰è¿›ç¨‹å¯¹ SIGINT åšäº†å¤„ç†, é‚£ä¹ˆåœ¨æ”¶åˆ° SIGCONT ä¿¡å·ä¹‹ååˆå¯ä»¥ç»§ç»­è¿è¡Œäº†.&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´å½“æˆ‘ä»¬é€€å‡º shell çš„æ—¶å€™, å†…æ ¸ä¼šå‘ session ä¸­çš„&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‰å°è¿›ç¨‹ç»„&lt;/li&gt;
&lt;li&gt;å­¤å„¿è¿›ç¨‹ç»„&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‘é€ SIGHUP ä¿¡å·, ä»è€Œé€€å‡ºä»–ä»¬. é‚£ä¹ˆé—®é¢˜æ¥äº†, åå°è¿›ç¨‹ç»„å‘¢?&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¯: shell ä¼šå‘sessionçš„æ‰€æœ‰è¿›ç¨‹ç»„å‘é€ SIGHUP ä¿¡å·, æ‰€ä»¥è¿è¡Œä¸­çš„åå°è¿›ç¨‹ç»„ä¹Ÿä¼šé€€å‡º.&lt;/p&gt;
&lt;h2&gt;daemonize&lt;/h2&gt;
&lt;p&gt;åœ¨ Unix çš„ä¸Šå¤æ—¶æœŸ, æ²¡æœ‰ Process Manager è¿™ä¸ªæ¦‚å¿µ, æ‰€ä»¥æ¯ä¸ªå®ˆæŠ¤è¿›ç¨‹(æ¯”å¦‚è¯´ apache)éƒ½éœ€è¦è‡ªå·±å˜æˆå®ˆæŠ¤è¿›ç¨‹, ä¸€èˆ¬æ¥è¯´æ˜¯é€šè¿‡ double fork çš„å½¢å¼:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;fork ç¬¬ä¸€æ¬¡, ç¡®ä¿è‡ªå·±ä¸æ˜¯ group leader&lt;/li&gt;
&lt;li&gt;setsid, åˆ›å»ºæ–°çš„ session&lt;/li&gt;
&lt;li&gt;fork ç¬¬äºŒæ¬¡, ç¡®ä¿è‡ªå·±ä¸æ˜¯ session leader, é¿å…è·å– tty&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å®é™…ä¸Šæ•´ä¸ªæ­¥éª¤éœ€è¦ 15 æ­¥ä¹‹å¤š, å¯ä»¥æŸ¥çœ‹ &lt;code&gt;man 7 daemon&lt;/code&gt; å‘½ä»¤.&lt;/p&gt;
&lt;p&gt;æ•´ä¸ªè¿‡ç¨‹éå¸¸å¤æ‚, åœ¨ GNU C lib ä¸­æä¾›äº† daemon() å‡½æ•°æ¥å®ç°è¿™äº›æ­¥éª¤, ç„¶è€Œè®½åˆºçš„æ˜¯, ç”±äºæ­¥éª¤å®åœ¨å¤ªå¤šäº†, ç³»ç»Ÿæä¾›çš„ daemon å‡½æ•°ç«Ÿç„¶å¿˜äº†å…¶ä¸­å‡ æ­¥, æ‰€ä»¥ä¸æ¨èä½¿ç”¨...&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘çœ‹æ¥, ç”±è¿›ç¨‹è‡ªæˆ‘å®ˆæŠ¤å®é™…ä¸Šå®Œå…¨èƒŒç¦»çš„ Unix philosophy -- Write programs that do one thing and do it well, æ¯ä¸ªè¿›ç¨‹åº”è¯¥åªåšä¸€ä»¶äº‹, å˜æˆå®ˆæŠ¤è¿›ç¨‹æ˜¾ç„¶æ˜¯è®©ä¸€ä¸ªè¿›ç¨‹åšäº†ä¸¤ä»¶äº‹, è€Œä¸”æ˜¯ä¸€ä¸ªé‡å¤æ€§çš„å·¥ä½œ, ç”±ä¸€ä¸ªç»Ÿä¸€çš„ init è¿›ç¨‹æ¥ç®¡ç† daemon æ‰æ˜¯çœŸæ­£ç¬¦åˆ Unix å“²å­¦çš„.&lt;/p&gt;
&lt;h1&gt;systemd&lt;/h1&gt;
&lt;p&gt;åœ¨ç°ä»£çš„ Linux ä¸Š, ç³»ç»Ÿå±‚é¢, æˆ‘ä»¬é€šè¿‡ systemd æ¥ç®¡ç†å®ˆæŠ¤è¿›ç¨‹, æ¯ä¸ªè¿›ç¨‹åªéœ€è¦å®ç°æœ€ç®€å•çš„å•è¿›ç¨‹ç¨‹åºå°±å¥½äº†, ç„¶åé€šè¿‡ç¼–å†™ systemd çš„ unit æ–‡ä»¶æ¥å®ç° daemonize. ç”¨æˆ·å±‚é¢, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ supervisord æˆ–è€… pm2 æ¥ç®¡ç†è¿›ç¨‹, ä»–ä»¬å’Œ systemd çš„åŠŸèƒ½å’Œç†å¿µéƒ½æ˜¯ç±»ä¼¼çš„.&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯, å¦‚ä¸Šæ–‡æ‰€è¿°, ä¸€ä¸ªè¿›ç¨‹å®Œå…¨å¯ä»¥é€šè¿‡ setsid å’Œ fork ç­‰æ“ä½œè€Œå®Œå…¨è„±ç¦»åˆ›å»ºè¿›ç¨‹çš„æ§åˆ¶, è€Œä¸”ä¸å°‘è¿›ç¨‹åœ¨åˆ›å»ºçš„æ—¶å€™ä¹Ÿæ˜¯å…·æœ‰ root æƒé™çš„, é‚£ä¹ˆ systemd æ˜¯æ€æ ·ç¡®ä¿è¿›ç¨‹ä¸ä¼šå·å·è·‘æ‰çš„å‘¢? &lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¯ cgroups, ä¸”å¬ä¸‹å›åˆ†è§£...&lt;/p&gt;
&lt;h1&gt;å‚è€ƒèµ„æ–™&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://www.win.tue.nl/~aeb/linux/lk/lk-10.html&lt;/li&gt;
&lt;li&gt;https://notes.shichao.io/apue/ch9/#sessions&lt;/li&gt;
&lt;li&gt;http://blog.jorgenschaefer.de/2014/07/why-systemd.html&lt;/li&gt;
&lt;li&gt;https://unix.stackexchange.com/questions/149741/why-is-sigint-not-propagated-to-child-process-when-sent-to-its-parent-process&lt;/li&gt;
&lt;li&gt;https://segmentfault.com/a/1190000009152815&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/24346126/where-do-zombie-processes-go-after-their-parent-dies&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/881388/what-is-the-reason-for-performing-a-double-fork-when-creating-a-daemon&lt;/li&gt;
&lt;li&gt;https://unix.stackexchange.com/questions/404054/how-is-a-process-group-id-set&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/a/39109685/1061155&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/32780706/does-linux-kill-background-processes-if-we-close-the-terminal-from-which-it-has&lt;/li&gt;
&lt;li&gt;https://superuser.com/questions/403200/what-is-a-stopped-process-in-linux&lt;/li&gt;
&lt;li&gt;http://www.informit.com/articles/article.aspx?p=397655&amp;amp;seqNum=6&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/13069634/python-daemon-and-systemd-service&lt;/li&gt;
&lt;li&gt;https://unix.stackexchange.com/questions/447275/does-systemd-not-protect-processes-against-acquiring-a-controlling-terminal&lt;/li&gt;
&lt;li&gt;https://linuxaria.com/article/how-to-manage-processes-with-cgroup-on-systemd&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 20 Oct 2018 07:22:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-10-20:/posts/linux-zhong-de-process-group-he-session.html</guid><category>å¹¶å‘ç¼–ç¨‹</category><category>è®¡ç®—æœº</category></item><item><title>Python + Influxdb + Grafana çš„ç›‘æ§ç³»ç»Ÿ</title><link>/posts/python-influxdb-grafana-de-jian-kong-xi-tong.html</link><description>&lt;h1&gt;influxdb&lt;/h1&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æŠŠç›‘æ§æ•°æ®å­˜åˆ° influxdb å‘¢? å­˜åˆ° MySQL æˆ–è€… MongoDB ç”šè‡³ Elasticsearch ä¸å¥½ä¹ˆ?&lt;/p&gt;
&lt;p&gt;æ•°æ®æ¨¡å‹ä¸Š, ç›‘æ§æ•°æ®æ˜¯å’Œæ—¶é—´ç›¸å…³çš„, è„±ç¦»ç‚¹äº§ç”Ÿçš„æ—¶é—´, é‚£ä¹ˆæ•°æ®å°†æ¯«æ— æ„ä¹‰, ä¼ ç»Ÿæ•°æ®åº“ä¸­å¹¶æ²¡åˆå¼ºè°ƒè¿™ä¸€ç‚¹.&lt;/p&gt;
&lt;p&gt;æ€§èƒ½ä¸Š, influxdb æ˜¯æ—¶é—´åºåˆ—æ•°æ®åº“, è¿™ç±»æ•°æ®åº“é¢ä¸´çš„é—®é¢˜æ˜¯å†™å…¥éå¸¸å¤š, è€Œè¯»å–æ¯”è¾ƒå°‘. è€Œæ™®é€šçš„æ•°æ®åº“ä¸€èˆ¬éƒ½æ˜¯è¯»æ¯”è¾ƒå¤š, è€Œå†™å…¥è¾ƒå°‘, å¹¶ä¸”è¦ä¿è¯å†™å…¥çš„æ­£ç¡®æ€§. &lt;/p&gt;
&lt;p&gt;ç›‘æ§æ‰“ç‚¹æ˜¾ç„¶æ˜¯ä¸€ä¸ªé¢å‘æ—¶é—´åºåˆ—çš„è¿‡ç¨‹, å¹¶ä¸”å†™å…¥éå¸¸å¤š, è€Œä¸€èˆ¬åªæœ‰åœ¨è§¦å‘å‘Šè­¦, æ’æŸ¥é—®é¢˜çš„æ—¶å€™å¯èƒ½è¯»å–æ‰æ¯”è¾ƒå¤š. æ‰€ä»¥ä»æ€§èƒ½å’ŒåŠŸèƒ½è€ƒè™‘ä¸Šæ¥è¯´, ä¼ ç»Ÿæ•°æ®åº“éƒ½æ˜¯ä¸é€‚ç”¨çš„.&lt;/p&gt;
&lt;p&gt;influxdb ä¸­å¸¸è§çš„å­˜å‚¨æ•°æ®æ ¼å¼:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cpu_usage value=49 1502043216
cpu_usage value=50 1502193042
cpu_usage value=5 1502196258
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;influxdb æ•°æ®æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä»¥ä¸€ä¸ª measurement(æµ‹é‡) ä½œä¸ºä¸€ä¸ªè¡¨, tag-value, field-value éƒ½æ˜¯è®°å½•æ•°æ®çš„é”®å€¼å¯¹, åŒºåˆ«æ˜¯ tag æ˜¯ç”±ç´¢å¼•çš„, è€Œ field æ²¡æœ‰, timestamp æ˜¯æ—¶é—´æˆ³. tag set è‡ªç„¶æŒ‡çš„æ˜¯ä¸€ç»„ tag çš„ç»„åˆ.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;measurement,tag=value,tag1=value1 field=value,field1=value1 timestamp
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;measurement + tag set&lt;/code&gt; è¢«ç§°ä¸ºä¸€ä¸ªåºåˆ—(series). æ¯ä¸€ä¸ª series éƒ½å¯ä»¥æŒ‡å®šä¸åŒçš„ retention policy.&lt;/p&gt;
&lt;h2&gt;influxdb æŸ¥è¯¢&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ç±»ä¼¼ SQL çš„è¯­è¨€, æ‰§è¡Œ &lt;code&gt;influx&lt;/code&gt; è¿›å…¥shell&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt; CREATE DATABASE mydb
&amp;gt; SHOW DATABASES
&amp;gt; USE mydb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ’å…¥æ•°æ®, å’Œ SQL å·®åˆ«è¿˜æ˜¯æŒºå¤§çš„, å…¶ä¸­ cpu æ˜¯ measurement, ä¹Ÿå°±æ˜¯ "è¡¨å", æ²¡æŒ‡å®šæ—¶é—´çš„è¯, influxdb ä¼šè‡ªå·±åŠ ä¸Š.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;INSERT cpu,host=serverA,region=us_west value=0.64
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æŸ¥è¯¢æ•°æ®, æ³¨æ„å¤šå‡ºæ¥çš„ timestamp ä¸€æ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt; SELECT &amp;quot;host&amp;quot;, &amp;quot;region&amp;quot;, &amp;quot;value&amp;quot; FROM &amp;quot;cpu&amp;quot;
name: cpu
---------
time                                     host       region   value
2015-10-21T19:28:07.580664347Z  serverA   us_west    0.64
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å›æ”¶ç­–ç•¥&lt;/h2&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹, influxdb ä¼šæ°¸ä¹…ä¿ç•™æ•°æ®, ä¸€èˆ¬æ¥è¯´è¿™æ ·æ˜¯æ²¡æœ‰æ„ä¹‰çš„, æˆ‘ä»¬å¯ä»¥è®¾ç½®çŸ­ä¸€ç‚¹.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CREATE RETENTION POLICY &amp;lt;retention_policy_name&amp;gt; ON &amp;lt;database_name&amp;gt; DURATION &amp;lt;duration&amp;gt; REPLICATION &amp;lt;n&amp;gt; [DEFAULT]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ replication åªèƒ½è®¾ç½®ä¸º 1, å› ä¸ºå¼€æºç‰ˆåªæœ‰ 1. å¯ä»¥è®¾ç½®æˆ 30d, 1w&lt;/p&gt;
&lt;h1&gt;Python å®¢æˆ·ç«¯çš„ç¼–å†™&lt;/h1&gt;
&lt;p&gt;çœ‹åˆ°è¿™é‡Œæœ‰äººå¯èƒ½è¦é—®äº†, ä¸æ˜¯æœ‰ python-influxdb è¿™ä¸ªåº“ä¹ˆ, å¥½å¥½åœ°å®¢æˆ·ç«¯ä½ ä¸ºä»€ä¹ˆè¦å°è£…ä¸€å±‚å‘¢? ç­”æ¡ˆå¾ˆç®€å•: æ€§èƒ½.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è°ƒç”¨ &lt;code&gt;influxdb.write_points()&lt;/code&gt; æ˜¯ä¸€ä¸ªæ¶‰åŠåˆ°ç½‘ç»œçš„é˜»å¡æ“ä½œ, ææœ‰å¯èƒ½å¯¹äºç¨‹åºé€ æˆæ€§èƒ½å½±å“.&lt;/li&gt;
&lt;li&gt;å¦‚æœæˆ‘ä»¬åœ¨ç¨‹åºä¸­æ•£è½ç€å„ç§æ‰“ç‚¹çš„ä»£ç , é‚£ä¹ˆå°±ä¼šé€ æˆæ²¡æ‰“ä¸€ä¸ªç‚¹éƒ½å»è°ƒç”¨ä¸€äº› IO, ä¸å¦‚æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—é‡Œé¢å¯ä»¥æ¯æ¬¡å¤šæ‰“å‡ ä¸ª, å‡å°‘ IO æ¬¡æ•°, è¿™æ ·å¯¹ç¨‹åºå’Œ influxdb çš„æ€§èƒ½éƒ½æœ‰å¥½å¤„.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;UDP vs http&lt;/h2&gt;
&lt;p&gt;influxdb æ”¯æŒä½¿ç”¨ UDP å’Œ HTTP ä¸¤ç§åè®®è®¿é—®. æ˜¾ç„¶å¯¹äºæ‰“ç‚¹è¿™ç§æ“çºµæ¥è¯´, æˆ‘ä»¬ä¸å…³å¿ƒå“åº”ç»“æœ, å“ªæ€•ä¸€ä¸ªç‚¹æ²¡æ‰“ä¸Š, æ²¡æ‰“ä¸Šå°±æ²¡æ‰“ä¸Šå§......æ‰€ä»¥é‡‡ç”¨ UDP å°±å¥½äº†. æ ¹æ®æµ‹è¯• udp çš„æ€§èƒ½åœ¨ http çš„å‡ åå€.&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§ influxdb å®˜ç½‘çš„å»ºè®®, æˆ‘ä»¬éœ€è¦è°ƒæ•´ UDP buffer çš„ size åˆ° 25MB(26214400B) ä¸ºå®œ.&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ç³»ç»Ÿçš„ udp buffer å¤§å°:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sysctl net.core.rmem_max
$ sysctl net.core.rmem_default
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¿®æ”¹ &lt;code&gt;/etc/sysctl.conf&lt;/code&gt; æ–‡ä»¶: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;net.core.rmem_max=26214400
net.core.rmem_default=26214400
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½†æ˜¯è¿™ä¸ªè®¾ç½®åªæœ‰åˆ°ä¸‹æ¬¡é‡å¯æ‰èƒ½ç”Ÿæ•ˆ, ç»§ç»­ä½¿ç”¨ sysctl è®¾ç½®ç«‹å³ç”Ÿæ•ˆ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sysctl -w net.core.rmem_max&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;26214400&lt;/span&gt;
$ sysctl -w net.core.rmem_default&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;26214400&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦å¤–æ³¨æ„, UDP æœ‰ä¸€ä¸ªå¤§å‘, åªåƒåƒç²¾åº¦ä¸º s çš„æ‰“ç‚¹, æ‰€ä»¥åœ¨é…ç½®å’Œå®¢æˆ·ç«¯ä¸­éƒ½å¿…é¡»ä½¿ç”¨è¿™ä¸ªæ—¶é—´ç²¾åº¦.&lt;/p&gt;
&lt;p&gt;P.S. ä¸­æ–‡äº’è”ç½‘ä¸Šçš„å¥½å¤šæ•™ç¨‹éƒ½åœ¨ä½¿ç”¨ http æ‰“ç‚¹, è¯¯äººå­å¼Ÿ, æ¯äººä¸å€¦å•Š......&lt;/p&gt;
&lt;p&gt;å‚è€ƒ:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://docs.influxdata.com/influxdb/v1.6/supported_protocols/udp/&lt;/li&gt;
&lt;li&gt;https://github.com/MikaelGRA/InfluxDB.Client/issues/31&lt;/li&gt;
&lt;li&gt;https://blog.codeship.com/a-deep-dive-into-influxdb/&lt;/li&gt;
&lt;li&gt;http://docs.grafana.org/features/datasources/influxdb/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 16 Oct 2018 02:18:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-10-16:/posts/python-influxdb-grafana-de-jian-kong-xi-tong.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>ä½¿ç”¨ prctl åœ¨çˆ¶è¿›ç¨‹é€€å‡ºçš„æ—¶å€™å®‰å…¨é€€å‡ºå­è¿›ç¨‹</title><link>/posts/shi-yong-prctl-zai-fu-jin-cheng-tui-chu-de-shi-hou-an-quan-tui-chu-zi-jin-cheng.html</link><description>&lt;p&gt;åœ¨ Linux ä¸­, å½“å­è¿›ç¨‹é€€å‡ºçš„æ—¶å€™, çˆ¶è¿›ç¨‹å¯ä»¥æ”¶åˆ°ä¿¡å·, ä½†æ˜¯å½“çˆ¶è¿›ç¨‹é€€å‡ºçš„æ—¶å€™, å­è¿›ç¨‹å¹¶ä¸ä¼šå—åˆ°ä¿¡å·. è¿™æ ·å°±é€ æˆäº†åœ¨çˆ¶è¿›ç¨‹å´©æºƒçš„æ—¶å€™, å­è¿›ç¨‹å¹¶ä¸èƒ½åŒæ—¶é€€å‡º, è€Œæ˜¯ä¸€ç›´ä¼šåœ¨åå°è¿è¡Œ, æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;loop_print&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;child alive, &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fork&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;OSError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# parent&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;parent sleep for 2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;parent quit&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;loop_print&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“çˆ¶è¿›ç¨‹é€€å‡ºçš„æ—¶å€™, å­è¿›ç¨‹ä¸€ç›´åœ¨ä¸æ–­åœ° print, è€Œæ²¡æœ‰é€€å‡º.&lt;/p&gt;
&lt;h1&gt;naive çš„æ–¹æ³•, ä½¿ç”¨ multiprocessing åº“&lt;/h1&gt;
&lt;p&gt;æ˜¨å¤©æˆ‘å·²ç»åæ§½è¿‡æ ‡å‡†åº“çš„ multiprocessing æœ‰å¾ˆå¤šå‘, ä¸å‡ºæ‰€æœ›, åœ¨è¿™ä¸ªé—®é¢˜ä¸Š multiprocessing ä¾ç„¶æä¾›äº†åŠä¸ªè§£æ³•, åªè§£å†³äº†ä¸€åŠé—®é¢˜......&lt;/p&gt;
&lt;p&gt;åœ¨ä½¿ç”¨ multiprocessing åº“åˆ›å»ºè¿›ç¨‹çš„æ—¶å€™, å¯ä»¥è®¾ç½® &lt;code&gt;Process.daemon = True&lt;/code&gt;, è¿™ä¸ªå±æ€§åˆæ˜¯æ¨¡ä»¿ threading åº“çš„ API æ¥çš„.&lt;/p&gt;
&lt;p&gt;æ­£å¸¸æƒ…å†µä¸‹, å½“ä¸€ä¸ªç¨‹åºæ”¶åˆ° SIGTERM æˆ–è€… SIGHUP ç­‰ä¿¡å·çš„æ—¶å€™, multiprocessing ä¼šè°ƒç”¨æ¯ä¸ªå­è¿›ç¨‹çš„ terminate æ–¹æ³•, è¿™æ ·ä¼šç»™æ¯ä¸ªå­è¿›ç¨‹å‘é€ SIGTERM ä¿¡å·, å­è¿›ç¨‹å°±å¯ä»¥ä¼˜é›…é€€å‡º. ç„¶è€Œ, å½“å¼‚å¸¸å‘ç”Ÿçš„æ—¶å€™, çˆ¶è¿›ç¨‹æŒ‚äº†, æ¯”å¦‚è¯´æ”¶åˆ°äº† SIGKILL ä¿¡å·, é‚£ä¹ˆå­è¿›ç¨‹å°±å¾—ä¸åˆ°æ”¶å‰², ä¹Ÿå°±å˜æˆäº†å­¤å„¿è¿›ç¨‹.&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¯´, multiprocessing åº“åªè§£å†³äº†åŠä¸ªé—®é¢˜, çœŸé‡åˆ°é—®é¢˜çš„æ—¶å€™å°±ä¼šå‘ä½ ä¸€æŠŠ.&lt;/p&gt;
&lt;h1&gt;æ­£ç¡®è§£å†³æ–¹æ³•&lt;/h1&gt;
&lt;p&gt;Linux æä¾›äº† prctl ç³»ç»Ÿè°ƒç”¨, å¯ä»¥ç”±å­è¿›ç¨‹å‘å†…æ ¸æ³¨å†Œçˆ¶è¿›ç¨‹é€€å‡ºæ—¶å€™æ”¶åˆ°ä»€ä¹ˆä¿¡å·, æˆ‘ä»¬åªè¦æ³¨å†Œä¸€ä¸ª SIGTERM ä¿¡å·å°±å¥½äº†.&lt;/p&gt;
&lt;p&gt;åœ¨ Python ä¸­å¯ä»¥ä½¿ç”¨ python-prctl è¿™ä¸ªåŒ….&lt;/p&gt;
&lt;h2&gt;å®‰è£…&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# apt install libcap-dev &amp;amp;&amp;amp; pip install python-prctl
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šé¢çš„ç¨‹åºä¸ºä¾‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;loop_print&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;prctl&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;signal&lt;/span&gt;
    &lt;span class="n"&gt;prctl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_pdeathsig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;child alive, &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fork&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;OSError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pid&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# parent&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;parent sleep for 2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;parent quit&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;loop_print&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ¬¡æˆ‘ä»¬çœ‹åˆ°, åœ¨çˆ¶è¿›ç¨‹é€€å‡ºçš„åŒæ—¶, å­è¿›ç¨‹ä¹Ÿæ¨å‡ºäº†.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;parent sleep for 2
child alive, 1539676057.5094635
child alive, 1539676058.5105338
parent quit
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 15 Oct 2018 23:50:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-10-15:/posts/shi-yong-prctl-zai-fu-jin-cheng-tui-chu-de-shi-hou-an-quan-tui-chu-zi-jin-cheng.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>åæ§½ä¸€ä¸‹ Python æ··ä¹±çš„ threading å’Œ multiprocessing</title><link>/posts/tu-cao-yi-xia-python-hun-luan-de-threading-he-multiprocessing.html</link><description>&lt;p&gt;æœ€è¿‘è¦å†™ä¸€ä¸ªåº“å¾€ influxdb ä¸­æ‰“ç‚¹, å› ä¸ºè¦è¢«å¾ˆå¤šç¨‹åºä½¿ç”¨, è€Œåˆè¦åˆ›å»ºæ–°çš„è¿›ç¨‹, ä¸ºäº†é¿å…å¼•èµ·ä½¿ç”¨æ–¹çš„å¼‚å¸¸, ç®€å•æ·±å…¥äº†è§£äº†ä¸‹ Python çš„å¹¶å‘æ§åˆ¶, è¿™æ‰å‘ç°æ ‡å‡†åº“çœŸæ˜¯å‘. ä¹‹å‰æ²¡è¿‡å¤šè€ƒè™‘è¿‡, åªæ˜¯å‡­æ„Ÿè§‰åœ¨ CPU å¯†é›†çš„æ—¶å€™ä½¿ç”¨ multiprocessing, è€Œé»˜è®¤ä½¿ç”¨ threading, å…¶å®ä¸¤ä¸ªè¿˜æ˜¯æœ‰å¾ˆå¤šä¸ä¸€æ ·çš„, é™¤äº†éƒ½æ˜¯å¹¶å‘æ‰§è¡Œä»¥å¤–è¿˜æœ‰å¾ˆå¤§çš„ä¸åŒ. Python ä¸­è¯•å›¾ç”¨ threading å’Œ multiprocessing å®ç°ç±»ä¼¼çš„æ¥å£æ¥ç»Ÿä¸€ä¸¤æ–¹é¢, ç»“æœå¯¼è‡´æ›´æ··ä¹±äº†. æœ¬æ–‡æ¢è®¨å‡ ä¸ªå‘.&lt;/p&gt;
&lt;h1&gt;åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ fork&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆä¸è°ˆ Python, æˆ‘ä»¬æ€è€ƒä¸€ä¸‹, åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¦‚æœæ‰§è¡Œ fork ä¼šæ€æ ·? åœ¨æ–°çš„è¿›ç¨‹ä¸­, ä¼šä¸ä¼šæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨è¿è¡Œ? ç­”æ¡ˆæ˜¯å¦å®šçš„, &lt;strong&gt;åœ¨ fork ä¹‹å, åªæœ‰æ‰§è¡Œ fork çš„çº¿ç¨‹åœ¨è¿è¡Œ&lt;/strong&gt;, è€Œå…¶ä»–çº¿ç¨‹éƒ½ä¸ä¼šè¿è¡Œ. è¿™æ˜¯ POSIX æ ‡å‡†è§„å®šçš„:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A process shall be created with a single thread. If a multi-threaded process calls fork(), the new process shall contain a replica of the calling thread and its entire address space, possibly including the states of mutexes and other resources. Consequently, to avoid errors, the child process may only execute async-signal-safe operations until such time as one of the exec functions is called. Fork handlers may be established by means of the pthread_atfork() function in order to maintain application invariants across fork() calls.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½†æ˜¯è¿™æ—¶å€™å…¶ä»–çº¿ç¨‹æŒæœ‰çš„é”å¹¶ä¸ä¼šè‡ªåŠ¨è½¬åŒ–åˆ°å½“å‰çº¿ç¨‹, æ‰€ä»¥å¯èƒ½é€ æˆæ­»é”. å…³äºåœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­æ‰§è¡Œ fork ä¼šé€ æˆçš„é—®é¢˜, æœ‰å¥½å¤šæ–‡ç« æœ‰è¯¦ç»†çš„è®¨è®º:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;http://www.linuxprogrammingblog.com/threads-and-fork-think-twice-before-using-them&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/1073954/fork-and-existing-threads/1074663#1074663&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;åœ¨ python çš„ daemon thread ä¸­ fork åˆä¼šæ€æ ·&lt;/h1&gt;
&lt;p&gt;åœ¨ Python ä¸­å¯ä»¥æŠŠçº¿ç¨‹è®¾ç½®ä¸º daemon çŠ¶æ€, å¦‚æœä¸€ä¸ªè¿›ç¨‹ä¸­åªæœ‰ daemon thread, è¿™ä¸ªè¿›ç¨‹å°±ä¼šè‡ªåŠ¨é€€å‡º. é‚£ä¹ˆé—®é¢˜æ¥äº†, å¦‚æœæˆ‘ä»¬ daemon thread ä¸­æ‰§è¡Œ fork ä¼šæ€æ ·å‘¢?&lt;/p&gt;
&lt;p&gt;ç†è®ºä¸Šæ¥è¯´, æ—¢ç„¶ fork ä¹‹ååªæœ‰ä¸€ä¸ªçº¿ç¨‹, è€Œè¿™ä¸ªçº¿ç¨‹åˆæ˜¯ daemon çº¿ç¨‹, é‚£ä¹ˆæ˜¾ç„¶è¿™ä¸ªè¿›ç¨‹åº”è¯¥ç›´æ¥é€€å‡ºçš„, ç„¶è€Œå¹¶ä¸ä¼šè¿™æ ·, è¿™ä¸ªè¿›ç¨‹ä¼šä¸€ç›´è¿è¡Œ, ç›´åˆ°è¯¥çº¿ç¨‹é€€å‡º. è¿™æ˜¯å› ä¸º fork ä¹‹å, å”¯ä¸€çš„çº¿ç¨‹è‡ªåŠ¨æˆä¸ºäº† main thread, è€Œ Python ä¸­ç¡¬ç¼–ç äº† main thread ä¸æ˜¯ daemon thread, æ‰€ä»¥è¿™ä¸ªçº¿ç¨‹ä¸ä¼šé€€å‡º.&lt;/p&gt;
&lt;p&gt;å‚è€ƒ: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/31055960/is-it-a-python-bug-that-the-main-thread-of-a-process-created-in-a-daemon-thread&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;åœ¨æ–°åˆ›å»ºçš„è¿›ç¨‹ä¸­åˆ›å»ºçº¿ç¨‹åˆä¼šæ€æ ·&lt;/h1&gt;
&lt;p&gt;åœ¨æ™®é€šè¿›ç¨‹ä¸­, è¿›ç¨‹åœ¨æ‰€æœ‰édaemon çš„çº¿ç¨‹é€€å‡ºä¹‹åæ‰ä¼šæ¨å‡º, ä½†æ˜¯åœ¨æ–°åˆ›å»ºçš„è¿›ç¨‹ä¸­, ä¸è®ºåˆ›å»ºçš„çº¿ç¨‹æ˜¯ daemon thread è¿˜æ˜¯ä¸æ˜¯ daemon thread éƒ½ä¼šåœ¨ä¸»çº¿ç¨‹é€€å‡ºåé€€å‡º. è¿™æ˜¯ Python çš„ä¸€ä¸ª &lt;a href="https://bugs.python.org/issue18966"&gt;bug&lt;/a&gt;, è¿™ä¸ª bug æœ€æ—©åœ¨ 2013-09-08 01:20 æŠ¥å‘Šå‡ºæ¥, è€Œç›´åˆ° 2017-08-16 18:54 çš„ Python 3.7 æ‰ä¿®å¤...&lt;/p&gt;
&lt;p&gt;å¦‚ä½•å¤ç°è¿™ä¸ª bug&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;multiprocessing&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Process&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;threading&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Thread&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;sleep&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;proc&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;mythread&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;mythread&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Thread.daemon = &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;mythread&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;daemon&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;#mythread.join()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Tick: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;proc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Process.daemon = &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;daemon&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;ä¸‹é¢å¤§æ¦‚è¯´ä¸‹è¿™ä¸ª bug çš„åŸå› :&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ™®é€šè¿›ç¨‹ä¼šè°ƒç”¨ &lt;code&gt;sys.exit()&lt;/code&gt; é€€å‡º, åœ¨è¿™ä¸ªå‡½æ•°ä¸­ä¼šè°ƒç”¨ &lt;code&gt;thread.join()&lt;/code&gt; ä¹Ÿå°±æ˜¯ä¼šç­‰å¾…å…¶ä»–çº¿ç¨‹è¿è¡Œç»“æŸ&lt;/li&gt;
&lt;li&gt;åœ¨ Python 3.4 ä¹‹å‰, é»˜è®¤åªä¼šä½¿ç”¨ fork åˆ›å»ºçº¿ç¨‹, è€Œå¯¹äº fork åˆ›å»ºçš„çº¿ç¨‹, ä¼šä½¿ç”¨ &lt;code&gt;os._exit()&lt;/code&gt; é€€å‡º, ä¹Ÿå°±æ˜¯ä¸ä¼šè°ƒç”¨ &lt;code&gt;thread.join()&lt;/code&gt;. æ‰€ä»¥ä¹Ÿå°±ä¸ä¼šç­‰å¾…å…¶ä»–çº¿ç¨‹é€€å‡º&lt;/li&gt;
&lt;li&gt;åœ¨ Python 3.4 ä¸­å¼•å…¥äº†å¯¹ &lt;code&gt;spawn&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨çš„æ”¯æŒ, å¯ä»¥é€šè¿‡ &lt;code&gt;multiprocessing.set_start_method&lt;/code&gt; æ¥è®¾å®šåˆ›å»ºè¿›ç¨‹ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨. è€Œä½¿ç”¨ &lt;code&gt;spawn&lt;/code&gt; è°ƒç”¨åˆ›å»ºçš„è¿›ç¨‹ä¼šé€šè¿‡ &lt;code&gt;sys.exit()&lt;/code&gt; é€€å‡º, ä¹Ÿå°±é¿å…äº†è¿™ä¸ª bug çš„å½±å“. è€Œä½¿ç”¨ &lt;code&gt;fork&lt;/code&gt; åˆ›å»ºçš„è¿›ç¨‹ä¾ç„¶å—åˆ°è¿™ä¸ª bug çš„å½±å“.&lt;/li&gt;
&lt;li&gt;åœ¨ Python 3.7 ä¸­ç»ˆäºåœ¨æ·»åŠ äº† &lt;code&gt;thread._shutdown&lt;/code&gt; çš„è°ƒç”¨, ä¹Ÿå°±æ˜¯ä¼š join å…¶ä»–çš„ thread.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;fork vs spawn é€ æˆçš„ OS å¹³å°å·®å¼‚æ€§&lt;/h1&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“, åœ¨ &lt;code&gt;*nix&lt;/code&gt; ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªä¸€ä¸ªæ–°çš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ &lt;code&gt;fork&lt;/code&gt;, çˆ¶è¿›ç¨‹çš„æ‰€æœ‰èµ„æºéƒ½ä¼šè¢«å¤åˆ¶åˆ°å­è¿›ç¨‹ä¸­, å½“ç„¶æ˜¯ Copy On Write çš„. å¦‚æœè¦æ‰§è¡Œä¸€ä¸ªæ–°çš„ç¨‹åº, å¿…é¡»åœ¨ &lt;code&gt;fork&lt;/code&gt; ä¹‹åè°ƒç”¨ &lt;code&gt;exec*&lt;/code&gt; å®¶æ—çš„ç³»ç»Ÿè°ƒç”¨, åæ¥ Linux ä¸­æ·»åŠ äº† &lt;code&gt;spawn&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨, &lt;code&gt;spawn&lt;/code&gt; å’Œ &lt;code&gt;fork&lt;/code&gt; çš„ä¸åŒæ˜¯, ä»–æ˜¯ä»å¤´åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å­ç¨‹åº, è€Œä¸æ˜¯åƒ &lt;code&gt;fork&lt;/code&gt; ä¸€æ ·å¤åˆ¶äº†ä¸€ä»½çˆ¶è¿›ç¨‹. &lt;/p&gt;
&lt;p&gt;è€Œåœ¨ Windows ä¸Š, ä»æ¥æ²¡æœ‰ç±»ä¼¼ &lt;code&gt;fork&lt;/code&gt; çš„ç³»ç»Ÿè°ƒç”¨, åªæœ‰ç±»ä¼¼ &lt;code&gt;spawn&lt;/code&gt; çš„ç³»ç»Ÿè°ƒç”¨, ä¹Ÿå°±æ˜¯ä»å¤´åˆ›å»ºä¸€ä¸ªæ–°çš„ç¨‹åº.&lt;/p&gt;
&lt;p&gt;å¯¹äº Python çš„å½±å“. åœ¨ &lt;code&gt;*nix&lt;/code&gt; æ“ä½œç³»ç»Ÿä¸Š, å½“ä½¿ç”¨ multiprocessing çš„æ—¶å€™, é»˜è®¤è°ƒç”¨çš„æ˜¯ fork, åœ¨æ–°çš„è¿›ç¨‹ä¸­æ‰€æœ‰å¯¼å…¥çš„åŒ…éƒ½å·²ç»åœ¨äº†, æ‰€ä»¥ä¸ä¼šå† import ä¸€æ¬¡. è€Œåœ¨ Windows ç³»ç»Ÿä¸Š, ä½¿ç”¨ multiprocessing åˆ›å»ºæ–°çš„è¿›ç¨‹æ—¶, æ‰€æœ‰åŒ…éƒ½ä¼šè¢«åœ¨æ–°è¿›ç¨‹ä¸­é‡æ–° import ä¸€é, å¦‚æœ import æ“ä½œæ˜¯å¯¹å¤–éƒ¨ç³»ç»Ÿæœ‰å‰¯ä½œç”¨çš„, å°±ä¼šé€ æˆä¸åŒ. &lt;/p&gt;
&lt;p&gt;å½“ç„¶å¦‚ä¸Šæ–‡æ‰€è¿°, åœ¨ Python 3.4 ä¹‹åå¯ä»¥é€‰æ‹©åˆ›å»ºè¿›ç¨‹æ—¶ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨, å¦‚æœé€‰æ‹©äº† &lt;code&gt;spawn&lt;/code&gt;, é‚£ä¹ˆåœ¨å„ä¸ªå¹³å°ä¸Šè¡Œä¸ºå°±æ˜¯ç»Ÿä¸€çš„äº†.&lt;/p&gt;
&lt;p&gt;å‚è€ƒ:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸ºä»€ä¹ˆè¦åŒºåˆ« fork å’Œ exec: https://www.zhihu.com/question/66902460&lt;/li&gt;
&lt;li&gt;fork å’Œ spawn é€ æˆçš„æœ‰è¶£å½±å“: https://zhuanlan.zhihu.com/p/39542342&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/38236211/why-multiprocessing-process-behave-differently-on-windows-and-linux-for-global-o&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;fork å’Œ asyncio&lt;/h1&gt;
&lt;p&gt;å¤šè¿›ç¨‹å’Œ Event Loop ä¹Ÿå¯èƒ½å¼•èµ·ä¸€äº›é—®é¢˜, &lt;a href="http://4fish.xyz/posts/asyncio-concurrency/"&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt; ç»™äº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­:&lt;/p&gt;
&lt;p&gt;å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œä¸»è¿›ç¨‹è¿è¡Œç€ä¸€ä¸ªevent loopï¼Œåœ¨æŸä¸ªæ—¶å€™ä¼šforkå‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹å†å»è¿è¡Œä¸€ä¸ªæ–°å»ºçš„event loopï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;async def coro(loop):
    pid = os.fork()
    if pid != 0:  # parent
        pass
    else:  # child
        cloop = asyncio.new_event_loop()
        cloop.run_forever()

loop = asyncio.get_event_loop()
asyncio.ensure_future(coro(loop), loop=loop)
loop.run_forever()
loop.close()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ®µä»£ç çœ‹èµ·æ¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜, åœ¨å­è¿›ç¨‹ä¸­å¼€äº†ä¸€ä¸ªæ–°çš„ Event Loop, ç„¶è€Œåœ¨ Python 3.5 å’Œä»¥ä¸‹, åœ¨çœŸæ­£è¿è¡Œæ—¶ä¼šæŠ¥é”™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;...
cloop.run_forever()
  File &amp;quot;/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/asyncio/base_events.py&amp;quot;, line 411, in run_forever
    &amp;#39;Cannot run the event loop while another loop is running&amp;#39;)
RuntimeError: Cannot run the event loop while another loop is running
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åŸå› å°±åœ¨äºæ ‡å‡†åº“çš„ Event Loop æ²¡æœ‰è€ƒè™‘å¤šè¿›ç¨‹ç¯å¢ƒ, åªæ˜¯ä½¿ç”¨ä¸€ä¸ª thread local æ¥è¡¨ç¤ºå½“å‰çš„ loop, åœ¨å¤šçº¿ç¨‹æ¡ä»¶ä¸‹, è¿™æ ·å½“ç„¶æ˜¯å¯ä»¥çš„, ä½†æ˜¯åœ¨ fork ä¹‹å, æ•°æ®ç»“æ„å…¨éƒ¨éƒ½å¾—åˆ°äº†å¤åˆ¶, å› æ­¤å­è¿›ç¨‹å°±ä¼šæ£€æŸ¥åˆ°å·²ç»æœ‰ event loop åœ¨è¿è¡Œäº†.&lt;/p&gt;
&lt;p&gt;åœ¨ Python 3.6 ä¸­, è¿™ä¸ªé—®é¢˜å¾—åˆ°äº†ç®€å•ç²—æš´çš„ä¿®å¤, åœ¨æ¯ä¸ª loop ä¸Šéƒ½æ ‡è®°ä¸€ä¸ª pid, æ£€æŸ¥çš„æ—¶å€™å†åŠ ä¸Š pid éªŒè¯æ˜¯ä¸æ˜¯å½“å‰è¿›ç¨‹å°±å¥½äº†.&lt;/p&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹, å°½é‡ä¸è¦åŒæ—¶ä½¿ç”¨å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹, å¦‚æœéè¦ç”¨çš„è¯, é¦–å…ˆå°½æ—©åˆ›å»ºå¥½éœ€è¦çš„è¿›ç¨‹, ç„¶ååœ¨è¿›ç¨‹ä¸­å†å¼€å§‹åˆ›å»ºçº¿ç¨‹æˆ–è€…å¼€å¯ Event Loop.&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ç¯‡æ–‡ç« æ²¡çœ‹, ç”¨ç©ºäº†å†çœ‹ä¸‹å§, æ˜¯è®² multiprocessing.Pool çš„å‘:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://codewithoutrules.com/2018/09/04/python-multiprocessing/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 15 Oct 2018 03:21:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-10-15:/posts/tu-cao-yi-xia-python-hun-luan-de-threading-he-multiprocessing.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python é«˜æ€§èƒ½è¯·æ±‚åº“ aiohttp çš„åŸºæœ¬ç”¨æ³•</title><link>/posts/python-gao-xing-neng-qing-qiu-ku-aiohttp-de-ji-ben-yong-fa.html</link><description>&lt;p&gt;aiohttp æ˜¯ Python å¼‚æ­¥ç¼–ç¨‹æœ€å¸¸ç”¨çš„ä¸€ä¸ª web è¯·æ±‚åº“äº†, ä¾æ‰˜äº asyncio, æ€§èƒ½éå¸¸å“äºº. ä¸‹é¢åˆ—ä¸¾å‡ ä¸ªå¸¸è§çš„ç”¨æ³•:&lt;/p&gt;
&lt;h1&gt;æœ€åŸºç¡€: å¹¶å‘ä¸‹è½½ç½‘é¡µ&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;aiohttp&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;http://python.org&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;https://google.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;http://yifei.me&amp;#39;&lt;/span&gt;
        &lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;tasks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;aiohttp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ClientSession&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;htmls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gather&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;htmls&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 13 Oct 2018 17:05:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-10-13:/posts/python-gao-xing-neng-qing-qiu-ku-aiohttp-de-ji-ben-yong-fa.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>kubernetes åˆæ¢â€”â€”ä½¿ç”¨ helm éƒ¨ç½²æœåŠ¡</title><link>/posts/kubernetes-chu-tan-shi-yong-helm-bu-shu-fu-wu.html</link><description>&lt;p&gt;å‰å‡ ç¯‡å†™äº†ä¸€å†™ k8s éƒ¨ç½²æ–¹é¢çš„ä¸œè¥¿, åæ¥å‘ç°é˜¿é‡Œäº‘çš„ k8s é›†ç¾¤è¿˜å¾ˆå¥½ç”¨...ä½•è‹¦è‡ªå·±ç ”ç©¶å‡ å¤©éƒ¨ç½²å‘¢...?&lt;/p&gt;
&lt;p&gt;------åˆ†éš”çº¿------&lt;/p&gt;
&lt;p&gt;åœ¨ k8s ä¸Šéƒ¨ç½²ä¸€ä¸ªåº”ç”¨è¿˜æ˜¯æœ‰äº›å¤æ‚çš„, è‡ªå·±çš„åº”ç”¨å½“ç„¶éœ€è¦è‡ªå·±ä¸€æ­¥ä¸€æ­¥éƒ¨ç½², ä½†æ˜¯å¯¹äºä¸€äº›é€šç”¨çš„åº”ç”¨, æ¯”å¦‚è¯´ mysql/grafana è¿™ç§å°±æ²¡å¿…è¦è‡ªå·±æ‰‹å·¥ä¸€æ­¥ä¸€æ­¥éƒ¨ç½²äº†. è¿™æ—¶å€™å°±æœ‰äº† helm, é€šä¿—çš„æ¥è¯´ä»–å°±æ˜¯ kubernetes ä¸Šçš„ AppStore, å¸¸è§çš„åº”ç”¨éƒ½å·²ç»åœ¨äº†, è€Œä¸”ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§ä»–çš„æ ¼å¼æ‰“åŒ…è‡ªå·±çš„åº”ç”¨éƒ¨ç½².&lt;/p&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;åœ¨ helm çš„ release é¡µé¢ä¸‹è½½, ç„¶åæ‹·è´åˆ°æœ¬åœ°çš„ /usr/local/bin/ ç›®å½•å°±å¥½äº†. helm è¿è¡Œçš„æ—¶å€™ä¼šä½¿ç”¨ ~/.kube/config æ–‡ä»¶, æ‰€ä»¥æœ¬åœ° kubectl å¯ä»¥ä½¿ç”¨å°±å¥½äº†.&lt;/p&gt;
&lt;p&gt;helm åˆ†ä¸ºä¸¤éƒ¨åˆ†, helm æ˜¯æœ¬åœ°å‘½ä»¤, tiller æ˜¯æœåŠ¡ç«¯, ä½œä¸ºä¸€ä¸ª pod è¿è¡Œåœ¨, ä¸¤è€…çš„ç‰ˆæœ¬éœ€è¦ä¿æŒä¸€è‡´. ç†è®ºä¸Šæ¥è¯´, å®‰è£…å¥½ helm ä¹‹å, åªéœ€è¦æ‰§è¡Œ helm init å°±å¯ä»¥è‡ªåŠ¨åœ¨ k8s é›†ç¾¤ä¸­å®‰è£… tiller äº†, ä½†æ˜¯ç”±äºä¸€äº›ä¼—æ‰€å‘¨çŸ¥çš„åŸå› , åœ¨ä¸­å›½å¤§é™†åœ°åŒºå¹¶ä¸èƒ½å®‰è£…æˆåŠŸ, éœ€è¦ä½¿ç”¨é˜¿é‡Œäº‘æˆ–è€…ä¸­ç§‘å¤§çš„é•œåƒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;ä½¿ç”¨&lt;/h1&gt;
&lt;h2&gt;æ¦‚å¿µ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Chart, å¤§æ¦‚ç›¸å½“äº package çš„æ„æ€&lt;/li&gt;
&lt;li&gt;Repository, Helm çš„ä¸­å¿ƒä»“åº“&lt;/li&gt;
&lt;li&gt;Release, æ¯æ¬¡è¿è¡Œä¸€ä¸ª Chart éƒ½ä¼šç”Ÿæˆä¸€ä¸ª Release, æ¯ä¸ª release ä¹‹é—´æ˜¯ç‹¬ç«‹çš„. Chart/Release çš„å…³ç³»å°±å¥½æ¯” Docker çš„ Image/Container ä¸€æ ·.&lt;/li&gt;
&lt;li&gt;Revision, æ¯æ¬¡æ›´æ–° Release éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ç‰ˆæœ¬, å¯ä»¥å›æ»š&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;åŸºç¡€å‘½ä»¤&lt;/h2&gt;
&lt;p&gt;helm search æŸ¥æ‰¾ç›¸å…³çš„è½¯ä»¶åŒ…(chart), ç°åœ¨ stable ä»“åº“ä¸­å¤§æ¦‚æœ‰ 200 å¤šä¸ªåŒ…å¯ä»¥å®‰è£….&lt;/p&gt;
&lt;p&gt;helm install --name NAME PACKAGE ä¼šå®‰è£…å¯¹åº”çš„ chart. å¦‚æœä¸æŒ‡å®š name, ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª.&lt;/p&gt;
&lt;p&gt;helm status NAME å¯ä»¥æŸ¥çœ‹å¯¹åº”çš„åŒ…çš„ä¿¡æ¯, ä¸€èˆ¬åŒ…æ‹¬äº†å¦‚ä½•è¿æ¥ä½¿ç”¨è¿™ä¸ªåŒ…ç­‰ä¿¡æ¯, å¯ä»¥å½“åšå¸®åŠ©æ¥ç”¨.&lt;/p&gt;
&lt;h2&gt;åœ¨å®‰è£…åŒ…ä¹‹å‰æ›´æ”¹é…ç½®&lt;/h2&gt;
&lt;p&gt;æ¯ä¸ª helm chart éƒ½å®šä¹‰äº†ä¸€äº›é»˜è®¤çš„é…ç½®, å¯ä»¥åœ¨å®‰è£…ä¹‹å‰æŸ¥çœ‹å¹¶ä¿®æ”¹è¿™äº›å€¼.&lt;/p&gt;
&lt;p&gt;helm inspect values stable/mysql æŸ¥çœ‹ mysql çš„é»˜è®¤å€¼. æˆ–è€…å» GitHub ä¸Šçœ‹è¿™ä¸ªä»“åº“çš„ readme.&lt;/p&gt;
&lt;p&gt;æŠŠéœ€è¦è¦†ç›–çš„å˜é‡å†™åˆ° OVERRIDE.yml æ–‡ä»¶ä¸­, helm install -f OVERRIDE.yml stable/mysql å°±å¯ä»¥ä½¿ç”¨è‡ªå·±çš„é…ç½®äº†&lt;/p&gt;
&lt;h2&gt;æ›´æ–° release&lt;/h2&gt;
&lt;p&gt;å¦‚æœéœ€è¦æ›´æ–°ä¸€ä¸ª release, å¯ä»¥ä½¿ç”¨ helm upgrade -f OVERRIDE.yml RELEASE_NAME å‘½ä»¤æ›´æ–°ç›¸å…³çš„é…ç½®. è¿™æ—¶å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬.&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ helm list å¯ä»¥æŸ¥çœ‹å½“å‰éƒ¨ç½²çš„ release, è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥çœ‹åˆ°éƒ¨ç½²çš„ç‰ˆæœ¬å˜æˆäº† 2 (æœ€åˆæ˜¯1).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % helm ls
NAME    REVISION        UPDATED                         STATUS          CHART           NAMESPACE
mysql   1               Sat Oct  6 15:44:25 2018        DEPLOYED        mysql-0.3.0     default
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœå½“å‰çš„æ›´æ–°æœ‰è¯¯, å¯ä»¥å›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬, è¯­æ³•æ˜¯ helm rollback [RELEASE] [REVISION]&lt;/p&gt;
&lt;h2&gt;ç®¡ç† repo&lt;/h2&gt;
&lt;p&gt;helm repo list åˆ—å‡ºå½“å‰æ·»åŠ çš„ repo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ helm repo list
NAME            URL
stable          https://kubernetes-charts.storage.googleapis.com
&lt;span class="nb"&gt;local&lt;/span&gt;           http://localhost:8879/charts
mumoshu         https://mumoshu.github.io/charts
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ·»åŠ æ–°çš„ repo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ helm repo add dev https://example.com/dev-charts
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å‚è€ƒæ–‡çŒ®&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://docs.helm.sh/&lt;/li&gt;
&lt;li&gt;https://ezmo.me/2017/09/24/helm-quick-toturial/&lt;/li&gt;
&lt;li&gt;https://help.aliyun.com/document_detail/58587.html&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 06 Oct 2018 02:52:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-10-06:/posts/kubernetes-chu-tan-shi-yong-helm-bu-shu-fu-wu.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>kubernetes åˆæ¢â€”â€”éƒ¨ç½²æœ‰çŠ¶æ€æœåŠ¡</title><link>/posts/kubernetes-chu-tan-bu-shu-you-zhuang-tai-fu-wu.html</link><description>&lt;p&gt;ä¸ºäº†éƒ¨ç½²æˆ‘ä»¬è‡ªå·±çš„åº”ç”¨, é¦–å…ˆéœ€è¦æŠŠåŸºç¡€è®¾æ–½éƒ¨ç½²ä¸Šå», å…¶ä¸­æ•°æ®åº“å°±å äº†å¤§å¤´. æœ‰äººè¯´æ•°æ®åº“ç­‰åº”ç”¨ä¸æ˜¯å’Œå®¹å™¨åŒ–éƒ¨ç½², ä½†æ˜¯ä¹Ÿæœ‰äººè®¤ä¸ºæ‰€æœ‰çš„åº”ç”¨éƒ½é€‚åˆå®¹å™¨åŒ–éƒ¨ç½². åœ¨è¿™é‡Œæˆ‘ä»¬ä¸è®¨è®ºè¿™äº›è§‚ç‚¹ï¼Œä»…ä»¥éƒ¨ç½² MySQL ä¸ºä¾‹è¯´æ˜ä¸€ä¸‹å¦‚ä½•åœ¨ K8S ä¸Šéƒ¨ç½²æœ‰çŠ¶æ€æœåŠ¡ã€‚&lt;/p&gt;
&lt;h1&gt;ç›¸å…³æ¦‚å¿µ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;PersistentVolume(PV) æ˜¯é›†ç¾¤ä¹‹ä¸­çš„ä¸€å—ç½‘ç»œå­˜å‚¨ã€‚è·Ÿ Node ä¸€æ ·ï¼Œä¹Ÿæ˜¯é›†ç¾¤çš„èµ„æºã€‚PV è·Ÿ Volume ç±»ä¼¼ï¼Œä¸è¿‡ä¼šæœ‰ç‹¬ç«‹äº Pod çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™ä¸€ API å¯¹è±¡åŒ…å«äº†å­˜å‚¨çš„å®ç°ç»†èŠ‚ï¼Œä¾‹å¦‚ NFSã€iSCSI æˆ–è€…å…¶ä»–çš„äº‘æä¾›å•†çš„å­˜å‚¨ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;li&gt;PersistentVolumeClaim (PVC) æ˜¯ç”¨æˆ·çš„ä¸€ä¸ªè¯·æ±‚ã€‚ä»–è·Ÿ Pod ç±»ä¼¼ã€‚Pod æ¶ˆè´¹ Node çš„èµ„æºï¼ŒPVC æ¶ˆè´¹ PV çš„èµ„æºã€‚Pod èƒ½å¤Ÿç”³è¯·ç‰¹å®šçš„èµ„æºï¼ˆCPU å’Œ å†…å­˜ï¼‰ï¼›Claim èƒ½å¤Ÿè¯·æ±‚ç‰¹å®šçš„å°ºå¯¸å’Œè®¿é—®æ¨¡å¼ï¼ˆä¾‹å¦‚å¯ä»¥åŠ è½½ä¸€ä¸ªè¯»å†™ï¼Œä»¥åŠå¤šä¸ªåªè¯»å®ä¾‹ï¼‰&lt;/li&gt;
&lt;li&gt;Stateful Set. Deployment æ˜¯æ— çŠ¶æ€çš„æœåŠ¡ï¼Œè€Œ StatefulSets æ—¨åœ¨ä¸æœ‰çŠ¶æ€çš„åº”ç”¨åŠåˆ†å¸ƒå¼ç³»ç»Ÿä¸€èµ·ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ConfigMap ç”¨æ¥ä¿å­˜éå¯†ç çš„é…ç½®. configmap å¯ä»¥ä»¥é…ç½®æ–‡ä»¶æˆ–è€…ç¯å¢ƒå˜é‡ç­‰æ–¹å¼æŒ‚åœ¨åˆ° pod ä¸­&lt;/li&gt;
&lt;li&gt;Secret ç”¨æ¥ä¿å­˜å¯†ç ç­‰ç§å¯†æ•°æ®&lt;/li&gt;
&lt;li&gt;Init Container ç”¨äºåˆå§‹åŒ–çš„å®¹å™¨. æœ‰ç‚¹ç±»ä¼¼äº docker build çš„è¿‡ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;åŠ¨æ€ PV vs é™æ€ PV&lt;/h1&gt;
&lt;h1&gt;ä½¿ç”¨ Deployment PVC è¿˜æ˜¯ Stateful Set&lt;/h1&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºæˆ‘ä»¬å³å¯ä»¥ä½¿ç”¨æ™®é€šçš„ Deployment + PVC æ¥éƒ¨ç½² MySQL, ä¹Ÿå¯ä»¥ä½¿ç”¨ Stateful Set æ¥éƒ¨ç½², é‚£ä¹ˆå“ªç§æ–¹å¼æ›´å¥½å‘¢?&lt;/p&gt;
&lt;p&gt;ä¸ªäººç†è§£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºéœ€è¦ä½¿ç”¨æŒ‚è½½ä¸€å®šèµ„æºçš„ï¼Œä½¿ç”¨ PVC å°±å¥½äº†ï¼Œç”šè‡³åªéœ€è¦åªè¯»æŒ‚è½½å°±å¥½ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºå¼ºçŠ¶æ€ä¾èµ–çš„æœåŠ¡ï¼Œæ¯”å¦‚æ•°æ®åº“ï¼Œè‚¯å®šè¦ä½¿ç”¨ PVC&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Stack Overflow ä¸Šçš„ä¸€ä¸ªé—®é¢˜[2]ä¹Ÿå¾ˆå€¼å¾—å‚è€ƒ. &lt;/p&gt;
&lt;h1&gt;MySQL ä¸»ä»é›†ç¾¤&lt;/h1&gt;
&lt;p&gt;æœ¬æ–‡ä¸­æˆ‘ä»¬è¦éƒ¨ç½²ä¸€ä¸ªä¸€ä¸»å¤šä»çš„ MySQL é›†ç¾¤. å…³äºä¸€ä¸»å¤šä»çš„ä¼˜ç‚¹ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹, è¿™é‡Œå°±ä¸å¤šè¯´äº†, å¯ä»¥å‚è€ƒä¸‹é¢:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;æ‰©å®¹è§£å†³æ–¹æ¡ˆï¼šåœ¨å¤šä¸ªslaveä¹‹é—´æ‰©å±•è´Ÿè½½ä»¥æé«˜æ€§èƒ½ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„å†™å…¥å’Œæ›´æ–°æ“ä½œéƒ½å¿…é¡»åœ¨ä¸»æœåŠ¡å™¨ä¸Šè¿›è¡Œã€‚ç„¶è€Œï¼Œè¯»å–æ“ä½œé€šè¿‡slaveé•œåƒã€‚è¯¥æ¨¡å‹å¯ä»¥æé«˜å†™å…¥æ“ä½œçš„æ€§èƒ½ï¼ŒåŒæ—¶ï¼Œä¹Ÿèƒ½å¤Ÿé€šè¿‡å¢åŠ slaveçš„èŠ‚ç‚¹æ•°é‡ï¼Œä»è€Œæ˜¾è‘—åœ°æå‡è¯»å–é€Ÿåº¦ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®å®‰å…¨ï¼šæ•°æ®ä»masterè¢«å¤åˆ¶åˆ°slaveï¼Œå¹¶ä¸”slaveå¯ä»¥æš‚åœå¤åˆ¶è¿‡ç¨‹ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨ä¸æŸåmasterçš„æƒ…å†µä¸‹ï¼Œåœ¨slaveä¸Šè¿è¡Œå¤‡ä»½æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†æï¼šç°åœºæ•°æ®å¯ä»¥åœ¨masterä¸Šåˆ›å»ºï¼Œè€Œå¯¹ä¿¡æ¯çš„åˆ†æå¯ä»¥åœ¨slaveè¿›è¡Œï¼Œè€Œä¸å½±å“masterçš„æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;è¿œç¨‹æ•°æ®åˆ†å‘ï¼šå¯ä»¥ä½¿ç”¨å¤åˆ¶ä¸ºè¿œç¨‹ç«™ç‚¹åˆ›å»ºæœ¬åœ°æ•°æ®çš„å‰¯æœ¬ï¼Œè€Œä¸å¿…ä¸€ç›´é€šè¿‡è®¿é—®masterã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://blog.csdn.net/sweatOtt/article/details/81092484"&gt;ä½¿ç”¨ PVC å’Œ Deployment éƒ¨ç½²å•å®ä¾‹ MySQL é›†ç¾¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/41732819/why-statefulsets-cant-a-stateless-pod-use-persistent-volumes&lt;/li&gt;
&lt;li&gt;&lt;a href="https://kubernetes.io/docs/tasks/run-application/run-single-instance-stateful-application/"&gt;ä½¿ç”¨æ™®é€š Deployment éƒ¨ç½²å•èŠ‚ç‚¹ mysql&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;https://kubernetes.io/cn/docs/tutorials/stateful-application/basic-stateful-set/&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.cnblogs.com/zhenyuyaodidiao/p/6594410.html"&gt;å¦‚ä½•ä½¿ç”¨ ConfigMap&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://kubernetes.io/cn/docs/concepts/configuration/secret/"&gt;Secret æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/41583672/kubernetes-deployments-vs-statefulsets&lt;/li&gt;
&lt;li&gt;&lt;a href="https://yq.aliyun.com/articles/640212"&gt;é˜¿é‡Œäº‘æŒ‚è½½ OSS Volume&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;https://jimmysong.io/posts/kubernetes-persistent-volume/&lt;/li&gt;
&lt;li&gt;https://kubernetes.io/docs/concepts/storage/volumes/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 05 Oct 2018 08:02:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-10-05:/posts/kubernetes-chu-tan-bu-shu-you-zhuang-tai-fu-wu.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>kubernetes åˆæ¢â€”â€”éƒ¨ç½²æ— çŠ¶æ€åº”ç”¨</title><link>/posts/kubernetes-chu-tan-bu-shu-wu-zhuang-tai-ying-yong.html</link><description>&lt;p&gt;kubernetes æ¶æ„å›¾&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNbRwly1fvxa7izqb8j30mb0gcmzk.jpg"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Master. ç”¨äºæ§åˆ¶æ•´ä¸ªé›†ç¾¤éƒ¨ç½²çš„æœºå™¨, ä¸ºäº†é«˜å¯ç”¨, å¯ä»¥ä½¿ç”¨å¤šå°ï¼Œä¸€èˆ¬è‡³å°‘ä¸‰å°ä¸ºå®œã€‚&lt;/li&gt;
&lt;li&gt;Node. å·¥ä½œèŠ‚ç‚¹, ç”¨äºéƒ¨ç½²æœåŠ¡. ä¸€å°æœºå™¨å¯ä»¥æ—¢æ˜¯ Master ä¹Ÿæ˜¯ Workerï¼Œå½“ç„¶æœ€å¥½ Master ä¸è¦åš Workerã€‚&lt;/li&gt;
&lt;li&gt;Pod. k8s éƒ¨ç½²çš„æœ€å°å•å…ƒ, ä¸€ä¸ª Pod ä¸­å¯èƒ½åŒ…å«å¤šä¸ª container. Pod éšæ—¶å¯èƒ½æŒ‚æ‰ï¼Œä¹Ÿå¯èƒ½è¢«æ›¿æ¢ã€‚&lt;/li&gt;
&lt;li&gt;Label. Pod çš„æ ‡ç­¾, å¯ä»¥é€šè¿‡è¿™äº›æ ‡ç­¾ï¼ˆç»„åˆï¼‰æ¥é€‰æ‹©å¯¹åº”çš„ Podã€‚&lt;/li&gt;
&lt;li&gt;Replica Set. ä½œä¸ºä¸€ä¸ªé«˜å¯ç”¨çš„ç³»ç»Ÿ, æ¯ä¸ªæœåŠ¡ä¸€èˆ¬æ¥è¯´å¯èƒ½æœ‰å¤šä¸ª Pod. Replication Set ç”¨æ¥åˆ›å»ºå¹¶ä¿è¯æœ‰è¶³å¤Ÿçš„ Pod å‰¯æœ¬ã€‚RS çš„åå­—æ€»æ˜¯ &lt;Deploymentçš„åå­—&gt;-&lt;pod templateçš„hashå€¼&gt; æ ¼å¼çš„ã€‚&lt;/li&gt;
&lt;li&gt;Deployment. ç”¨æˆ·ä¸€èˆ¬æ¥è¯´ä¸ä¼šç›´æ¥åˆ›å»º Pod, è€Œæ˜¯åˆ›å»ºä¸€ä¸ª Deployment æ¥éƒ¨ç½²æœåŠ¡. (åœ¨è€ç‰ˆæœ¬ä¸­æ˜¯åˆ›å»º RC)&lt;/li&gt;
&lt;li&gt;Namespace. å‘½åç©ºé—´, é»˜è®¤æƒ…å†µä¸‹ä¼šæœ‰ kube-system å’Œ default ä¸¤ä¸ªå‘½åç©ºé—´, kube-system å­˜æ”¾çš„æ˜¯ k8s ç³»ç»Ÿçš„ pod ç­‰èµ„æº, è€Œç”¨æˆ·éƒ¨ç½²çš„èµ„æºä¼šåœ¨ default å‘½åç©ºé—´ä¸­.&lt;/li&gt;
&lt;li&gt;PersistendVolume. å¦‚æœæŠŠ Node ç†è§£ä¸ºæŠ½è±¡çš„ CPU å’Œå†…å­˜èµ„æºï¼Œé‚£ä¹ˆ PV å°±å¯ä»¥ç†è§£ä¸ºæŠ½è±¡çš„ç¡¬ç›˜èµ„æºã€‚æˆ‘ä»¬é€šè¿‡ Pod æ¥ä½¿ç”¨ Nodeï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿä¸ç›´æ¥ä½¿ç”¨ PVï¼Œè€Œæ˜¯é€šè¿‡ PersistentVolumeClaim æ¥ä½¿ç”¨ PVã€‚&lt;/li&gt;
&lt;li&gt;PersistentVolumeClaim. å­˜å‚¨å£°æ˜ï¼Œç”¨æ¥å£°æ˜éœ€è¦ä½¿ç”¨çš„å­˜å‚¨èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;Stateful Set. Deployment å¯¹åº”çš„éƒ¨ç½²è¯­ä¹‰ä¸Šæ²¡æœ‰çŠ¶æ€çš„ï¼Œè€ŒStatefulSetä¼šå……åˆ†è¿ç”¨ PV å’Œ PVC å®ç° Pod é‡å¯ä¹‹é—´çš„çŠ¶æ€ä¿æŒã€‚å…¸å‹åº”ç”¨åœºæ™¯æ˜¯æ•°æ®åº“ã€‚&lt;/li&gt;
&lt;li&gt;Label å’Œ Selector. K8S ä¸­çš„èµ„æºå…¨éƒ¨éƒ½é€šè¿‡ Label æ¥æ ‡è¯†çš„é€‰æ‹©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;deployment&lt;/h1&gt;
&lt;p&gt;deployment æ˜¯ä½¿ç”¨ k8s éƒ¨ç½²æœåŠ¡ç›´æ¥æ“ä½œçš„æ¦‚å¿µã€‚å…¶ä»–çš„æ¦‚å¿µå¾€å¾€éƒ½æ˜¯&lt;strong&gt;é€šè¿‡ deployment æ¥é—´æ¥ä½¿ç”¨&lt;/strong&gt;çš„ï¼Œå› æ­¤ç†è§£ deployment è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå…¸å‹çš„ deployment é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;apiVersion&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;apps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v1&lt;/span&gt;
&lt;span class="n"&gt;kind&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Deployment&lt;/span&gt;
&lt;span class="n"&gt;metadata&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;
&lt;span class="n"&gt;spec&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;selector&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;matchLabels&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;
  &lt;span class="n"&gt;replicas&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
  &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;metadata&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;
    &lt;span class="n"&gt;spec&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;containers&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
      &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;my&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;
        &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;nginx&lt;/span&gt;
        &lt;span class="n"&gt;ports&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;containerPort&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;deployment çš„é…ç½®å¯ä»¥å‘ç”Ÿæ”¹å˜ï¼Œå¦‚æœåªæ˜¯ replica çš„æ•°ç›®å‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆè¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„æ‰©å®¹æˆ–è€…ç¼©å®¹æ“ä½œï¼Œk8såªä¼šç®€å•çš„æ‰“å¼€æˆ–è€…æ€æ­»æ–°çš„ Podã€‚å¦‚æœé•œåƒã€å‘½ä»¤ç­‰å‚æ•°å‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆ K8S ä¼šæŠŠè¿™æ¬¡æ“ä½œè§†ä¸ºå‡çº§ï¼Œä¹Ÿå°±æ˜¯å¼€å§‹ä¸€ä¸ª RollOut æ“ä½œï¼Œåˆ›å»ºæ–°çš„ ReplicaSetã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœ deployment ä¸­çš„ spec æŒ‡å®šäº†ä¿ç•™å†å² revision çš„æ¬¡æ•°å¤§äºé›¶ï¼Œé‚£ä¹ˆåŸæœ‰çš„ ReplicaSet ä¸ä¼šè¢«åˆ é™¤ï¼Œåªæ˜¯ä¼šè¢« Scale åˆ° 0 è€Œå·²ï¼Œæ–¹ä¾¿å›æ»šã€‚&lt;/p&gt;
&lt;p&gt;æ–‡æ¡£ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: a Deploymentâ€™s rollout is triggered if and only if the Deploymentâ€™s pod template (i.e. .spec.template) is changed, e.g. updating labels or container images of the template. Other updates, such as scaling the Deployment, will not trigger a rollout.&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/42561791/right-way-to-update-deployments-on-kubernetes&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;æœåŠ¡&lt;/h1&gt;
&lt;h2&gt;ç›¸å…³æ¦‚å¿µ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Service. å¦‚æœä¸€ä¸ª Deployment å¯¹å¤–ï¼ˆpod å¤–ï¼‰æä¾›æœåŠ¡çš„è¯ï¼Œå¯ä»¥æš´éœ²ä¸º Serviceã€‚å®ƒæ˜¯æœåŠ¡çš„æŠ½è±¡, é€šè¿‡ kube-proxy å’Œ DNS ç­‰æä¾›è´Ÿè½½å‡è¡¡ç»™åç«¯ RC å®šä¹‰çš„ Podã€‚&lt;/li&gt;
&lt;li&gt;clusterIP. æœåŠ¡æš´éœ²åœ¨é›†ç¾¤å†…éƒ¨çš„ä¸€ä¸ªè™šæ‹Ÿ IPï¼Œå£°æ˜å‘¨æœŸå’ŒæœåŠ¡ç›¸åŒ&lt;/li&gt;
&lt;li&gt;nodePort. æš´éœ²åœ¨ Node ä¸Šçš„æœåŠ¡ç«¯å£ï¼Œä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;Ingress Controller. Service åªæ˜¯å¯¹é›†ç¾¤å†…éƒ¨æš´éœ²äº†æœåŠ¡ï¼Œingress controller ç”¨äºæŠŠ Service å†å¯¹å¤–æš´éœ²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ª deployment éœ€è¦å¯¹é›†ç¾¤å†…éƒ¨æˆ–è€…æ˜¯å¤–éƒ¨æä¾›æœåŠ¡çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ serviceã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å°†åˆ›å»ºä¸€ä¸ª clusterIPï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ª clusterIP ä¹Ÿæ˜¯è™šæ‹Ÿçš„ï¼Œå¹¶æ²¡æœ‰å’Œä»»ä½• pod ç»‘å®šï¼Œè€Œæ˜¯ç»‘å®šåˆ°äº†æœåŠ¡ä¸Šï¼Œå¯ä»¥ç†è§£ä¸ºç»‘å®šåˆ°äº†è¿™ä¸ªæœåŠ¡å¯¹åº”çš„å†…éƒ¨è´Ÿè½½å‡è¡¡ä¸Šï¼Œå¹¶ä¸”æ˜¯ä¸å˜çš„ã€‚å³ä½¿ä½ çš„ RC ä¸­æŒ‡å®šäº†å¤šä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆä¹Ÿåªæœ‰è¿™ä¸€ä¸ª clusterIPï¼Œpod çš„åˆ›å»ºå’Œé”€æ¯ä¹Ÿéƒ½ä¸ä¼šå½±å“åˆ° clusterIPã€‚&lt;/p&gt;
&lt;h1&gt;kubectl ä½¿ç”¨&lt;/h1&gt;
&lt;h2&gt;kubectl get&lt;/h2&gt;
&lt;p&gt;å¸¸ç”¨å‚æ•° &lt;code&gt;-o wide&lt;/code&gt; ç”¨æ¥ç°å®æ›´è¯¦ç»†ä¿¡æ¯. ç”¨æ¥è·å–é›†ç¾¤çš„å„ç§ä¿¡æ¯:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;kubectl get pod&lt;/code&gt; æ˜¾ç¤ºæ‰€æœ‰ pod ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;kubectl get deployment&lt;/code&gt; æ˜¾ç¤ºæ‰€æœ‰éƒ¨ç½²ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;kubectl get node&lt;/code&gt; æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;kubectl create &amp;amp; apply&lt;/h2&gt;
&lt;p&gt;ç”¨æ¥åˆ›å»º pod, éƒ¨ç½²ç­‰. ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯ä½¿ç”¨ &lt;code&gt;-f&lt;/code&gt; å‚æ•°æ¥åˆ¶å®šé…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;kubectl create -f file.yml
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å’Œ kubectl create è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼çš„æ¦‚å¿µï¼Œkubectl apply ä¹Ÿå¯ä»¥ç”¨äºåˆ›å»ºèµ„æºã€‚è¿™ä¸¤ä¸ªçš„åŒºåˆ«æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;kubectl create æ˜¯è¿‡ç¨‹æ€§çš„ï¼Œé‡ç‚¹åœ¨äºâ€œåˆ›å»ºâ€è¿™ä¸ªæ“ä½œï¼›è€Œ kubectl apply æ˜¯å£°æ˜æ€§çš„ï¼Œé‡ç‚¹åœ¨äºè¾¾æˆâ€œåº”ç”¨â€è¿™ä¸ªç»“æœ&lt;/li&gt;
&lt;li&gt;kubectl create åœ¨åˆ›å»ºé‡å¤èµ„æºçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œè€Œ kubectl apply å¯ä»¥ç”¨äºæ›´æ–°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;kubectl run&lt;/h2&gt;
&lt;p&gt;ç±»ä¼¼äº docker run, ä½†æ˜¯ç”± kubernetes æ¥ç®¡, ç›´æ¥è¿è¡Œåœ¨é›†ç¾¤ä¸Š. æ¯”å¦‚è¿è¡Œ hello world&lt;/p&gt;
&lt;h2&gt;kubectl delete&lt;/h2&gt;
&lt;p&gt;ç”¨æ¥åˆ é™¤èŠ‚ç‚¹ä¸Šçš„ pod, deployment ç­‰ä¿¡æ¯&lt;/p&gt;
&lt;h2&gt;kubectl logs&lt;/h2&gt;
&lt;p&gt;ç±»ä¼¼äº docker logs, ç”¨æ¥æ˜¾ç¤ºæ‰“å°åˆ° stdout çš„æ—¥å¿—&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/41325087/in-kubernetes-what-is-the-difference-between-a-pod-and-a-deployment"&gt;deployment å’Œ pod çš„åŒºåˆ«&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://dockone.io/article/932"&gt;Kubernetes åŸºç¡€æ¦‚å¿µ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.jianshu.com/p/1bf9a46efe7a"&gt;å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æœåŠ¡å‘ç°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://docs.kubernetes.org.cn/683.html"&gt;kubernetes å‘½ä»¤è¡¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://blog.csdn.net/liumiaocn/article/details/73913597"&gt;Kubernetesä¹‹kubectlå¸¸ç”¨å‘½ä»¤ä½¿ç”¨æŒ‡å—:1:åˆ›å»ºå’Œåˆ é™¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://blog.csdn.net/xingwangc2014/article/details/51204224"&gt;Kubernetesä¹‹kubectlå¸¸ç”¨å‘½ä»¤&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://blog.csdn.net/u010209217/article/details/78782353"&gt;KubernetesåŸºæœ¬æ¦‚å¿µä»¥åŠæœ¯è¯­&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/47369351/kubectl-apply-vs-kubectl-create"&gt;kubectl create å’Œ apply çš„åŒºåˆ«&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/42561791/right-way-to-update-deployments-on-kubernetes&lt;/li&gt;
&lt;li&gt;https://kubernetes.io/docs/concepts/workloads/controllers/deployment/&lt;/li&gt;
&lt;li&gt;&lt;a href="https://blog.csdn.net/phantom_111/article/details/79427144"&gt;K8S YAML æ–‡ä»¶åŸºç¡€&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0"&gt;NodePort/LB/Ingress ä¸‰ç§æ–¹å¼çš„å¯¹æ¯”&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;https://kubernetes.io/docs/tasks/access-application-cluster/service-access-application-cluster/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 04 Oct 2018 17:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-10-04:/posts/kubernetes-chu-tan-bu-shu-wu-zhuang-tai-ying-yong.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>kubernetes åˆæ¢â€”â€”éƒ¨ç½²é›†ç¾¤</title><link>/posts/kubernetes-chu-tan-bu-shu-ji-qun.html</link><description>&lt;p&gt;éšç€ docker cloud çš„å…³é—­ï¼Œå®¹å™¨çš„ç¼–æ’å·¥å…·ä¹‹äº‰ä¼¼ä¹å·²ç»ç»“æŸäº†ï¼ŒDocker Swarm ä¸Šç®—æ˜¯å®Œäº†ï¼ŒKubernetes ç¬‘åˆ°äº†æœ€åã€‚ç„¶è€Œ k8s çš„ç»„ä»¶ä¼—å¤šï¼Œå› æ­¤éƒ¨ç½²èµ·æ¥ä¹Ÿå¾ˆéº»çƒ¦ã€‚ä¸ºæ­¤ï¼Œç½‘ä¸Šæœ‰ä¸å°‘çš„ç½‘ä¸Šæœ‰ä¸å°‘çš„éƒ¨ç½²æ•™ç¨‹å’Œè„šæœ¬ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;kubesaz&lt;/li&gt;
&lt;li&gt;minikube&lt;/li&gt;
&lt;li&gt;kubespray&lt;/li&gt;
&lt;li&gt;rke&lt;/li&gt;
&lt;li&gt;kubernetes: the hard way&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰çš„å‡ºäºæ•™å­¦ç›®çš„çš„å•æœºç‰ˆæœ¬ï¼Œæœ‰çš„æ˜¯å¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„ç‰ˆæœ¬ã€‚ç ”ç©¶äº†ä¸€ç•ªï¼Œå‘ç° rke è¿™ä¸ªå·¥å…·åº”è¯¥æ˜¯æœ€ç®€å•çš„äº†ã€‚ä¸è¿‡ rke è¿˜ä¸å¤ªç¨³å®šï¼Œç›®å‰çœ‹æ¥ï¼Œkubespray å£°æ˜äº†å¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡åŸºäº ubuntu 16.04. CentOS ä¸Šå¥½å¤šé»˜è®¤è®¾ç½®éƒ½éœ€è¦ä¿®æ”¹ï¼Œå› æ­¤å»ºè®®å¤§å®¶åŸºäº Ubuntu éƒ¨ç½² k8sã€‚&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨ kubespray å®‰è£… k8s&lt;/h1&gt;
&lt;p&gt;(é›¶) å‡è®¾æˆ‘ä»¬è¦åœ¨ä¸‰å°æœºå™¨ä¸Šå®‰è£…, å¦å¤–ä¸€å°æœºå™¨ä½œä¸ºæ§åˆ¶èŠ‚ç‚¹. å…¶ä¸­æ¯å°éƒ½ä½œä¸ºå·¥ä½œèŠ‚ç‚¹, ä¸¤å°ä½œä¸º master èŠ‚ç‚¹.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;IP&lt;/th&gt;
&lt;th&gt;è§’è‰²&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;10.4.17.165&lt;/td&gt;
&lt;td&gt;æ§åˆ¶èŠ‚ç‚¹, ä¸å‚ä¸ k8s é›†ç¾¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10.4.17.167&lt;/td&gt;
&lt;td&gt;master, node&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10.4.17.168&lt;/td&gt;
&lt;td&gt;master, node&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10.4.17.169&lt;/td&gt;
&lt;td&gt;node&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;(ä¸€) ä¸‹è½½ kubespray å®‰è£…åŒ…, è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æœ€æ–°ç‰ˆ(2018.10), å¯èƒ½éœ€è¦å®‰è£… python3, å¦‚æœæ²¡æœ‰å®‰è£…çš„è¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;VERSION=2.7.0

# download kubespray
wget https://github.com/kubernetes-incubator/kubespray/archive/v&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;VERSION&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;.tar.gz
tar xzf v&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;VERSION&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;.tar.gz

# install dependencies
pip3 install -r kubespray-&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;VERSION&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;/requirements.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(äºŒ) ç”Ÿæˆéƒ¨ç½²çš„ hosts.ini&lt;/p&gt;
&lt;p&gt;kubespray ä¸­æœ‰ä¸€ä¸ªè„šæœ¬å«åš inventory_builder ç”¨æ¥ç”Ÿæˆéƒ¨ç½²çš„ hosts.ini&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cd kubespray-v&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;VERSION&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
cp -r inventory/sample inventory/mycluster
declare -a IPS=(10.4.17.167 10.4.17.168 10.4.17.169)
CONFIG_FILE=inventory/mycluster/hosts.ini python3 contrib/inventory_builder/inventory.py &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;IPS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç”Ÿæˆä¹‹å, å¯ä»¥æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat inventory/mycluster/host.ini

[k8s-cluster:children]
kube-masterÂ·â–¸   Â·
kube-nodeÂ·â–¸ Â·

[all]
node1 â–¸  ansible_host=10.4.17.167 ip=10.4.17.167
node2 â–¸  ansible_host=10.4.17.168 ip=10.4.17.168
node3 â–¸  ansible_host=10.4.17.169 ip=10.4.17.169

[kube-master]
node1Â·â–¸ Â·
node2Â·â–¸ Â·

[kube-node]
node1Â·â–¸ Â·
node2Â·â–¸ Â·
node3Â·â–¸ Â·

[etcd]
node1Â·â–¸ Â·
node2Â·â–¸ Â·
node3Â·â–¸ Â·

[calico-rr]

[vault]
node1Â·â–¸ Â·
node2Â·â–¸ Â·
node3Â·â–¸ Â·
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(ä¸‰) ä¿®æ”¹ä¸€äº›é…ç½®&lt;/p&gt;
&lt;p&gt;ä»£ç†:&lt;/p&gt;
&lt;p&gt;ç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› , k8s ä¾èµ–çš„ gcr.io åœ¨ä¸­å›½å¤§é™†èŒƒå›´å†…æ— æ³•è®¿é—®, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç†è®¿é—®, å…³äºå¦‚ä½•æ­å»ºä»£ç†è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´.
å‡è®¾æˆ‘ä»¬çš„ä»£ç†æ˜¯ http://proxy.com:10086, ä¿®æ”¹ &lt;code&gt;inventory/mycluster/group_vars/all/all.yml&lt;/code&gt;  æ–‡ä»¶, è®¾ç½® http_proxy å’Œ https_proxy ä¸¤ä¸ªå˜é‡.&lt;/p&gt;
&lt;p&gt;ä¸‹è½½ kubectl åˆ°æœ¬æœº:&lt;/p&gt;
&lt;p&gt;è®¾ç½® kubectl_localhost å’Œ kubeconfig_localhost ä¸¤ä¸ªå˜é‡ä¸º true. å®‰è£…å®Œæˆåä¼šåœ¨æœ¬æœºå®‰è£… kubectl, å¹¶ä¸”å¯ä»¥ä½¿ç”¨ inventory/mycluster/artifacts/admin.conf ä½¿ç”¨ kubectl.&lt;/p&gt;
&lt;p&gt;(å››) éƒ¨ç½²&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ tiger ç”¨æˆ·, è¿™ä¸ªç”¨æˆ·éœ€è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯ä»¥æ— å¯†ç è¿œç¨‹ç™»å½•&lt;/li&gt;
&lt;li&gt;åœ¨è¿œç¨‹ä¸»æœºä¸Šå…·æœ‰æ— å¯†ç  sudo æƒé™&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ansible-playbook -i inventory/mycluster/hosts.ini cluster.yml --become --user tiger -v
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¤§æ¦‚è¿‡åå‡ åˆ†é’Ÿå°±éƒ¨ç½²å¥½äº†&lt;/p&gt;
&lt;p&gt;(äº”) éªŒè¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cd inventory/mycluster/artifacts
./kubectl.sh get nodes


NAME      STATUS    ROLES         AGE       VERSION
node1     Ready     master,node   1d        v1.11.3
node2     Ready     master,node   1d        v1.11.3
node3     Ready     node          1d        v1.11.3
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://news.ycombinator.com/item?id=16665130"&gt;HN ä¸Šå…³äº Docker Cloud å…³é—­çš„è®¨è®º&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.itmuch.com/docker/kubernetes-deploy-by-kubespray/"&gt;ä½¿ç”¨Kubesprayéƒ¨ç½²ç”Ÿäº§å¯ç”¨çš„Kubernetesé›†ç¾¤&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 30 Sep 2018 04:58:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-09-30:/posts/kubernetes-chu-tan-bu-shu-ji-qun.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>requests cookies ä¸ºç©ºçš„ä¸€ä¸ªå‘</title><link>/posts/requests-cookies-wei-kong-de-yi-ge-keng.html</link><description>&lt;p&gt;æœ‰æ—¶å€™ï¼Œrequests è¿”å›çš„ cookies ä¼šä¸ºç©ºï¼ŒåŸå› æ˜¯é“¾æ¥å‘ç”Ÿäº† 301/302 è·³è½¬ï¼Œè€Œ cookies æ˜¯è·Ÿç€ç¬¬ä¸€ä¸ªå“åº”è¿”å›çš„ï¼Œç¬¬äºŒä¸ªå“åº”æ²¡æœ‰è¿”å› Set-Cookie headerã€‚æ‰€ä»¥ç›´æ¥è¯»å– r.cookies æ˜¯ç©ºçš„ï¼Œè€Œåœ¨ session.cookies ä¸­æ˜¯æœ‰æ•°æ®çš„ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ³•æ˜¯ç›´æ¥è¯» s.cookiesã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;s = requests.Session()
r = s.get(&amp;#39;http://httpbin.org/cookies/set?foo=bar&amp;#39;)
cookies = requests.utils.dict_from_cookiejar(s.cookies)
s.cookies.clear()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨ session éœ€è¦æ³¨æ„é”çš„é—®é¢˜ï¼Œå»ºè®®æŠŠ session è®¾ç½®æˆ thread local çš„ç±»å‹ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 27 Sep 2018 19:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-09-27:/posts/requests-cookies-wei-kong-de-yi-ge-keng.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>influxdb+grafana+telegraf ç›‘æ§ç³»ç»Ÿæ­å»º</title><link>/posts/influxdbgrafanatelegraf-jian-kong-xi-tong-da-jian.html</link><description>&lt;p&gt;æœ¬æ–‡åŸºäº ubuntu 18.04&lt;/p&gt;
&lt;h1&gt;è¦ä¸è¦ç”¨ dockerï¼Ÿ&lt;/h1&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå“²å­¦é—®é¢˜ï¼Œç”¨ä¸ç”¨å…¶å®éƒ½æœ‰å„è‡ªçš„å¥½å¤„ã€‚ä¸è¿‡åœ¨è¿™é‡Œæˆ‘å€¾å‘äºä¸ç”¨ã€‚å› ä¸º influxdb å’Œ grafana éƒ½æœ‰å¥½å¤šçš„çŠ¶æ€ï¼Œè€Œä¸”ä¸æ˜¯éƒ½å¯ä»¥å†™åˆ° mysql ä¸­çš„ï¼Œæ‰€ä»¥æ—¢ç„¶è¿˜å¾— mount å‡ºæ¥ï¼Œä½•è‹¦ç”¨ docker å‘¢ï¼Ÿtelegraf éœ€è¦é‡‡é›†ç³»ç»Ÿçš„ç›¸å…³ä¿¡æ¯ï¼Œæ›´ä¸é€‚åˆæ”¾åœ¨ docker é‡Œé¢ã€‚&lt;/p&gt;
&lt;h1&gt;æ­å»ºè¿‡ç¨‹&lt;/h1&gt;
&lt;h2&gt;influxdb &amp;amp;&amp;amp; telegraf&lt;/h2&gt;
&lt;p&gt;å› ä¸ºè¿™ä¸¤ä¸ªéƒ½æ˜¯ä¸€å®¶çš„äº§å“ï¼Œæ‰€ä»¥å®‰è£…æ­¥éª¤éƒ½æ˜¯ä¸€æ ·çš„ã€‚æŒ‰ç…§&lt;a href="https://docs.influxdata.com/influxdb/v1.6/introduction/installation/"&gt;å®˜ç½‘&lt;/a&gt;ç»™çš„å®‰è£…æ­¥éª¤ï¼Œå…¶å®å¾ˆç®€å•çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl -sL https://repos.influxdata.com/influxdb.key | sudo apt-key add -
source /etc/lsb-release
echo &amp;quot;deb https://repos.influxdata.com/&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;DISTRIB_ID&lt;/span&gt;&lt;span class="p"&gt;,,&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt; &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;DISTRIB_CODENAME&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt; stable&amp;quot; | sudo tee /etc/apt/sources.list.d/influxdb.list

sudo apt-get update &lt;span class="err"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get install influxdb telegraf
sudo systemctl start influxdb telegraf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬æš‚æ—¶å°±ä¸é…ç½®äº†ï¼Œç›´æ¥ä½¿ç”¨é»˜è®¤é…ç½®ã€‚å¯ä»¥é€šè¿‡ &lt;code&gt;systemctl status influxdb&lt;/code&gt; æ¥æŸ¥çœ‹çŠ¶æ€&lt;/p&gt;
&lt;h2&gt;grafana&lt;/h2&gt;
&lt;p&gt;åŒæ ·å‚è€ƒ&lt;a href="http://docs.grafana.org/installation/debian/"&gt;å®˜ç½‘&lt;/a&gt;çš„æ•™ç¨‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;VERSION=5.1.4
wget https://s3-us-west-2.amazonaws.com/grafana-releases/release/grafana_&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;VERSION&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;_amd64.deb
apt-get install -y adduser libfontconfig
dpkg -i grafana_&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;VERSION&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;_amd64.deb

sudo /bin/systemctl daemon-reload
sudo /bin/systemctl enable grafana-server
sudo /bin/systemctl start grafana-server
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åå°± ok å•¦ï¼Œæ‰“å¼€ http://ip:3000 å°±èƒ½è®¿é—® grafana çš„ç•Œé¢äº†ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç æ˜¯ adminã€‚å¦‚æœæ˜¯åœ¨é˜¿é‡Œäº‘ç­‰äº‘ä¸Šé¢ï¼Œæ³¨æ„è¦åœ¨å®‰å…¨ç»„é‡Œé¢å¼€ä¸€ä¸‹ 3000 ç«¯å£ã€‚&lt;/p&gt;
&lt;h1&gt;é…ç½®&lt;/h1&gt;
&lt;h2&gt;é…ç½® telegraf çš„æ’ä»¶&lt;/h2&gt;
&lt;h2&gt;é…ç½® grafana çš„ datasource&lt;/h2&gt;
&lt;p&gt;æœªå®Œå¾…ç»­&lt;/p&gt;
&lt;h1&gt;å‚è€ƒèµ„æ–™&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://blog.csdn.net/w958660278/article/details/80484486&lt;/li&gt;
&lt;li&gt;https://juejin.im/post/5b4568c851882519790c72f3&lt;/li&gt;
&lt;li&gt;https://grafana.com/dashboards/928&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 20 Sep 2018 19:05:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-09-20:/posts/influxdbgrafanatelegraf-jian-kong-xi-tong-da-jian.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>ç›‘æ§ç³»ç»Ÿé€‰å‹</title><link>/posts/jian-kong-xi-tong-xuan-xing.html</link><description>&lt;p&gt;ç°ä»£çš„ç›‘æ§ç³»ç»Ÿä¸€èˆ¬éƒ½æœ‰å¦‚ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š&lt;/p&gt;
&lt;p&gt;æ—¶åºæ•°æ®åº“ + å‰ç«¯æ˜¾ç¤º + æŠ¥è­¦ç³»ç»Ÿ + æŒ‡æ ‡æ”¶é›†&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬éœ€è¦å®ç°çš„åŠŸèƒ½:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åº¦é‡æ•°æ®æ”¶é›†å’Œå¯è§†åŒ–&lt;/li&gt;
&lt;li&gt;æ”¶é›†å°½å¯èƒ½å¤šçš„æ€§èƒ½å’ŒçŠ¶æ€æ•°æ®&lt;/li&gt;
&lt;li&gt;å›¾å½¢åŒ–åšæœ‰æ„ä¹‰çš„å±•ç¤º&lt;/li&gt;
&lt;li&gt;å¦‚æœå‘ç°å¯ç–‘é—®é¢˜,å¯ä»¥å…³è”å…¶ä»–å›¾è¡¨æ‰¾åˆ°åŸå› &lt;/li&gt;
&lt;li&gt;é”™è¯¯æ£€æµ‹&lt;/li&gt;
&lt;li&gt;æŒ‰éœ€å‘Šè­¦, è§¦å‘æ¡ä»¶è¶Šå®½æ¾åˆ™å‘Šè­¦åº”è¯¥è¶Šå°‘&lt;/li&gt;
&lt;li&gt;é¿å…è¯¯æŠ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»ç›‘æ§çš„å±‚æ¬¡åˆ’åˆ†çš„è¯,ä¸€èˆ¬åŒ…å«ä¸‰å±‚ç›‘æ§:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºç¡€å±‚: ä¸»æœºçš„CPU,å†…å­˜,ç½‘ç»œåŠIOç­‰&lt;/li&gt;
&lt;li&gt;ä¸­é—´å±‚: åº”ç”¨è¿è¡Œçš„ä¸­é—´ä»¶å±‚, Nginx, Tomcat, MySQL, Redis&lt;/li&gt;
&lt;li&gt;åº”ç”¨å±‚: æœåŠ¡ç«¯åŠå®¢æˆ·ç«¯æ€§èƒ½æ•°æ®,å¦‚APIè®¿é—®æ¬¡æ•°å’Œå“åº”æ—¶é—´ç­‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç°ä»£çš„ç›‘æ§è¶Šæ¥è¶Šå…³æ³¨åº”ç”¨å±‚å’Œå…¶ä»–å±‚æ•°æ®çš„æ•´åˆèƒ½åŠ›, å…·æœ‰å¿«é€Ÿæ‰¾åˆ°ç³»ç»Ÿç“¶é¢ˆ, æ–¹ä¾¿æ‰©å®¹æˆ–ä»£ç ä¼˜åŒ–.&lt;/p&gt;
&lt;h1&gt;æ—¶åºæ•°æ®åº“çš„é€‰æ‹©&lt;/h1&gt;
&lt;p&gt;ç›‘æ§æ•°æ®å¾€å¾€éƒ½å¸¦æœ‰æ—¶é—´æˆ³ï¼Œå…¶å®å°±æ˜¯ä¸€ç§å…¸å‹æ—¶é—´åºåˆ—æ•°æ®ï¼Œè€Œè¿™æ–¹é¢å·²ç»æœ‰å¾ˆå¤šä¸“é—¨çš„å­˜å‚¨ç³»ç»Ÿï¼Œå¦‚ opentsdbï¼Œinfluxdbï¼Œprometheus ç­‰ã€‚ç›¸æ¯” mysql è¿™æ ·çš„ä¼ ç»Ÿæ•°æ®åº“ï¼Œè¿™ç±»ç³»ç»Ÿåœ¨å­˜å‚¨ã€æŸ¥è¯¢ä¸Šé’ˆå¯¹æ—¶é—´åºåˆ—æ•°æ®éƒ½åšäº†ç‰¹åˆ«çš„ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ opentsdb åŸºäº hadoop ç”Ÿæ€ç³»ç»Ÿï¼Œè€ƒè™‘åˆ°æ­å»ºçš„å¤æ‚åº¦ï¼Œæš‚æ—¶ä¸è€ƒè™‘äº†ã€‚influxdb å’Œ prometheus éƒ½æ˜¯ Golang ç¼–å†™çš„ï¼Œç›´æ¥ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å°±å¯ä»¥è¿è¡Œã€‚ä¸¤è€…çš„åŒºåˆ«æœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;prometheus å¯¹äºä¿å­˜é•¿æ—¶é—´çš„æ•°æ®æœ‰ä¸€äº›é—®é¢˜ï¼Œinfluxdb ä¼¼ä¹æ²¡æœ‰é—®é¢˜&lt;/li&gt;
&lt;li&gt;å¦å¤– influxdb å¯ä»¥ç›´æ¥å†™å…¥ï¼Œè€Œ prometheus æ˜¯åŸºäºæ‹‰(pull)æ¨¡å¼çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç¨‹åºä¸èƒ½ç›´æ¥å†™å…¥ prometheusï¼Œè€Œæ˜¯éœ€è¦ç”± prometheus å»å®šæœŸæ‹‰ç›‘æ§æ•°æ®ï¼Œå¤ªåäººç±»äº†ã€‚&lt;/li&gt;
&lt;li&gt;influxdb çš„æŸ¥è¯¢ç±»ä¼¼ SQLï¼Œè€Œ prometheus çš„æŸ¥è¯¢è¯­æ³•æ›´åŠ ç®€æ´ï¼Œä½†æ˜¯æœ‰å­¦ä¹ æˆæœ¬ï¼Œå„æœ‰åƒç§‹å§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€ä»¥é€‰ç”¨ influxdbäº†ã€‚&lt;/p&gt;
&lt;h1&gt;å‰ç«¯æ˜¾ç¤º&lt;/h1&gt;
&lt;p&gt;å”¯ä¸€çš„æ ‡å‡†è‡ªç„¶æ˜¯è¶Šæ¼‚äº®è¶Šå¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹© grafanaã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶å¦ä¸€éœ€è¦è€ƒè™‘çš„æ˜¯ç¼–å†™æŸ¥è¯¢ç•Œé¢ä¸è¦è¿‡äºå¤æ‚ï¼Œè¿™æ–¹é¢ grafana åªéœ€è¦æ‹–æ‹½ç©ºé—´å’Œå‹¾å‹¾é€‰é€‰å°±å¯ä»¥äº†ï¼Œæ˜¾ç„¶ä¸æˆé—®é¢˜ã€‚&lt;/p&gt;
&lt;h1&gt;æŠ¥è­¦ç³»ç»Ÿ&lt;/h1&gt;
&lt;p&gt;grafan è‡ªå¸¦äº†ä¸€äº›æŠ¥è­¦ï¼Œä½†æ˜¯åªèƒ½æ ¹æ®é˜ˆå€¼æŠ¥è­¦ï¼Œæ˜¾ç„¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚æˆ‘ä»¬è¿™é‡Œé€‰æ‹©äº† bosunï¼Œæ˜¯ Stack Overflow å¼€æºçš„ä¸€æ¬¾ç›‘æ§ç³»ç»Ÿã€‚é€šè¿‡ç®€å•çš„å‡ ä¸ªè¯­å¥å°±å¯ä»¥ç¼–å†™å¤æ‚çš„æŠ¥è­¦æ¡ä»¶ã€‚&lt;/p&gt;
&lt;h1&gt;æŒ‡æ ‡æ”¶é›†&lt;/h1&gt;
&lt;p&gt;æŒ‰ç…§å‰é¢çš„åˆ†æï¼Œå¯¹äºåº”ç”¨å±‚ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è‡ªå·±çš„ä»£ç ï¼Œå¯ä»¥éšæ„åœ°æ·»åŠ ä»£ç æ‰“ç‚¹ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚å¯¹äºç³»ç»Ÿçš„ metrics çš„æ”¶é›†ï¼Œå¯ä»¥ä½¿ç”¨ influxdb å…¬å¸é’¦å®šçš„ telegrafã€‚telegraf ä¹Ÿæœ‰ä¸€äº›ä¸åŒçš„æ’ä»¶ï¼Œå¯ä»¥å¾ˆå¥½åœ°æ”¯æŒ mysqlã€redis ç­‰çš„ç›‘æ§æ•°æ®æ”¶é›†ã€‚&lt;/p&gt;
&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://grafana.com/blog/2016/01/05/logs-and-metrics-and-graphs-oh-my/"&gt;Logs and Metrics and Graphs, Oh my!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.gaott.info/prometheus-vs-influxdb/"&gt;Prometheus å’Œ influxdb å¯¹æ¯”&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://dbaplus.cn/news-72-1462-1.html"&gt;360åŸºäºPrometheusçš„åœ¨çº¿æœåŠ¡ç›‘æ§å®è·µ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.yunweipai.com/archives/20983.html"&gt;è™ç‰™ç›´æ’­è¿ç»´è´Ÿè´£äººå¼ è§‚çŸ³ï¼šåŸºäºæ—¶åºæ•°æ®åº“çš„ç›´æ’­ä¸šåŠ¡ç›‘æ§å®è·µ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://xoyo.space/2017/04/new-monitor-architecture/"&gt;ç›‘æ§ç³»ç»Ÿé€‰å‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://blog.csdn.net/lslxdx/article/details/79454916"&gt;openTSDB/BosunæŠ¥è­¦è¯­æ³• ä»‹ç»/å­¦ä¹ ç¬”è®°&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 17 Sep 2018 23:16:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-09-17:/posts/jian-kong-xi-tong-xuan-xing.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ scrapyï¼Ÿ</title><link>/posts/wei-shi-yao-bu-shi-yong-scrapy.html</link><description>&lt;p&gt;æœ€è¿‘é¢äº†å‡ å®¶å…¬å¸ï¼Œæ¯å½“æˆ‘æåˆ°å¤´æ¡çš„çˆ¬è™«éƒ½æ˜¯è‡ªå·±å†™çš„æ—¶å€™ï¼Œå¯¹æ–¹ä¸€ä¸ªä¸‹æ„è¯†çš„é—®é¢˜å°±æ˜¯â€œä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¼€æºçš„ scrapyï¼Ÿâ€ã€‚å®é™…ä¸Šæˆ‘åœ¨å¤´æ¡çš„ lead å°±æ˜¯ scrapy çš„ contributorï¼Œè€Œä»–è‡ªå·±ä¹Ÿä¸ç”¨è‡ªå·±çš„æ¡†æ¶ï¼Œæ˜¾ç„¶è¯´æ˜ scrapy ä¸é€‚åˆå¤§å‹é¡¹ç›®ï¼Œé‚£ä¹ˆå…·ä½“é—®é¢˜åœ¨å“ªå„¿å‘¢ï¼Ÿä»Šå¤©ç»ˆäºæœ‰æ—¶é—´äº†ï¼Œè¯¦ç»†å†™å†™è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h1&gt;çˆ¬è™«å¹¶ä¸éœ€è¦ä¸€ä¸ªæ¡†æ¶&lt;/h1&gt;
&lt;p&gt;Web æœåŠ¡å™¨æ˜¯ä¸€ä¸ªçˆ¬è™«å¯ä»¥æŠ½è±¡å‡ºæ¥çš„æ˜¯å„ç§ç»„ä»¶ã€‚è€Œ scrapy å¤ªç®€é™‹äº†ï¼Œæ¯”å¦‚è¯´å»é‡ï¼Œç›´æ¥ç”¨çš„æ˜¯å†…å­˜ä¸­çš„ä¸€ä¸ªé›†åˆã€‚å¦‚æœè¦ä¾èµ– scrapy å†™ä¸€ä¸ªå¤§å‹çš„çˆ¬è™«ï¼Œå‡ ä¹æ¯ä¸ªç»„ä»¶éƒ½è¦è‡ªå·±å®ç°ï¼Œé‚£æœ‰ä½•å¿…ç”¨ scrapy å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h1&gt;scrapy ä¸æ˜¯å®Œæ•´çš„çˆ¬è™«æ¡†æ¶&lt;/h1&gt;
&lt;p&gt;ä¸€ä¸ªå®Œæ•´çš„çˆ¬è™«è‡³å°‘éœ€è¦ä¸¤éƒ¨åˆ†ï¼Œfetcher å’Œ frontierã€‚å…¶ä¸­ fetcher ç”¨äºä¸‹è½½ç½‘é¡µï¼Œè€Œ frontier ç”¨äºè°ƒåº¦ã€‚scrapy é‡ç‚¹å®ç°çš„æ˜¯ fetcher éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯ä¸‹è½½éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h1&gt;scrapy ä¾èµ– twisted&lt;/h1&gt;
&lt;p&gt;è¿™ä¸€ç‚¹å¯¼è‡´ scrapy æ·±å…¥åæ›²çº¿éå¸¸åœ°é™¡å³­ï¼Œè¦æƒ³äº†è§£ä¸€äº›å†…éƒ¨çš„æœºç†ï¼Œå¿…é¡»å¯¹ twisted æ¯”è¾ƒæ˜äº†ã€‚è€Œ twisted æ­£å¦‚å®ƒçš„åå­—ä¸€æ ·ï¼Œæ˜¯éå¸¸æ‰­æ›²çš„ä¸€äº›æ¦‚å¿µï¼Œè™½ç„¶æ€§èƒ½éå¸¸å¥½ï¼Œä½†æ˜¯è¦ç†è§£èµ·æ¥æ˜¯è¦èŠ±ä¸Šä¸å°‘æ—¶é—´çš„ã€‚&lt;/p&gt;
&lt;h1&gt;scrapy é€‚åˆçš„é¢†åŸŸ&lt;/h1&gt;
&lt;p&gt;scrapy ä¸»è¦æ˜¯å’Œä¸€æ¬¡æ€§åœ°ä»æŒ‡å®šçš„ç«™ç‚¹çˆ¬å–ä¸€äº›æ•°æ®&lt;/p&gt;
&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://kaito-kidd.com/2016/11/01/scrapy-code-analyze-architecture/"&gt;scrapy æºç è§£è¯»&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 05 Sep 2018 19:50:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-09-05:/posts/wei-shi-yao-bu-shi-yong-scrapy.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>rabbitmq æ•™ç¨‹</title><link>/posts/rabbitmq-jiao-cheng.html</link><description>&lt;p&gt;æ›´æ–°ï¼šå¼ƒå‘äº†ï¼Œrabbitmq åœ¨æˆ‘è¿™é‡Œæ€»æ˜¯å´©æºƒï¼Œå®åœ¨æ²¡æ³•æ­£å¸¸ä½¿ç”¨&lt;/p&gt;
&lt;p&gt;è¯„ä¼°äº†å‡ æ¬¾ Message Queueï¼Œå‘ç°è¿˜æ˜¯ rabbitmq æ¯”è¾ƒç®€å•ä¸€äº›ï¼Œå„ç§ç‰¹æ€§ä¹Ÿæ”¯æŒåœ°å¾ˆå¥½ã€‚ç½‘ä¸Šå¥½å¤šæ•™ç¨‹è¯´â€œrabbitmq éå¸¸é‡é‡çº§ï¼Œé€‚åˆä¼ä¸šåº”ç”¨å¼€å‘â€ï¼Œè¿™äº›è¯å¯ä»¥è¯´æ˜¯äººäº‘äº¦äº‘ï¼Œçæ‰¯äº†ã€‚å®é™…ä¸Š rabbitmq é‡‡ç”¨ erlang å¼€å‘ï¼Œä¸å…‰æ€§èƒ½å¼ºå¤§ï¼Œè€Œä¸”ä»æ“ä½œå’Œè¿ç»´ä¸Šæ¥è¯´éƒ½æ˜¯éå¸¸è½»é‡çº§çš„ã€‚&lt;/p&gt;
&lt;h1&gt;åŸºç¡€æ¦‚å¿µ&lt;/h1&gt;
&lt;p&gt;rabbitmq å®ç°çš„æ˜¯ AMQP 0.9.1 åè®®ï¼Œå…¶ä¸­é‡è¦æ¦‚å¿µæœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;producerï¼šç”Ÿäº§è€…ï¼Œç”Ÿäº§æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;consumerï¼šæ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;routing-key: æ¯ä¸ªæ¶ˆæ¯ä¸­å†³å®šæ¶ˆæ¯å¦‚ä½•åˆ†å‘çš„å‚æ•°&lt;/li&gt;
&lt;li&gt;exchangeï¼šç±»ä¼¼è·¯ç”±ï¼Œæ¶ˆæ¯å®é™…å‘é€ç»™ exchangeï¼Œå¯ä»¥æŒ‡å®šå‡ ç§ä¸åŒçš„åˆ†å‘ç®—æ³•ï¼Œç„¶åç”¨ routing-key ä½œä¸ºå‚æ•°è®¡ç®—å‡ºè¯¥å‘é€åˆ°å“ªä¸ªé˜Ÿåˆ—ä¸­ï¼Œä¸€ä¸ªexchange å¯ä»¥å’Œä¸€ä¸ªæˆ–è€…å¤šä¸ª queue ç»‘å®šï¼Œexchange æœ‰å¦‚ä¸‹å‡ ç§åˆ†å‘ç®—æ³•&lt;/li&gt;
&lt;li&gt;directï¼Œç›´æ¥æŒ‰ç…§ routing-key å’Œ queue åå­—åŒ¹é…&lt;/li&gt;
&lt;li&gt;fan-outï¼Œå‘é€åˆ°æ‰€æœ‰ç»‘å®šçš„ queue ä¸­&lt;/li&gt;
&lt;li&gt;topicï¼Œåˆ©ç”¨ routing-key å’Œ queue çš„åå­—æ¨¡å¼åŒ¹é…&lt;/li&gt;
&lt;li&gt;queueï¼šç¼“å†²æ¶ˆæ¯ï¼Œéœ€è¦å’Œ exchange ç»‘å®š&lt;/li&gt;
&lt;li&gt;bindingï¼šæŒ‡çš„æ˜¯ exchange å’Œ queue ä¹‹é—´çš„ç»‘å®šå…³ç³»&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;Ubuntu:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get install rabbitmq-server
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Python å®¢æˆ·ç«¯ pika&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install pika
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åŸºç¡€ä½¿ç”¨&lt;/h1&gt;
&lt;p&gt;å’Œå…¶ä»–ä¸€äº›é˜Ÿåˆ—ä¸ä¸€æ ·çš„æ˜¯ï¼Œrabbitmq çš„é˜Ÿåˆ—éœ€è¦æ˜¾å¼åˆ›å»ºï¼Œä¸èƒ½ç›´æ¥å‘æ¶ˆæ¯è¿‡å»ç”Ÿæˆã€‚å¯ä»¥ä½¿ç”¨ &lt;code&gt;sudo rabbitmqctl list_queues&lt;/code&gt; å‘½ä»¤æŸ¥çœ‹å·²æœ‰çš„é˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯å®ç°ä¸€ä¸ªç”Ÿäº§è€…ï¼Œå¤šä¸ªæ¶ˆè´¹è€…çš„å…³ç³»ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://www.rabbitmq.com/img/tutorials/prefetch-count.png"&gt;&lt;/p&gt;
&lt;p&gt;ç”Ÿäº§è€…&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pika&lt;/span&gt;

&lt;span class="n"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BlockingConnection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionParameters&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queue_declare&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;durable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# å£°æ˜ä¸€ä¸ªé˜Ÿåˆ—ï¼Œrabbitmq ä¸­çš„é˜Ÿåˆ—å¿…é¡»é¦–å…ˆåˆ›å»ºæ‰èƒ½ä½¿ç”¨&lt;/span&gt;

&lt;span class="c1"&gt;# å‘é€æ¶ˆæ¯éœ€è¦æŒ‡æ˜å‘é€åˆ°çš„ exchangeï¼Œç•™ç©ºè¡¨ç¤ºé»˜è®¤ exchange&lt;/span&gt;
&lt;span class="c1"&gt;# é»˜è®¤çš„ exchange ä¼šæ ¹æ® routing-key æŠŠæ¶ˆæ¯å‘åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;basic_publish&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exchange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;routing_key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Hello World!&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# æ¶ˆæ¯ä½“&lt;/span&gt;
                      &lt;span class="n"&gt;properties&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BasicProperties&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                         &lt;span class="n"&gt;delivery_mode&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# AMQP å®šä¹‰çš„ï¼Œå…¶ä¸­ 1 ä»£è¡¨ä¸è¦æŒä¹…åŒ–ï¼Œ2 ä»£è¡¨éœ€è¦æŒä¹…åŒ–&lt;/span&gt;
                      &lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; [x] Sent &amp;#39;Hello World!&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æœ€åå…³é—­é“¾æ¥&lt;/span&gt;
&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¶ˆè´¹è€…&lt;/p&gt;
&lt;p&gt;æ¶ˆè´¹è€…é€šè¿‡æ³¨å†Œå¤„ç†å‡½æ•°ï¼Œæ¥æ¶ˆè´¹æ¶ˆæ¯ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹åŒä¸€ä¸ªé˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pika&lt;/span&gt;

&lt;span class="n"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BlockingConnection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionParameters&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queue_declare&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;durable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;properties&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; [x] Received &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;basic_ack&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;delivery_tag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delivery_tag&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;basic_qos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prefetch_count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# æœ€å¤šæœ‰ä¸€ä¸ªæ¶ˆæ¯æ²¡æœ‰ ack&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;basic_consume&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;no_ack&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# é»˜è®¤æƒ…å†µåŠ å°±æ˜¯ Falseï¼Œä¹Ÿå°±æ˜¯éœ€è¦ ack&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; [*] Waiting for messages. To exit press CTRL+C&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start_consuming&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;å¯ä»¥ç›´æ¥ä½¿ç”¨å¤šä¸ªæ¶ˆè´¹è€…æ¥æ¶ˆè´¹åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œé»˜è®¤æƒ…å†µä¸‹ rabbitmq é‡‡ç”¨äº† round robin çš„ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯æ¶ˆæ¯ä¼šä¾æ¬¡å‘é€ç»™æ¯ä¸€ä¸ªæ¶ˆè´¹è€…ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ²¡æœ‰ ack çš„è¯ï¼Œrabbitmq çš„å†…å­˜æœ€ç»ˆå¯èƒ½ä¼šå æ»¡&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨å…¶ä»–çš„ exchange&lt;/h1&gt;
&lt;p&gt;rabbitmq ä¸­é»˜è®¤çš„ exchange æ˜¯ &lt;code&gt;direct&lt;/code&gt; exchangeï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æŠŠæ”¶åˆ°çš„æ¶ˆæ¯æ”¾åˆ° routing key å¯¹åº”çš„é˜Ÿåˆ—ä¸­ã€‚rabbitmq è¿˜æ”¯æŒä¸å°‘å…¶ä»–çš„ç±»å‹ï¼Œå¯ä»¥çœ‹æ–‡ç« å¼€å§‹çš„è®¨è®ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ä¾‹å­é€šè¿‡ä½¿ç”¨ä¸€ä¸ª fanout ç±»å‹çš„ exchange æ¥å®ç°æ¶ˆæ¯å‘é€ç»™æ‰€æœ‰æ¶ˆè´¹è€…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://www.rabbitmq.com/img/tutorials/python-three-overall.png"&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pika&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;

&lt;span class="n"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BlockingConnection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionParameters&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# å£°æ˜ä¸€ä¸ª fanout ç±»å‹çš„ exchangeï¼Œåå­—ä¸º logs&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exchange_declare&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exchange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;logs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                         &lt;span class="n"&gt;exchange_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;fanout&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:])&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;info: Hello World!&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;basic_publish&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exchange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;logs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;routing_key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; [x] Sent &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;æ¶ˆè´¹è€…&lt;/p&gt;
&lt;p&gt;Exchange éœ€è¦å’Œ queue ç»‘å®šæ‰ä¼šå‘é€æ¶ˆæ¯ï¼Œå¦åˆ™ä¼šç›´æ¥ä¸¢æ‰ã€‚
queue éœ€è¦å’Œ exchange ç»‘å®šä¹‹åæ‰èƒ½å¤Ÿæ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œè€Œæ‰€æœ‰çš„ queue é»˜è®¤å·²ç»æ˜¯å’Œé»˜è®¤ exchange ç»‘å®šçš„ï¼Œæ‰€ä»¥åœ¨ä¸Šä¸€ä¸ªä¾‹å­ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨ç»‘å®šã€‚&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pika&lt;/span&gt;

&lt;span class="n"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BlockingConnection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionParameters&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exchange_declare&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exchange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;logs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                         &lt;span class="n"&gt;exchange_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;fanout&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# å£°æ˜ä¸€ä¸ªä¸´æ—¶çš„ç§æœ‰ queue&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queue_declare&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exclusive&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;queue_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queue&lt;/span&gt;

&lt;span class="c1"&gt;# ç»‘å®š queue åˆ°åˆšåˆšå£°æ˜çš„ exchange&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queue_bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exchange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;logs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                   &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;queue_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; [*] Waiting for logs. To exit press CTRL+C&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;properties&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; [x] &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;basic_consume&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;queue_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;no_ack&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start_consuming&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h1&gt;å¸¸è§é—®é¢˜&lt;/h1&gt;
&lt;h2&gt;åœ¨ä¸€ä¸ªå¾ªç¯ä¸­å‘é€æ¶ˆæ¯ï¼Œä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šæç¤º Channel Closed?&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ BlockingConnection éœ€è¦æ‰‹åŠ¨ç®¡ç†å¿ƒè·³ï¼Œå¦‚æœè¶…è¿‡å¿ƒè·³æ—¶é—´å°±ä¼šè¢«å…³é—­é“¾æ¥ã€‚å¸¸è§çš„é”™è¯¯åŒ…æ‹¬ä½¿ç”¨äº† time.sleep å¯¼è‡´é•¿æ—¶é—´æ²¡æœ‰ publish æ¶ˆæ¯ï¼Œä»è€Œé“¾æ¥è¢«å…³é—­ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡å•ç‹¬å¼€ä¸€ä¸ªå¿ƒè·³çº¿ç¨‹çš„æ–¹æ³•ï¼Œæˆ–è€…ä½¿ç”¨ &lt;a href="https://github.com/pika/pika/commit/df6a31630c530559cc61df14c1f23813b870d80a"&gt;connction.sleep&lt;/a&gt;ã€‚å½“ç„¶ä½¿ç”¨ connction.sleep æ— æ³•é¿å…æœ¬èº«æ“ä½œæ—¶é•¿è¶…è¿‡äº†å¿ƒè·³æ—¶é—´çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;h1&gt;channel å’Œ connection çš„åŒºåˆ«ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;Connection è¡¨ç¤ºçš„æ˜¯åˆ° rabbitmq broker çš„ä¸€ä¸ªç‰©ç†è¿æ¥ï¼Œä¸€èˆ¬ä¸€ä¸ªç¨‹åºä½¿ç”¨ä¸€ä¸ªé“¾æ¥ï¼Œæˆ–è€…ä½¿ç”¨ä¸€ä¸ªè¿æ¥æ± ï¼Œå¯ä»¥ä½¿ç”¨å¿ƒè·³æ¥ç»´æŠ¤ä¸€ä¸ªé“¾æ¥ï¼Œç†è®ºä¸Šåº”è¯¥åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´åˆ†äº«ï¼Œå¾ˆé—æ†¾ python çš„å®¢æˆ·ç«¯ pika å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;è€Œchannel åˆ™åº”è¯¥æ˜¯çŸ­æ—¶æ•ˆçš„ï¼Œåœ¨æ¯ä¸ªçº¿ç¨‹å†…éƒ¨åˆ›å»ºï¼Œä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/18418936/rabbitmq-and-relationship-between-channel-and-connection&lt;/li&gt;
&lt;li&gt;https://www.rabbitmq.com/tutorials/amqp-concepts.html&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;å¦‚æœå®¢æˆ·ç«¯é‡å¯ï¼Œä¹‹å‰çš„åŒ¿åé˜Ÿåˆ—ä¼šè¢«åˆ é™¤å—ï¼Ÿå¦‚æœæ²¡æœ‰åˆ«åˆ é™¤ï¼Œè¿˜èƒ½è¿æ¥ä¸Šä¹‹å‰çš„åŒ¿åé˜Ÿåˆ—å—ï¼Ÿå¦‚æœè¿ä¸ä¸Šæ˜¯ä¸æ˜¯æ¶ˆæ¯å°±éƒ½ä¸¢äº†ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;To be answered&lt;/p&gt;
&lt;h1&gt;UIç®¡ç†å·¥å…·&lt;/h1&gt;
&lt;p&gt;åœ¨å‘é˜Ÿåˆ—ä¸­å‘æ¶ˆæ¯çš„è¿‡ç¨‹ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨å­¦ä¹ æˆ–è€…æ’æŸ¥é”™è¯¯çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ rabbitmq çš„ç®¡ç†å·¥å…·æ¥æŸ¥çœ‹å½“å‰æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæ¿€æ´»ç®¡ç†å·¥å…·æ’ä»¶ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rabbitmq-plugins enable rabbitmq_management
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åæ·»åŠ ç”¨æˆ·&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rabbitmqctl add_user username password
rabbitmqctl set_user_tags username administrator
rabbitmqctl set_permissions -p / username &amp;quot;.*&amp;quot; &amp;quot;.*&amp;quot; &amp;quot;.*&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åå¯ä»¥æ‰“å¼€ï¼šhttp://server-name:15672/ æŸ¥çœ‹ï¼Œä½¿ç”¨åˆšåˆšè®¾ç½®çš„å¯†ç ç™»å½•&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/0069RVTdly1fu228vp43hj31kw0v9jyg.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;å‚è€ƒï¼š&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;http://www.rabbitmq.com/management.html&lt;/li&gt;
&lt;li&gt;https://www.rabbitmq.com/tutorials/tutorial-three-python.html&lt;/li&gt;
&lt;li&gt;https://github.com/pika/pika/issues/196&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 07 Aug 2018 17:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-08-07:/posts/rabbitmq-jiao-cheng.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>mysql åŸºç¡€çŸ¥è¯†(3) - åˆ›å»ºä¿®æ”¹è¡¨å’Œæƒé™</title><link>/posts/mysql-ji-chu-zhi-shi-3-chuang-jian-xiu-gai-biao-he-quan-xian.html</link><description>&lt;h2&gt;åˆ›å»ºæ•°æ®åº“&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CREATE DATABASE db_name
    [[DEFAULT] CHARACTER SET charset_name]
    [[DEFAULT] COLLATE collation_name]

ALTER DATABASE db_name
    [[DEFAULT] CHARACTER SET charset_name]
    [[DEFAULT] COLLATE collation_name]
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åˆ›å»ºè¡¨?&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CREATE TABLE table_name (
Â Â Â  field_name type is_null default options,
    ...
Â Â Â  PRIMAR KEY (id),
Â Â Â  INDEX/KEY index_name (field_name),
) ENGINE=InnoDB;
Â 
// æ³¨æ„ï¼šKEYÂ is normally a synonym forÂ INDEX
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è®¾å®š auto_increment&lt;/p&gt;
&lt;p&gt;æ³¨æ„ mysql çš„å…³é”®å­—æ˜¯ auto_increment, è€Œ sqlite çš„æ˜¯ autoincrement&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CREATE TABLE(...) AUTO_INCREMENT=xxx;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ›´æ”¹å·²ç»å­˜åœ¨çš„è¡¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ALTER TABLE SET AUTO_INCREMENT=xxx;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ•°æ®ç±»å‹&lt;/h2&gt;
&lt;h3&gt;å­—ç¬¦ä¸²&lt;/h3&gt;
&lt;p&gt;å­—ç¬¦ä¸²åˆ†ä¸¤ç§ï¼Œå®šé•¿å’Œå˜é•¿ï¼ŒMySQLå¤„ç†å®šé•¿æ•°æ®æ¯”å˜é•¿æ•°æ®å¿«å¾—å¤šã€‚CHARå±äºå®šé•¿ç±»å‹ï¼ŒVARCHARå’ŒTEXTå±äºå˜é•¿ç±»å‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CHARçš„é•¿åº¦ä¸º1-255ï¼Œé»˜è®¤ä¸º1ï¼Œä½¿ç”¨CHAR(n)æŒ‡å®šé•¿åº¦&lt;/li&gt;
&lt;li&gt;VARCHARä¸º0-255ï¼Œä½¿ç”¨VARCHAR(n)æŒ‡å®šé•¿åº¦&lt;/li&gt;
&lt;li&gt;TEXTä¸º65536ï¼ŒMEDIUMTEXTä¸º16kï¼ŒLONGTEXTä¸º4GB&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tNc79ly1ft17mebw0kj31900n6wkx.jpg"&gt;&lt;/p&gt;
&lt;h3&gt;æ•°å­—&lt;/h3&gt;
&lt;p&gt;æ³¨æ„æ•°å­—åé¢è·Ÿçš„æ•°å­—ï¼Œä¾‹å¦‚INT(5)ï¼Œå¹¶ä¸æ˜¯é™åˆ¶æ•°å­—çš„å­˜å‚¨é•¿åº¦ï¼Œè€Œæ˜¯é™åˆ¶æ•°å­—çš„å±•ç¤ºé•¿åº¦ï¼ˆæ˜¾ç¤ºæ—¶å¡«å……0ï¼‰ï¼å¯ä»¥ä½¿ç”¨UNSIGNEDæŒ‡å®šä¸ºéè´Ÿå€¼ï¼Œé»˜è®¤ä¸ºsigned&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tNc79ly1ft17lhmrv7j30wk0fswh3.jpg"&gt;&lt;/p&gt;
&lt;h3&gt;æ—¥æœŸ&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨DATETIMEï¼Œä¸è¦ä½¿ç”¨TIMESTAMPï¼Œé˜²æ­¢2038å¹´æº¢å‡º&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tNc79ly1ft17luawbtj312w09kabw.jpg"&gt;&lt;/p&gt;
&lt;h3&gt;tips&lt;/h3&gt;
&lt;h4&gt;åˆ›å»º modify_time/update_time å­—æ®µæ—¶ä½¿ç”¨è‡ªåŠ¨æ›´æ–°æ—¶é—´&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;`modify_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;è®¾è®¡è¡¨è¦æ³¨æ„æ¯ä¸ªå­—æ®µçš„æ­£äº¤æ€§ï¼Œä¸è¦å‡ºç°ä¸€ä¸ªå­—æ®µè¡¨ç¤ºâ€œxxä¸”xxâ€çš„çŠ¶æ€ã€‚&lt;/h4&gt;
&lt;h2&gt;æ›´æ–°è¡¨&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rename table &amp;#39;old_name&amp;#39; to &amp;#39;new_name&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ·»åŠ ä¸€åˆ—ï¼Œå…¶ä¸­çš„ COLUMN å…³é”®å­—æ˜¯ optional çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ALTER TABLE table_name ADD COLUMN field_name type;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ›´æ–°æŸä¸ªå­—æ®µçš„æ•°æ®ç±»å‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Alter TABLE `tableName` MODIFY COLUMN `ColumnName` datatype(length);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¯”å¦‚è¯´ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Alter TABLE `tbl_users` MODIFY COLUMN `dup` VARCHAR(120);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é‡å‘½åä¸€åˆ—&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯æ•°æ®ç±»å‹ä¹Ÿéœ€è¦å¸¦ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;alter table `user` change `name` `first_name` varchar(128) default null;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ·»åŠ ä¸åŒç±»å‹çš„ç´¢å¼•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ALTER TABLE table_name ADD INDEX index_name (column_list)

ALTER TABLE table_name ADD UNIQUE index_name (column_list)

ALTER TABLE table_name ADD PRIMARY KEY index_name (column_list)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ mysql ç´¢å¼•çš„æœ€å¤§é•¿åº¦æ˜¯ 255ï¼Œä¹Ÿå°±æ˜¯åœ¨ VARCHAR(255) ä»¥ä¸Šçš„åˆ—æ˜¯ä¸èƒ½æ·»åŠ ç´¢å¼•çš„ï¼Œä¸€ä¸ªæ”¹è¿›æ–¹æ³•å°±æ˜¯å¦å¤–æ·»åŠ ä¸€åˆ—å­˜å‚¨è¿™ä¸€åˆ—çš„ hash å€¼ã€‚&lt;/p&gt;
&lt;h2&gt;åˆ é™¤å­—æ®µ&lt;/h2&gt;
&lt;p&gt;åˆ é™¤ç´¢å¼•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;alter table TABLENAME drop index xxxx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;------------------ä¹‹å‰ç¬”è®°çš„åˆ†å‰²çº¿------------------------
Â 
Â &lt;/p&gt;
&lt;h2&gt;ç»„åˆç´¢å¼•&lt;/h2&gt;
&lt;p&gt;å¦‚æœæœ‰ä¸€ä¸ªç»„åˆç´¢å¼•(col_a,col_b,col_c)
Â 
ä¸‹é¢çš„æƒ…å†µéƒ½ä¼šç”¨åˆ°è¿™ä¸ªç´¢å¼•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;col_a = &amp;quot;some value&amp;quot;;
col_a = &amp;quot;some value&amp;quot; and col_b = &amp;quot;some value&amp;quot;;
col_a = &amp;quot;some value&amp;quot; and col_b = &amp;quot;some value&amp;quot; and col_c = &amp;quot;some value&amp;quot;;
col_b = &amp;quot;some value&amp;quot; and col_a = &amp;quot;some value&amp;quot; and col_c = &amp;quot;some value&amp;quot;;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯¹äºæœ€åä¸€æ¡è¯­å¥ï¼Œmysqlä¼šè‡ªåŠ¨ä¼˜åŒ–æˆç¬¬ä¸‰æ¡çš„æ ·å­
Â 
ä¸‹é¢çš„æƒ…å†µå°±ä¸ä¼šç”¨åˆ°ç´¢å¼•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;col_b = &amp;quot;aaaaaa&amp;quot;;
col_b = &amp;quot;aaaa&amp;quot; and col_c = &amp;quot;cccccc&amp;quot;;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 07 Aug 2018 15:47:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-08-07:/posts/mysql-ji-chu-zhi-shi-3-chuang-jian-xiu-gai-biao-he-quan-xian.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>ç½‘ç»œåè®®æ¦‚è¿°</title><link>/posts/wang-luo-xie-yi-gai-shu.html</link><description>&lt;p&gt;ç½‘ç»œæ¯å±‚çš„å¤´éƒ¨åŸºæœ¬ä¸Šå°±æ˜¯æ·»åŠ ä¸Šæœ¬å±‚çš„åœ°å€ï¼Œè¿˜æœ‰ä¸€äº›æ ¡éªŒå’Œæ§åˆ¶ä½&lt;/p&gt;
&lt;p&gt;è¿è¾“å±‚çš„ MAC åœ°å€æ˜¯ç‚¹åˆ°ç‚¹çš„ï¼Œæ²¡ä¼ é€’ä¸€æ¬¡å°±ä¼šæŠŠå‘é€è€…å’Œæ¥å—è€…ç”¨ ARP è½¬æ¢ï¼Œæ›¿æ¢ä¸ºç»è¿‡çš„è·¯ç”±å™¨çš„MACåœ°å€ã€‚è€Œ IP å±‚çš„åœ°å€å’Œç«¯å£å·æ˜¯ç«¯åˆ°ç«¯ï¼Œä»å‘é€åˆ°ç»“æŸå§‹ç»ˆä¸å˜ã€‚é™¤éç»è¿‡ä¸Šå±‚åè®®æ”¹å˜äº†åœ°å€å’Œç«¯å£å·ï¼Œæ¯”å¦‚ä»£ç†æœåŠ¡å™¨æˆ–è€… NAPT è·¯ç”±å™¨ã€‚&lt;/p&gt;
&lt;p&gt;äº¤æ¢æœºæ²¡æœ‰ä»»ä½•åœ°å€ï¼Œåªæœ‰ç«¯å£çš„æ¦‚å¿µã€‚å†…éƒ¨æœ‰ä¸€ä¸ªè½¬å‘è¡¨ï¼Œè®°å½•äº†ç‰©ç†ç«¯å£å’ŒMACçš„å¯¹åº”å…³ç³»ï¼Œé€šè¿‡è‡ªä¸»å­¦ä¹ æ¥å»ºç«‹ã€‚æ¯å°ä¸»æœºä¸Šéƒ½æœ‰è‡ªå·±çš„é«˜é€Ÿ ARP åœ°å€ç¼“å­˜å’Œè·¯ç”±è¡¨ã€‚å¯ä»¥é€šè¿‡ &lt;code&gt;ip n&lt;/code&gt; å’Œ &lt;code&gt;ip r&lt;/code&gt; å‘½ä»¤æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;VLAN å¯ä»¥ç†è§£ä¸ºé€»è¾‘ä¸Šå°†ä¸€å°äº¤æ¢æœºåˆ†å‰²æˆæ•°å°è™šæ‹Ÿäº¤æ¢æœºï¼Œä¸”è¿™äº›è™šæ‹Ÿäº¤æ¢æœºäº’ä¸ç›¸é€šã€‚Vlan æ˜¯å¹¿æ’­åŸŸï¼Œè€Œé€šå¸¸ä¸¤ä¸ªå¹¿æ’­åŸŸä¹‹é—´ç”±è·¯ç”±å™¨ç›¸è¿æ¥ï¼Œå¹¿æ’­åŸŸä¹‹é—´æ¥å¾€çš„æ•°æ®å¸§é€šè¿‡è·¯ç”±å™¨ä¸­ç»§ã€‚å› æ­¤ Vlané—´çš„é€šä¿¡ä¹Ÿéœ€è¦è·¯ç”±å™¨ï¼ˆæˆ–è€…ä¸‰å±‚äº¤æ¢æœºï¼‰æä¾›ä¸­ç»§æœåŠ¡ï¼Œå³â€œVlané—´è·¯ç”±â€ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 02 Aug 2018 17:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-08-02:/posts/wang-luo-xie-yi-gai-shu.html</guid><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>å›¾è§£ä¸€è‡´æ€§å“ˆå¸Œ</title><link>/posts/tu-jie-yi-zhi-xing-ha-xi.html</link><description>&lt;h1&gt;èµ·æº&lt;/h1&gt;
&lt;p&gt;æ¯”å¦‚ä½ æœ‰ N ä¸ª cache æœåŠ¡å™¨ï¼ˆåé¢ç®€ç§° cache ï¼‰ï¼Œé‚£ä¹ˆå¦‚ä½•å°†ä¸€ä¸ªå¯¹è±¡ object æ˜ å°„åˆ° N ä¸ª cache ä¸Šå‘¢ï¼Œä½ å¾ˆå¯èƒ½ä¼šé‡‡ç”¨ç±»ä¼¼ä¸‹é¢çš„é€šç”¨æ–¹æ³•è®¡ç®— object çš„ hash å€¼ï¼Œç„¶åå‡åŒ€çš„æ˜ å°„åˆ°åˆ° N ä¸ª cache ï¼›&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hash(object) % N
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸€åˆ‡éƒ½è¿è¡Œæ­£å¸¸ï¼Œå†è€ƒè™‘å¦‚ä¸‹çš„ä¸¤ç§æƒ…å†µï¼›&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¸€ä¸ª cache æœåŠ¡å™¨ m down æ‰äº†ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­å¿…é¡»è¦è€ƒè™‘è¿™ç§æƒ…å†µï¼‰ï¼Œè¿™æ ·æ‰€æœ‰æ˜ å°„åˆ° cache m çš„å¯¹è±¡éƒ½ä¼šå¤±æ•ˆï¼Œæ€ä¹ˆåŠï¼Œéœ€è¦æŠŠ cache m ä» cache ä¸­ç§»é™¤ï¼Œè¿™æ—¶å€™ cache æ˜¯ N-1 å°ï¼Œæ˜ å°„å…¬å¼å˜æˆäº† &lt;code&gt;hash(object) % (N-1)&lt;/code&gt; ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±äºè®¿é—®åŠ é‡ï¼Œéœ€è¦æ·»åŠ  cache ï¼Œè¿™æ—¶å€™ cache æ˜¯ N+1 å°ï¼Œæ˜ å°„å…¬å¼å˜æˆäº† &lt;code&gt;hash(object) % (N+1)&lt;/code&gt; ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;1 å’Œ 2 æ„å‘³ç€ä»€ä¹ˆï¼Ÿè¿™æ„å‘³ç€çªç„¶ä¹‹é—´å‡ ä¹æ‰€æœ‰çš„ cache éƒ½å¤±æ•ˆäº†ã€‚å¯¹äºæœåŠ¡å™¨è€Œè¨€ï¼Œè¿™æ˜¯ä¸€åœºç¾éš¾ï¼Œæ´ªæ°´èˆ¬çš„è®¿é—®éƒ½ä¼šç›´æ¥å†²å‘åå°æœåŠ¡å™¨ï¼›&lt;/p&gt;
&lt;p&gt;å†æ¥è€ƒè™‘ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼Œç”±äºç¡¬ä»¶èƒ½åŠ›è¶Šæ¥è¶Šå¼ºï¼Œä½ å¯èƒ½æƒ³è®©åé¢æ·»åŠ çš„èŠ‚ç‚¹å¤šåšç‚¹æ´»ï¼Œæ˜¾ç„¶ä¸Šé¢çš„ hash ç®—æ³•ä¹Ÿåšä¸åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥æ”¹å˜è¿™ä¸ªçŠ¶å†µå‘¢ï¼Œè¿™å°±æ˜¯ consistent hashing...&lt;/p&gt;
&lt;h1&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/h1&gt;
&lt;p&gt;ä¸€è‡´æ€§å“ˆå¸ŒæŠŠå“ˆå¸Œå€¼æƒ³è±¡æˆä¸€ä¸ªç¯ï¼Œæ¯”å¦‚è¯´åœ¨ 0 ~ 2^32-1 è¿™ä¸ªèŒƒå›´å†…ï¼Œç„¶åå°†èŠ‚ç‚¹ï¼ˆåå­—ã€IPç­‰ï¼‰æ±‚å“ˆå¸Œä¹‹ååˆ†ä¸åˆ°ç¯ä¸Šã€‚å½“æœ‰è®¿é—®è¯·æ±‚æ—¶ï¼ŒæŠŠè¯·æ±‚ä¿¡æ¯æ±‚å“ˆå¸Œä¹‹åï¼Œå¯»æ‰¾å°äºè¯¥å“ˆå¸Œå€¼çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å½“æœ‰èŠ‚ç‚¹å®•æœºçš„æ—¶å€™ï¼Œè¯·æ±‚ä¼šä¾æ¬¡æŸ¥æ‰¾ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œä¸è®©æ‰€æœ‰èŠ‚ç‚¹çš„ç¼“å­˜éƒ½å¤±æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;å½“åŠ å…¥æ–°èŠ‚ç‚¹çš„æ—¶å€™ï¼Œåªä¼šå½±å“ä¸€ä¸ªåŒºé—´å†…çš„è¯·æ±‚ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–åŒºé—´ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tKfTcly1ftvggxvlwfj315o0djq52.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;è™šæ‹ŸèŠ‚ç‚¹&lt;/h1&gt;
&lt;p&gt;ä»¥ä¸Šè™½ç„¶è§£å†³äº†å¤§éƒ¨åˆ†é—®é¢˜ï¼Œä½†æ˜¯è¿˜æœ‰ä¸‰ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;èŠ‚ç‚¹æœ‰å¯èƒ½åœ¨åˆ†å¸ƒä¸å‡åŒ€ã€‚&lt;/li&gt;
&lt;li&gt;å½“ä¸€ä¸ªèŠ‚ç‚¹å› ä¸ºè´Ÿè½½è¿‡é‡å®•æœºä»¥åï¼Œæ‰€æœ‰è¯·æ±‚ä¼šè½åˆ°ä¸‹ä¸€å°ä¸»æœºï¼Œè¿™æ ·å°±æœ‰å¯èƒ½ä½¿ä¸‹ä¸€å°ä¸»æœºä¹Ÿå®•æœºï¼Œè¿™å°±æ˜¯é›ªå´©é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;ä¸åŒä¸»æœºå¤„ç†èƒ½åŠ›ä¸åŒå¦‚ä½•é…ç½®ä¸åŒçš„é‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ—¶å€™å¯ä»¥å¼•å…¥è™šæ‹ŸèŠ‚ç‚¹ã€‚åŸå§‹çš„ä¸€è‡´æ€§å“ˆå¸Œä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹é€šè¿‡å“ˆå¸Œä¹‹ååœ¨ç¯ä¸Šå æœ‰ä¸€ä¸ªä½ç½®ï¼Œå¯ä»¥é€šè¿‡å¯¹æ¯ä¸ªèŠ‚ç‚¹å¤šæ¬¡è®¡ç®—å“ˆå¸Œæ¥è·å¾—è¿‡ä¸ªè™šæ‹ŸèŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ï¼Œæœ¬æ¥æˆ‘ä»¬é€šè¿‡èŠ‚ç‚¹çš„ IP æ¥è®¡ç®—å“ˆå¸Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hash(&amp;#39;10.1.1.1&amp;#39;)  =&amp;gt; n1
hash(&amp;#39;10.1.1.2&amp;#39;)  =&amp;gt; n2
hash(&amp;#39;10.1.1.3&amp;#39;)  =&amp;gt; n3
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç°åœ¨å¼•å…¥ä¸¤å€çš„è™šæ‹ŸèŠ‚ç‚¹ä¹‹å&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hash(&amp;#39;10.1.1.1-1&amp;#39;)  =&amp;gt; n1-1
hash(&amp;#39;10.1.1.1-2&amp;#39;)  =&amp;gt; n1-2
hash(&amp;#39;10.1.1.2-1&amp;#39;)  =&amp;gt; n2-1
hash(&amp;#39;10.1.1.2-2&amp;#39;)  =&amp;gt; n2-2
hash(&amp;#39;10.1.1.3-1&amp;#39;)  =&amp;gt; n3-1
hash(&amp;#39;10.1.1.3-2&amp;#39;)  =&amp;gt; n3-2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚å›¾æ‰€ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tKfTcly1ftvggbzovij315o0en40x.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å¼•å…¥è™šæ‹ŸèŠ‚ç‚¹ä¹‹åï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¹³è¡¡æ€§å¾—åˆ°äº†ç›´æ¥æ”¹å–„&lt;/li&gt;
&lt;li&gt;ä¸»æœºæ˜¯äº¤æ›¿å‡ºç°çš„ï¼Œæ‰€ä»¥å½“ä¸€ä¸ªèŠ‚ç‚¹å®•æœºåï¼Œæ‰€æœ‰æµé‡ä¼šéšæœºåˆ†é…ç»™å‰©ä½™èŠ‚ç‚¹&lt;/li&gt;
&lt;li&gt;å¯ä»¥ç»™å¤„ç†èƒ½åŠ›å¼ºçš„èŠ‚ç‚¹é…ç½®æ›´å¤šåœ°è™šæ‹ŸèŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ€åï¼Œä¸€è‡´æ€§å“ˆå¸Œå¯ä»¥ç”¨è·³è¡¨æˆ–è€…å¹³è¡¡äºŒå‰æ ‘æ¥å®ç°&lt;/p&gt;
&lt;p&gt;å‚è€ƒæ–‡æ¡£ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://blog.csdn.net/MBuger/article/details/76189561&lt;/li&gt;
&lt;li&gt;https://www.cnblogs.com/23lalala/p/3588553.html&lt;/li&gt;
&lt;li&gt;https://crossoverjie.top/2018/01/08/Consistent-Hash/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 01 Aug 2018 05:43:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-08-01:/posts/tu-jie-yi-zhi-xing-ha-xi.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>è›¤ï¼Ÿä»€ä¹ˆæ˜¯ raft åè®®ï¼Ÿ</title><link>/posts/ha-shi-yao-shi-raft-xie-yi.html</link><description>&lt;p&gt;Raft åè®®æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ä¸€è‡´æ€§åè®®ï¼Œä¸»è¦é€šè¿‡ Leader Election å’Œ Log Replication ä¸¤ä¸ªæ­¥éª¤æ¥å®ç°é«˜å¯ç”¨çš„ä¸€è‡´æ€§çŠ¶æ€å­˜å‚¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« å¹¶ä¸æ˜¯ Raft åè®®çš„ä¸€ä¸ªå®Œæ•´ä»‹ç»ï¼Œåªæ˜¯å…¶ä¸­æ ¸å¿ƒæ¦‚å¿µçš„ä¸€ä¸ªæ€»ç»“æ¦‚æ‹¬ï¼Œè¦å®Œå…¨ç†è§£æ‰€æœ‰ç»†èŠ‚è¿˜æ˜¯å¾—çœ‹è®ºæ–‡ã€‚&lt;/p&gt;
&lt;h1&gt;Leader é€‰ä¸¾&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸‰ç§çŠ¶æ€ï¼šfollowerã€candidateã€leaderã€‚&lt;/li&gt;
&lt;li&gt;ä½œä¸º leader æœ‰ä»»æœŸ(term)çš„æ¦‚å¿µï¼Œæ ¹æ®åŸºæœ¬æ³•å¿…é¡»é€‰ä¸¾ä¸Šå°ã€‚Term æ˜¯ä¸€ä¸ªè‡ªå¢çš„æ•°å­—ã€‚&lt;/li&gt;
&lt;li&gt;ä½œä¸º leader è¦ä¸æ–­å‘é€å¿ƒè·³ç»™ followerï¼Œå‘Šè¯‰ä»–ä»¬ä¸€å¾‹ä¸å¾—ç»å•†ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªéšæœºçš„å®šæ—¶å™¨ï¼ˆ150ms~300msï¼‰ï¼Œå½“ follower æ²¡æœ‰æ”¶åˆ°æ—¥å¿—åå°±ä¼šå‡çº§ä¸º candidateï¼Œterm + 1ï¼Œç»™è‡ªå·±æŠ•ä¸€ç¥¨ï¼Œå¹¶ä¸”å‘é€ Request Vote RPC ç»™æ‰€æœ‰èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ apply for professor å•¦ã€‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹æ”¶åˆ° Request Vote åï¼Œå¦‚æœè‡ªå·±è¿˜æ²¡æœ‰æŠ•ç¥¨ï¼Œè€Œä¸”æ¯”è‡ªå·±åœ¨çš„ä»»æœŸå¤§ï¼Œé‚£å°±è¯´æ˜æ°´å¹³æ¯”è‡ªå·±é«˜åˆ°ä¸çŸ¥é“å“ªé‡Œå»äº†ï¼Œå°±æŠ•ç¥¨å‡ºå»ï¼Œå¦åˆ™æ‹’ç»ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœèŠ‚ç‚¹å‘ç°è‡ªå·±çš„ç¥¨è¶…è¿‡äº†ä¸€åŠï¼Œå°±åŸä¸¤å¥è¯—ï¼Œè®¤ä¸ºè‡ªå·±æ˜¯ leader äº†&lt;/li&gt;
&lt;li&gt;æ–°çš„ leader ä¸Šå°åï¼Œç»§ç»­å‘é€æ—¥å¿—æ˜­å‘Šå¤©ä¸‹ï¼Œå…¶ä»–çš„ candidate è‡ªåŠ¨ç°æºœæºœçš„å˜ä¸º follower äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;æ—¥å¿—å¤åˆ¶ï¼ˆLog Replicationï¼‰&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;æ‰€æœ‰çš„è¯·æ±‚éƒ½å‘é€ç»™ leaderï¼Œä¸€å¾‹ç”±ä¸­å¤®è´Ÿè´£ã€‚&lt;/li&gt;
&lt;li&gt;leader æŠŠæ”¶åˆ°çš„è¯·æ±‚é¦–å…ˆæ·»åŠ åˆ°è‡ªå·±çš„æ—¥å¿—å½“ä¸­&lt;/li&gt;
&lt;li&gt;ç„¶åå‘é€ Append Entries RPC ç»™æ‰€æœ‰çš„ followerï¼Œè¦æ±‚ä»–ä»¬ä¹Ÿæ·»åŠ è¿™æ¡æ—¥å¿—&lt;/li&gt;
&lt;li&gt;å½“å¤§å¤šæ•°çš„èŠ‚ç‚¹éƒ½æ·»åŠ è¿™æ¡æ—¥å¿—ä¹‹åï¼Œleader ä¸Šè¿™æ¡æ—¥å¿—å°±å˜ä¸ºäº† commited&lt;/li&gt;
&lt;li&gt;leader å†å‘é€ç»™æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œå‘Šè¯‰ä»–ä»¬è¿™æ¡æ—¥å¿— commited&lt;/li&gt;
&lt;li&gt;leader è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå‘Šè¯‰ä»–è¯·æ±‚æˆåŠŸ&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;åˆ†åŒºå®¹å¿&lt;/h2&gt;
&lt;p&gt;å¦‚æœç½‘ç»œå‘ç”Ÿäº†åˆ†åŒºï¼Œä¹Ÿå°±æ˜¯å¦ç«‹ä¸­å¤®äº†ï¼Œé‚£ä¹ˆ raft çš„æ—¥å¿—å¤åˆ¶æœºåˆ¶ä¹Ÿå¯ä»¥ä¿è¯ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä¸‹å›¾ä¸­ï¼Œç”±äºä¸­é—´çš„ç½‘ç»œåˆ†åŒºï¼Œå‡ºç°äº†ä¸¤ä¸ª leaderï¼Œè¿™ä¹‹åå¦‚æœç»™ä¸‹é¢çš„ leaderï¼ˆNode Bï¼‰ä¸­å‘é€è¯·æ±‚ï¼Œå› ä¸ºå®ƒå‘ä¸€ä¸ªèŠ‚ç‚¹ä¸­åŒæ­¥æ—¥å¿—ï¼Œæ‰€ä»¥åªèƒ½è·å¾—ä¸¤ä¸ªèŠ‚ç‚¹çš„ç¡®è®¤ï¼Œå› æ­¤æäº¤å¤±è´¥ã€‚è€Œå¦‚æœå‘ä¸Šé¢çš„leader ä¸­å‘é€è¯·æ±‚ï¼Œå¯ä»¥å‘ä¸¤ä¸ªèŠ‚ç‚¹ä¸­åŒæ­¥æ—¥å¿—ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å…±ä¸‰ä¸ªèŠ‚ç‚¹éƒ½æ˜¯åŒæ­¥çš„ï¼Œé‚£ä¹ˆå°±æäº¤æˆåŠŸã€‚ä¸ä¼šå‡ºç°ä¸¤ä¸ª leader åˆ†å‰çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tKfTcly1ftu1lfepqbj30zk0lmmz7.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://thesecretlivesofdata.com/raft/"&gt;Raft åŠ¨ç”»æ¼”ç¤º&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.infoq.com/cn/articles/raft-paper"&gt;Raft è®ºæ–‡&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 31 Jul 2018 18:59:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-31:/posts/ha-shi-yao-shi-raft-xie-yi.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>LSM å’Œ sstable</title><link>/posts/lsm-he-sstable.html</link><description>&lt;h1&gt;æ ¸å¿ƒè¦ç‚¹&lt;/h1&gt;
&lt;p&gt;lsm æ˜¯ bigtableã€leveldbã€rocksdb ç­‰æ•°æ®åº“é‡‡ç”¨çš„ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç¡¬ç›˜ï¼Œå°¤å…¶æ˜¯æœºæ¢°ç¡¬ç›˜ï¼Œé¡ºåºå†™å…¥æ€§èƒ½è¿œå¤§äºéšæœºå†™å…¥æ€§èƒ½ï¼Œæ‰€ä»¥ lsm æŠŠå¤§é‡çš„éšæœºå†™å…¥æŠ“æ¢æˆäº†é¡ºåºå†™å…¥ï¼Œä»è€Œæå¤§åœ°åˆèŠ±äº†å†™å…¥èƒ½åŠ›ã€‚åŒæ—¶æŸ¥æ‰¾æ•ˆç‡æ”¶åˆ°äº†æŸä¼¤ã€‚&lt;/p&gt;
&lt;p&gt;é€‚ç”¨äºé¡ºåºå†™å…¥å¤šï¼Œéšæœºè¯»å–å°‘çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹æ‰€ä»¥è¦ä½¿ç”¨ Immutable Memtableï¼Œå°±æ˜¯ä¸ºäº†é¿å…å°† MemTable ä¸­çš„å†…å®¹åºåˆ—åŒ–åˆ°ç£ç›˜ä¸­æ—¶ä¼šé˜»å¡å†™æ“ä½œã€‚&lt;/p&gt;
&lt;h2&gt;æ“ä½œ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ’å…¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å†™å…¥ WALï¼Œç„¶åæ“ä½œ memtableã€‚WAL æ˜¯é¡ºåºè¯»å†™ï¼Œè€Œmemtable æ˜¯è·³è¡¨ï¼Œæ“ä½œéƒ½å¾ˆè¿…é€Ÿ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ›´æ–°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å’Œæ’å…¥å…¶å®æ˜¯ä¸€æ ·çš„æ“ä½œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ é™¤&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ’å…¥ä¸€æ¡ç‰¹æ®Šçš„åˆ é™¤æ—¥å¿—ï¼Œåœ¨ memtable ä¸­æ ‡è®°åˆ é™¤&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;compactionï¼ˆå‹ç¼©ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å½“ memtable è¾¾åˆ°è®¾å®šçš„é˜ˆå€¼çš„æ—¶å€™ï¼Œä¼šå†™å…¥åˆ° immutable memtableï¼Œç„¶åå†™å…¥åˆ°ç¡¬ç›˜ä¸Šçš„ sstableã€‚å½“ sstable çš„æ•°é‡è¾¾åˆ°æŸä¸ªé˜ˆå€¼çš„æ—¶å€™ï¼Œå°±åˆå¹¶åˆ°ä¸‹ä¸€çº§çš„ memtableã€‚éœ€è¦æ³¨æ„çš„æ˜¯åªæœ‰ç¬¬ä¸€çº§çš„memtableå¯èƒ½æœ‰é‡å¤çš„é”®å€¼ï¼Œå…¶ä»–å±‚éƒ½ä¸ä¼šæœ‰é‡å¤çš„ï¼Œæ‰€ä»¥å¯ä»¥å¤šçº¿ç¨‹ compactã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¯»å–&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ€åŸå§‹çš„ç®—æ³•ï¼šé¦–å…ˆä»memtableè¯»ï¼Œç„¶åä»sstableä¸­å¾€é«˜å±‚è¯»å–ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥é‡‡å–çš„ä¼˜åŒ–æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŠŠ sstable çš„ä¸€äº›åŸå§‹ä¿¡æ¯æ”¾åˆ° manifest ä¸­ï¼Œæ”¾åœ¨å†…å­˜ä¸­ï¼Œå¿«é€ŸæŸ¥æ‰¾&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ bloom filter å…ˆè¿‡æ»¤ä¸€éï¼Œçœ‹ key æ˜¯å¦åœ¨ LSM ä¸­ï¼Œç„¶åå†æŸ¥æ‰¾ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸€å›¾èƒœåƒè¨€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/801b780aly1ftt76pvzotj21kw13eh8u.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;http://blog.fatedier.com/2016/06/15/learn-lsm-tree/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 31 Jul 2018 10:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-31:/posts/lsm-he-sstable.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>çº¢é»‘æ ‘</title><link>/posts/hong-hei-shu.html</link><description>&lt;p&gt;çº¢é»‘æ ‘çš„è¦æ±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;èŠ‚ç‚¹æ˜¯çº¢è‰²æˆ–é»‘è‰²ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ˜¯é»‘è‰²ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰å¶å­éƒ½æ˜¯é»‘è‰²ï¼ˆå¶å­æ˜¯NILèŠ‚ç‚¹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªçº¢è‰²èŠ‚ç‚¹å¿…é¡»æœ‰ä¸¤ä¸ªé»‘è‰²çš„å­èŠ‚ç‚¹ã€‚ï¼ˆä»æ¯ä¸ªå¶å­åˆ°æ ¹çš„æ‰€æœ‰è·¯å¾„ä¸Šä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²èŠ‚ç‚¹ã€‚ï¼‰&lt;/li&gt;
&lt;li&gt;ä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰ç®€å•è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/Red-black_tree_example.svg/900px-Red-black_tree_example.svg.png"&gt;&lt;/p&gt;
&lt;p&gt;ä¸¤ç¯‡ä¸é”™çš„æ•™ç¨‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://juejin.im/post/5a27c6946fb9a04509096248"&gt;æ¼«ç”»ï¼šä»€ä¹ˆæ˜¯çº¢é»‘æ ‘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://zh.wikipedia.org/wiki/%E7%BA%A2%E9%BB%91%E6%A0%91"&gt;ç»´åŸºä¸Šçš„çº¢é»‘æ ‘&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 26 Jul 2018 18:37:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-26:/posts/hong-hei-shu.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>MySQL æ€§èƒ½å°æŠ€å·§å’Œåœ¨ Django ä¸­çš„åº”ç”¨</title><link>/posts/mysql-xing-neng-xiao-ji-qiao-he-zai-django-zhong-de-ying-yong.html</link><description>&lt;h1&gt;1. æ‹†åˆ†å½±å“å¾ˆå¤šè¡Œçš„è¯­å¥&lt;/h1&gt;
&lt;p&gt;å¯¹äº delete update insert ç­‰è¯­å¥ä¸€å®šè¦ä½¿ç”¨ limit å­å¥é™åˆ¶å½±å“çš„è¡Œæ•°ï¼Œé¿å…ä¸€æ¬¡æ›´æ”¹ç‰¹åˆ«å¤šçš„è¡Œï¼Œé€ æˆæ•°æ®åº“å‡æ­»&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;while (1) {
    //æ¯æ¬¡åªåš1000æ¡
    mysql_query(&amp;quot;DELETE FROM logs WHERE log_date &amp;lt;= &amp;#39;2009-11-01&amp;#39; LIMIT 1000&amp;quot;);
    if (mysql_affected_rows() == 0) {
        // æ²¡å¾—å¯åˆ äº†ï¼Œé€€å‡ºï¼
        break;
    }
    // æ¯æ¬¡éƒ½è¦ä¼‘æ¯ä¸€ä¼šå„¿
    usleep(50000);
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;2. å‚ç›´åˆ†å‰²&lt;/h1&gt;
&lt;p&gt;æŠŠä¸ä¼šç”¨ä½œç´¢å¼•çš„ï¼Œæˆ–è€…æ˜¯è¿‡é•¿çš„å­—æ®µå¯ä»¥è€ƒè™‘ä½¿ç”¨å…¶ä»–å­˜å‚¨å¼•æ“ï¼Œæ¯”å¦‚ rocksdb ç­‰ã€‚&lt;/p&gt;
&lt;h1&gt;3. IPv4 åœ°å€å¯ä»¥å­˜ä¸º uint32&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ uint32 å­˜å‚¨ IP åœ°å€ä¸å…‰å¯ä»¥èŠ‚çœç©ºé—´ï¼Œè€Œä¸”å¯ä»¥æŒ‰åŒºé—´æŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;h1&gt;4. é¿å… select *&lt;/h1&gt;
&lt;p&gt;ä»æ•°æ®åº“é‡Œè¯»å‡ºè¶Šå¤šçš„æ•°æ®ï¼Œé‚£ä¹ˆæŸ¥è¯¢å°±ä¼šå˜å¾—è¶Šæ…¢ã€‚å¹¶ä¸”ï¼Œå¦‚æœä½ çš„æ•°æ®åº“æœåŠ¡å™¨å’Œåº”ç”¨æœåŠ¡å™¨æ˜¯ä¸¤å°ç‹¬ç«‹çš„æœåŠ¡å™¨çš„è¯ï¼Œè¿™è¿˜ä¼šå¢åŠ ç½‘ç»œä¼ è¾“çš„è´Ÿè½½ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œä½ åº”è¯¥å…»æˆä¸€ä¸ªéœ€è¦ä»€ä¹ˆå°±å–ä»€ä¹ˆçš„å¥½çš„ä¹ æƒ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¦ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SELECT * FROM user WHERE user_id = 1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SELECT username FROM user WHERE user_id = 1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ django ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;only&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;books = Book.objects.filter(author=&amp;quot;Jim&amp;quot;).only(&amp;#39;book_name&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;5. å½“åªè¦ä¸€è¡Œæ•°æ®æ—¶ä½¿ç”¨ LIMIT 1&lt;/h1&gt;
&lt;p&gt;å½“ä½ æŸ¥è¯¢è¡¨çš„æœ‰äº›æ—¶å€™ï¼Œä½ å·²ç»çŸ¥é“ç»“æœåªä¼šæœ‰ä¸€æ¡ç»“æœï¼Œä½†å› ä¸ºä½ å¯èƒ½éœ€è¦å»fetchæ¸¸æ ‡ï¼Œæˆ–æ˜¯ä½ ä¹Ÿè®¸ä¼šå»æ£€æŸ¥è¿”å›çš„è®°å½•æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŠ ä¸Š LIMIT 1 å¯ä»¥å¢åŠ æ€§èƒ½ã€‚è¿™æ ·ä¸€æ ·ï¼ŒMySQLæ•°æ®åº“å¼•æ“ä¼šåœ¨æ‰¾åˆ°ä¸€æ¡æ•°æ®ååœæ­¢æœç´¢ï¼Œè€Œä¸æ˜¯ç»§ç»­å¾€åæŸ¥å°‘ä¸‹ä¸€æ¡ç¬¦åˆè®°å½•çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ç¤ºä¾‹ï¼Œåªæ˜¯ä¸ºäº†æ‰¾ä¸€ä¸‹æ˜¯å¦æœ‰â€œä¸­å›½â€çš„ç”¨æˆ·ï¼Œå¾ˆæ˜æ˜¾ï¼Œåé¢çš„ä¼šæ¯”å‰é¢çš„æ›´æœ‰æ•ˆç‡ã€‚ï¼ˆè¯·æ³¨æ„ï¼Œç¬¬ä¸€æ¡ä¸­æ˜¯Select *ï¼Œç¬¬äºŒæ¡æ˜¯Select 1ï¼‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SELECT * FROM user WHERE country = &amp;#39;China&amp;#39;
SELECT 1 FROM user WHERE country = &amp;#39;China&amp;#39; LIMIT 1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ Django ä¸­å¯ä»¥ä½¿ç”¨ &lt;code&gt;[:1]&lt;/code&gt; æ¥æ·»åŠ  limit 1&lt;/p&gt;
&lt;h1&gt;6. EXPLAIN ä½ çš„ SELECT æŸ¥è¯¢&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ EXPLAIN å…³é”®å­—å¯ä»¥è®©ä½ çŸ¥é“MySQLæ˜¯å¦‚ä½•å¤„ç†ä½ çš„SQLè¯­å¥çš„ã€‚è¿™å¯ä»¥å¸®ä½ åˆ†æä½ çš„æŸ¥è¯¢è¯­å¥æˆ–æ˜¯è¡¨ç»“æ„çš„æ€§èƒ½ç“¶é¢ˆã€‚&lt;/p&gt;
&lt;h1&gt;7. å°½é‡è®©æŸ¥è¯¢èƒ½ fit è¿›å†…å­˜ä¸­&lt;/h1&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://coolshell.cn/articles/1846.html&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 24 Jul 2018 08:11:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-24:/posts/mysql-xing-neng-xiao-ji-qiao-he-zai-django-zhong-de-ying-yong.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥çŸ¥é“çš„å»¶è¿Ÿæ•°å­—</title><link>/posts/mei-ge-cheng-xu-yuan-du-ying-gai-zhi-dao-de-yan-chi-shu-zi.html</link><description>&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åŠ¨ä½œ&lt;/th&gt;
&lt;th&gt;æ—¶é—´&lt;/th&gt;
&lt;th&gt;æ¢ç®—&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;L1 ç¼“å­˜è®¿é—®&lt;/td&gt;
&lt;td&gt;0.5 ns&lt;/td&gt;
&lt;td&gt;0.5ns&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åˆ†æ”¯é¢„æµ‹é”™è¯¯&lt;/td&gt;
&lt;td&gt;5 ns&lt;/td&gt;
&lt;td&gt;5ns&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;L2 ç¼“å­˜è®¿é—®&lt;/td&gt;
&lt;td&gt;7 ns&lt;/td&gt;
&lt;td&gt;7ns&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;äº’æ–¥é”/è§£é”&lt;/td&gt;
&lt;td&gt;25 ns&lt;/td&gt;
&lt;td&gt;25ns&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†…å­˜è®¿é—®&lt;/td&gt;
&lt;td&gt;100 ns&lt;/td&gt;
&lt;td&gt;100ns&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä½¿ç”¨ Zippyå‹ç¼© 1KiB&lt;/td&gt;
&lt;td&gt;3,000 ns&lt;/td&gt;
&lt;td&gt;3 Âµs&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é€šè¿‡ 1 Gbps ç½‘ç»œå‘é€ 2KiB&lt;/td&gt;
&lt;td&gt;20,000 ns&lt;/td&gt;
&lt;td&gt;20 Âµs&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SSD éšæœºè¯»å–&lt;/td&gt;
&lt;td&gt;150,000 ns&lt;/td&gt;
&lt;td&gt;150 Âµs&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†…å­˜ä¸­è¿ç»­è¯»å– 1 MB&lt;/td&gt;
&lt;td&gt;250,000 ns&lt;/td&gt;
&lt;td&gt;250 Âµs&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŒä¸€ä¸ªæ•°æ®ä¸­å¿ƒçš„æ¥å›&lt;/td&gt;
&lt;td&gt;500,000 ns&lt;/td&gt;
&lt;td&gt;0.5 ms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä» SSD ä¸Šè¿ç»­è¯»å– 1 MB*&lt;/td&gt;
&lt;td&gt;1,000,000 ns&lt;/td&gt;
&lt;td&gt;1 ms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœºæ¢°ç£ç›˜å¯»é“&lt;/td&gt;
&lt;td&gt;10,000,000 ns&lt;/td&gt;
&lt;td&gt;10 ms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœºæ¢°ç£ç›˜è¿ç»­è¯»å– 1 MB&lt;/td&gt;
&lt;td&gt;20,000,000 ns&lt;/td&gt;
&lt;td&gt;20 ms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‘é€æ•°æ®åŒ… åŠ å·-&amp;gt;è·å…°-&amp;gt;åŠ å·&lt;/td&gt;
&lt;td&gt;150,000,000 ns&lt;/td&gt;
&lt;td&gt;150 ms&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;å‡è®¾ ~1GB/sec SSD&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæŠŠè¿™äº›æ—¶é•¿éƒ½ä¹˜ä»¥ 10 äº¿çš„è¯:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åŠ¨ä½œ&lt;/th&gt;
&lt;th&gt;æ—¶é•¿&lt;/th&gt;
&lt;th&gt;ç›¸å½“äº&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;L1 ç¼“å­˜è®¿é—®&lt;/td&gt;
&lt;td&gt;0.5 s&lt;/td&gt;
&lt;td&gt;ä¸€æ¬¡å¿ƒè·³ (0.5 s)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åˆ†æ”¯é¢„æµ‹é”™è¯¯&lt;/td&gt;
&lt;td&gt;5 s&lt;/td&gt;
&lt;td&gt;æ‰“ä¸ªå“ˆæ¬ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;L2 ç¼“å­˜è®¿é—®&lt;/td&gt;
&lt;td&gt;7 s&lt;/td&gt;
&lt;td&gt;æ‰“ä¸ªé•¿å“ˆæ¬ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;äº’æ–¥é”/è§£é”&lt;/td&gt;
&lt;td&gt;25 s&lt;/td&gt;
&lt;td&gt;å†²ä¸€æ¯å’–å•¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†…å­˜è®¿é—®&lt;/td&gt;
&lt;td&gt;100 s&lt;/td&gt;
&lt;td&gt;åˆ·ç‰™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä½¿ç”¨ Zippyå‹ç¼© 1KiB&lt;/td&gt;
&lt;td&gt;50 min&lt;/td&gt;
&lt;td&gt;ä¸€é›†ç”µè§†å‰§(åŒ…æ‹¬å¹¿å‘Š)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é€šè¿‡ 1 Gbps ç½‘ç»œå‘é€ 2KiB&lt;/td&gt;
&lt;td&gt;5.5 hr&lt;/td&gt;
&lt;td&gt;ä»åˆé¤åˆ°ä¸‹åˆå·¥ä½œç»“æŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SSD éšæœºè¯»å–&lt;/td&gt;
&lt;td&gt;1.7 days&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªæ™®é€šçš„å‘¨æœ«&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†…å­˜ä¸­è¿ç»­è¯»å– 1 MB&lt;/td&gt;
&lt;td&gt;2.9 days&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªé•¿å‘¨æœ«&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŒä¸€ä¸ªæ•°æ®ä¸­å¿ƒçš„æ¥å›&lt;/td&gt;
&lt;td&gt;5.8 days&lt;/td&gt;
&lt;td&gt;ä¸€ä¸ªæ™®é€šå‡æœŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä» SSD ä¸Šè¿ç»­è¯»å– 1 MB*&lt;/td&gt;
&lt;td&gt;11.6 days&lt;/td&gt;
&lt;td&gt;ç­‰å¿«é€’ç­‰äº†ä¸¤å‘¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœºæ¢°ç£ç›˜å¯»é“&lt;/td&gt;
&lt;td&gt;16.5 weeks&lt;/td&gt;
&lt;td&gt;å¤§å­¦é‡Œçš„ä¸€ä¸ªå­¦æœŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœºæ¢°ç£ç›˜è¿ç»­è¯»å– 1 MB&lt;/td&gt;
&lt;td&gt;7.8 months&lt;/td&gt;
&lt;td&gt;å‡ ä¹èƒ½é€ ä¸ªäººäº†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸Šé¢ä¸¤ä¸ªåŠ èµ·æ¥&lt;/td&gt;
&lt;td&gt;1 year&lt;/td&gt;
&lt;td&gt;æ•´æ•´ä¸€å¹´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‘é€æ•°æ®åŒ… åŠ å·-&amp;gt;è·å…°-&amp;gt;åŠ å·&lt;/td&gt;
&lt;td&gt;4.8 years&lt;/td&gt;
&lt;td&gt;å¿«èƒ½è¯»ä¸ªåšå£«äº†&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¯è§†åŒ–ç½‘é¡µï¼š
https://people.eecs.berkeley.edu/~rcs/research/interactive_latency.html&lt;/p&gt;
&lt;h1&gt;è¿™äº›æ•°å­—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h1&gt;
&lt;p&gt;äº†è§£è¿™äº›æ—¶é—´çš„é‡çº§æœ‰åŠ©äºæ¯”è¾ƒä¸åŒçš„è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡è¿™äº›æ•°å­—ï¼Œä½ å¯ä»¥çœ‹å‡ºæ¥ä»è¿œç¨‹æœåŠ¡å™¨çš„å†…å­˜ä¸­è¯»ä¸€äº›æ•°æ®æ—¶æ¯”ç›´æ¥ä»ç¡¬ç›˜ä¸Šè¯»å–å¿«çš„ã€‚åœ¨ä¸€èˆ¬çš„ç¨‹åºä¸­ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ä½¿ç”¨ç£ç›˜å­˜å‚¨æ¯”ä½¿ç”¨æ•°æ®åº“æœåŠ¡å™¨è¦æ…¢ï¼Œå› ä¸ºæ•°æ®åº“é€šå¸¸æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½æ”¾åœ¨å†…å­˜é‡Œäº†ã€‚è€Œä¸”è¿™ä¹Ÿè¯´æ˜äº†ä¸ºä»€ä¹ˆåœ¨æœåŠ¡å…¨çƒå®¢æˆ·çš„æ—¶å€™ CDN è‡³å…³é‡è¦ã€‚ä»åŒ—ç¾åˆ°æ¬§æ´²çš„ä¸€ä¸ª ping å°±è¦èŠ±ä¸Š 100+ msï¼Œæ‰€ä»¥ä»åœ°ç†ä¸Šæ¥è¯´ï¼Œå†…å®¹åº”è¯¥æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²çš„ã€‚&lt;/p&gt;
&lt;p&gt;The idea is more about knowing the scale of time it takes to help compare different solution. With those number you can see that it's faster to get data in memory from a distant server than to read the same data from disk. In common application that means using disk storage is less efficient that storing it in a database on an other server, since it usually keeps almost everything in memory. It also tells a lot about why CDN are needed if you are serving client worldwide. A ping from North America to Europe will always takes 100+ ms, so having geographically distributed content is a good idea.&lt;/p&gt;
&lt;p&gt;å¯¹äºäº’æ–¥é”çš„å¼€å¯é”å®šæ—¶é—´
mutex lock/unlock time is important for anyone writing code that depends on code that is accessing the same data structures at the same time. If you don't know that there is a considerable cost to writing such code, now you do; and this number can quantify it.&lt;/p&gt;
&lt;p&gt;è¿˜éœ€è¦æ³¨æ„é¡ºåºè¯»å†™å’Œæ‰¹é‡è¯»å†™å¸¦æ¥çš„æé€Ÿ&lt;/p&gt;
&lt;h1&gt;å¸¸è§é—®é¢˜&lt;/h1&gt;
&lt;h2&gt;éšç€æ‘©å°”å®šå¾‹çš„å‘å±•ï¼Œè¿™äº›æ•°å­—ä¼šä¸ä¼šä¸å¤ªå‡†ç¡®äº†ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæ‘©å°”å®šå¾‹åŸºæœ¬ä¸Šç»å¤±æ•ˆäº†ã€‚å…¶æ¬¡ï¼Œè¿™äº›æ•°å­—çš„é‡ç‚¹æ˜¯ä»–ä»¬ä¹‹é—´çš„æ¯”ä¾‹ï¼Œè€Œä¸æ˜¯å…·ä½“æ•°å­—ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://gist.github.com/hellerbarde/2843375 &lt;/li&gt;
&lt;li&gt;https://softwareengineering.stackexchange.com/questions/312485/how-can-jeff-deans-latency-numbers-every-programmer-should-know-be-accurate-i&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 23 Jul 2018 02:32:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-23:/posts/mei-ge-cheng-xu-yuan-du-ying-gai-zhi-dao-de-yan-chi-shu-zi.html</guid><category>è®¡ç®—æœº</category></item><item><title>Mysql çš„ wait_timeout é—®é¢˜</title><link>/posts/mysql-de-wait_timeout-wen-ti.html</link><description>&lt;p&gt;Mysql ä¸­é»˜è®¤çš„ wait_timeout å’Œ interactive_timeout çš„å€¼æ˜¯å…«å°æ—¶ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè¿æ¥ï¼ˆäº¤äº’å¼å’Œéäº¤äº’å¼çš„ï¼‰åªæœ‰åœ¨ 8 å°æ—¶æ²¡æœ‰æ´»åŠ¨ä¹‹åæ‰ä¼šè¢«å…³é—­æ‰ã€‚å¯¹äºäº’è”ç½‘å…¬å¸æ¥è¯´ï¼Œè¿™ä¸ªå€¼å®åœ¨å¤ªå¤§äº†ï¼Œä¸€ä¸ªåº“å¯èƒ½è¢«å¾ˆå¤šè„šæœ¬å’ŒæœåŠ¡è®¿é—®ï¼Œå¯èƒ½åªæ˜¯ä¸€ä¸ªç®€çŸ­çš„æŸ¥è¯¢å°±ä¸éœ€è¦æ•°æ®åº“äº†ï¼Œå¦‚æœæ¯ä¸ªæŸ¥è¯¢éƒ½å æ®äº†8å°æ—¶çš„æ—¶é—´ï¼Œé‚£ä¹ˆ mysql å¾ˆå¿«è¿æ¥æ•°å°±ä¼šæ»¡äº†ï¼ŒæŠ¥å‡º too many connections é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;mysql é»˜è®¤çš„è¿æ¥æ•°å¯ä»¥ä¿®æ”¹ max_connections å‚æ•°ï¼Œä½†æ˜¯ä¸€ä¸ªæœåŠ¡å™¨èƒ½æ”¯æ’‘çš„è¿æ¥æ•°æ˜¾ç„¶æ˜¯ç”±ç¡¬ä»¶å†³å®šçš„ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ç½® wait_timeout è¿‡çŸ­å¯èƒ½ä¼šé€ æˆä¸€äº›é—®é¢˜ï¼Œå¦‚æœåœ¨ django ä¸­ä¸¤æ¬¡æŸ¥è¯¢çš„ä¹‹é—´æ—¶é—´å¤§äº wait_timeoutï¼Œå°±ä¼šæŠ¥ (2006, 'MySQL server has gone away')ã€‚django å®˜æ–¹ç»™çš„å»ºè®®æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å½“ä½ çš„è„šæœ¬ä¸éœ€è¦ä½¿ç”¨æ•°æ®åº“çš„æ—¶å€™ï¼Œä¸»åŠ¨å…³é—­è¿æ¥ &lt;code&gt;from django.db import connection; connection.close()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¢å¤§ wait_timeout çš„å€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸è¿‡djangoé»˜è®¤ CONN_MAX_AGE æ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯åœ¨æŸ¥è¯¢æ•°æ®åº“ä¹‹åä¼šç«‹å³å…³é—­é“¾æ¥ï¼Œç†è®ºä¸Šåº”è¯¥ä¸ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ã€‚ä½†æ˜¯è¿™æ ·ä¸èƒ½å¤ç”¨é“¾æ¥ï¼Œä¼šé€ æˆå¯¹æ•°æ®å‹åŠ›å¾ˆå¤§ã€‚&lt;/p&gt;
&lt;p&gt;CONN_MAX_AGEåº”è¯¥å°äºæ•°æ®åº“æœ¬èº«çš„æœ€å¤§è¿æ¥æ—¶é—´wait_timeoutï¼Œå¦åˆ™åº”ç”¨ç¨‹åºå¯èƒ½ä¼šè·å–åˆ°è¿æ¥è¶…æ—¶çš„æ•°æ®åº“è¿æ¥ï¼Œè¿™æ—¶ä¼šå‡ºç°MySQL server has gone awayçš„æŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥åœ¨ settings.py ä¸­åŠ¨æ€åœ°è·å–å¹¶å¡«å……è¿™ä¸ªå€¼ï¼Œç„¶åå†™åˆ° CONN_MAX_AGE ä¸­&lt;/p&gt;
&lt;p&gt;ç†è®ºä¸Šè¿™æ ·å°±ä¸ä¼šå†æŠ¥é”™äº†ï¼Œä½†æ˜¯éš¾å…æ•°æ®åº“é‡å¯æˆ–è€…ä»€ä¹ˆæ—¶å€™ä¼šæŠ¥é”™ï¼Œæ€»æ˜¯ä½¿ç”¨ close_old_connections è¿˜æ˜¯å¾ˆçƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ç§æ€è·¯æ˜¯åœ¨æ£€æµ‹åˆ°å’Œæ•°æ®åº“é“¾æ¥æ–­å¼€çš„æ—¶å€™ï¼Œè‡ªåŠ¨é‡è¿ï¼Œä½†æ˜¯è¿™æ ·ä¼šç ´å django.db.atomicï¼Œä½†æ˜¯å¯ä»¥å®ç°ä¸€ç§ä¸åŒçš„backendã€‚å¯ä»¥å‚è€ƒè¿™ä¸¤ä¸ªï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;https://github.com/django/django/pull/2740/commits/38f58aa4d751ad83f1dc76d5b945a1036239584f&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;https://github.com/django/django/pull/2454/commits/36b8bf870cab183b7ad63c0d8e7e8c02e314a053#diff-f8a587a973ef4c3a94d7550a5b85342c&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ç§è§£å†³æ€è·¯æ˜¯ä½¿ç”¨ connection poolingï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ sqlalchemy çš„ è¿æ¥æ± ä½œä¸ºdjangoè¿æ¥æ•°æ®åº“çš„å·¥å…·ã€‚å‚è€ƒè¿™é‡Œï¼šhttp://menendez.com/blog/mysql-connection-pooling-django-and-sqlalchemy/, ä¸è¿‡è¿™ç§æ–¹æ³•æ¯”è¾ƒ hackã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://code.djangoproject.com/ticket/21597#no2&lt;/li&gt;
&lt;li&gt;https://github.com/django/django/commit/2ee21d9f0d9eaed0494f3b9cd4b5bc9beffffae5&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/1125504/django-persistent-database-connection&lt;/li&gt;
&lt;li&gt;django ä¼˜åŒ–https://blog.csdn.net/u011546806/article/details/45576669&lt;/li&gt;
&lt;li&gt;https://docs.djangoproject.com/en/2.1/ref/databases/#persistent-connections&lt;/li&gt;
&lt;li&gt;å¦‚ä½•è®¾ç½® max_age https://stackoverflow.com/questions/19937257/what-is-a-good-value-for-conn-max-age-in-django&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 23 Jul 2018 02:28:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-23:/posts/mysql-de-wait_timeout-wen-ti.html</guid><category>æ•°æ®åº“</category><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>åŠ¨æ€è§„åˆ’ï¼ˆLeetCode 413. Arithmetic Slicesï¼‰</title><link>/posts/dong-tai-gui-hua-leetcode-413-arithmetic-slices.html</link><description>&lt;h1&gt;LeetCode 413. Arithmetic Slice&lt;/h1&gt;
&lt;p&gt;æ˜¯ä¸€é“å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’è§£çš„é—®é¢˜&lt;/p&gt;
&lt;h2&gt;é¢˜ç›®&lt;/h2&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ‰¾å‡ºå…¶ä¸­ç­‰å·®æ•°åˆ—çš„ä¸ªæ•°ã€‚ç­‰å·®æ•°åˆ—çš„å®šä¹‰ï¼š3å„å…ƒç´ ä»¥ä¸Šï¼Œæ¯ä¸ªå…ƒç´ ä¹‹é—´å·®ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;1, 3, 5, 7, 9
7, 7, 7, 7
3, -1, -5, -9
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸‹é¢çš„å°±ä¸æ˜¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;1, 1, 2, 5, 7
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;A = [1, 2, 3, 4]

return: 3, for 3 arithmetic slices in A: [1, 2, 3], [2, 3, 4] and [1, 2, 3, 4] itself.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è§£æ³•&lt;/h2&gt;
&lt;p&gt;è§‚å¯Ÿå‘ç°ï¼Œå½“æˆ‘ä»¬éå†æ•°ç»„çš„æ—¶å€™ï¼Œå¦‚æœèƒ½å’Œå‰ä¸€ä¸ªå…ƒç´ æ„æˆç­‰å·®æ•°åˆ—ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªä½ç½®å¯ä»¥æ„æˆçš„ç­‰å·®æ•°åˆ—çš„ä¸ªæ•°å°±æ˜¯ä¸Šä¸€ä¸ªä½ç½®åŠ ä¸€ï¼Œæ‰€ä»¥çš„åˆ°é€’æ¨å…¬å¼ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dp[i] = dp[i-1] + 1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å€Ÿç”¨å®˜æ–¹ç­”æ¡ˆé‡Œçš„å›¾ç‰‡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tNc79ly1ftjiweuvyaj317m0homzj.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å°±å¾—åˆ°äº†ç­”æ¡ˆï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;Solution&lt;/span&gt;:
    &lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;numberOfArithmeticSlices&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;        :type A: List[int]&lt;/span&gt;
&lt;span class="s2"&gt;        :rtype: int&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="nx"&gt;dp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nx"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nx"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nx"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
                &lt;span class="nx"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 23 Jul 2018 01:12:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-23:/posts/dong-tai-gui-hua-leetcode-413-arithmetic-slices.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>è‰¾å®¾æµ©æ–¯è®°å¿†æ›²çº¿</title><link>/posts/ai-bin-hao-si-ji-yi-qu-xian.html</link><description>&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tNc79ly1ftigyvr6ioj30a506974c.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å¾·å›½è‘—åçš„å¿ƒç†å­¦å®¶è‰¾å®¾æµ©æ–¯å‘Šè¯‰æˆ‘ä»¬äººçš„è®°å¿†å’Œé—å¿˜æ˜¯æœ‰è§„å¾‹çš„ï¼Œè®°å¿†çš„ä¿æŒåœ¨æ—¶é—´ä¸Šæ˜¯ä¸åŒçš„ï¼Œæœ‰çŸ­æ—¶çš„è®°å¿†å’Œé•¿æ—¶çš„è®°å¿†ä¸¤ç§ï¼Œäººä»¬æ¥è§¦åˆ°çš„ä¿¡æ¯åœ¨ç»è¿‡äººçš„å­¦ä¹ åï¼Œä¾¿æˆä¸ºäº†äººçš„çŸ­æ—¶çš„è®°å¿†ï¼Œä½†æ˜¯å¦‚æœä¸ç»è¿‡åŠæ—¶çš„å¤ä¹ ï¼Œè¿™äº›è®°ä½è¿‡çš„ä¸œè¥¿å°±ä¼šé—å¿˜ã€‚å¹¶æ ¹æ®å®éªŒå¾—å‡ºäº†è‘—åçš„è‰¾å®¾æµ©æ–¯è®°å¿†æ›²çº¿ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;è¿™æ¡æ›²çº¿å‘Šè¯‰æˆ‘ä»¬åœ¨è®°å¿†çš„æœ€åˆé˜¶æ®µé—å¿˜çš„é€Ÿåº¦å¾ˆå¿«ï¼Œåæ¥å°±é€æ¸å‡æ…¢äº†ï¼Œåˆ°äº†ç›¸å½“é•¿çš„æ—¶å€™åï¼Œå‡ ä¹å°±ä¸å†é—å¿˜äº†ï¼Œè¿™å°±æ˜¯é—å¿˜çš„å‘å±•è§„å¾‹ï¼Œå³"å…ˆå¿«åæ…¢"çš„åŸåˆ™ã€‚è§‚å¯Ÿè¿™æ¡é—å¿˜æ›²çº¿ï¼Œä½ ä¼šå‘ç°ï¼Œå­¦å¾—çš„çŸ¥è¯†åœ¨ä¸€å¤©åï¼Œå¦‚ä¸æŠ“ç´§å¤ä¹ ï¼Œå°±åªå‰©ä¸‹åŸæ¥çš„25%ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œé—å¿˜çš„é€Ÿåº¦å‡æ…¢ï¼Œé—å¿˜çš„æ•°é‡ä¹Ÿå°±å‡å°‘ã€‚&lt;/p&gt;
&lt;p&gt;è‰¾å®¾æµ©æ–¯åœ¨å…³äºè®°å¿†çš„å®éªŒä¸­å‘ç°ï¼Œè®°ä½12ä¸ªæ— æ„ä¹‰éŸ³èŠ‚ï¼Œå¹³å‡éœ€è¦é‡å¤16.5æ¬¡ï¼›ä¸ºäº†è®°ä½36ä¸ªæ— æ„ä¹‰ç« èŠ‚ï¼Œéœ€é‡å¤54æ¬¡ï¼›è€Œè®°å¿†å…­é¦–è¯—ä¸­çš„480ä¸ªéŸ³èŠ‚ï¼Œå¹³å‡åªéœ€è¦é‡å¤8æ¬¡ï¼è¿™ä¸ªå®éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œå‡¡æ˜¯ç†è§£äº†çš„çŸ¥è¯†ï¼Œå°±èƒ½è®°å¾—è¿…é€Ÿã€å…¨é¢è€Œç‰¢å›ºã€‚ä¸ç„¶ï¼Œæ„£æ˜¯æ­»è®°ç¡¬èƒŒï¼Œé‚£ä¹Ÿæ˜¯è´¹åŠ›ä¸è®¨å¥½çš„ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†æ•£å­¦ä¹ æ¯”é›†ä¸­å­¦ä¹ ä¼˜è¶Šã€‚å¦‚å¯¹ä¸€ä¸ª12ä¸ªéŸ³èŠ‚çš„éŸ³èŠ‚ç»„é›†ä¸­å­¦ä¹ éœ€è¦è‚²è¯»68æ¬¡æ‰èƒ½è¾¾åˆ°æ­£ç¡®èƒŒè¯µï¼Œè€Œåˆ†æ•£å­¦ä¹ åªè¦35æ¬¡å°±å¤Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼šhttp://wiki.mbalib.com/wiki/%E8%89%BE%E5%AE%BE%E6%B5%A9%E6%96%AF%E8%AE%B0%E5%BF%86%E9%81%97%E5%BF%98%E6%9B%B2%E7%BA%BF&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 22 Jul 2018 03:16:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-22:/posts/ai-bin-hao-si-ji-yi-qu-xian.html</guid><category>åæ€ä¸æ€»ç»“</category></item><item><title>å½­åšåˆ°åº•æ˜¯åšä»€ä¹ˆç”Ÿæ„çš„ï¼Ÿ</title><link>/posts/peng-bo-dao-di-shi-zuo-shi-yao-sheng-yi-de.html</link><description>&lt;p&gt;ä¸€å¥è¯ï¼šå–å½­åšç»ˆç«¯æœº&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆå¤§å®¶è¦ä¹°å½­åšç»ˆç«¯æœºå‘¢ï¼Ÿç•Œé¢é‚£ä¹ˆè€åœŸ&lt;/p&gt;
&lt;p&gt;I think most of your questions can be answered by realizing that Bloomberg was founded in 1981, and they basically got a monopoly in financial data provision becauseÂ there were no other options in 1981. That is why they have a custom monitor &amp;amp; keyboard: in the days before the IBM PC,Â everyoneÂ had a custom monitor &amp;amp; keyboard, because these things were not standardized. Bloomberg was a technologist &amp;amp; businessman before he was a politician; his business success gave him the money to run for office, his office doesn't force people to pay for Bloomberg.&lt;/p&gt;
&lt;p&gt;The reason they'reÂ stillÂ a monopoly is because knowing how to navigate a Bloomberg is a critical skill for most finance professionals, and now that they have that skillset, they can be very productive moving around in it. A different (better?) UI would require they re-learn everything, which is not going to happen. And when financial professionals are making half a million a year, paying $24k/year for a terminal so that they can be productive isn't a bad investment.
(Source: have a couple friends at Bloomberg. One is in their UI department, and keeps having his proposals for better UIs shot down for business reasons. Also married a financial professional who had to use a Bloomberg in her days as a bond trader.)&lt;/p&gt;
&lt;p&gt;The best way to think about the Bloomberg terminal is a web browser that connects you to a private network. (Bloomberg actually is the largest known private network.) Once connected, you have access to thousands of "web apps" - which Bloomberg users call "functions". Instead of a URL, you use a short 2 to 5 letter mnemonic code for each function, such as "MSG" for email, or "TOP" for top news. These different functions provide all sorts of various functionality - most of them are of course related to financial information. Functions like "CDSW" are for analyzing credit default swaps, "SDLC" gives you supply chain data for different companies, other functions analyze or curate Twitter, others correlate news events with historical stock data, etc. There are also many non-financial functions as well that reflect the "social network" aspect of the Bloomberg terminal, such as "POSH" which is basically a high-end Craigs list, or "DINE" which is a high-end Yelp.
All-in-all, the Bloomberg Terminal is like a private Internet for financial professionals.&lt;/p&gt;
&lt;p&gt;æ ¸å¿ƒçš„ä¾èµ–å¯èƒ½æ˜¯ bloomberg chatï¼Œç›¸å½“äºé‡‘èåœˆçš„ç¤¾äº¤ç½‘ç»œã€‚&lt;/p&gt;
&lt;p&gt;â€œI think Facebook is the best comparison,â€ Ayzerov says. â€œIf Facebook had only one fourth of your friends, you wouldnâ€™t use it. The advantage of Bloomberg is that every financial person has it.â€"&lt;/p&gt;
&lt;p&gt;Wow, great comments about Bloomberg. It makes me wonder, is there similar system for Cryptocoins traders?&lt;/p&gt;
&lt;p&gt;Bloomberg would be very hard to dethrone. It's key selling point is all of the data they have access to, which takes forever to setup integration with all of those providers. They continually expand data sources as well so it's not like they are asleep at the wheel.
Finally, Bloomberg chat has strong network effects so even if you had all of the same data, many traders still wouldn't switch to you because they can't communicate with others still on Bloomberg.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;It is a all-in-one news source. There are a lot of features that allow you to monitor the news from many different sources in real time.&lt;/li&gt;
&lt;li&gt;It is a social network. The built-in chat and email service is &lt;em&gt;really&lt;/em&gt; basic. But, just about every one working in Finance is on it, with their contact details and resumes. As a trader, you can legally close financial transactions on the Bloomberg chat, as one would over the phone.&lt;/li&gt;
&lt;li&gt;It is a data sharing platform. Banks and other market participants contribute to Bloomberg data by sending information that is normally not visible in the market. For instance FX volatilities are quoted by banks on bloomberg in real time. This information is only available in few places.&lt;/li&gt;
&lt;li&gt;It is an API that allows its users to use its data for custom analytics.&lt;/li&gt;
&lt;li&gt;It is an execution platform, where you can book trades, follow their values and risk when the market moves, etc.&lt;/li&gt;
&lt;li&gt;It is open to 3rd parties: some banks and other data vendors have their own pages on bloomberg (which I never had access to).&lt;/li&gt;
&lt;li&gt;It has many many other stuffs. There is a restaurant review system. There is a classified section. There are things to monitor the weather. It has videos, maps, it's just huge.&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 22 Jul 2018 01:13:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-22:/posts/peng-bo-dao-di-shi-zuo-shi-yao-sheng-yi-de.html</guid><category>åˆ›ä¸š</category><category>è¿è¥ä¸äº§å“</category></item><item><title>redis å¸¸è§é—®é¢˜</title><link>/posts/redis-chang-jian-wen-ti.html</link><description>&lt;p&gt;ä¸»è¦å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šhttps://mp.weixin.qq.com/s/vS8IMgBIrfGpZYNUwtXrPQ&lt;/p&gt;
&lt;h1&gt;1. é›†åˆæ“ä½œé¿å…èŒƒå›´è¿‡å¤§&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ sortedsetã€setã€listã€hashç­‰é›†åˆç±»çš„O(N)æ“ä½œæ—¶è¦è¯„ä¼°å½“å‰å…ƒç´ ä¸ªæ•°çš„è§„æ¨¡ä»¥åŠå°†æ¥çš„å¢é•¿è§„æ¨¡ï¼Œå¯¹äºçŸ­æœŸå°±å¯èƒ½å˜ä¸ºå¤§é›†åˆçš„keyï¼Œè¦é¢„ä¼°O(N)æ“ä½œçš„å…ƒç´ æ•°é‡ï¼Œé¿å…å…¨é‡æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨HSCANã€SSCANã€ZSCANè¿›è¡Œæ¸è¿›æ“ä½œã€‚é›†åˆå…ƒç´ æ•°é‡è¿‡å¤§åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šå½±å“redisçš„å®é™…æ€§èƒ½ï¼Œå…ƒç´ ä¸ªæ•°å»ºè®®å°½é‡ä¸è¦è¶…è¿‡5000ï¼Œå…ƒç´ æ•°é‡è¿‡å¤§å¯è€ƒè™‘æ‹†åˆ†æˆå¤šä¸ªkeyè¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;h1&gt;2. åˆç†ä½¿ç”¨è¿‡æœŸæ—¶é—´&lt;/h1&gt;
&lt;p&gt;å¦‚æœkeyæ²¡æœ‰è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä¼šå¯¼è‡´ä¸€ç›´å ç”¨å†…å­˜ã€‚å¯¹äºå¯ä»¥é¢„ä¼°ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçš„keyåº”å½“è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´æˆ–åœ¨æœ€åä¸€æ¬¡æ“ä½œæ—¶è¿›è¡Œæ¸…ç†ï¼Œé¿å…åƒåœ¾æ•°æ®æ®‹ç•™redisã€‚redis ä¸æ˜¯åƒåœ¾æ¡¶ã€‚&lt;/p&gt;
&lt;h1&gt;3. åˆ©ç”¨æ‰¹é‡æ“ä½œå‘½ä»¤&lt;/h1&gt;
&lt;p&gt;å‡è®¾è¦ç»™ä¸€ä¸ªé›†åˆå¯¼å…¥ 5000 ä¸ªå…ƒç´ ï¼š&lt;/p&gt;
&lt;p&gt;æ–¹æ¡ˆ1ï¼šç›´æ¥ä½¿ç”¨redisçš„HSETé€ä¸ªè®¾ç½®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;for _ in 0..5000
    HSET hash, kï¼Œv
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç»“æœï¼šå¤±è´¥ã€‚redis opsé£™å‡ï¼ŒåŒæ—¶æ¥å£å“åº”è¶…æ—¶&lt;/p&gt;
&lt;p&gt;æ–¹æ¡ˆ2ï¼šæ”¹ç”¨redisçš„ HMSETä¸€æ¬¡å°†æ‰€æœ‰å…ƒç´ è®¾ç½®åˆ°hashä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;map&amp;lt;k, v&amp;gt; = 50000ä¸ªå…ƒç´ 
HMSET hash map
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç»“æœï¼šå¤±è´¥ã€‚å‡ºç°redisæ…¢æ—¥å¿—&lt;/p&gt;
&lt;p&gt;æ–¹æ¡ˆ3ï¼šä¾ç„¶ä½¿ç”¨ HMSETï¼Œåªæ˜¯æ¯æ¬¡è®¾ç½®500ä¸ªï¼Œå¾ªç¯100æ¬¡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;map_chunk&amp;lt;k, v&amp;gt; = 500ä¸ªå…ƒç´ 
for i in 0..100
    HMSET hash map_chunk[i]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç»“æœï¼šæˆåŠŸ&lt;/p&gt;
&lt;p&gt;MSET/HMSETç­‰éƒ½æ”¯æŒä¸€æ¬¡è¾“å…¥å¤šä¸ªkeyï¼ŒLPUSH/RPUSH/SADDç­‰å‘½ä»¤éƒ½æ”¯æŒä¸€æ¬¡è¾“å…¥å¤šä¸ªvalue,ä¹Ÿè¦æ³¨æ„æ¯æ¬¡æ“ä½œæ•°é‡ä¸è¦è¿‡å¤š,å»ºè®®æ§åˆ¶åœ¨500ä¸ªä»¥å†…&lt;/p&gt;
&lt;h1&gt;4. åˆç†è®¾ç½®å€¼çš„å¤§å°&lt;/h1&gt;
&lt;p&gt;Stringç±»å‹å°½é‡æ§åˆ¶åœ¨10KBä»¥å†…ã€‚è™½ç„¶rediså¯¹å•ä¸ªkeyå¯ä»¥ç¼“å­˜çš„å¯¹è±¡é•¿åº¦èƒ½å¤Ÿæ”¯æŒçš„å¾ˆå¤§ï¼Œä½†æ˜¯å®é™…ä½¿ç”¨åœºåˆä¸€å®šè¦åˆç†æ‹†åˆ†è¿‡å¤§çš„ç¼“å­˜é¡¹ï¼Œ1k åŸºæœ¬æ˜¯redisæ€§èƒ½çš„ä¸€ä¸ªæ‹ç‚¹ã€‚å½“ç¼“å­˜é¡¹è¶…è¿‡10kã€100kã€1mæ€§èƒ½ä¸‹é™ä¼šç‰¹åˆ«æ˜æ˜¾ã€‚å…³äºååé‡ä¸æ•°æ®å¤§å°çš„å…³ç³»å¯è§ä¸‹é¢å®˜æ–¹ç½‘ç«™æä¾›çš„ç¤ºæ„å›¾ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å±€åŸŸç½‘ç¯å¢ƒä¸‹åªè¦ä¼ è¾“çš„åŒ…ä¸è¶…è¿‡ä¸€ä¸ª MTUï¼ˆä»¥å¤ªç½‘ä¸‹å¤§çº¦ 1500 bytesï¼‰ï¼Œé‚£ä¹ˆå¯¹äº 10ã€100ã€1000 bytesä¸åŒåŒ…å¤§å°çš„å¤„ç†ååèƒ½åŠ›å®é™…ç»“æœå·®ä¸å¤šã€‚&lt;/p&gt;
&lt;h1&gt;5. ç¦ç”¨ä¸€äº›å‘½ä»¤&lt;/h1&gt;
&lt;p&gt;keysã€monitorã€flushallã€flushdbåº”å½“é€šè¿‡redisçš„renameæœºåˆ¶ç¦æ‰å‘½ä»¤ï¼Œè‹¥æ²¡æœ‰ç¦ç”¨ï¼Œå¼€å‘äººå‘˜è¦è°¨æ…ä½¿ç”¨ã€‚å…¶ä¸­flushallã€flushdbä¼šæ¸…ç©ºredisæ•°æ®ï¼›keyså‘½ä»¤å¯èƒ½ä¼šå¼•èµ·æ…¢æ—¥å¿—ï¼›monitorå‘½ä»¤åœ¨å¼€å¯çš„æƒ…å†µä¸‹ä¼šé™ä½redisçš„ååé‡ï¼Œæ ¹æ®å‹æµ‹ç»“æœå¤§æ¦‚ä¼šé™ä½redis50%çš„ååé‡ï¼Œè¶Šå¤šå®¢æˆ·ç«¯å¼€å¯è¯¥å‘½ä»¤ï¼Œååé‡ä¸‹é™ä¼šè¶Šå¤šã€‚&lt;/p&gt;
&lt;p&gt;keyså’Œmonitoråœ¨ä¸€äº›å¿…è¦çš„æƒ…å†µä¸‹è¿˜æ˜¯æœ‰åŠ©äºæ’æŸ¥çº¿ä¸Šé—®é¢˜çš„ï¼Œå»ºè®®å¯åœ¨é‡å‘½åååœ¨å¿…è¦æƒ…å†µä¸‹ç”±redisç›¸å…³è´Ÿè´£äººå‘˜åœ¨rediså¤‡æœºä½¿ç”¨ï¼Œmonitorå‘½ä»¤å¯å€ŸåŠ©redis-fainaç­‰è„šæœ¬å·¥å…·è¿›è¡Œè¾…åŠ©åˆ†æï¼Œèƒ½æ›´å¿«æ’æŸ¥çº¿ä¸Šopsé£™å‡ç­‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1&gt;6. é¿å…å¤§é‡ key åŒæ—¶è¿‡æœŸ&lt;/h1&gt;
&lt;p&gt;å¦‚æœå¤§é‡çš„ key è¿‡æœŸæ—¶é—´è®¾ç½®å¾—è¿‡äºé›†ä¸­ï¼Œåˆ°è¿‡æœŸçš„æ—¶é—´ç‚¹ï¼Œredis å¯èƒ½ä¼šå‡ºç°çŸ­æš‚çš„å¡é¡¿ç°è±¡ã€‚ä¸€èˆ¬éœ€è¦åœ¨æ—¶é—´ä¸ŠåŠ ä¸€ä¸ªéšæœºå€¼ï¼Œä½¿å¾—è¿‡æœŸæ—¶é—´åˆ†æ•£ä¸€äº›ã€‚&lt;/p&gt;
&lt;h1&gt;7. Redis å¦‚ä½•åšæŒä¹…åŒ–&lt;/h1&gt;
&lt;p&gt;bgsave åšé•œåƒå…¨é‡æŒä¹…åŒ–ï¼Œaof åšå¢é‡æŒä¹…åŒ–ã€‚å› ä¸º bgsave ä¼šè€—è´¹è¾ƒé•¿æ—¶é—´ï¼Œä¸å¤Ÿå®æ—¶ï¼Œåœ¨åœæœºçš„æ—¶å€™å›å¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ aof æ¥é…åˆä½¿ç”¨ã€‚åœ¨ redis å®ä¾‹é‡å¯æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ aof æ¥å›å¤å†…å­˜çŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰ aof æ—¥å¿—ï¼Œå°±ä¼šä½¿ç”¨ rdb æ¥æ¢å¤ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ aof æ–‡ä»¶è¿‡å¤§ä¼šå¯¼è‡´æ¢å¤æ—¶é—´è¿‡é•¿ï¼Œä¸è¿‡ redis ä¼šå®šæœŸåš aof é‡å†™ï¼Œå‹ç¼© aof æ–‡ä»¶æ—¥å¿—å¤§å°ã€‚åœ¨ redis 4.0 ä¹‹åè¿˜æœ‰äº†æ··åˆæŒä¹…åŒ–çš„åŠŸèƒ½ï¼Œå°† bgsave çš„å…¨é‡å’Œ aof çš„å¢é‡åšäº†èåˆå¤„ç†ï¼Œè¿™æ ·æ—¢ä¿è¯äº†å›å¤çš„æ•ˆç‡æœ‰å…¼å®¹äº†æ•°æ®çš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é¿å…æ–­ç”µæ—¶åä¸¢å¤±æ•°æ®ï¼Œè¿˜å¯ä»¥è®¾ç½® aof æ—¥å¿—çš„ sync å±æ€§ï¼Œæç«¯æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¯æ¬¡å†™å…¥éƒ½æ‰§è¡Œï¼Œä¸è¿‡ä¼šå¯¹æ€§èƒ½æœ‰å½±å“ï¼Œä¸€èˆ¬æ¯ç§’ä¸€æ¬¡å°±å¯ä»¥ã€‚&lt;/p&gt;
&lt;h1&gt;8. ä¿å­˜å¤±è´¥&lt;/h1&gt;
&lt;p&gt;redis æŠ¥é”™ï¼šCan't save in background: fork: Cannot allocate memoryã€‚&lt;/p&gt;
&lt;p&gt;åŸå› æ˜¯ redis åœ¨åå°ä¿å­˜çš„æ—¶å€™ä¼šç›´æ¥ fork ä¸€ä¸‹ï¼Œç„¶åä¿å­˜ã€‚ç”±äºæ•°æ®åº“è¿‡å¤§ï¼Œå°±ä¼š fork å¤±è´¥ï¼Œä½†æ˜¯å®é™…ä¸Šç”±äº copy-on-write æœºåˆ¶çš„å­˜åœ¨ï¼Œå¹¶ä¸ä¼šäº§ç”Ÿé—®é¢˜ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥æ›´æ”¹ç³»ç»Ÿçš„é…ç½®ï¼Œå…è®¸ forkã€‚&lt;/p&gt;
&lt;p&gt;æŠŠ &lt;code&gt;/etc/sysctl.conf&lt;/code&gt; æ–‡ä»¶ä¿®æ”¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vm.overcommit_memory=1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åé‡æ–°åŠ è½½ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sysctl -p /etc/sysctl.conf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/11752544/redis-bgsave-failed-because-fork-cannot-allocate-memory&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 20 Jul 2018 04:03:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-20:/posts/redis-chang-jian-wen-ti.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>å¤§è§„æ¨¡å­—ç¬¦ä¸²çš„åŒ¹é…</title><link>/posts/da-gui-mo-zi-fu-chuan-de-pi-pei.html</link><description>&lt;p&gt;é—®é¢˜ï¼šå‡è®¾æˆ‘ä»¬æœ‰ä¸€ç»„æ¯”è¾ƒé•¿çš„æ–‡æœ¬ï¼Œæ¯ä¸€ä¸ªæ–‡æœ¬éƒ½æœ‰å‡ åkå·¦å³ï¼Œè¿˜æœ‰ä¸€äº›æ•æ„Ÿå…³é”®è¯éœ€è¦åˆ é™¤ï¼Œå¤§æ¦‚æœ‰å‡ åƒï¼Œç„¶åéœ€è¦åœ¨è¿™äº›æ–‡æœ¬ä¸­æŠŠå…³é”®è¯æ‰¾å‡ºæ¥ã€‚&lt;/p&gt;
&lt;h1&gt;æ–¹æ³•1ï¼šæš´åŠ›æœç´¢&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;

&lt;span class="n"&gt;compiled_words&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\b&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;my20000words&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;sentence&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sentences&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;compiled_words&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;***&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æ”¹è¿›1ï¼šæŠŠæ­£åˆ™ç»„åˆèµ·æ¥&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pattern = &amp;quot;\b(word1|word2|word3)\b&amp;quot;

for sentence in sentences:
  print(re.sub(pattern, &amp;quot;***&amp;quot;, sentence))
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æ”¹è¿›2ï¼šä½¿ç”¨ Trie ä¼˜åŒ–æ­£åˆ™&lt;/h1&gt;
&lt;p&gt;å¯¹äºæ•°ç»„ï¼š['foobar', 'foobah', 'fooxar', 'foozap', 'fooza']ï¼Œä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå†™å‡ºæ­£åˆ™ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;\b(foobar|foobah|fooxar|foozap|fooza)\b&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½†æ˜¯è¿™å¹¶ä¸æ˜¯æœ€ä¼˜çš„æ­£åˆ™ï¼Œåº”è¯¥ä½¿ç”¨å‰ç¼€æ ‘çš„æ€æƒ³æ¥åˆå¹¶å•è¯ï¼Œå½¢æˆä¸‹é¢çš„æ­£åˆ™ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;r&amp;quot;\bfoo(?:ba[hr]|xar|zap?)\b&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…·ä½“çš„æ–¹æ³•å¯ä»¥çœ‹è¿™é‡Œï¼šhttps://stackoverflow.com/a/42789508/1061155&lt;/p&gt;
&lt;h1&gt;æ”¹è¿›3ï¼šåŸºäºé›†åˆçš„æœç´¢&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;delete_banned_words&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;matchobj&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;word&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;matchobj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;banned_words&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;

&lt;span class="n"&gt;word_pattern&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\w+&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;sentence&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sentences&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;sentence&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;word_pattern&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;delete_banned_words&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/42742810/speed-up-millions-of-regex-replacements-in-python-3/42789508&lt;/p&gt;
&lt;p&gt;https://medium.freecodecamp.org/regex-was-taking-5-days-flashtext-does-it-in-15-minutes-55f04411025f&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 20 Jul 2018 02:35:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-20:/posts/da-gui-mo-zi-fu-chuan-de-pi-pei.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­çš„ GCï¼ˆåƒåœ¾å›æ”¶ï¼‰</title><link>/posts/python-zhong-de-gcla-ji-hui-shou.html</link><description>&lt;h1&gt;å¼•ç”¨è®¡æ•°ï¼ˆreference countingï¼‰&lt;/h1&gt;
&lt;p&gt;CPython ä¸­é»˜è®¤ä½¿ç”¨çš„åƒåœ¾å›æ”¶ç®—æ³•æ˜¯ Reference Countingã€‚ä¹Ÿå°±æ˜¯å¯¹æ¯ä¸ªå…ƒç´ æ ‡è®°æœ‰å¤šå°‘ä¸ªå…¶ä»–å…ƒç´ å¼•ç”¨äº†å®ƒï¼Œå½“å¼•ç”¨æ•°é™åˆ°é›¶çš„æ—¶å€™å°±åˆ é™¤ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å½“å¯¹è±¡å¢åŠ ä¸€ä¸ªå¼•ç”¨ï¼Œæ¯”å¦‚èµ‹å€¼ç»™å˜é‡ï¼Œå±æ€§æˆ–è€…ä¼ å…¥ä¸€ä¸ªæ–¹æ³•ï¼Œå¼•ç”¨è®¡æ•°æ‰§è¡ŒåŠ 1è¿ç®—ã€‚&lt;/li&gt;
&lt;li&gt;å½“å¯¹è±¡å‡å°‘ä¸€ä¸ªå¼•ç”¨ï¼Œæ¯”å¦‚å˜é‡ç¦»å¼€ä½œç”¨åŸŸï¼Œå±æ€§è¢«èµ‹å€¼ä¸ºå¦ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œå±æ€§æ‰€åœ¨çš„å¯¹è±¡è¢«å›æ”¶æˆ–è€…ä¹‹å‰ä¼ å…¥å‚æ•°çš„æ–¹æ³•è¿”å›ï¼Œå¼•ç”¨è®¡æ•°æ‰§è¡Œå‡1æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;å½“å¼•ç”¨è®¡æ•°å˜ä¸º0ï¼Œä»£è¡¨è¯¥å¯¹è±¡ä¸è¢«å¼•ç”¨ï¼Œå¯ä»¥æ ‡è®°æˆåƒåœ¾è¿›è¡Œå›æ”¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼ŒCPython ä½¿ç”¨äº† Cyclic GCï¼Œéå†æ‰€æœ‰çš„ç¯ï¼Œå¹¶ä¸”æŠŠæ¯ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨å‡ä¸€ï¼Œæ¥æ£€æµ‹æ¯ä¸€ä¸ªå¼•ç”¨ç¯æ˜¯ä¸æ˜¯å¾ªç¯åº”ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tKfTcly1ftg5mu2087j30we0i6gv5.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;æ ‡è®°åˆ é™¤ï¼ˆMark and Sweepï¼‰&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;ä»æŸä¸€ä¸ªå·²çŸ¥çš„è¿˜æ´»ç€çš„å¯¹è±¡å¼€å§‹ï¼Œä¾¿åˆ©å¯¹è±¡ï¼Œå¦‚æœç»è¿‡äº†æŸä¸ªå¯¹è±¡å°±è®¤ä¸ºæ˜¯æ´»ç€çš„&lt;/li&gt;
&lt;li&gt;å¦‚æœæ²¡æœ‰è¢«æ ‡è®°çš„å°±åˆ é™¤&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é¿å…äº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tKfTcly1ftf9x2kejlj30wo0ic11s.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å®é™…çš„å¤„ç†è¿‡ç¨‹&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tKfTcly1ftfa55k2e7j30wi0ick3k.jpg"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tKfTcly1ftfa6amfmmj30wc0iedr8.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Pluggable
Generational
Incremental&lt;/p&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://www.youtube.com/watch?v=iHVs_HkjdmI&lt;/li&gt;
&lt;li&gt;https://droidyue.com/blog/2015/06/05/how-garbage-collector-handles-circular-references/&lt;/li&gt;
&lt;li&gt;https://www.cnblogs.com/Xjng/p/5128269.html&lt;/li&gt;
&lt;li&gt;https://foofish.net/python-gc.html&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 19 Jul 2018 08:52:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-19:/posts/python-zhong-de-gcla-ji-hui-shou.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>åœ¨ Python ä¸­ä¼˜é›…åœ°å¤„ç† SIGTERM ä¿¡å·</title><link>/posts/zai-python-zhong-you-ya-di-chu-li-sigterm-xin-hao.html</link><description>&lt;p&gt;æ˜¨å¤©å†™äº†ä¸€ä¸ªæœåŠ¡ï¼Œåœ¨æœ¬åœ°è¿è¡Œå¾ˆå¥½ï¼Œä½¿ç”¨ Ctrl-C ç»“æŸè¿è¡Œä¹‹åä¼šæ¸…ç†èµ„æºï¼Œç„¶åå–æ¶ˆæ³¨å†Œï¼Œç„¶è€Œæ”¾åˆ° Docker ä¸­è·‘ä¹‹åå‘ç°ç»“æŸä¹‹åèµ„æºæ²¡æœ‰é‡Šæ”¾ã€‚æŸ¥äº†æŸ¥å‘ç°åŸæ¥æ˜¯ä¸‹é¢æ˜¯å‡ ä¸ªå› ç´ é€ æˆçš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Ctrl-C å‘é€çš„æ˜¯ SIGINT ä¿¡å·ï¼ŒPython ä¼šè½¬åŒ–æˆ KeyboardInterrupt å¼‚å¸¸ï¼Œè€Œæˆ‘çš„èµ„æºæ˜¯åœ¨ finally é‡Šæ”¾èµ„æºï¼Œæ‰€ä»¥ä½¿ç”¨ Ctrl-C å¯ä»¥ä¼˜é›…åœ°é€€å‡º&lt;/li&gt;
&lt;li&gt;Python ä¸­å¯¹å…¶ä»–çš„ä¿¡å·ï¼ˆæ¯”å¦‚ SIGTERMã€SIGHUPï¼‰éƒ½ä¸ä¼šå¤„ç†ï¼Œè€Œæ˜¯ç›´æ¥é€€å‡º&lt;/li&gt;
&lt;li&gt;Docker åœ¨æ¨å‡ºçš„æ—¶å€™é»˜è®¤å‘é€çš„æ˜¯ SIGTERM ä¿¡å·&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥åœ¨ docker stop çš„æ—¶å€™æœåŠ¡å¹¶ä¸èƒ½ä¼˜é›…çš„æ¨å‡ºã€‚&lt;/p&gt;
&lt;h1&gt;è§£å†³æ–¹æ³•&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ atexit æ¨¡å—æ˜¯ä¸å¯ä»¥çš„ï¼Œatexit ä¸ä¼šå¤„ç† SIGTERMã€‚éœ€è¦ä½¿ç”¨ signal æ¨¡å—æ¥ï¼Œåœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€ä»½æºç ã€‚è¿™ä¸ªä»£ç æ³¨å†Œäº†ä¸€ä¸ª SIGTERM çš„ handlerï¼ŒæŠŠ SIGTERM è½¬æ¢æˆæ­£å¸¸çš„ &lt;code&gt;sys.exit&lt;/code&gt; è°ƒç”¨ï¼Œå½“è¿è¡Œ &lt;code&gt;sys.exit&lt;/code&gt; çš„æ—¶å€™ä¼šè¿è¡Œ finally å­å¥ä¸­çš„è¯­å¥ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Author: Giampaolo Rodola&amp;#39; &amp;lt;g.rodola [AT] gmail [DOT] com&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;# License: MIT&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;with_statement&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;contextlib&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;signal&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_sigterm_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;_sigterm_handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__enter_ctx__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;


&lt;span class="nd"&gt;@contextlib.contextmanager&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;A context manager which properly handles SIGTERM and SIGINT&lt;/span&gt;
&lt;span class="sd"&gt;    (KeyboardInterrupt) signals, registering a function which is&lt;/span&gt;
&lt;span class="sd"&gt;    guaranteed to be called after signals are received.&lt;/span&gt;
&lt;span class="sd"&gt;    Also, it makes sure to execute previously registered signal&lt;/span&gt;
&lt;span class="sd"&gt;    handlers as well (if any).&lt;/span&gt;

&lt;span class="sd"&gt;    &amp;gt;&amp;gt;&amp;gt; app = App()&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;gt;&amp;gt;&amp;gt; with handle_exit(app.stop):&lt;/span&gt;
&lt;span class="sd"&gt;    ...     app.start()&lt;/span&gt;
&lt;span class="sd"&gt;    ...&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;

&lt;span class="sd"&gt;    If append == False raise RuntimeError if there&amp;#39;s already a handler&lt;/span&gt;
&lt;span class="sd"&gt;    registered for SIGTERM, otherwise both new and old handlers are&lt;/span&gt;
&lt;span class="sd"&gt;    executed in this order.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;old_handler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_sigterm_handler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old_handler&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIG_DFL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old_handler&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;_sigterm_handler&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;RuntimeError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;there is already a handler registered for &amp;quot;&lt;/span&gt;
                               &lt;span class="s2"&gt;&amp;quot;SIGTERM: &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;old_handler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;_sigterm_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;old_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;_sigterm_handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__enter_ctx__&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;RuntimeError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;can&amp;#39;t use nested contexts&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;_sigterm_handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__enter_ctx__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;yield&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;KeyboardInterrupt&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;SystemExit&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# code != 0 refers to an application error (e.g. explicit&lt;/span&gt;
        &lt;span class="c1"&gt;# sys.exit(&amp;#39;some error&amp;#39;) call).&lt;/span&gt;
        &lt;span class="c1"&gt;# We don&amp;#39;t want that to pass silently.&lt;/span&gt;
        &lt;span class="c1"&gt;# Nevertheless, the &amp;#39;finally&amp;#39; clause below will always&lt;/span&gt;
        &lt;span class="c1"&gt;# be executed.&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt;
    &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;_sigterm_handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__enter_ctx__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# ===============================================================&lt;/span&gt;
    &lt;span class="c1"&gt;# --- test suite&lt;/span&gt;
    &lt;span class="c1"&gt;# ===============================================================&lt;/span&gt;

    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;unittest&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TestOnExit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;setUp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="c1"&gt;# reset signal handlers&lt;/span&gt;
            &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIG_DFL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tearDown&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="c1"&gt;# make sure we exited the ctx manager&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertTrue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_base&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
                &lt;span class="k"&gt;pass&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
            &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
                &lt;span class="k"&gt;pass&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_kinterrupt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
                &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;KeyboardInterrupt&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_sigterm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
                &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_sigint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
                &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGINT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_sigterm_old&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="c1"&gt;# make sure the old handler gets executed&lt;/span&gt;
            &lt;span class="n"&gt;queue&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
            &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;old&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;new&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;old&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;new&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_sigint_old&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="c1"&gt;# make sure the old handler gets executed&lt;/span&gt;
            &lt;span class="n"&gt;queue&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
            &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;old&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;new&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGINT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queue&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;old&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;new&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_no_append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="c1"&gt;# make sure we can&amp;#39;t use the context manager if there&amp;#39;s&lt;/span&gt;
            &lt;span class="c1"&gt;# already a handler registered for SIGTERM&lt;/span&gt;
            &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
                    &lt;span class="k"&gt;pass&lt;/span&gt;
            &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;RuntimeError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;pass&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;exception not raised&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_nested_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
            &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
                    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;handle_exit&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
                        &lt;span class="k"&gt;pass&lt;/span&gt;
            &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;RuntimeError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;pass&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;exception not raised&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;docker é€€å‡ºä¿¡å·ï¼šhttps://www.ctl.io/developers/blog/post/gracefully-stopping-docker-containers/&lt;/li&gt;
&lt;li&gt;finally ä¸­çš„è¯­å¥å¹¶ä¸æ€»ä¼šæ‰§è¡Œï¼šhttps://stackoverflow.com/questions/49262379/does-finally-always-execute-in-python&lt;/li&gt;
&lt;li&gt;Python ä¸å¤„ç† SIGTERM ä¿¡å· https://stackoverflow.com/questions/9930576/python-what-is-the-default-handling-of-sigterm&lt;/li&gt;
&lt;li&gt;sys.exit ä¹Ÿä¼šè¿è¡Œ finally ä¸­çš„è¯­å¥ https://stackoverflow.com/questions/7709411/why-finally-block-is-executing-after-calling-sys-exit0-in-except-block&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 18 Jul 2018 01:46:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-18:/posts/zai-python-zhong-you-ya-di-chu-li-sigterm-xin-hao.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>åœ¨é˜¿é‡Œäº‘ä¸Šä¸ºå†…ç½‘VPCæ­å»ºNATå‡ºå£æœåŠ¡å™¨</title><link>/posts/zai-a-li-yun-shang-wei-nei-wang-vpcda-jian-natchu-kou-fu-wu-qi.html</link><description>&lt;p&gt;å¯¹äºå¤§å¤šæ•°çš„å†…éƒ¨æœåŠ¡æ¥è¯´ï¼Œæˆ‘ä»¬æ˜¯ä¸å¸Œæœ›ä»–ä»¬æš´éœ²åœ¨å…¬ç½‘ä¸Šçš„ï¼›è€Œä¸”æœåŠ¡ä¹‹é—´é€šè¿‡å…¬ç½‘é€šä¿¡æ•ˆç‡ä¹Ÿæ¯”è¾ƒä½ã€‚é˜¿é‡Œäº‘æä¾›äº†è™šæ‹Ÿç§ç½‘çš„æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæœåŠ¡éƒ½éƒ¨ç½²åœ¨å†…ç½‘ã€‚ä½†æ˜¯ä¸æ­¤åŒæ—¶å¦‚ä½•è®©å†…ç½‘çš„æœåŠ¡å™¨èƒ½å¤Ÿä¸Šç½‘ä¹Ÿå°±æˆäº†é—®é¢˜ï¼Œæ¯•ç«Ÿè¿˜æ˜¯ç»å¸¸éœ€è¦&lt;code&gt;apt-get&lt;/code&gt; ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œä¸å¯èƒ½æ¯ä¸ªæœåŠ¡å™¨éƒ½ç»‘å®šä¸€ä¸ªå¼¹æ€§IPï¼Œè´µä¸”ä¸è¯´ï¼Œè¿™æ ·å’ŒåˆæŠŠå†…éƒ¨æœåŠ¡æš´éœ²åœ¨äº†å…¬ç½‘ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œé˜¿é‡Œäº‘æä¾›äº†ä¸“ç”¨çš„NATæœåŠ¡å™¨ï¼Œä½†æ˜¯å¤ªè´µäº†ï¼ï¼ï¼&lt;/p&gt;
&lt;p&gt;å…¶å® NAT æœåŠ¡å™¨ä¹Ÿå¾ˆç®€å•å•¦ï¼Œå°±æ˜¯ä¸€ä¸ªè·¯ç”±è½¬å‘è€Œå·²ï¼Œåˆ©ç”¨ iptables å¯ä»¥è½»æ¾å®ç°ã€‚ä¸‹é¢ä»¥ä¸€ä¸ªä¾‹å­æ¥è®²è§£ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè¯´ä¸€ä¸‹ NAT çš„ä¸¤ç§æœ¯è¯­ï¼šSNAT å’Œ DNATã€‚SNATçš„æ„æ€å°±æ˜¯ source NATï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è®¿é—®å…¶ä»–ç½‘ç«™ï¼Œä½œä¸º TCP é“¾æ¥çš„æ¥æºã€‚è€Œ DNAT å°±æ˜¯ destination NATï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä½œä¸ºæœåŠ¡å™¨ï¼Œä½œä¸º TCP é“¾æ¥çš„é‡ç‚¹ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬è¦å®ç°çš„æ˜¯å†…ç½‘ä¸Šç½‘ï¼Œè€Œä¸æ˜¯å†…ç½‘æä¾›æœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ SNAT å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æœ‰ä¸‰å°æœåŠ¡å™¨ï¼Œåœ¨ä¸€ä¸ªå†…ç½‘ä¸­ï¼Œåˆ†åˆ«æ˜¯ï¼š10.1.1.1, 10.1.1.2, 10.1.1.3ã€‚å…¶ä¸­ 10.1.1.1 ç»‘å®šäº†å¤–ç½‘IPå¯ä»¥ä¸Šç½‘ã€‚è¿™é‡Œè¦è¯´æ˜çš„æ˜¯ï¼šé˜¿é‡Œäº‘çš„å¼¹æ€§ IP å®é™…ä¸Šæ˜¯ä¸€ä¸ªâ€œä¼ªIPâ€ï¼Œä¹Ÿå°±æ˜¯å¹¶æ²¡æœ‰çœŸçš„ç»‘å®šåˆ°æˆ‘ä»¬çš„ä¸»æœºä¸Šï¼Œè€Œæ˜¯é€šè¿‡ SNAT å’Œ DNAT çš„æ–¹å¼æ¥æ¨¡æ‹Ÿäº†ç»‘å®šIPçš„è¡Œä¸ºã€‚å¯ä»¥é€šè¿‡ &lt;code&gt;ip addr show&lt;/code&gt; å‘½ä»¤éªŒè¯ä¸€ä¸‹ï¼Œå¹¶æ²¡ç”¨å¼¹æ€§ IP çš„ä»»ä½•ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;é˜¿é‡Œäº‘å†…ç½‘å¿…é¡»å»ºç«‹ä¸€ä¸ªè™šæ‹Ÿäº¤æ¢æœºæ¥è¿æ¥å„ä¸ªä¸»æœºï¼Œåœ¨åå°æˆ‘ä»¬å¯ä»¥é…ç½®è¿™ä¸ªä¸»æœºçš„è·¯ç”±è¡¨ã€‚ä¸ºäº†å®ç°è®© 10.1.1.1 ä½œä¸ºå‡ºå£çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬é…ç½®äº¤æ¢æœºçš„è·¯ç”±è¡¨ï¼Œæ·»åŠ å¦‚ä¸‹ä¸€è¡Œï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNc79ly1ftbtme2354j319m0eo3zv.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æŠŠæ‰€æœ‰çš„æµé‡éƒ½è½¬å‘åˆ° 10.1.1.1&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œåœ¨ 10.1.1.1 ä¸Šæ‰§è¡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;echo 1 &amp;gt; /proc/sys/net/ipv4/ip_forward   # æ‰“å¼€è½¬å‘åŠŸèƒ½

# æ‰€æœ‰æ¥è‡ª10.0.0.0/8 çš„æµé‡é€šè¿‡ eth0 å‘å‡º
iptables -t nat -A POSTROUTING -s 10.0.0.0/8 -o eth0 -j MASQUERADE

iptables -A FORWARD -d 10.0.0.0/8 -j ACCEPT # æœ‰äººè¯´éœ€è¦è¿™ä¸¤å¥ï¼Œä½†æ˜¯äº²æµ‹è¿™ä¸¤å¥ä¸éœ€è¦ï¼Œä½†æ˜¯ä¹Ÿä¸çŸ¥é“ä»€ä¹ˆæ„æ€
iptables -A FORWARD -s 10.0.0.0/8 -j ACCEPT
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ—¶å€™åœ¨ 10.1.1.2 ä¸Šå°±å¯ä»¥ä¸Šç½‘äº†&lt;/p&gt;
&lt;p&gt;è¯´åœ¨æœ€åï¼šè‡ªå·±æ­å»ºDNAT/SNATåªèƒ½å•æœºï¼Œæ— æ³•åšåˆ°é«˜å¯ç”¨ï¼Œå› ä¸ºé˜¿é‡Œäº‘ä¸ç»™æˆ‘ä»¬æä¾›VIPã€‚å¦‚æœä½ è€ƒè™‘æ„å»ºé«˜å¯ç”¨çš„ç§æœ‰äº‘ï¼Œè¿˜æ˜¯ç›´æ¥è´­ä¹°é˜¿é‡Œäº‘çš„è´Ÿè½½å‡è¡¡+NATç½‘å…³å§ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”DNATå’ŒSNATï¼Œä½†æ˜¯å¯é æ€§æ›´é«˜ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼šhttps://yuerblog.cc/2017/03/25/vpc-in-aliyun/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 16 Jul 2018 08:14:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-16:/posts/zai-a-li-yun-shang-wei-nei-wang-vpcda-jian-natchu-kou-fu-wu-qi.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>redis ä¸­å¦‚ä½•ç»™é›†åˆä¸­çš„å…ƒç´ è®¾ç½® TTL</title><link>/posts/redis-zhong-ru-he-gei-ji-he-zhong-de-yuan-su-she-zhi-ttl.html</link><description>&lt;p&gt;æˆ‘ä»¬çŸ¥é“åœ¨ redis ä¸­å¯ä»¥ç»™æ¯ä¸ª key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆTTLï¼‰ï¼Œä½†æ˜¯æ²¡æ³•ä¸ºæ¯ä¸ªé›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨zsetæ¥å®ç°è¿™ä¸ªæ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥ä¸Šä»£ç å§ï¼ŒPython ç‰ˆçš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;RedisSet&lt;/span&gt;:

    &lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;redis&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;StrictRedis&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;ttl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;time&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;æŠŠè¿‡æœŸæ—¶é—´ä½œä¸º&lt;/span&gt; &lt;span class="nx"&gt;score&lt;/span&gt; &lt;span class="err"&gt;æ·»åŠ åˆ°&lt;/span&gt; &lt;span class="nx"&gt;zset&lt;/span&gt; &lt;span class="err"&gt;ä¸­&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;zadd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;now&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;ttl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;åˆ é™¤å·²ç»è¿‡æœŸçš„å…ƒç´ &lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;zremrangebyscore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;now&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;+inf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;getall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;åªè¯»å–è¿˜æ²¡æœ‰è¿‡æœŸçš„å…ƒç´ &lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;zrangebyscore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-inf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;time&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;time&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒï¼šhttps://github.com/antirez/redis/issues/135&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 16 Jul 2018 07:54:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-16:/posts/redis-zhong-ru-he-gei-ji-he-zhong-de-yuan-su-she-zhi-ttl.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>ä¸€ç¯‡ç®€å•çš„ Python gRPC æ•™ç¨‹</title><link>/posts/yi-pian-jian-dan-de-python-grpc-jiao-cheng.html</link><description>&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install grpcio grpcio-tools protobuf googleapis-common-protos
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;IDL&lt;/h1&gt;
&lt;p&gt;grpc ä½¿ç”¨ protobuf æ¥å®šä¹‰æ¥å£ã€‚æŒ‰ç…§ protobuf çš„ &lt;a href="https://developers.google.com/protocol-buffers/docs/style"&gt;Style Guide&lt;/a&gt; çš„è¦æ±‚ï¼Œservice å’Œå…¶ä¸­çš„æ–¹æ³•éƒ½åº”è¯¥ä½¿ç”¨ CamelCaseã€‚&lt;/p&gt;
&lt;p&gt;service å…³é”®å­—å®šä¹‰ä¸€ä¸ªæœåŠ¡ï¼Œç›¸å½“äºä¸€ä¸ªæ¥å£ã€‚æŠŠä¸‹é¢çš„æ–‡ä»¶ä¿å­˜ä¸º helloworld.proto&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œgrpc ä¸­çš„æ–¹æ³•åªèƒ½æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå‚æ•°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;// The greeter service definition.
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}
}

// The request message containing the user&amp;#39;s name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings
message HelloResponse {
  string message = 1;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ç”Ÿæˆ rpc ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python -m grpc_tools.protoc  --python_out=. --grpc_python_out=. helloworld.proto
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç”Ÿæˆäº†ä¸¤ä¸ªæ–‡ä»¶:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;helloworld_pb2ï¼ŒåŒ…å«äº† protobuf ä¸­ç»“æ„çš„å®šä¹‰&lt;/li&gt;
&lt;li&gt;helloworld_pb2_grpc, åŒ…å«äº† protobuf grpc æ¥å£çš„å®šä¹‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å®ç° rpc æœåŠ¡&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;current.futures&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ThreadPoolExecutor&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;helloworld_pb2&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HelloRepsonse&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;helloworld_pb2_grpc&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;GreeterServicer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;add_GreeterServicer_to_server&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Greeter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;GreeterServicer&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;SayHello&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;HelloResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Hello, &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;!&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;SayHelloAgain&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;HelloResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Hello again, &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;!&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;serve&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;grpc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ThreadPoolExecutor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_workers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;add_GreeterServicer_to_server&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Greeter&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_insecure_port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[::]:50051&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_ONE_DAY_IN_SECONDS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;KeyboardInterrupt&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å®¢æˆ·ç«¯è°ƒç”¨&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;grpc&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;helloworld_pb2&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HelloRequest&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;helloworld_pb2_grpc&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;GreeterStub&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="c1"&gt;# NOTE(gRPC Python Team): .close() is possible on a channel and should be&lt;/span&gt;
    &lt;span class="c1"&gt;# used in circumstances in which the with statement does not fit the needs&lt;/span&gt;
    &lt;span class="c1"&gt;# of the code.&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;grpc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;insecure_channel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;localhost:50051&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;stub&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GreeterStub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stub&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SayHello&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HelloRequest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;you&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Greeter client received: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;é«˜çº§è¯é¢˜&lt;/h1&gt;
&lt;p&gt;stream&lt;/p&gt;
&lt;p&gt;æœªå®Œå¾…ç»­&lt;/p&gt;
&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;[A simplified guide to gRPC in Python](&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 05:22:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/yi-pian-jian-dan-de-python-grpc-jiao-cheng.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Goè¯­è¨€è¯»å†™æ–‡ä»¶ç›¸å…³å‡½æ•°å¯¹æ¯”</title><link>/posts/goyu-yan-du-xie-wen-jian-xiang-guan-han-shu-dui-bi.html</link><description>&lt;h1&gt;æ–‡ä»¶ IO&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;io.Reader&lt;/code&gt; å’Œ &lt;code&gt;io.Writer&lt;/code&gt;ã€‚è¿™ä¸¤ä¸ªæ˜¯ä¸¤ä¸ªç‰¹åˆ«é‡è¦çš„ interfaceã€‚ä¸€èˆ¬æ¥è¯´å‡¡æ˜¯å¯ä»¥æŠ½è±¡ä¸ºè¾“å…¥çš„ IO æ“ä½œéƒ½ä¼šä½¿ç”¨ io.Readerã€‚å‡¡æ˜¯å¯ä»¥æŠ½è±¡ä¸ºè¾“å‡ºçš„ IO æ“ä½œéƒ½ä¼šä½¿ç”¨ io.Writerã€‚&lt;/p&gt;
&lt;h1&gt;io/ioutil&lt;/h1&gt;
&lt;p&gt;å¯¹äºé…ç½®æ–‡ä»¶ç­‰ç­‰æ¯”è¾ƒå°çš„å¸¸è§„æ–‡ä»¶ï¼Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ io/ioutil åŒ…ä¸­çš„è¾…åŠ©å‡½æ•°æ“ä½œå°±å¥½äº†ï¼Œæ¯”è¾ƒå¿«æ·æ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‡½æ•°ç­¾å&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func NopCloser(r io.Reader) io.ReadCloser&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŠŠ io.Reader åŒ…è£…æˆä¸€ä¸ª io.ReadWriter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func ReadAll(r io.Reader) ([]byte, error)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¯»å–æ‰€æœ‰å­—ç¬¦ï¼ŒæˆåŠŸçš„è¯ err == nil&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func ReadDir(dirname string) ([]os.FileInfo, error)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¯»å–å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func ReadFile(filename string) ([]byte, error)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¯»å–æ–‡ä»¶çš„æ‰€æœ‰å†…å®¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func TempDir(dir, prefix string) (name string, err error)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºä¸´æ—¶ç›®å½•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func TempFile(dir, prefix string) (f *os.File, err error)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºä¸´æ—¶æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func WriteFile(filename string, data []byte, perm os.FileMode) error&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å†™å…¥æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¯¹äºæ¯”è¾ƒå¤§çš„æ–‡ä»¶ï¼Œç›´æ¥ä½¿ç”¨ &lt;code&gt;ioutil.ReadFile&lt;/code&gt; è¯»åˆ°å†…å­˜é‡Œæ˜¾ç„¶æ˜¯ä¸ç°å®çš„ï¼Œè¿™æ—¶å€™åº”è¯¥ä½¿ç”¨ &lt;code&gt;os&lt;/code&gt; æ¨¡å—ä¸­çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;h2&gt;æ–‡ä»¶æ“ä½œ&lt;/h2&gt;
&lt;p&gt;å…¶ä»–è¯­è¨€ä¸­ä¸€èˆ¬ç»Ÿä¸€é€šè¿‡ open(filename, rw) è¿™ä¸ªå‡½æ•°æ¥æ‰“å¼€æ–‡ä»¶ï¼Œè€Œ golang ä¸­æœ‰æ‰€
ä¸åŒï¼Œä¸€èˆ¬æ¥è¯´æ˜¯é€šè¿‡ os.Open(filename) æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å–ï¼Œä½¿ç”¨ os.Create(filename) 
æ‰“å¼€æ–‡ä»¶ç”¨äºå†™å…¥ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 05:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/goyu-yan-du-xie-wen-jian-xiang-guan-han-shu-dui-bi.html</guid><category>golang</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Goè¯­è¨€å¤„ç† CSV æ–‡ä»¶</title><link>/posts/goyu-yan-chu-li-csv-wen-jian.html</link><description>&lt;p&gt;åœ¨ Go è¯­è¨€ä¸­å¯ä»¥ä½¿ç”¨ &lt;code&gt;encoding/csv&lt;/code&gt; åŒ…æ¥å¤„ç† csv æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;csv åŒ…ä¸­ä¸»è¦æœ‰ä¸¤ä¸ª structï¼ŒReader å’Œ Writerã€‚Reader ä»ä¸€ä¸ª io.Reader
ä¸­è¯»å–æ¯ä¸€è¡Œçš„å†…å®¹ï¼ŒåŒæ—¶æä¾›äº†ä¸€äº›è®¾ç½®çš„é€‰é¡¹ã€‚Writer ç”¨æ¥å†™å…¥ csv æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h1&gt;Reader&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;r := csv.NewReader(strings.NewReader(in))

for {
    record, err := r.Read()
    if err == io.EOF {
        break
    }
    if err != nil {
        log.Fatal(err)
    }

    fmt.Println(record)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‡½æ•°ç­¾å&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func NewReader(r io.Reader) *Reader&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func (r *Reader) Read() (record []string, err error)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿”å› []string ç±»å‹æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func (r *Reader) ReadAll() (records [][]string, err error)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç›´æ¥è¿”å›æ‰€æœ‰æ•°æ®&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;Writer&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;records := [][]string{
    {&amp;quot;first_name&amp;quot;, &amp;quot;last_name&amp;quot;, &amp;quot;username&amp;quot;},
    {&amp;quot;Rob&amp;quot;, &amp;quot;Pike&amp;quot;, &amp;quot;rob&amp;quot;},
    {&amp;quot;Ken&amp;quot;, &amp;quot;Thompson&amp;quot;, &amp;quot;ken&amp;quot;},
    {&amp;quot;Robert&amp;quot;, &amp;quot;Griesemer&amp;quot;, &amp;quot;gri&amp;quot;},
}

w := csv.NewWriter(os.Stdout)

for _, record := range records {
    if err := w.Write(record); err != nil {
        log.Fatalln(&amp;quot;error writing record to csv:&amp;quot;, err)
    }
}

// Write any buffered data to the underlying writer (standard output).
w.Flush()

if err := w.Error(); err != nil {
    log.Fatal(err)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‡½æ•°ç­¾å&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func NewWriter(w io.Writer) *Writer&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func (w *Writer) Error() error&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func (w *Writer) Flush()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func (w *Writer) Write(record []string) error&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;func (w *Writer) WriteAll(records [][]string) error&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 04:59:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/goyu-yan-chu-li-csv-wen-jian.html</guid><category>golang</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>çŸ¥ä¹ç§»åŠ¨ç«¯æ¥å£åˆ†æ</title><link>/posts/zhi-hu-yi-dong-duan-jie-kou-fen-xi.html</link><description>&lt;p&gt;æœ€è¿‘æƒ³æ³¨å†Œä¸€äº›çŸ¥ä¹çš„æœºå™¨äººç©ç©å„¿ï¼Œæ¯”å¦‚ç»™è‡ªå·±ç‚¹èµä¹‹ç±»çš„ï¼Œé€šè¿‡æŠ“åŒ…åˆ†æï¼Œè·å¾—äº†å®Œæ•´æ³¨å†Œç™»å½•æµç¨‹ã€‚&lt;/p&gt;
&lt;h1&gt;æŠ“åŒ…&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;1 POST https://api.zhihu.com/auth/digits
      â† 401 application/json 97b 246ms
2 GET https://api.zhihu.com/captcha
     â† 200 application/json 22b 233ms
3 PUT https://api.zhihu.com/captcha
     â† 202 application/json 5.46k 323ms
4 POST https://api.zhihu.com/captcha
      â† 201 application/json 16b 295ms
5 POST https://api.zhihu.com/sms/digits
      â† 201 application/json 16b 353ms
6 POST https://api.zhihu.com/validate/digits
      â† 201 application/json 16b 409ms
7 POST https://api.zhihu.com/validate/register_form
      â† 200 application/json 16b 279ms
8 POST https://api.zhihu.com/register
      â† 201 application/json 761b 529ms
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é€è¡Œåˆ†æä¸€ä¸‹æ¯ä¸ªåŒ…:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿™ä¸ªè¯·æ±‚å‘é€äº† &lt;code&gt;username: +86155xxxxxxxx&lt;/code&gt; è¯·æ±‚ï¼Œç„¶åè¿”å›äº† &lt;code&gt;ç¼ºå°‘éªŒè¯ç ç¥¨æ®&lt;/code&gt;ï¼Œåº”è¯¥æ˜¯è¡¨ç¤ºç¼ºå°‘éªŒè¯ç ã€‚&lt;/li&gt;
&lt;li&gt;åº”è¯¥ä¸æ˜¯è¯·æ±‚éªŒè¯ç ï¼Œè€Œæ˜¯è¯·æ±‚æ˜¯å¦éœ€è¦éªŒè¯ç ï¼Œè¿”å›äº†&lt;code&gt;"show_captcha": false&lt;/code&gt;ï¼Œè™½ç„¶è¡¨ç¤ºçš„æ˜¯ä¸éœ€è¦éªŒè¯ç ï¼Œä½†æ˜¯è¿˜æ˜¯å¼¹å‡ºäº†éªŒè¯ç ï¼Œå¥‡æ€ªã€‚&lt;/li&gt;
&lt;li&gt;æ³¨æ„è¿™ä¸ªè¯·æ±‚æ˜¯ PUTï¼ŒPOST å‚æ•°&lt;code&gt;height: 60, width: 240&lt;/code&gt;ã€‚ç„¶åè¿”å›äº†éªŒè¯ç ï¼š&lt;code&gt;{"img_base64": ...}&lt;/code&gt;, base64 è§£ç åå°±æ˜¯éªŒè¯ç &lt;/li&gt;
&lt;li&gt;è¿™ä¸€æ­¥ POST æ­£ç¡®çš„ captcha å¹¶é€šè¿‡éªŒè¯ï¼Œå‚æ•°æ˜¯ï¼š&lt;code&gt;input_text: nxa8&lt;/code&gt;, è¿”å›æ˜¯ï¼š&lt;code&gt;{ "success": true }&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¿™ä¸€æ­¥è¯·æ±‚å‘é€çŸ­ä¿¡éªŒè¯ç ï¼ŒPOST å‚æ•°æ˜¯ï¼š&lt;code&gt;phone_no: +86155xxxxxxxx&lt;/code&gt;, å‘æŒ¥æ˜¯ï¼š&lt;code&gt;{ "success": true }&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æäº¤éªŒè¯ç ï¼ŒPOST å‚æ•°æ˜¯: &lt;code&gt;phone_no: +86155xxxxxxxx, digits: xxxxxx&lt;/code&gt;ï¼Œ è¿”å›æ˜¯ï¼š&lt;code&gt;{ "success": true }&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¡«å†™ç”¨æˆ·ä¿¡æ¯ï¼ŒPOST å‚æ•°æ˜¯ï¼š&lt;code&gt;phone_no: +86155xxxxxxxx, gender: 0, fullname: XXX&lt;/code&gt;,è¿”å›æ˜¯ï¼š&lt;code&gt;{ "success": true }&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸Šä¸€æ­¥æ³¨å†Œäº†ç”¨æˆ·ï¼Œè¿™ä¸€æ­¥æ˜¯å‘çŸ¥ä¹è¯·æ±‚æ–°çš„ access tokenã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ±‚ POST å‚æ•°ï¼š
&lt;code&gt;digits:        865405
fullname:      Lucindai
phone_no:      +8615568995304
register_type: phone_digits&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿”å›æ•°æ®å¦‚ä¸‹ï¼š
&lt;code&gt;{
"access_token": "...",
"cookie": { },
"expires_in": 2592000,
"lock_in": 1800,
"old_id": 155681178,
"refresh_token": "...",
"token_type": "bearer",
"uid": "...",
"unlock_ticket": "...",
"user_id":...
}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­çš„ refresh token å’Œ access token éƒ½æ˜¯ OAuth2 ä¸­çš„å‚æ•°ï¼Œå¯ä»¥ç”¨äºä½¿ç”¨ OAuth2 è®¿é—®çŸ¥ä¹çš„ APIã€‚å¯ä»¥ä½¿ç”¨ zhihu_oauth è¿™ä¸ªåº“æ¥è®¿é—®çŸ¥ä¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;çŸ¥ä¹çš„ API è¿˜éœ€è¦åœ¨ header ä¸­è®¾å®šä¸€äº›ç‰¹æ®Šå‚æ•°ï¼Œå¯ä»¥å‚è€ƒ zhihu_oauth ä¸­çš„å‚æ•°&lt;/p&gt;
&lt;p&gt;å†æ³¨å†ŒæˆåŠŸä¹‹åè¿˜åº”è¯¥è®¾å®šå¯†ç ï¼Œè¿™æ ·ä¹‹åå°±å¯ä»¥ä½¿ç”¨å¯†ç ç™»å½•äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;PUT https://api.zhihu.com/account/password
new_password=xxxxxx
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 04:58:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/zhi-hu-yi-dong-duan-jie-kou-fen-xi.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>ç‚’è‚¡è®°</title><link>/posts/chao-gu-ji.html</link><description>&lt;p&gt;è€å©†æ€»æ˜¯å¿µå¨ç€è¦ç‚’è‚¡ï¼Œç»è¿‡ä¸€ç•ªç§‘å­¦åˆ†æï¼Œåˆšå¼€å§‹è¿˜èµšäº†å‡ åƒã€‚ä¸è¿‡å› ä¸ºå¬ä¿¡äº†å¡‘æ–™å§å¦¹èŠ±çš„ä¼ è¨€ï¼Œä¹°äº†å‡ åªä¼ è¯´è¦ç–¯é•¿çš„è‚¡ç¥¨ï¼ŒæŠŠèµšè¿›æ¥çš„å…¨éƒ½èµ”äº†å›å»ã€‚å¤©å¤©çœ‹ç€è¢«å¥—ç‰¢å¾ˆçƒ¦ï¼Œç„¶åå¥¹æŠŠè´¦æˆ·ç»™äº†æˆ‘ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œä¸è¦ç›¸ä¿¡æ‰€è°“çš„å†…éƒ¨æ¶ˆæ¯ï¼Œè¦è‡ªå·±åˆ†ææ‰å¥½ã€‚&lt;/p&gt;
&lt;p&gt;A è‚¡æ²¡æœ‰ä»€ä¹ˆäº’è”ç½‘ä¼ä¸šã€‚&lt;/p&gt;
&lt;p&gt;A è‚¡çš„ç™½è‰²å®¶ç”µè‚¡ç¥¨ä¸é”™ï¼ŒåŒ…æ‹¬äº†æ ¼åŠ›ã€ç¾çš„ã€æµ·å°”ã€‚å…¶ä¸­æ ¼åŠ›å› ä¸ºæ²¡æœ‰åˆ†çº¢å¯¼è‡´è‚¡ç¥¨æš´è·Œï¼Œåº”è¯¥å¾ˆå¿«å°±ä¼šæ¢å¤åŸæ¥çš„ä»·æ ¼ã€‚ç¾çš„æ”¶è´­äº†å¾·å›½çš„å·¥ä¸šæœºå™¨äººå…¬å¸ï¼Œé•¿æœŸçœ‹å¥½ã€‚&lt;/p&gt;
&lt;p&gt;äº¬ä¸œæ–¹A ä½œä¸ºæ”¿åºœæ‰¶æŒçš„æ¶²æ™¶é¢æ¿å…¬å¸ï¼Œåº”è¯¥ä¸šç»©ä¸ä¼šå¾ˆå·®ã€‚&lt;/p&gt;
&lt;p&gt;ç´«å…‰çš„ RAM ç”Ÿäº§çº¿ä¸çŸ¥é“ä½•æ—¶æ‰èƒ½ä¸‹çº¿ï¼Œåº”è¯¥æ—¶åˆ»å…³æ³¨ç›¸å…³æ–°é—»&lt;/p&gt;
&lt;p&gt;æµ·å¤©é…±æ²¹ä½œä¸ºè¡Œä¸šçš„é¾™å¤´ï¼Œè¿‘å‡ å¹´å‘å±•ä¸€ç›´ä¸é”™ï¼Œçœ‹å¥½ã€‚&lt;/p&gt;
&lt;p&gt;æ±½è½¦æ¿å—ä¹Ÿå€¼å¾—å…³æ³¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰ä¸€ç›´è§‰å¾—åƒæ˜¯"XXè¦æAIï¼Œä¸ºäº†æå‡è‚¡ä»·"è¿™ç§æ–°é—»éƒ½æ„Ÿè§‰å¾ˆå‡ï¼Œä½†æ˜¯ç°åœ¨å‘ç°çš„ç¡®æ˜¯è¿™æ ·çš„ï¼Œå¯¹äºä¸äº†è§£è¡Œä¸šçš„å°ç™½æ¥è¯´ï¼Œç«™ä¸Šè¿™äº›åè¯çš„ç¡®å¥½åƒæ˜¾å¾—å…¬å¸æœ‰å‰é€”ï¼Œæ‰€ä»¥å°ç™½æ´»è¯¥è¢«å¥—å•Šã€‚è¿™ä¹Ÿæé†’æˆ‘ä»¬ï¼Œä¸è¦ç¢°è‡ªå·±ä¸äº†è§£æˆ–è€…æ²¡æœ‰ç ”ç©¶è¿‡çš„è¡Œä¸šã€‚&lt;/p&gt;
&lt;p&gt;è¦ä¹°é•¿æœŸçœ‹å¥½çš„è‚¡ç¥¨ï¼Œè¿™æ ·å¦‚æœä¸Šæ¶¨çš„è¯å½“ç„¶æœ€å¥½ï¼Œå³ä½¿çŸ­æš‚ä¸‹è·Œï¼Œä¹Ÿå¯ä»¥æœ‰è§£å¥—çš„æœºä¼šã€‚&lt;/p&gt;
&lt;p&gt;2018-11-28 æ›´æ–°&lt;/p&gt;
&lt;p&gt;ç‹—æ—¥çš„è´¸æ˜“æˆ˜å•Šï¼Œä½ å¦¹çš„å·æ™®&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 04:43:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/chao-gu-ji.html</guid><category>ç”Ÿæ´»</category></item><item><title>OAuth2 åè®®è¯¦è§£</title><link>/posts/oauth2-xie-yi-xiang-jie.html</link><description>&lt;p&gt;ä»Šå¤©æœ‰ä¸ªé¡¹ç›®éœ€è¦ç”¨åˆ° OAuth2 æ¥å¤„ç†ä¸€äº›ä¸œè¥¿ï¼Œç„¶è€Œä¸­æ–‡äº’è”ç½‘æœ‰æ—¶å€™çœŸæ˜¯å¾ˆéš¾æ‰¾åˆ°åƒæ ·çš„æ–‡æ¡£ï¼Œæœç´¢ â€œOAuth æ•™ç¨‹â€ çš„åˆ°æ’åå‰ä¸¤ä½çš„&lt;a href="https://aaronparecki.com/oauth-2-simplified/"&gt;æ•™&lt;/a&gt;&lt;a href="https://aaronparecki.com/oauth-2-simplified/"&gt;ç¨‹&lt;/a&gt;éƒ½æ˜¯ç¿»è¯‘è‡ªä¸€ä¸ªè‹±æ–‡æ•™ç¨‹ï¼Œç¿»è¯‘è´¨é‡å¥‡å·®æ— æ¯”å°±ä¸è¯´äº†ï¼Œè¿™ä¸ªè‹±æ–‡æ•™ç¨‹æœ¬èº«å°±æ˜¯æœ‰é—®é¢˜çš„ï¼Œæ— å¥ˆåªå¥½æœç´¢ â€œOAuth tutorialâ€ æ‰æ‰¾åˆ°å‡ ä¸ªçœ‹å¾—è¿‡å»çš„è‹±æ–‡æ•™ç¨‹ï¼Œæ€»ç»“ä¸€ä¸‹æ”¾åœ¨è¿™é‡Œï¼Œç®—æ˜¯ä¸ºä¸­æ–‡äº’è”ç½‘å¼•å…¥ä¸€äº›æ­£ç¡®çš„çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹åˆ° OAuth2 è¿™ä¸ªè¯ï¼Œä¸€èˆ¬äººè‚¯å®šä¼šæƒ³ï¼Œæ˜¯ä¸æ˜¯è¿˜æœ‰ä¸ª OAuth 1 åè®®å‘¢ï¼Ÿæ˜¯çš„ï¼Œæœ‰ OAuth 1 åè®®ï¼Œä½†æ˜¯å› ä¸ºåè®®æå¾—å¤ªå¤æ‚äº†ï¼Œæ‰€ä»¥æ²¡äººç”¨ï¼Œå¸‚é¢ä¸Šçš„åŸºæœ¬éƒ½æ˜¯æ ¹æ® OAuth 2 æ¥çš„ã€‚æ—¢ç„¶å®é™…åªæœ‰ä¸€ä¸ª OAuthï¼Œä»¥ä¸‹å°±ç®€ç§° OAuth äº†ã€‚&lt;/p&gt;
&lt;h1&gt;ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ OAuth â€”â€” ä¸€ä¸ªä¾‹å­&lt;/h1&gt;
&lt;p&gt;å¤§å®¶æœ€ç†Ÿæ‚‰çš„ä¾‹å­å°±æ˜¯ç¬¬ä¸‰æ–¹ç™»å½•äº†ã€‚å‡è®¾æœ‰ä¸ªè®ºå›å«åšâ€œ91è®ºå›â€ä½ æ²¡æœ‰æ³¨å†Œè¿‡ï¼Œä¹Ÿæ‡’å¾—å¡«å†™é‚®ç®±ï¼Œç„¶åéªŒè¯é‚®ç®±æ³¨å†Œï¼Œé‚£ä¹ˆè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ QQ ç™»å½•ï¼Œå½“ç„¶å›½å¤–å¯èƒ½æ˜¯ Facebookã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå½“ä½ ç‚¹å‡» â€œç”¨ QQ ç™»å½•â€ è¿™ä¸ªæŒ‰é’®çš„æ—¶å€™ï¼Œè®ºå›æ€ä¹ˆå®‰å…¨åœ°çŸ¥é“ä½ ä½¿ç”¨çš„æ˜¯å“ªä¸ª QQ å·å‘¢ï¼Ÿä¼šæœ‰ä¸‹é¢å‡ ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœä½ éšä¾¿è¾“å…¥ä¸€ä¸ª QQ å·ï¼Œç„¶å91è®ºå›å°±ä¿¡ä»»äº†ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥ä¼ªé€ ä»»æ„çš„ QQ ç”¨æˆ·äº†ï¼Œæ‰€ä»¥è®ºå›éœ€è¦å»å‘ QQ éªŒè¯ä½ æ˜¯å¦æ˜¯ä½ æä¾›çš„ QQ å·çš„æ‰€æœ‰è€…ã€‚&lt;/li&gt;
&lt;li&gt;ä½ å¯ä»¥æä¾›ç»™è®ºå›ä½ çš„ QQ å·å’Œå¯†ç ï¼Œè¿™æ ·è®ºå›ä½¿ç”¨ä½ çš„ QQ å·å’Œå¯†ç æµ‹è¯•ä¸€ä¸‹èƒ½å¦ç™»å½•å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¿™æ ·è®ºå›å°±æœ‰äº†ä½ QQå·çš„æ‰€æœ‰æƒé™ï¼Œå¦‚æœè®ºå›å·å·åœ¨ä½ çš„ QQ ç©ºé—´å‘æ¨å¹¿æ¶ˆæ¯å‘¢ï¼Ÿæ‰€ä»¥ä½ ä¸å¸Œæœ›ç›´æ¥æŠŠ QQ å·å’Œå¯†ç éƒ½å‘Šè¯‰è®ºå›ã€‚&lt;/li&gt;
&lt;li&gt;ç°åœ¨é™·å…¥äº†ä¸¤éš¾å¢ƒç•Œï¼Œè®ºå›æ— æ³•ä¿¡ä»»ä½ åªæä¾› QQ å·ï¼Œä½ ä¹Ÿä¸èƒ½ä¿¡ä»»è®ºå›æ‹¿èµ°ä½ çš„è´¦æˆ·å¯†ç ã€‚å¦‚æœè¿™æ—¶å€™èƒ½è®© QQ ä½œä¸ºä¸­é—´äººåªæä¾›ç»™è®ºå›éƒ¨åˆ†ä¿¡æ¯å°±å¥½äº†ï¼ŒOAuth å°±æ˜¯ç”¨æ¥åšè¿™ä¸ªçš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;OAuth2&lt;/h1&gt;
&lt;p&gt;ç®€å•æ¥è¯´ï¼Œæ–¹æ¡ˆå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;91 è®ºå›åœ¨QQä¸Šæ³¨å†Œä¸€ä¸ªapp&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·åœ¨QQä¸Šç™»å½•ï¼Œé€šè¿‡è·³è½¬ï¼ŒæŠŠä¸€ä¸ªä¸€æ¬¡æ€§æˆæƒç ç»™ 91 è®ºå›&lt;/li&gt;
&lt;li&gt;è®ºå›åˆ©ç”¨è¿™ä¸ªæˆæƒç è·å¾— access tokenï¼Œç„¶ååˆ©ç”¨è¿™ä¸ª token è¯»å–ç”¨æˆ·ä¿¡æ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…·ä½“è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;91è®ºå›çš„å¼€å‘è€…åœ¨ QQ å¤„ç”³è¯·ä¸€ä¸ªå¼€å‘è€…è´¦æˆ·ï¼Œè·å¾—ä¸€ä¸ªå¼€å‘è€…æ ‡è¯†ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªå›è°ƒæ¥å£ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;{
    'client_id': 91bbs,
    'client_secret': 123456,
    'callback': "http://91bbs.com/login_callback"
}&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½ åœ¨91è®ºå›ä¸Šç‚¹å‡»ç”¨ QQ ç™»å½•ï¼Œç„¶åé¡µé¢è·³è½¬åˆ° QQ åŸŸ(qq.com)ä¸‹ï¼Œè¿™æ ·ä½ å¯ä»¥å®‰å…¨çš„è¾“å…¥ QQ å¯†ç ï¼Œè€Œä¸ç”¨è¢«91è®ºå›çŸ¥é“ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨ QQ ç™»å½•å¯¹åº”çš„åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;https://api.qq.com/v1/auth?
response_type=code&amp;amp;
client_id=91bbs&amp;amp;
callback=http://91bbs.com/login_callback&amp;amp;
scope=read&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„å…¶ä¸­æ ‡è¯†äº†è®ºå›åœ¨ä¸Šä¸€æ­¥ client_idã€‚åœ¨è¿™ä¸ªé¡µé¢ä¸Šå¯èƒ½å†™ç€ä½ æ˜¯å¦æˆæƒXXè®ºå›è®¿é—®ä½ çš„ä¸ªäººä¿¡æ¯ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;response_type è¡¨ç¤ºæˆæƒçš„ç±»å‹ï¼Œåé¢ä¼šè®²åˆ°&lt;/li&gt;
&lt;li&gt;client_id å‘ QQ è¡¨æ˜æ˜¯è¦ç™»å½•91è®ºå›è¿™ä¸ªç½‘ç«™&lt;/li&gt;
&lt;li&gt;callback æŒ‡æ˜äº†ä¸‹ä¸€æ­¥QQè¦å›è°ƒ91è®ºå›çš„åœ°å€&lt;/li&gt;
&lt;li&gt;scope æŒ‡å®šäº†å½“å‰æˆæƒçš„æƒé™èŒƒå›´&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç™»å½•QQåï¼Œç‚¹å‡»æˆæƒé€šè¿‡ï¼Œç„¶å QQ ä¼šæŠŠä½ é‡å®šå‘åˆ° redirect_uri å¯¹åº”çš„é¡µé¢ï¼Œå¹¶é™„åŠ å‚æ•° code=xxxï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªä¸´æ—¶çš„ä¸€æ¬¡æ€§æˆæƒç ã€‚&lt;/p&gt;
&lt;p&gt;é‡å®šå‘åˆ°çš„é¡µé¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://91bbs.com/login_callback&amp;amp;code=xxxxxx&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è®¿é—®è¿™ä¸ªé¡µé¢ï¼Œå°±ä¼šæŠŠè¿™ä¸ª code ä¼ é€’ç»™91è®ºå›ï¼Œä½†æ˜¯91è®ºå›æœ‰äº†è¿™ä¸ª code è¿˜ä¸èƒ½ç›´æ¥å‘ QQ è¯¢é—®å…³äºä½ çš„å…·ä½“ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;91è®ºå›ä½¿ç”¨è¿™ä¸ª code å‘ QQ ç”³è¯·ä¸€ä¸ª access tokenï¼Œä½¿ç”¨è¿™ä¸ª access token å°±å¯ä»¥è·å–ä½ çš„ QQ å·ç­‰ä¿¡æ¯ï¼Œå…·ä½“è·å¾—ä»€ä¹ˆä¿¡æ¯ï¼Œæ˜¯åœ¨ç¬¬äºŒæ­¥çš„ scope é¡µé¢æŒ‡å®šçš„ã€‚&lt;/p&gt;
&lt;p&gt;è®¿é—®ï¼š
&lt;code&gt;POST https://api.qq.com/v1/token
grant_type=authorization_code&amp;amp;
code=AUTH_CODE_HERE&amp;amp;
redirect_uri=REDIRECT_URI&amp;amp;
client_id=CLIENT_ID&amp;amp;
client_secret=CLIENT_SECRET&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„å…¶ä¸­çš„å‚æ•°ï¼š
1. grant_type æŒ‡å®šäº†æˆæƒçš„ç±»å‹ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸Šä¸€æ­¥è·å¾—çš„ authorization code æ¥è·å– access tokenï¼Œæ‰€ä»¥grant type å°±æ˜¯ authorization code
2. code å°±æ˜¯ä¸Šä¸€æ­¥è·å¾—çš„ authorization code
3. å…¶ä»–å‚æ•°å’Œä¸Šä¸€æ­¥ç±»ä¼¼&lt;/p&gt;
&lt;p&gt;QQ è¿”å›ç»™ 91 è®ºå›çš„ä¿¡æ¯ï¼š
&lt;code&gt;{
    "access_token":"ACCESS_TOKEN",
    "token_type":"bearer",
    "expires_in":2592000,
    "refresh_token":"REFRESH_TOKEN",
    "scope":"read",
}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºè¿™ä¸ª access token å¯ä»¥éšæ—¶ç”¨æ¥è®¿é—®ä½ çš„ä¿¡æ¯ï¼Œæ‰€ä»¥è®¾å®šäº†è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·å³ä½¿æ³„éœ²äº†æ”»å‡»çš„æ—¶é—´çª—å£ä¹Ÿä¸ä¼šå¾ˆé•¿ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;91è®ºå›ä½¿ç”¨ access token è®¿é—®ä½ çš„ä¿¡æ¯ã€‚access token é€šå¸¸æ˜¯æ”¾åœ¨ &lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization"&gt;Authorization&lt;/a&gt; è¿™ä¸ª header ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä½¿ç”¨ curl æ¥è¡¨ç¤ºè¿™ä¸ªè®¿é—®ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;curl -H 'Authorization: Bearer 1.1Zgwxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx=' \
'http://api.qq.com/v1/user/123456'&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœ token æ­£ç¡®æ— è¯¯çš„è¯ï¼ŒQQ æœåŠ¡å™¨ä¼šè¿”å›ç›¸åº”çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è®ºå›æ ¹æ®ä» QQ æœåŠ¡å™¨å¾—åˆ°çš„æ¶ˆæ¯ï¼Œä»è€ŒçŸ¥é“ä½ çœŸçš„æ˜¯ QQ ä¸º 123456 çš„ç”¨æˆ·ï¼Œç„¶åä¸ºä½ åˆ›å»ºè´¦æˆ·ã€‚ä»¥åä½ éœ€è¦ç™»å½•ä¹Ÿå¯ä»¥é‡å¤ä¸Šé¢çš„æµç¨‹ï¼Œè¯æ˜ä½ çš„ç¡®æ˜¯ QQ 123456 çš„ç”¨æˆ·å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;OAuth ä¸­çš„æœ¯è¯­&lt;/h1&gt;
&lt;p&gt;åœ¨ä¸Šé¢çš„è¿‡ç¨‹ä¸­ï¼Œä¸€å…±å‡ºç°äº†å››ä¸­è§’è‰²ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¬¬ä¸‰æ–¹ç¨‹åºï¼Œä¹Ÿå°±æ˜¯ 91è®ºå›&lt;/li&gt;
&lt;li&gt;èµ„æºæ‰€æœ‰äººï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·&lt;/li&gt;
&lt;li&gt;æˆæƒæœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯ QQ&lt;/li&gt;
&lt;li&gt;èµ„æºæœåŠ¡å™¨ï¼Œè¿˜æ˜¯ QQ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…¶ä¸­èµ„æºæŒ‡çš„å°±æ˜¯ç”¨æˆ·çš„ QQ ä¿¡æ¯ï¼Œè€ŒæˆæƒæœåŠ¡å™¨å’Œèµ„æºæœåŠ¡å™¨åœ¨å¤æ‚çš„ç»“æ„ä¸­å¾€å¾€æ˜¯åˆ†å¼€çš„ã€‚&lt;/p&gt;
&lt;h1&gt;å…¶ä»–çš„æˆæƒç±»å‹&lt;/h1&gt;
&lt;p&gt;é™¤äº†ä¸Šé¢è¯´è¿‡æˆæƒç±»å‹ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å¾®å°å·®å¼‚çš„æˆæƒç±»å‹ï¼Œæ¯”å¦‚ implict æˆæƒï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚&lt;/p&gt;
&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨è´¦æˆ·å¯†ç è·å¾— access tokenï¼Œæ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œä¸€èˆ¬ç”¨äºå®˜æ–¹å®¢æˆ·ç«¯ç›´æ¥ç™»å½•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;POST https://api.authorization-server.com/token
  grant_type=password&amp;amp;
  username=USERNAME&amp;amp;
  password=PASSWORD&amp;amp;
  client_id=CLIENT_ID
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“ access token è¿‡æœŸåï¼Œè¿˜å¯ä»¥ä½¿ç”¨ refresh token åˆ·æ–°ï¼Œè·å¾—æ–°çš„æœ‰æ•ˆçš„ access tokenï¼Œè€Œä¸éœ€è¦ç”¨æˆ·å†æ¬¡ç™»å½•ã€‚è™½ç„¶ refresh token æ²¡æœ‰è¿‡æœŸæ—¶é—´ï¼Œæˆ–è€…è¿‡æœŸæ—¶é—´è¿œæ¯” access token é•¿ï¼Œä½†æ˜¯å› ä¸ºä½¿ç”¨æ¬¡æ•°å°‘ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ç›¸å¯¹æ¯”è¾ƒå®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;POST https://cloud.digitalocean.com/v1/oauth/token?
grant_type=refresh_token&amp;amp;
client_id=CLIENT_ID&amp;amp;
client_secret=CLIENT_SECRET&amp;amp;
refresh_token=REFRESH_TOKEN
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://aaronparecki.com/oauth-2-simplified/"&gt;OAuth2 Simplified&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2"&gt;Introduction to OAuth2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://medium.com/@bantic/more-oauth-2-0-surprises-the-refresh-token-1831d71f4af6"&gt;Refresh token&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 04:41:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/oauth2-xie-yi-xiang-jie.html</guid><category>HTTP</category><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>æ¶ˆæ¯é˜Ÿåˆ—ï¼šä»ä¸€è„¸æ‡µé€¼åˆ° Kafka</title><link>/posts/xiao-xi-dui-lie-cong-yi-lian-meng-bi-dao-kafka.html</link><description>&lt;p&gt;æ¶ˆæ¯é˜Ÿåˆ—æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åˆ†ç¦»è§£è€¦ã€å‰Šå³°å¡«è°·ã€æ¨ªå‘æ‰©å±•çš„ä¸€ä¸ªåˆ©å™¨ã€‚è€Œå…¶ä¸­å°¤å…¶ä»¥ kafka ä¸ºä»£è¡¨ï¼Œåœ¨æ€§èƒ½ç­‰å„æ–¹é¢éƒ½å¾ˆå‡ºä¼—ã€‚&lt;/p&gt;
&lt;p&gt;Kafka ä½¿ç”¨ ZK ä½œä¸ºåè°ƒå™¨ï¼ŒåŸç”Ÿæ”¯æŒé›†ç¾¤ã€‚æ¯æ¡æ¶ˆæ¯æœ‰ä¸€ä¸ª &lt;key, value, timestamp&gt; ç»„æˆã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ª partition å¯ä»¥æœ‰å¤šå°æœºå™¨ï¼Œå…¶ä¸­çš„ leader è´Ÿè´£æ‰€æœ‰è¯»å†™ï¼Œè€Œ follower å¤åˆ¶ leader çš„æ‰€æœ‰æ“ä½œã€‚å¦‚æœ leader æŒ‚äº†ï¼Œ follower å°±ä¼šé¡¶ä¸Šå»ã€‚ç”Ÿäº§è€…æ—¢å¯ä»¥ä½¿ç”¨ RR è¿™äº›ç®—æ³•æ¥å¾€ä¸åŒçš„ partition å‘ä¸œè¥¿ï¼Œåšè´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§æŸäº›ä¸šåŠ¡è§„åˆ™ï¼Œå‘åˆ°æŒ‡å®šçš„ partitionã€‚&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯é˜Ÿåˆ—æœ‰ä¸¤ç§æ¨¡å‹ï¼ŒQueue å’Œ PubSubã€‚Kafka é€šè¿‡ Consumer Group è¿™ä¸ªæ¦‚å¿µå¾ˆå¥½åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜&lt;/p&gt;
&lt;h1&gt;æœ¯è¯­&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Term&lt;/th&gt;
&lt;th&gt;Explain&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Broker&lt;/td&gt;
&lt;td&gt;Kafka é›†ç¾¤ä¸­çš„æœºå™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Topic&lt;/td&gt;
&lt;td&gt;ä¸åŒçš„æ¶ˆæ¯é˜Ÿåˆ—&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Partition&lt;/td&gt;
&lt;td&gt;æ¯ä¸ª topic è¢«åˆ†æˆä¸åŒçš„åˆ†åŒº&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Producer&lt;/td&gt;
&lt;td&gt;ç”Ÿäº§è€…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Consumer&lt;/td&gt;
&lt;td&gt;æ¶ˆè´¹è€…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Consumer Group&lt;/td&gt;
&lt;td&gt;æ¶ˆè´¹ç»„ï¼Œæ¯ä¸ªæ¶ˆè´¹ç»„å¯¹äºåŒä¸€æ¡æ¶ˆæ¯ï¼Œåªæ¶ˆè´¹ä¸€æ¬¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;Basics&lt;/h1&gt;
&lt;p&gt;Kafka éå¸¸å¼ºå¤§ï¼ŒåŸºæœ¬å®ç°äº†ä¸€ä¸ªåç«¯å·¥ç¨‹å¸ˆå¯¹æ¶ˆæ¯é˜Ÿåˆ—çš„æ‰€æœ‰å¹»æƒ³ã€‚excat once è¯­ä¹‰ã€æ¶ˆæ¯æ˜¯åŸºæœ¬æœ‰åºçš„ã€å¯ä»¥å›æ”¾æ¶ˆæ¯ï¼ˆrewindï¼‰ã€‚å”¯ä¸€çš„ä¸€ä¸ªè‡´å‘½ç¼ºç‚¹æ˜¯ï¼šéƒ¨ç½²å®åœ¨å¤ªå¤æ‚äº†ï¼Œä¸å…‰æ˜¯è¦ä¾èµ– zookeeperï¼Œè€Œä¸”è¿˜æœ‰å…¶ä»–è´Ÿè½½çš„éƒ¨ç½²æ­¥éª¤ã€‚å¦å¤– kafka å¯¹å†…å­˜çš„éœ€æ±‚ä¸å°ï¼Œå®˜æ–¹å»ºè®®ä¸è¦å°äº 32Gï¼Œä¸è¿‡å¯¹äºä¼ä¸šæ¥è¯´è¿™ä¹Ÿä¸æ˜¯ä»€ä¹ˆé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ kafka æœ¬èº«èƒ½å¤Ÿåšåˆ° exactly once è¯­ä¹‰ï¼Œ&lt;/p&gt;
&lt;p&gt;Like many publish-subscribe messaging systems, Kafka maintains feeds of messages
in topics. Producers write data to topics and consumers read from topics. Since
Kafka is a distributed system, topics are partitioned and replicated across
multiple nodes.[1]&lt;/p&gt;
&lt;p&gt;What makes Kafka unique is that Kafka treats each topic partition as aÂ logÂ (an
ordered set of messages).Â Messages are stored as file in each partition and new
messages are appended to the file, which is very fast op for hard disk(even
faster than RAM access).&lt;/p&gt;
&lt;p&gt;Kafka retains all messages for a set amount of time, and consumers are
responsible to track their location in each log. Consequently, Kafka can support
a large number of consumers and retain large amounts of data with very little
overhead. Thus, consumers can rewind to a old message, which is very useful in
practice.&lt;/p&gt;
&lt;p&gt;There is no message ids in kafka, message is identified by offset. messages are
appended to each partition. Hard dist appendation can be veri fast, even faster
than RAM access, which is why kafka&lt;/p&gt;
&lt;p&gt;messages with the same key are sent to the same partition&lt;/p&gt;
&lt;h1&gt;Consumer Group&lt;/h1&gt;
&lt;p&gt;kafka implements broadcast and unicast by Consumer Group. If one message is
consumed by only one consumer, then it's a unicast, otherwise, it's a broadcast.&lt;/p&gt;
&lt;p&gt;offsets in one partition are stored in ZooKeeper. each Consumer Group has its
own offset. Consumer Group are globally in Kafka, not constrained to one topic.
by default, a consumer is in the default group.&lt;/p&gt;
&lt;p&gt;each message can be consumed only once for one consumer group.&lt;/p&gt;
&lt;p&gt;messages in partitions are not equally distributed to each consumer, they are
just simply fixed to one consumer. which is easy to implement and more
efficient.&lt;/p&gt;
&lt;h1&gt;Python å®¢æˆ·ç«¯&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ confluent-python-kafkaã€‚æ€§èƒ½æœ€å¥½ï¼Œè€Œä¸”æ˜¯å®˜æ–¹å®¢æˆ·ç«¯ã€‚Kafka-python è¿™ä¸ªåº“å¯èƒ½ä¸¢æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;h1&gt;ç®¡ç†å·¥å…·&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨å‘½ä»¤è¡Œç®¡ç† Kafka åŠŸèƒ½æœ€å…¨é¢ä¹Ÿæœ€å¼ºå¤§ï¼Œä½†æ˜¯å› ä¸ºå‘½ä»¤ä¸å¸¸ç”¨ï¼Œæ‰€ä»¥ä¹Ÿè¦ç»å¸¸æŸ¥æ–‡æ¡£ã€‚è€Œå›¾å½¢ç•Œé¢è™½ç„¶ä¸æ˜¯å¾ˆé«˜æ•ˆï¼Œä½†æ˜¯å¯¹äºå¶å°”ä½¿ç”¨æ¥è¯´ï¼Œè¿˜æ˜¯æœ€æ–¹ä¾¿çš„ã€‚&lt;/p&gt;
&lt;h1&gt;Q&amp;amp;A&lt;/h1&gt;
&lt;h2&gt;kafka ä¸­å¯ä»¥æœ‰æˆåƒä¸Šä¸‡çš„ topic å—ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸å¯ä»¥ã€‚å› ä¸º leader é€‰ä¸¾çš„ä¸€äº›é™åˆ¶ï¼Œä¸Šä¸‡éƒ½ä¸å¯èƒ½ã€‚æœ€å¥½çš„æ–¹å¼å®åœ¨ topic ä¸­åˆ† partitionã€‚åˆ† partition åˆæ˜¯é™æ€çš„ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/32950503/can-i-have-100s-of-thousands-of-topics-in-a-kafka-cluser&lt;/li&gt;
&lt;li&gt;https://grokbase.com/t/kafka/users/133v60ng6v/limit-on-number-of-kafka-topic&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Kafka ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ç¡¬ç›˜é¡ºåºè¯»å†™å¯ä»¥è¾¾åˆ° 600 MiB/s çš„é€Ÿåº¦ï¼Œè€Œéšæœºè¯»å†™åªæœ‰ 100 KiB/sï¼Œä¹Ÿå°±æ˜¯è¯´ 6000 å€çš„å·®è·ã€‚ç”šè‡³äºé¡ºåºè¯»å†™æ¯”å†…å­˜è®¿é—®è¿˜è¦å¿«ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ sendfile å¯ä»¥ä½¿æ•°æ®ç›´æ¥ä» page cache å‘é€åˆ°ç½‘å¡ï¼Œé¿å…äº†æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´çš„å¼€é”€ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://kafka.apache.org/documentation/#design_filesystem&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;push vs pull&lt;/h2&gt;
&lt;p&gt;Push æŒ‡çš„æ˜¯ broker å‘æ¶ˆè´¹ç«¯æ¨é€æ¶ˆæ¯ï¼Œè€Œ pull æŒ‡çš„æ˜¯æ¶ˆè´¹è€…ä¸»åŠ¨ä» Consumer ä¸­æ‹‰å–æ¶ˆæ¯ã€‚Kafka é‡‡ç”¨äº† pull æ¨¡å‹ã€‚å¦‚æœæ¶ˆè´¹è€…å¤„ç†ä¸è¿‡æ¥äº†å°±å †åœ¨ Kafka ä¸­ï¼Œå½“å¤„ç†èƒ½åŠ›è·Ÿä¸Šæ¥äº†å†ä¸»åŠ¨è¿½ä¸Šå°±å¥½äº†ã€‚&lt;/p&gt;
&lt;h1&gt;å…¶ä»–&lt;/h1&gt;
&lt;h2&gt;nsq&lt;/h2&gt;
&lt;p&gt;topic: å‘å¸ƒæ¶ˆæ¯çš„ç®¡é“ï¼Œç¬¬ä¸€æ¬¡å‘æŸä¸ªtopicå‘æ¶ˆæ¯å°±ä¼šåˆ›å»ºå®ƒ.
channel: æ¶ˆè´¹æ¶ˆæ¯çš„ç®¡é“ï¼Œä¸€ä¸ª topic å¯ä»¥å¯¹åº”å‡ ä¸ª channelï¼Œæ¯ä»½æ¶ˆæ¯éƒ½ä¼šå¤åˆ¶åˆ°æ¯ä¸ªchannel ä¸­
messageï¼šæ¶ˆæ¯&lt;/p&gt;
&lt;p&gt;nsq å»ºè®® co-location çš„éƒ¨ç½²ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¯ä¸ªå‘é€nsqæ¶ˆæ¯çš„æœºå™¨ä¸Šéƒ¨ç½²ä¸€ä¸ª nsqd&lt;/p&gt;
&lt;h2&gt;nsq çš„ç¼ºç‚¹&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ¶ˆæ¯ä¸æ˜¯ exact onceï¼Œå¯èƒ½æœ‰é‡å¤æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯ä¸èƒ½ä¿è¯é¡ºåº&lt;/li&gt;
&lt;li&gt;æ¶ˆæ¯å¯èƒ½ä¸¢ï¼Œæ²¡æœ‰ç¡¬ç›˜æŒä¹…åŒ–&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;redis stream&lt;/h2&gt;
&lt;p&gt;redis stream çœ‹èµ·æ¥å¾ˆå¥½ï¼Œä½†æ˜¯å®é™…ä¸Šç”¨å¤„å´ä¸å¤§ã€‚redis stream è™½ç„¶æ¨¡ä»¿äº† kafka çš„æ¶ˆæ¯æ¨¡å‹ï¼Œä½†æ˜¯ kafka çš„å¼ºåŠ¿åœ¨äºæ¶ˆæ¯å †ç§¯èƒ½åŠ›ï¼Œè€Œ redis stream æŠŠæ¶ˆæ¯æ”¾åœ¨å†…å­˜é‡Œï¼Œä¹Ÿæ²¡æœ‰å¾ˆå¥½çš„ replica æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h1&gt;Reference:&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://segment.com/blog/scaling-nsq/&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blog.cloudera.com/blog/2014/09/apache-kafka-for-beginners/"&gt;Apache Kafka for beginners&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;http://lihaoquan.me/2016/6/20/using-nsq.html&lt;/li&gt;
&lt;li&gt;Kafka Tutorial https://www.tutorialspoint.com/apache_kafka/apache_kafka_basic_operations.htm&lt;/li&gt;
&lt;li&gt;http://www.infoq.com/cn/news/2015/02/nsq-distributed-message-platform&lt;/li&gt;
&lt;li&gt;https://danielmiessler.com/blog/data-processing-using-the-unix-philosophy/&lt;/li&gt;
&lt;li&gt;http://www.confluent.io/blog/apache-kafka-samza-and-the-unix-philosophy-of-distributed-data&lt;/li&gt;
&lt;li&gt;http://sookocheff.com/post/kafka/kafka-in-a-nutshell/&lt;/li&gt;
&lt;li&gt;https://www.infoq.cn/article/2017/09/kafka-python-confluent-kafka&lt;/li&gt;
&lt;li&gt;https://www.confluent.io/blog/introduction-to-apache-kafka-for-python-programmers/&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;TO READ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/49276785/monitoring-ui-for-apache-kafka-kafka-manager-vs-kafka-monitor/49292872&lt;/li&gt;
&lt;li&gt;https://kafka.apache.org/quickstart&lt;/li&gt;
&lt;li&gt;https://cwiki.apache.org/confluence/display/KAFKA/Ecosystem&lt;/li&gt;
&lt;li&gt;https://zhuanlan.zhihu.com/p/37016944&lt;/li&gt;
&lt;li&gt;https://www.confluent.io/blog/introduction-to-apache-kafka-for-python-programmers/&lt;/li&gt;
&lt;li&gt;https://github.com/confluentinc/confluent-kafka-python/tree/master/examples&lt;/li&gt;
&lt;li&gt;https://docs.confluent.io/current/clients/confluent-kafka-python/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 04:35:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/xiao-xi-dui-lie-cong-yi-lian-meng-bi-dao-kafka.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>å¦‚ä½•ç ´è§£è¢« JS åŠ å¯†çš„æ•°æ®</title><link>/posts/ru-he-po-jie-bei-js-jia-mi-de-shu-ju.html</link><description>&lt;p&gt;ç”±äºç½‘é¡µå’ŒJavaScriptéƒ½æ˜¯æ˜æ–‡çš„ï¼Œå¯¼è‡´å¾ˆå¤šAPIæ¥å£éƒ½ç›´æ¥æš´éœ²åœ¨çˆ¬è™«çš„çœ¼é‡Œï¼Œæ‰€ä»¥å¥½å¤š
ç½‘ç«™é€‰æ‹©ä½¿ç”¨æ··æ·†åçš„ JavaScript æ¥åŠ å¯†æ¥å£ã€‚å…¶ä¸­æœ‰åˆ†ä¸ºä¸¤å¤§ç±»ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡ JavaScript è®¡ç®—ä¸€ä¸ªå‚æ•°æˆ–è€… Cookie ä½œä¸ºæ¥å£çš„ç­¾åéªŒè¯&lt;/li&gt;
&lt;li&gt;è¿”å›çš„æ•°æ®æ˜¯åŠ å¯†çš„ï¼Œéœ€è¦ä½¿ç”¨ JavaScript è§£å¯†&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸è¿‡æ€»çš„æ¥è¯´ï¼Œè¿™ä¸¤ç§åŠ å¯†çš„ç ´è§£æ€è·¯éƒ½æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰¾åˆ°ç›¸å…³çš„ç½‘ç»œè¯·æ±‚ã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œæ¸…ç©ºç¼“å­˜ï¼Œå°è¯•è§¦å‘&lt;/li&gt;
&lt;li&gt;æ‰“æ–­ç‚¹æ‰¾åˆ°ç›¸å…³ä»£ç ï¼Œå¯ä»¥æ˜¯ ajax æ–­ç‚¹æˆ–è€… js æ–­ç‚¹ã€‚æˆ–è€…ç›´æ¥çœ‹ç½‘ç»œè¯·æ±‚çš„
   initiator&lt;/li&gt;
&lt;li&gt;é€å±‚åˆ†æï¼Œæ‰¾åˆ°åŠ å¯†å‡½æ•°&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ node æ‰§è¡Œjsä»£ç è·å¾—æ•°æ®&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;å…·ä½“æ­¥éª¤&lt;/h1&gt;
&lt;p&gt;æœ‰ç©ºäº†å†å†™ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://cuiqingcai.com/5024.html"&gt;ä¸­å›½å¤©æ°”è´¨é‡ç½‘è¿”å›ç»“æœåŠ å¯†çš„ç ´è§£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://zhuanlan.zhihu.com/p/32139007"&gt;ç ´è§£ Google ç¿»è¯‘çš„token&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/jhao104/spider/tree/master/PyV8%E7%A0%B4%E8%A7%A3JS%E5%8A%A0%E5%AF%86Cookie"&gt;JavaScript ç”Ÿæˆ Cookie&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://liehu.tass.com.cn/archives/1016"&gt;å¸¸è§åŠ å¯†ç®—æ³•&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 04:32:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/ru-he-po-jie-bei-js-jia-mi-de-shu-ju.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>å¸‚é¢ä¸Šçš„ä¸€äº› RSS å·¥å…·</title><link>/posts/shi-mian-shang-de-yi-xie-rss-gong-ju.html</link><description>&lt;p&gt;YN: æ€»çš„æ¥è¯´ï¼ŒRSS æ˜¯ä¸€ä¸ªå°ä¼—çš„å·¥å…·ï¼Œä¹Ÿä¸ä¼šå¤§ä¼—åŒ–ï¼Œæ‰€ä»¥é€‚åˆé«˜ç«¯ç”¨æˆ·ï¼Œä»˜è´¹ä½¿ç”¨ã€‚
å¦å¤–å¯¹äº RSS æ¥è¯´ï¼Œé˜…è¯»ä¸€äº›å¨±ä¹åŒ–çš„ä¸œè¥¿æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä½†æ˜¯å¯¹äºæ¯”å¦‚è¯´ä½¿ç”¨å°è±¡ç¬”è®°çš„ç”¨æˆ·ï¼Œç”¨å¤„è¿˜æ˜¯å¾ˆå¤§çš„ã€‚å¯ä»¥ä½œä¸ºç”Ÿäº§åŠ›å·¥å…·&lt;/p&gt;
&lt;p&gt;phantomjscloud è¿˜æœ‰è¿™ç§ç½‘ç«™ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;ç°æœ‰çš„ä¸€äº›å·¥å…·&lt;/p&gt;
&lt;h2&gt;ç”Ÿæˆ RSS çš„å·¥å…·&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/huginn/huginn"&gt;huginn&lt;/a&gt;. ç±»ä¼¼ iftttï¼Œä¸­æ–‡ç¤¾åŒºä¹Ÿæœ‰ï¼Œè€Œä¸”æœ‰&lt;a href="http://git.huginn.cn/docs/Huginn%E7%AE%80%E4%BB%8B.html"&gt;ä¸­æ–‡
æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://feed43.com/"&gt;feed43&lt;/a&gt;. è€ç‰Œçš„ç”Ÿæˆ RSS çš„å·¥å…·ï¼Œæœ€è¿‘ç•Œé¢åšäº†æ”¹åŠ¨ï¼Œä½†æ˜¯ç”Ÿæˆ
RSS éœ€è¦ç½‘é¡µæºç ä¸­è‡ªå·±å–æ‰¾å‡ºæ¨¡å¼ï¼Œå¯¹äºæ™®é€šç”¨æˆ·æ¥è¯´éå¸¸éš¾ç”¨ï¼Œå¯¹äºç¨‹åºå‘˜æ¥è¯´åˆå¾ˆé¸¡
è‚‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="https://feedity.com/"&gt;feedity&lt;/a&gt;. æä¾›ä¸€ä¸ªå¯è§†åŒ–çš„ç•Œé¢ç”¨æ¥é€‰æ‹©å…ƒç´ ï¼Œç„¶åæ„å»ºRSSï¼Œ
ä¸è¿‡ç”Ÿæˆçš„ RSS æ˜¯æœ‰å¹¿å‘Šçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="http://fivefilters.org/content-only/"&gt;fivefilters&lt;/a&gt;. æä¾›æ‘˜è¦è½¬å…¨æ–‡ RSS çš„æ–¹æ³•&lt;/p&gt;
&lt;p&gt;&lt;a href="https://feedex.net/"&gt;feedex&lt;/a&gt;. æœ‰ä¸€ä¸ªå…¨æ–‡RSS è½¬æ¢å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="http://feedsoso.com/about.html"&gt;feedsoso&lt;/a&gt;. ä¸€ä¸ªå›½äº§çš„ RSS è½¬å…¨æ–‡çš„å·¥å…·ï¼Œ2011å¹´
çš„ï¼Œä¸çŸ¥é“è¿˜èƒ½ä¸èƒ½ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="https://kindle4rss.com/"&gt;kindle4rss&lt;/a&gt; æŠŠrssè½¬æ¢æˆå…¨æ–‡æ¨é€åˆ°kindle.cné‚®ç®±ä¸­ã€‚&lt;/p&gt;
&lt;h2&gt;åŸç”Ÿæ”¯æŒrss çš„ç½‘ç«™&lt;/h2&gt;
&lt;p&gt;reddit&lt;/p&gt;
&lt;h2&gt;ç‰¹å®šç½‘ç«™è½¬åŒ–ä¸º RSS&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://diygod.me/neteasecloudmusic2rss/"&gt;ç½‘æ˜“äº‘éŸ³ä¹&lt;/a&gt;ï¼Œæ¥è‡ª diygodï¼Œæœ‰æºç &lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/DIYgod/bilibili2RSS"&gt;Bç«™&lt;/a&gt;ï¼ŒåŒæ ·æ¥è‡ª diygodã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="https://tumblr2rss.obstack.net/"&gt;tumblr&lt;/a&gt;. tumblr feed çš„rssã€‚tumblr çš„åšå®¢æœ¬èº«
æ˜¯æä¾›rssçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="http://pullfeed.co/"&gt;GitHub pull requests&lt;/a&gt; æŠŠ GitHub çš„pull requestsæä¾›ä¸ºrss&lt;/p&gt;
&lt;p&gt;&lt;a href="http://emails2rss.appspot.com/"&gt;é‚®ä»¶è½¬rss&lt;/a&gt; æŠŠé‚®ä»¶è½¬ä¸ºrssã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="https://rss.lilydjwg.me/"&gt;çŸ¥ä¹è½¬rss&lt;/a&gt;çŸ¥ä¹ä¸“æ è½¬ä¸ºrss&lt;/p&gt;
&lt;p&gt;&lt;a href="https://mte90.net/en/2014/06/google-groups-in-rss-feed/"&gt;Google Groups è½¬rss&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="http://jianshu.milkythinking.com/"&gt;ç®€ä¹¦ä¸“æ è½¬rss&lt;/a&gt;è²Œä¼¼å·²ç»å¤±æ•ˆäº†&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.v2ex.com/t/132853"&gt;v2ex&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://api.izgq.net/weibo/"&gt;weibo&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;twitter, hacker news, instagram ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;h2&gt;è¯„æµ‹æ–‡ç« &lt;/h2&gt;
&lt;p&gt;è±†ç“£ç½‘å‹çš„æ€»ç»“ï¼Œå†æ¬¡è¯æ˜äº†è±†ç“£çš„ SEO æ˜¯åšçš„å¤šä¹ˆçš„å¥½ã€‚https://www.douban.com/note/522518464/&lt;/p&gt;
&lt;p&gt;appinn ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ¨å¹¿æ¸ é“&lt;/p&gt;
&lt;p&gt;ä¸€æ¬¾ iOS ä¸Šçš„ RSS é˜…è¯»å·¥å…·çš„è¯„æµ‹&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 15 Jul 2018 04:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-15:/posts/shi-mian-shang-de-yi-xie-rss-gong-ju.html</guid><category>åˆ›ä¸š</category><category>å¼€å§‹åšçš„é¡¹ç›®</category></item><item><title>åºåˆ—åŒ–åè®®çš„é€‰æ‹© json vs msgpack vs thrift vs protobuf</title><link>/posts/xu-lie-hua-xie-yi-de-xuan-ze-json-vs-msgpack-vs-thrift-vs-protobuf.html</link><description>&lt;p&gt;å½“æˆ‘ä»¬çš„ç¨‹åºéœ€è¦ä¿å­˜ä¸€äº›å¯¹è±¡åˆ°ç¡¬ç›˜ä¸Šä¾›ä¸‹æ¬¡è¿è¡Œæ—¶ä½¿ç”¨ï¼Œæˆ–è€…éœ€è¦å’Œå…¶ä»–ç¨‹åºäº¤æ¢æ•°æ®
çš„æ—¶å€™ï¼Œéœ€è¦æŠŠå¯¹è±¡ç”¨æŸç§æ–¹å¼ç¼–ç¨‹äºŒè¿›åˆ¶å­—ç¬¦ä¸²ç„¶åä¿å­˜åˆ°ç¡¬ç›˜ä¸Šæˆ–è€…å‘é€å‡ºå»ï¼Œè¿™ç§æ–¹
æ³•æˆ‘ä»¬ä¸€èˆ¬ç§°ä½œåºåˆ—åŒ–ã€‚åºåˆ—åŒ–æœ‰å¾ˆå¤šä¸åŒçš„æ–¹æ³•, ä¸€èˆ¬è€ƒè™‘ä¸‰ä¸ªæ–¹é¢ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€Ÿåº¦ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„é€Ÿåº¦è¶Šå¿«è¶Šå¥½&lt;/li&gt;
&lt;li&gt;ä½“ç§¯ï¼Œåºåˆ—åŒ–ä¹‹åçš„æ–‡ä»¶ä½“ç§¯è¶Šå°è¶Šå¥½&lt;/li&gt;
&lt;li&gt;è·¨è¯­è¨€ï¼Œåºåˆ—åŒ–èƒ½å¤Ÿæ”¯æŒçš„è¯­è¨€è¶Šå¤šè¶Šå¥½&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹é¢è€ƒå¯Ÿå‡ ç§åºåˆ—åŒ–çš„æ–¹æ³•&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¯­è¨€å†…ç½®çš„åºåˆ—åŒ–ã€‚æ¯”å¦‚ Python çš„ pickleï¼Œæ˜¾ç„¶è¿™ç§åè®®åªèƒ½åœ¨ä¸€ç§è¯­è¨€å†…éƒ¨ä½¿ç”¨ï¼Œ
   è€Œä¸”å¯¹äºPythonæ¥è¯´ï¼Œç”šè‡³ä¸åŒç‰ˆæœ¬çš„ pickle åè®®éƒ½æ˜¯ä¸å…¼å®¹çš„ã€‚&lt;/li&gt;
&lt;li&gt;json / xmlã€‚è¿™ä¸¤ä¸ªéƒ½å¯ä»¥æŠŠå¯¹è±¡åºåˆ—åŒ–æˆäººç±»å¯è¯»çš„å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œä½†æ˜¯åºåˆ—åŒ–åä¹‹
   åä½“ç§¯éƒ½å˜å¤§ä¸å°‘ï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿä¸å¥½ï¼Œé€‚åˆäºç®€å•çš„åœºæ™¯ã€‚å¦å¤–ä¸€ç‚¹å°±æ˜¯ json ä¸èƒ½å®š
   ä¹‰ schemaï¼ˆæ¥å£è§„èŒƒï¼‰ï¼Œ&lt;em&gt;åœ¨å¤§å‹é¡¹ç›®ä¸­ schema æ˜¯å¿…é¡»çš„&lt;/em&gt;ã€‚&lt;/li&gt;
&lt;li&gt;msgpack åºåˆ—åŒ–ä¹‹åçš„ä½“ç§¯ä¹Ÿæ¯”è¾ƒç´§è‡´ï¼Œä½†æ˜¯åŒæ ·ä¸èƒ½å®šä¹‰ schemaã€‚&lt;/li&gt;
&lt;li&gt;ä¸“é—¨çš„åºåˆ—åŒ–åº“ã€‚æ¯”å¦‚ protobuf/thriftã€‚è¿™äº›åº“éƒ½æ”¯æŒå¤šä¸ªè¯­è¨€ï¼Œéœ€è¦é¢„å…ˆå®šä¹‰
   schema, å¹¶ä¸”æŠŠå¯¹è±¡åºåˆ—åŒ–æˆäºŒè¿›åˆ¶çš„æ¨¡å¼ï¼Œæ€§èƒ½ä¹Ÿéƒ½ä¸é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¸€ä¸‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è€ƒè™‘åˆ°éœ€è¦å®šä¹‰æ¥å£è§„èŒƒï¼Œæ‰€ä»¥æˆ‘ä»¬åªè€ƒè™‘ thrift å’Œ protobuf ä¸¤ç§&lt;/p&gt;
&lt;p&gt;Thrift çš„ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸æ”¯æŒ uint64ã€‚&lt;/li&gt;
&lt;li&gt;æŸ¥è¿‡ä¸€äº›æ–‡æ¡£ä¹‹åï¼Œå‘ç° thrift çš„æ€§èƒ½å·®äº pbã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€ä»¥å…ˆæ·˜æ±°äº† thriftã€‚æˆ‘ä»¬é€‰æ‹© protobuf&lt;/p&gt;
&lt;h2&gt;ç¼–è¯‘æ­¥éª¤æ”¾åœ¨å“ªé‡Œï¼Ÿ&lt;/h2&gt;
&lt;p&gt;protobuf å’Œ thrift ä¸¤ä¸ªçš„ç”¨æ³•éƒ½æ˜¯å…ˆå®šä¹‰ IDLï¼ˆæ¥å£ï¼‰æ–‡ä»¶ï¼Œç„¶åç”±ç¼–è¯‘å™¨ç¼–è¯‘ç”Ÿæˆå¯¹åº”çš„è¯­è¨€
çš„ä»£ç ã€‚å¯¹äº C++ è¿™æ ·çš„ç¼–è¯‘è¯­è¨€æ¥è¯´é—®é¢˜ä¸å¤§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ IDL ç¼–è¯‘çš„è¿‡ç¨‹æ”¾åˆ°
makefile é‡Œé¢å»ï¼Œä½†æ˜¯å¯¹äº Python è¿™ç§æ²¡æœ‰ç¼–è¯‘çš„åŠ¨æ€è¯­è¨€å°±å°´å°¬äº†ã€‚å…·ä½“æ¥è¯´ï¼ŒIDL
æ–‡ä»¶æ˜¯éœ€è¦æäº¤åˆ°ä»£ç ä»“åº“çš„ï¼Œä½†æ˜¯ç”Ÿæˆçš„ Python ä»£ç éœ€ä¸éœ€è¦å‘¢?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸æäº¤ï¼Œåœ¨è¿è¡Œä¹‹å‰å¤šä¸€ä¸ªç¼–è¯‘æ­¥éª¤ï¼Œä¸è¿‡å¯ä»¥æŠŠç¼–è¯‘è¿™ä¸€æ­¥å†™åˆ° dockerfile é‡Œé¢&lt;/li&gt;
&lt;li&gt;æäº¤ï¼Œè¿™æ ·ä¼šé€ æˆæäº¤çš„ä»£ç å†—ä½™ï¼Œç›¸å½“äºæŠŠäºŒè¿›åˆ¶æ–‡ä»¶æäº¤åˆ°äº†ä»“åº“&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘è¿˜æ˜¯å€¾å‘äºåªå‘ä»£ç åº“ä¸­æäº¤ &lt;code&gt;*.proto&lt;/code&gt; æˆ–è€… &lt;code&gt;*.thrift&lt;/code&gt; æºæ–‡ä»¶ï¼Œè€Œä¸æäº¤ç¼–è¯‘è¿‡åçš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h1&gt;Protobuf&lt;/h1&gt;
&lt;h2&gt;åŸºæœ¬è¯­æ³•&lt;/h2&gt;
&lt;p&gt;protobuf ç°åœ¨æœ‰ä¸¤ä¸ªä¸»æµç‰ˆæœ¬ï¼Œæ˜¾ç„¶ proto2 è¦è¢«é€æ¸åºŸå¼ƒï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯ proto3ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;syntax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;proto3&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;package&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;myproject/other_protos.proto&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="n"&gt;SearchRequest&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;int32&lt;/span&gt; &lt;span class="n"&gt;page_number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;int32&lt;/span&gt; &lt;span class="n"&gt;result_per_page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;enum&lt;/span&gt; &lt;span class="n"&gt;Corpus&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;UNIVERSAL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;WEB&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;IMAGES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;LOCAL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;NEWS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;PRODUCTS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;VIDEO&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="n"&gt;Corpus&lt;/span&gt; &lt;span class="n"&gt;corpus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="n"&gt;SearchResponse&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;repeated&lt;/span&gt; &lt;span class="n"&gt;Result&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="n"&gt;Result&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;repeated&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;snippets&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸Šé¢çš„ç»“æ„å’Œ C è¯­è¨€çš„ struct å®šä¹‰å¾ˆåƒã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;message å…³é”®å­—ç”¨äºå£°æ˜ä¸€ä¸ªç»“æ„ï¼Œåé¢åŠ ç»“æ„çš„åå­—&lt;/li&gt;
&lt;li&gt;protobuf 3 ä¸æ”¯æŒé»˜è®¤å€¼ã€‚&lt;/li&gt;
&lt;li&gt;ç±»å‹ã€‚protobuf ä¸­å®šä¹‰çš„æ ‡é‡ç±»å‹æœ‰ double/float/int32(64)/uint32(64)/bool/string/bytes.
   å…¶ä¸­ bytes ç”¨æ¥è¡¨ç¤ºä»»æ„çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;åºå·ï¼Œæ¯ä¸ªå­—æ®µåé¢çš„æ•°å­—è¡¨ç¤ºçš„æ˜¯åºå·ã€‚protobuf ç”¨è¿™ä¸ªåºå·æ¥è¿›è¡Œé«˜æ•ˆç¼–ç ï¼Œéœ€è¦
   æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¦å¢æ·»å­—æ®µä¸èƒ½å¤ç”¨å·²æœ‰çš„åºå·ã€‚&lt;/li&gt;
&lt;li&gt;æšä¸¾ã€‚å¯ä»¥ä½¿ç”¨ enum å…³é”®å­—å®šä¹‰æšä¸¾ã€‚æšä¸¾å¯ä»¥å®šä¹‰åœ¨ message çš„å¤–é¢æˆ–è€…é‡Œé¢&lt;/li&gt;
&lt;li&gt;åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å¯ä»¥å®šä¹‰å¤šä¸ª messageã€‚åƒæ˜¯ enum ä¸€æ ·ï¼Œmessage ä¹Ÿå¯ä»¥åµŒå¥—åœ¨å¦ä¸€ä¸ª
   messageä¸­ã€‚æ¯”å¦‚å¯ä»¥æŠŠä¸Šé¢çš„ Result åµŒå¥—åœ¨ SearchResponse ä¸­ã€‚ä¸è¿‡è¿™æ—¶å€™å†å¼•ç”¨
   Resultï¼Œéœ€è¦ä½¿ç”¨ SearchResponse.Result&lt;/li&gt;
&lt;li&gt;message ä¸­å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ª message ä½œä¸ºç±»å‹ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ import è¯­å¥æ¥å¼•å…¥å…¶ä»–çš„ proto æ–‡ä»¶ã€‚è¿™æ ·å°±å¯ä»¥ç›´æ¥ä½¿ç”¨å¼•å…¥&lt;/li&gt;
&lt;li&gt;package è¯­å¥ç”¨æ¥å£°æ˜å®šä¹‰çš„ message æ‰€å¤„çš„å‘½åç©ºé—´ï¼ˆnamespace)&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;ç¼–è¯‘&lt;/h2&gt;
&lt;h3&gt;åœ¨ Python ä¸­ä½¿ç”¨&lt;/h3&gt;
&lt;p&gt;ParseFromString: ä»å­—ç¬¦ä¸²ä¸­è§£æprotobufå¯¹è±¡. è™½ç„¶è¿™ä¸ªæ–¹æ³•åå­—ä¸­åŒ…å«äº†stringï¼Œä½†æ˜¯å®é™…ä¸Šä½¿ç”¨çš„æ˜¯ bytesã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;r = SearchResponse()
r.ParseFromString(data)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;SerializeToString: åºåˆ—åŒ–æˆå­—ç¬¦ä¸²ã€‚åŒæ ·ä½¿ç”¨ bytesã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;data = r.SerializeToString()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å±æ€§å¯ä»¥ç›´æ¥è®¿é—®å’Œè®¾ç½®ï¼Œå¦‚æœå±æ€§åæˆ–è€…ç±»å‹å‡ºé”™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;repeated ç±»å‹çš„åŸºç¡€ç±»å‹å±æ€§å¯ä»¥åƒä¸€ä¸ªæ•°ç»„ä¸€æ ·è®¿é—®ï¼Œmap ç±»å‹å¯ä»¥åƒå­—å…¸ä¸€æ ·è®¿é—®ã€‚ä½†æ˜¯èµ‹å€¼å¿…é¡»é€šè¿‡ append å’Œ extend èµ‹å€¼ï¼Œè€Œä¸èƒ½ç›´æ¥èµ‹å€¼.&lt;/p&gt;
&lt;p&gt;repeated ç±»å‹çš„ message ç±»å‹ä¸èƒ½ä½¿ç”¨ appendï¼Œè€Œå¿…é¡»ä½¿ç”¨ add æˆ–è€… extend æ–¹æ³•ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ message ç±»å‹è¢«æ‹·è´è¿›å»ã€‚&lt;/p&gt;
&lt;h1&gt;REF&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://tech.meituan.com/serialization_vs_deserialization.html&lt;/li&gt;
&lt;li&gt;https://my.oschina.net/fir01/blog/468123&lt;/li&gt;
&lt;li&gt;http://colobu.com/2015/01/07/Protobuf-language-guide/&lt;/li&gt;
&lt;li&gt;https://developers.google.com/protocol-buffers/docs/pythontutorial&lt;/li&gt;
&lt;li&gt;&lt;a href="https://blog.csdn.net/losophy/article/details/17006573"&gt;åœ¨ Python ä¸­ä½¿ç”¨ ProtoBuf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;https://developers.google.com/protocol-buffers/docs/reference/python-generated&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 14 Jul 2018 19:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-14:/posts/xu-lie-hua-xie-yi-de-xuan-ze-json-vs-msgpack-vs-thrift-vs-protobuf.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>äº’è”ç½‘åˆ›ä¸šçš„æ–¹å‘</title><link>/posts/hu-lian-wang-chuang-ye-de-fang-xiang.html</link><description>&lt;p&gt;ä¸»è¦è€ƒè™‘å›¢é˜Ÿå’Œèˆªé“å¤§å°ï¼Œå¦‚æœéš¾ä»¥çœ‹æ¸…èˆªé“ï¼Œåˆ™çœ‹æœ‰æ— å›½å¤–æ˜æ˜¾å¯¹æ ‡ï¼Œå¦‚æœå›½å¤–æœ‰å¯¹æ ‡ï¼Œä¹Ÿè¦æ³¨æ„åŒºåˆ†å›½å†…å¤–å¤–éƒ¨ç¯å¢ƒï¼ˆæ¯”å¦‚ fb å’Œäººäººï¼‰&lt;/p&gt;
&lt;p&gt;åˆ¶åº¦æ€§çš„è…è´¥åœ¨äºå…¶åˆæ³•æ€§ï¼Œé€šè¿‡å¯¹æŸäº›è¡Œä¸šè®¾ç«‹å‡†å…¥é—¨æ§›ï¼Œåˆæ³•åœ°æŠŠç‰Œç…§è¾“é€ç»™è‡ªå·±çš„åˆ©ç›Šç›¸å…³æ–¹ï¼Œæ¯”å¦‚äº’è”ç½‘æ”¯ä»˜ç‰Œç…§ç­‰ã€‚&lt;/p&gt;
&lt;h1&gt;To C&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å…±äº«ç»æµ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…±äº«å•è½¦ âŒ&lt;/li&gt;
&lt;li&gt;å…±äº«å……ç”µå® âŒ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;O2O&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¾å›¢&lt;/li&gt;
&lt;li&gt;58&lt;/li&gt;
&lt;li&gt;å¤–å–&lt;ul&gt;
&lt;li&gt;ç¾å›¢å¤–å–&lt;/li&gt;
&lt;li&gt;é¥¿äº†ä¹ˆ&lt;/li&gt;
&lt;li&gt;æ»´æ»´å¤–å– âŒå·²æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;AI&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Face++&lt;/li&gt;
&lt;li&gt;å•†æ±¤&lt;/li&gt;
&lt;li&gt;ç¬¬å››èŒƒå¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;VR âŒä¸çœ‹å¥½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;äº’è”ç½‘é‡‘è&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŒºå—é“¾ âŒï¼ˆå…¨æ˜¯éª—å­ï¼‰&lt;/li&gt;
&lt;li&gt;P2P âŒï¼ˆå…¨æ˜¯éª—å­ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åŸºæœ¬éƒ½æ˜¯éª—å­&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç”µå•†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç»¼åˆç”µå•†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;C2C æ·˜å®&lt;/li&gt;
&lt;li&gt;B2C äº¬ä¸œ&lt;/li&gt;
&lt;li&gt;å¾®ä¿¡ç”µå•†&lt;ul&gt;
&lt;li&gt;æ‹¼å¤šå¤š&lt;/li&gt;
&lt;li&gt;è¶£åº—&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¥³æ€§è´­ç‰©ç¤¾åŒº&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°çº¢ä¹¦&lt;/li&gt;
&lt;li&gt;èšç¾ä¼˜å“&lt;/li&gt;
&lt;li&gt;ç¾ä¸½è¯´&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”Ÿé²œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;äºŒæ‰‹ âŒæˆæœ¬å¤ªé«˜ï¼Œä¸çœ‹å¥½&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å’¸é±¼&lt;/li&gt;
&lt;li&gt;è½¬è½¬&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;äºŒæ‰‹è½¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äººäººè½¦&lt;/li&gt;
&lt;li&gt;ç“œå­&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨çº¿åŒ»ç–—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç¤¾åŒº&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¥é›¨åŒ»ç”Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¥³æ€§ç¤¾åŒº&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤§å§¨å¦ˆ&lt;/li&gt;
&lt;li&gt;ç¾æŸš&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†…å®¹ç¤¾åŒº&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘ç»œæ–‡å­¦ âŒï¼ˆå¸‚åœºå¤ªå°ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æˆ¿äº§&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äºŒæ‰‹æˆ¿&lt;ul&gt;
&lt;li&gt;é“¾å®¶&lt;/li&gt;
&lt;li&gt;è´å£³&lt;/li&gt;
&lt;li&gt;è¯¸è‘›æ‰¾æˆ¿&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç§Ÿæˆ¿&lt;ul&gt;
&lt;li&gt;è˜‘è‡ç§Ÿæˆ¿&lt;/li&gt;
&lt;li&gt;è±†ç“£ç§Ÿæˆ¿&lt;/li&gt;
&lt;li&gt;58&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…¬å¯“ç®¡ç†&lt;ul&gt;
&lt;li&gt;æ°´æ»´ç®¡å®¶&lt;/li&gt;
&lt;li&gt;å¯“å°äºŒ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨çº¿æ•™è‚²&lt;/p&gt;
&lt;p&gt;åœ¨çº¿æ•™è‚²åº”è¯¥å¢é•¿å¾ˆå¿«ï¼Œä½†æ˜¯æ–°ä¸œæ–¹ã€å¥½æœªæ¥ã€æ²ªæ±Ÿéƒ½è€ç‰Œå…¬å¸å·²ç»å‘å±•å¤šå¹´ï¼Œå¾ˆéš¾å†æœ‰å¤§çš„çªç ´ã€‚é‡ç‚¹å…³æ³¨æœ‰å…¨æ–°æ¨¡å¼çš„æ–°å…¬å¸ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çŒ¿é¢˜åº“&lt;/li&gt;
&lt;li&gt;vipkid&lt;/li&gt;
&lt;li&gt;æ²ªæ±Ÿç½‘&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çŸ¥è¯†ä»˜è´¹ âŒ å…¨éƒ½æ˜¯æ™ºå•†ç¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ³›è§†é¢‘&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é•¿è§†é¢‘&lt;/li&gt;
&lt;li&gt;çŸ­è§†é¢‘&lt;/li&gt;
&lt;li&gt;ç›´æ’­&lt;ul&gt;
&lt;li&gt;ç§€åœºç›´æ’­&lt;/li&gt;
&lt;li&gt;æ¸¸æˆç›´æ’­&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨çº¿éŸ³ä¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¤¾äº¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç†Ÿäººç¤¾äº¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¾®ä¿¡&lt;/li&gt;
&lt;li&gt;QQ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é™Œç”Ÿäººç¤¾äº¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é™Œé™Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›¸äº² âŒï¼ˆå…¨æ˜¯éª—å­ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¤¾åŒºã€è®ºå›&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è´´å§&lt;/li&gt;
&lt;li&gt;è±†ç“£&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†…å®¹åˆ†å‘&lt;/p&gt;
&lt;p&gt;èµ¢åˆ©ç‚¹ä¸€èˆ¬ä¸ºç½‘ç»œå¹¿å‘Š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æœç´¢&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç™¾åº¦&lt;/li&gt;
&lt;li&gt;æœç‹—&lt;/li&gt;
&lt;li&gt;360&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¨è&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¤´æ¡&lt;/li&gt;
&lt;li&gt;è¶£å¤´æ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é—®ç­”&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çŸ¥ä¹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¡¬ä»¶ã€ç‰©è”ç½‘&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ— äººæœº&lt;/li&gt;
&lt;li&gt;å¹³è¡¡è½¦&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;To B&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;äº’è”ç½‘åŸºç¡€è®¾æ–½&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…¬æœ‰äº‘&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¡Œä¸šç”µå•†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰¾é’¢ç½‘&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿¡æ¯&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼ä¸šä¿¡æ¯æŸ¥è¯¢&lt;ul&gt;
&lt;li&gt;ä¼æŸ¥æŸ¥&lt;/li&gt;
&lt;li&gt;å¤©çœ¼æŸ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¾ä¿¡&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.76hui.com/info/news/413"&gt;ä¼ä¹æ±‡&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;å‡ºæµ·&lt;/h1&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 11 Jul 2018 14:19:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-11:/posts/hu-lian-wang-chuang-ye-de-fang-xiang.html</guid><category>åˆ›ä¸š</category></item><item><title>Get å’Œ Post æ–¹æ³•çš„é€‰æ‹©å’ŒURLçš„è®¾è®¡</title><link>/posts/get-he-post-fang-fa-de-xuan-ze-he-urlde-she-ji.html</link><description>&lt;p&gt;HTTP ä¸­å¸¸ç”¨çš„æ–¹æ³•æœ‰ GET/POST/PUT/DELETE ç­‰ï¼Œåœ¨è®¾è®¡APIæˆ–è€…è¡¨å•çš„æ—¶å€™æˆ‘ä»¬éœ€è¦é€‰æ‹©åˆé€‚çš„æ–¹æ³•ã€‚ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åªä½¿ç”¨ GET å’Œ POSTï¼ŒGET ä¸»è¦ç”¨æ¥è¯»å–æ•°æ®ï¼ŒPOST ç”¨æ¥åˆ›å»ºæˆ–è€…æ›´æ–°æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;RESTfulçš„æ–¹æ³•ï¼ŒGET/POST/PUT/DELETE åˆ†åˆ«ç”¨æ¥å¢åˆ æ”¹æŸ¥ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;URL çš„è®¾è®¡&lt;/h1&gt;
&lt;p&gt;ä¸ºäº†æ¢è®¨ä¸¤ç§æ–¹æ¡ˆï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ URL çš„è®¾è®¡ã€‚URL æ˜¯ Universal Resource Locator çš„ç¼©å†™ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª URL è¡¨ç¤ºçš„æ˜¯å”¯ä¸€çš„ä¸€ä¸ªèµ„æºï¼Œæ‰€ä»¥è¿™ä¸ªèµ„æºçš„ id æˆ–è€…è¯´ä¸»é”®åº”è¯¥æ˜¯æ”¾åœ¨ URL è·¯å¾„ä¸­çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä¸€ä¸ªå¥½çš„è®¾è®¡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://example.com/post/1234
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸å¥½çš„è®¾è®¡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://example.com/post?id=1234
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è€Œæ§åˆ¶è¿™ä¸ªèµ„æºå±•ç¤ºæ–¹å¼çš„å…¶ä»–å­—æ®µå¯ä»¥ä½œä¸ºå‚æ•°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://exmaple.com/post/1234?lang=zh&amp;amp;utm_source=google
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;HTTP æ–¹æ³•çš„å«ä¹‰&lt;/h1&gt;
&lt;p&gt;å¥½å¤šäººå¯¹äº http æ–¹æ³•çš„ç†è§£æ˜¯ GET æ˜¯å‚æ•°åœ¨urlé‡Œï¼Œè€ŒPOSTæ˜¯å‚æ•°åœ¨ body é‡Œé¢ï¼Œè¿™æ ·ç†è§£æ˜¯ä¸å¯¹çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šè¿°çš„ä¸¤ç§æ–¹æ¡ˆä¸­ï¼ŒGET éƒ½æ˜¯ç”¨æ¥è¯»å–èµ„æºçš„ï¼Œä¸€èˆ¬æ¥è¯´ä¸è¦å¯¹èµ„æºè¿›è¡Œä»»ä½•æ›´æ–°æ“ä½œï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å‰¯ä½œç”¨ã€‚æ¯”å¦‚è¯´&lt;/p&gt;
&lt;p&gt;ä¸å¥½çš„è®¾è®¡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;GET http://example.com/post/1234?action=delete
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸Šé¢çš„è®¾è®¡æ„å›¾é€šè¿‡GETæ“ä½œæ¥åˆ é™¤ä¸€ä¸ªèµ„æºï¼Œè¿™æ ·éå¸¸ä¸å¥½ã€‚æ¯”å¦‚è¯´å¦‚æœæµè§ˆå™¨å…·æœ‰é¢„ç¼“å­˜é¡µé¢çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆé¢„å…ˆè¯»å–è¿™ä¸ªé“¾æ¥çš„æ—¶å€™å°±æŠŠå¯¹åº”çš„èµ„æºåˆ æ‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼ŒGET æ–¹æ³•è¿˜è¦æ±‚å¹‚ç­‰æ€§ï¼Œä¹Ÿå°±æ˜¯æ— è®ºå¤šå°‘æ¬¡æ“ä½œï¼Œæœ€ç»ˆç»“æœå’Œæ“ä½œä¸€æ¬¡éƒ½æ˜¯ä¸€æ ·çš„ã€‚GET æ“ä½œçš„å‚æ•°å—åˆ° url é•¿åº¦çš„é™åˆ¶ï¼Œå½“å‚æ•°è¶…è¿‡ 1k çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ POST ä»£æ›¿ã€‚ä¸è¿‡è¿™æ—¶å€™ä½ é¦–å…ˆåº”è¯¥æƒ³ä¸€ä¸‹è¿™ä¹ˆå¤šå‚æ•°æ˜¯ä¸æ˜¯éƒ½æœ‰ç”¨ï¼Œæ˜¯ä¸æ˜¯è®¾è®¡æœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;POST æ–¹æ³•å¯ä»¥ç”¨æ¥åˆ›å»ºèµ„æºï¼Œæ¯”å¦‚è¯´ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;POST http://example.com/post/

content=xxxxxxx&amp;amp;author=xxxx&amp;amp;date=xxxx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;POST æ“ä½œå…·æœ‰å‰¯ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šæ›´æ”¹æœåŠ¡å™¨ä¸Šçš„çŠ¶æ€ã€‚å¦å¤– POST æ“ä½œä¸€èˆ¬ä¸æ˜¯å¹‚ç­‰çš„ï¼Œæ¯æ¬¡ POST æ“ä½œéƒ½åº”è¯¥åˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;PUT æ“ä½œç”¨æ¥æ›´æ–°èµ„æºï¼Œä¹Ÿæ˜¯å¹‚ç­‰çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;PUT http://example.com/post/1234

content=yyyyyy
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;DELETE ç”¨æ¥åˆ é™¤èµ„æºï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ ¹æ®è§„èŒƒ DELETE æ–¹æ³•ä¸èƒ½å¸¦æœ‰ bodyã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;DELETE http://example.com/post/1234
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 10 Jul 2018 08:59:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-10:/posts/get-he-post-fang-fa-de-xuan-ze-he-urlde-she-ji.html</guid><category>HTTP</category><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>çˆ¶è¿›ç¨‹é€€å‡ºåå¦‚ä½•é€€å‡ºå­è¿›ç¨‹</title><link>/posts/fu-jin-cheng-tui-chu-hou-ru-he-tui-chu-zi-jin-cheng.html</link><description>&lt;p&gt;æˆ‘ä»¬çŸ¥é“å½“å­è¿›ç¨‹æ¨å‡ºçš„æ—¶å€™ï¼Œçˆ¶è¿›ç¨‹ä¼šæ”¶åˆ° SIGCHLD ä¿¡å·ï¼Œä»è€Œå¯ä»¥é‡‡å–ç›¸åº”çš„æ“ä½œã€‚ä½†æ˜¯å½“çˆ¶è¿›ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šæŠŠå­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹æ›´æ”¹ä¸ºpid=0çš„ init è¿›ç¨‹ï¼Œè€Œä¸”å­è¿›ç¨‹ä¸ä¼šæ”¶åˆ°ä»»ä½•ä¿¡å·ã€‚è€Œæˆ‘ä»¬ç»å¸¸æƒ³åœ¨çˆ¶è¿›ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œè®©å­è¿›ç¨‹ä¹Ÿæ¨å‡ºã€‚åœ¨ Python ä¸­å¯ä»¥æœ‰å¦‚ä¸‹å‡ ç§åšæ³•ã€‚&lt;/p&gt;
&lt;h1&gt;è®¾ç½®å­è¿›ç¨‹ä¸º daemon&lt;/h1&gt;
&lt;p&gt;è¿™é‡Œçš„ daemon å’Œç³»ç»Ÿçš„å®ˆæŠ¤è¿›ç¨‹æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œæ˜¯ quit_when_parent_dies çš„æ„æ€ã€‚ä¹Ÿå°±æ˜¯å½“çˆ¶è¿›ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å°è¯•å…³é—­ daemon=True çš„å­è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;p = multiprocessing.Process(target=foo)
p.daemon = True
p.start()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;a href="https://docs.python.org/3/library/multiprocessing.html#multiprocessing.Process.daemon"&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;åœ¨å­è¿›ç¨‹ä¸­è®¾ç½® PDEATHSIG&lt;/h1&gt;
&lt;p&gt;åœ¨ Linux ä¸­ï¼Œè¿›ç¨‹å¯ä»¥è¦æ±‚å†…æ ¸åœ¨çˆ¶è¿›ç¨‹é€€å‡ºçš„æ—¶å€™ç»™è‡ªå·±å‘ä¿¡å·ã€‚ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ prctlã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;prctl(PR_SET_PDEATHSIG, SIGHUP);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ Pythonä¸­ä¹Ÿæœ‰&lt;a href="https://github.com/seveas/python-prctl"&gt;å¯¹åº”çš„åŒ… python-prctl&lt;/a&gt;ï¼Œå¯ä»¥åœ¨&lt;strong&gt;å­è¿›ç¨‹&lt;/strong&gt;ä¸­è¿™æ ·ä½¿ç”¨ï¼Œè¿™æ ·åœ¨çˆ¶è¿›ç¨‹æŒ‚æ‰çš„æ—¶å€™ï¼Œå­è¿›ç¨‹å°±ä¼šæ”¶åˆ° SIGHUP ä¿¡å·ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# apt-get install build-essential libcap-dev&lt;/span&gt;
&lt;span class="c1"&gt;# pip install python-prctl&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;signal&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;prctl&lt;/span&gt;

&lt;span class="n"&gt;prctl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_pdeathsig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGHUP&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç¼ºç‚¹ï¼šåªæ”¯æŒ linux&lt;/p&gt;
&lt;h1&gt;çˆ¶è¿›ç¨‹åœ¨ç»ˆæ­¢çš„æ—¶å€™å›æ”¶å­è¿›ç¨‹&lt;/h1&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ atexit.register åœ¨ä¸»è¿›ç¨‹ä¸­æ³¨å†Œä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# pip install psutil&lt;/span&gt;


&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;atexit&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;signal&lt;/span&gt;

&lt;span class="nd"&gt;@atexit.register&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;kill_children&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;quitting, press Ctrl-C to force quit&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;current_process&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Process&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;children&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;current_process&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;children&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;recursive&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;child&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;children&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Child pid is {}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGTERM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ atexit åœ¨&lt;a href="http://yifei.me/note/558"&gt;æ”¶åˆ° SIGTERM çš„æ—¶å€™å¹¶ä¸èƒ½è§¦å‘&lt;/a&gt;ï¼Œæ‰€ä»¥æœ€å¥½ä½¿ç”¨ signal æ³¨å†Œåˆ°ä¸»è¿›ç¨‹å¯¹åº”çš„ä¿¡å·ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹æ˜¯å½“ä½¿ç”¨ kill -9 æˆ–è€…ä½¿ç”¨ os._exit çš„æ—¶å€™ä¸ä¼šè°ƒç”¨è¿™äº›å‡½æ•°ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 09 Jul 2018 03:52:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-07-09:/posts/fu-jin-cheng-tui-chu-hou-ru-he-tui-chu-zi-jin-cheng.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>åç«¯å·¥å…·å’Œç®—æ³•é›†</title><link>/posts/hou-duan-gong-ju-he-suan-fa-ji.html</link><description>&lt;p&gt;æ€»ç»“ä¸€ä¸‹åç«¯å¸¸ç”¨çš„å·¥å…·å’Œè•´å«çš„ç®—æ³•&lt;/p&gt;
&lt;p&gt;TODO: åº”è¯¥æŠŠ GitHub 5000 star ä»¥ä¸Šçš„é¡¹ç›®éƒ½çœ‹ä¸€ä¸‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å‰ç«¯&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¡†æ¶&lt;ul&gt;
&lt;li&gt;vue&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ•°æ®åº“&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mysql(btree)&lt;/li&gt;
&lt;li&gt;postgresql&lt;/li&gt;
&lt;li&gt;redis&lt;/li&gt;
&lt;li&gt;pika/rocksdb/leveldb&lt;/li&gt;
&lt;li&gt;elasticsearch&lt;/li&gt;
&lt;li&gt;mongodb&lt;/li&gt;
&lt;li&gt;memcache åŠŸèƒ½æ˜¯redisçš„å­é›†ï¼Œç°åœ¨ç”¨å¾—æ¯”è¾ƒå°‘äº†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¶ˆæ¯é˜Ÿåˆ—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;kafka&lt;/li&gt;
&lt;li&gt;redis stream&lt;/li&gt;
&lt;li&gt;rabbitmq&lt;ul&gt;
&lt;li&gt;amqp åè®®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RPC å’Œåºåˆ—åŒ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;protobuf/grpc&lt;/li&gt;
&lt;li&gt;thrift&lt;/li&gt;
&lt;li&gt;msgpack&lt;/li&gt;
&lt;li&gt;envoy&lt;ul&gt;
&lt;li&gt;service mesh çš„æ€æƒ³&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è´Ÿè½½å‡è¡¡&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å››å±‚å’Œä¸ƒå±‚è´Ÿè½½å‡è¡¡çš„åŒºåˆ«&lt;/li&gt;
&lt;li&gt;nginx&lt;/li&gt;
&lt;li&gt;LVS&lt;/li&gt;
&lt;li&gt;ä¸€è‡´æ€§å“ˆå¸Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;éƒ¨ç½²å’Œå®¹å™¨åŒ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;docker&lt;ul&gt;
&lt;li&gt;cgroups&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;kubernetes&lt;ul&gt;
&lt;li&gt;borg è®ºæ–‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CI&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;jenkins&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;web æ¡†æ¶&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;django(MVC æ¨¡å¼)&lt;/li&gt;
&lt;li&gt;flask&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ—¥å¿—æ”¶é›†&lt;/p&gt;
&lt;p&gt;åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éœ€è¦æ—¥å¿—å¯èƒ½åˆ†å¸ƒåœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œè¦æƒ³æŸ¥æ‰¾ä¸€æ¡é”™è¯¯æ—¥å¿—ï¼Œå¯èƒ½éœ€è¦ ssh åˆ°ä¸åŒçš„æœºå™¨ä¸Šï¼Œéå¸¸æµªè´¹æ—¶é—´å’Œç²¾åŠ›ã€‚å¯ä»¥æŠŠæ—¥å¿—æ”¶é›†åˆ°ä¸€ä¸ªç»Ÿä¸€çš„å­˜å‚¨ä¸­ï¼Œæ–¹ä¾¿æ£€ç´¢æŸ¥çœ‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;filebeat&lt;/li&gt;
&lt;li&gt;sentry&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›‘æ§&lt;/p&gt;
&lt;p&gt;æ—¶åºæ•°æ®åº“&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;- OpenTSDB
- influxdb
- prometheus
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‰ç«¯é¢æ¿&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;- grafana
&lt;/pre&gt;&lt;/div&gt;


&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é«˜å¹¶å‘å‚å®¶æœåŠ¡&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®¡æ•°æœåŠ¡&lt;ul&gt;
&lt;li&gt;&lt;a href="http://zhuanlan.51cto.com/art/201706/542217.htm"&gt;è®¡æ•°ç³»ç»Ÿæ¶æ„å®è·µä¸€æ¬¡æå®š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://blog.cydu.net/weidesign/2012/09/09/weibo-counter-service-design-2/"&gt;å¾®åšè®¡æ•°å™¨çš„è®¾è®¡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://instagram-engineering.com/storing-hundreds-of-millions-of-simple-key-value-pairs-in-redis-1091ae80f74c"&gt;instagram ä½¿ç”¨ redis è®¡æ•°&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é™æµæœåŠ¡&lt;ul&gt;
&lt;li&gt;token bucket&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœç´¢å¼•æ“ç›¸å…³&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;simhash&lt;/li&gt;
&lt;li&gt;tf-idf&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç»Ÿä¸€ç™»å½•&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CASï¼Œ&lt;a href="https://blog.csdn.net/csdnxingyuntian/article/details/54970102"&gt;äº†è§£CASåè®®&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;kerbos&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…å­˜æ¢é¡µç®—æ³•&lt;ul&gt;
&lt;li&gt;OPT&lt;/li&gt;
&lt;li&gt;FIFO&lt;/li&gt;
&lt;li&gt;LRU&lt;/li&gt;
&lt;li&gt;CLOCK&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é™æµ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é”&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼é”&lt;/li&gt;
&lt;li&gt;è‡ªæ—‹é”&lt;/li&gt;
&lt;li&gt;ä¹è§‚é”ã€æ‚²è§‚é”&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 30 Jun 2018 08:16:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-30:/posts/hou-duan-gong-ju-he-suan-fa-ji.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>è½¯ä»¶å·¥ç¨‹ä¸­çš„ â€œ3â€ çš„è§„åˆ™</title><link>/posts/ruan-jian-gong-cheng-zhong-de-3-de-gui-ze.html</link><description>&lt;p&gt;æˆ‘æ³¨æ„åˆ°äº†ä¸€ä¸ªç¥å¥‡çš„è½¯ä»¶å·¥ç¨‹æ³•åˆ™ï¼šåœ¨ä½ æ­£ç¡®åœ°è§£å†³é—®é¢˜ä¹‹å‰ï¼Œä½ è‡³å°‘éœ€è¦3ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“è¯´æ¥æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸è¦è¯•å›¾åœ¨ä¸¤ä¸ªç±»ä¹‹é—´å…±äº«ä»£ç ï¼Œè‡³å°‘ç­‰åˆ°ä½ æœ‰ä¸‰ä¸ªç±»çš„æ—¶å€™ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³é—®é¢˜çš„å‰ä¸¤æ¬¡å°è¯•ä¸€å®šä¼šå¤±è´¥ï¼Œå› ä¸ºä½ è¿˜æ²¡å®Œå…¨ç†è§£è¿™ä¸ªé—®é¢˜ã€‚ç¬¬ä¸‰æ¬¡æ‰è¡Œ&lt;/li&gt;
&lt;li&gt;ä»»ä½•æƒ³è¦æ—©æœŸå°±èƒ½è®¾è®¡å¥½çš„å°è¯•éƒ½ä¼šå¯¼è‡´å¯¹äºå·§åˆæƒ…å½¢çš„è¿‡åº¦æ‹Ÿåˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;ä½ åœ¨è¯´ä»€ä¹ˆï¼Ÿè¯·ç»™ä¸ªä¾‹å­&lt;/h1&gt;
&lt;p&gt;æ¯”å¦‚è¯´ä½ åœ¨å®ç°ä¸€ä¸ªç±»ï¼Œä»é“¶è¡ŒæŠ“å–æ•°æ®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªéå¸¸å‚»ç“œçš„ç‰ˆæœ¬ï¼Œä½†æ˜¯åº”è¯¥è¯´æ˜äº†é—®é¢˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;ChaseScraper&lt;/span&gt;:
    &lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;scrape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;session&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;requests&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Session&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;sessions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://chase.com/rest/login.aspx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                   &lt;span class="s1"&gt;&amp;#39;password&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_password&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="nx"&gt;sessions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://chase.com/rest/download_current_statement.aspx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç°åœ¨ä½ æƒ³æ·»åŠ ç¬¬äºŒä¸ªç±» CitiBankScraper æ¥å®ç°ç›¸åŒçš„æ¥å£ï¼Œä½†æ˜¯æ”¹å˜äº†ä¸€äº›å®ç°ç»†èŠ‚ã€‚å®é™…ä¸Šå‡è®¾CitiBankåªæ˜¯æœ‰ä¸€ä¸ªä¸åŒçš„ url å’Œè¡¨å•å…ƒç´ åç§°è€Œå·²ã€‚è®©æˆ‘ä»¬æ¥æ·»åŠ ä¸€ä¸ªæ–°çš„çˆ¬è™«ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;CitibankScraper&lt;/span&gt;:
    &lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;scrape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;session&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;requests&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Session&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;sessions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://citibank.com/cgi-bin/login.pl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                   &lt;span class="s1"&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_password&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="nx"&gt;sessions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://citibank.com/cgi-bin/download-stmt.pl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å› ä¸ºç»è¿‡äº†å¤šå¹´DRYåŸåˆ™çš„æ•™è‚²ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å‘ç°è¿™ä¸¤ä¸ªç±»çš„ä»£ç å‡ ä¹æ˜¯é‡å¤çš„ï¼æˆ‘ä»¬åº”è¯¥é‡æ„ä¸€ä¸‹ï¼ŒæŠŠæ‰€æœ‰çš„é‡å¤ä»£ç éƒ½æ”¾åˆ°ä¸€ä¸ªåŸºç±»ä¸­ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦Inserve of Control æ¨¡å¼ï¼Œè®©åŸºç±»æ¥æ§åˆ¶é€»è¾‘ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;BaseScraper&lt;/span&gt;:
    &lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;scrape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;session&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;requests&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Session&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nx"&gt;sessions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_LOGIN_URL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;self._USERNAME_FORM_KEY&lt;/span&gt;: &lt;span class="kt"&gt;self._username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                   &lt;span class="nx"&gt;self._PASSWORD_FORM_KEY&lt;/span&gt;: &lt;span class="kt"&gt;self._password&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="nx"&gt;sessions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;_STATEMENT_URL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;ChaseScraper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;BaseScraper&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="nx"&gt;_LOGIN_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://chase.com/rest/login.aspx&amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;_STATEMENT_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://chase.com/rest/download_current_statement.aspx&amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;_USERNAME_FORM_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;username&amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;_PASSWORD_FORM_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;password&amp;#39;&lt;/span&gt;


&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;CitibankScraper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;BaseScraper&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="nx"&gt;_LOGIN_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://citibank.com/cgi-bin/login.pl&amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;_STATEMENT_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://citibank.com/cgi-bin/download-stmt.pl&amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;_USERNAME_FORM_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;_PASSWORD_FORM_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pass&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™åº”è¯¥è®©æˆ‘ä»¬åˆ æ‰äº†ä¸å°‘ä»£ç ã€‚è¿™å·²ç»æ˜¯æœ€ç®€å•çš„æ–¹æ³•ä¹‹ä¸€äº†ã€‚æ‰€ä»¥é—®é¢˜åœ¨å“ªé‡Œå‘¢ï¼Ÿï¼ˆå‡ºå»æˆ‘ä»¬å®ç°ç»§æ‰¿çš„æ–¹æ³•ä¸å¥½ä¹‹å¤–ï¼‰&lt;/p&gt;
&lt;p&gt;é—®é¢˜æ˜¯æˆ‘ä»¬è¿‡åº¦æ‹Ÿåˆäº†ï¼è¿‡åº¦æ‹Ÿåˆæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæˆ‘ä»¬æ­£åœ¨æŠ½è±¡å‡ºå¹¶ä¸èƒ½å¾ˆå¥½æ³›åŒ–çš„æ¨¡å¼ï¼&lt;/p&gt;
&lt;p&gt;&lt;img alt="facepalm" src="https://erikbern.com/assets/facepalm.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œå‡è®¾æˆ‘ä»¬åˆéœ€è¦ä»ç¬¬ä¸‰ä¸ªé“¶è¡ŒæŠ“å–æ•°æ®ã€‚ä¹Ÿè®¸å®ƒéœ€è¦å¦‚ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»–éœ€è¦ä¸¤æ­¥éªŒè¯&lt;/li&gt;
&lt;li&gt;å¯†ç æ˜¯ä½¿ç”¨ JSON ä¼ é€’çš„&lt;/li&gt;
&lt;li&gt;ç™»å½•ä½¿ç”¨äº†POSTè€Œä¸æ˜¯GET&lt;/li&gt;
&lt;li&gt;éœ€è¦åŒæ—¶è®¿é—®å¤šä¸ªé¡µé¢&lt;/li&gt;
&lt;li&gt;è¦è®¿é—®çš„urlæ˜¯æ ¹æ®å½“å‰æ—¥æœŸåŠ¨æ€ç”Ÿæˆçš„&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€¦â€¦ æˆ–è€…éšä¾¿ä»€ä¹ˆä¸œè¥¿ï¼Œæœ‰1000ä¸­æ–¹å¼è®©æˆ‘ä»¬çš„ä»£ç ä¸èƒ½å·¥ä½œã€‚æˆ‘å¸Œæœ›ä½ å·²ç»æ„Ÿè§‰åˆ°é—®é¢˜æ‰€åœ¨äº†ã€‚æˆ‘ä»¬ä»¥ä¸ºæˆ‘ä»¬é€šè¿‡å‰ä¸¤ä¸ªçˆ¬è™«å‘ç°äº†ä¸€ä¸ªæ¨¡å¼ï¼ç„¶é¹…æ‚²å‰§çš„æ˜¯ï¼Œæˆ‘ä»¬çš„çˆ¬è™«æ ¹æœ¬ä¸èƒ½æ³›åŒ–åˆ°ç¬¬ä¸‰ä¸ªé“¶è¡Œï¼ˆæˆ–è€…æ›´å¤šï¼Œç¬¬nä¸ªï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¿‡æ‹Ÿåˆäº†ã€‚&lt;/p&gt;
&lt;h1&gt;è¿‡æ‹Ÿåˆåˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;è¿‡æ‹ŸåˆæŒ‡çš„æ˜¯æˆ‘ä»¬åœ¨æ•°æ®å‘ç°äº†ä¸€ä¸ªæ¨¡å¼ï¼Œä½†æ˜¯è¿™ä¸ªæ¨¡å¼å¹¶ä¸èƒ½å¾ˆå¥½åœ°æ³›åŒ–ã€‚å½“æˆ‘ä»¬åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸å¯¹äºä¼˜åŒ–ä»£ç é‡å¤éå¸¸è­¦è§‰ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€äº›å¶ç„¶å‡ºç°çš„æ¨¡å¼ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æŸ¥çœ‹æ•´ä¸ªç¨‹åºçš„è¯ï¼Œæˆ‘ä»¬çŸ¥é“è¿™äº›æ¨¡å¼å¯èƒ½å¹¶ä¸èƒ½å¾ˆå¥½åœ°ä»£è¡¨æ•´ä¸ªç¨‹åºçš„æ¨¡å¼ã€‚æ‰€ä»¥å½“æˆ‘ä»¬å®ç°äº†ä¸¤ä¸ªé“¶è¡Œçš„çˆ¬è™«ä¹‹åï¼Œæˆ‘ä»¬ä»¥ä¸ºæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå¹¿æ³›çš„æ¨¡å¼ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°ï¼Œä»£ç é‡å¤å¹¶ä¸æ€»æ˜¯ä¸€ä»¶åäº‹ã€‚å·¥ç¨‹å¸ˆä»¬é€šå¸¸è¿‡åˆ†å…³æ³¨å‡å°‘é‡å¤ä»£ç ï¼Œä½†æ˜¯ä¹Ÿåº”è¯¥æ³¨æ„åŒºåˆ†å¶ç„¶çš„ä»£ç é‡å¤å’Œç³»ç»Ÿæ€§çš„ä»£ç é‡å¤ä¹‹é—´çš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œè®©æˆ‘æ¥å¼•å…¥ç¬¬ä¸€ä¸ª â€œ3â€ ä¹‹è§„åˆ™ã€‚å¦‚æœä½ åªæœ‰ä¸¤ä¸ªç±»æˆ–è€…å¯¹è±¡ï¼Œä¸è¦è¿‡åˆ†å…³æ³¨ä»£ç é‡å¤ã€‚å½“ä½ åœ¨ä¸‰ä¸ªä¸åŒçš„åœ°æ–¹çœ‹åˆ°åŒä¸€ä¸ªæ¨¡å¼çš„æ—¶å€™åœ¨è€ƒè™‘å¦‚ä½•é‡æ„ã€‚&lt;/p&gt;
&lt;h1&gt;â€œ3â€ ä¹‹è§„åˆ™åº”ç”¨åˆ°æ¶æ„ä¸Š&lt;/h1&gt;
&lt;p&gt;åŒæ ·çš„æ¨ç†å¯ä»¥åº”ç”¨åˆ°ç³»ç»Ÿè®¾è®¡ä¸Šï¼Œä½†æ˜¯ä¼šå¾—å‡ºä¸€ä¸ªéå¸¸ä¸åŒçš„ç»“è®ºã€‚å½“ä½ ä»å¤´æ„å»ºä¸€ä¸ªæ–°çš„ç³»ç»Ÿçš„æ—¶å€™ï¼Œä½ ä¸çŸ¥é“ä»–æœ€ç»ˆä¼šè¢«å¦‚ä½•ä½¿ç”¨ï¼Œä¸è¦è¢«å‡è®¾æ‰€é™åˆ¶ã€‚åœ¨ç¬¬ä¸€ä»£å’Œç¬¬äºŒä»£äº§å“ä¸Šï¼Œæˆ‘ä»¬è®¤ä¸ºéœ€è¦çš„é™åˆ¶å¯èƒ½çœŸçš„æ˜¯éœ€è¦çš„ï¼Œä½†æ˜¯å½“å®ç°ç¬¬ä¸‰ä»£äº§å“çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°å‡è®¾æ˜¯å®Œå…¨é”™è¯¯çš„ï¼Œå¹¶æœ€ç»ˆå®ç°æ­£ç¡®çš„ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ï¼ŒLuigiå°±æ˜¯è§£å†³é—®é¢˜çš„ç¬¬ä¸‰æ¬¡å°è¯•ã€‚å‰ä¸¤ä¸ªå°è¯•è§£å†³äº†é”™è¯¯çš„é—®é¢˜ï¼Œå¹¶ä¸”ä¸ºé”™è¯¯çš„æ–¹å‘åšäº†ä¼˜åŒ–ã€‚æ¯”å¦‚ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¾èµ–äºåœ¨ XML ä¸­è®¾è®¡ä¾èµ–å›¾ã€‚ä½†æ˜¯å¾ˆæ˜¾ç„¶è¿™æ˜¯éå¸¸ä¸å‹å¥½çš„ï¼Œå› ä¸ºä½ ä¸€èˆ¬å¿è¦åœ¨ä»£ç é‡Œç”Ÿæˆä¾èµ–å›¾æ¯”è¾ƒå¥½ã€‚è€Œä¸”ï¼Œåœ¨å‰ä¸¤æ¬¡è®¾è®¡ä¸­çœ‹èµ·æ¥å¾ˆæœ‰ç”¨çš„ä¸€äº›æ–°è®¾è®¡ï¼Œæ¯”å¦‚ä»»åŠ¡è§£è€¦è¾“å‡ºï¼Œæœ€ç»ˆåªç»™ä¸€äº›éå¸¸å°‘è§çš„ä¾‹å­æ·»åŠ äº†æ”¯æŒï¼Œä½†æ˜¯æœ‰æ·»åŠ äº†ä¸å°‘å¤æ‚åº¦ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­çœ‹èµ·æ¥å¾ˆå¥‡æ€ªçš„é—®é¢˜å¯èƒ½åœ¨åæ¥æ˜¯å¾ˆé‡è¦çš„é—®é¢˜ï¼Œåè¿‡æ¥ä¹Ÿæ˜¯ã€‚&lt;/p&gt;
&lt;p&gt;I was reminded of this when we built an email ingestion system at Better. The first attempt failed because we built it in a poor way (basically shoehorning it into a CRUD request). The second one had a solid microservice design but failed for usability reasons (we built a product that no one really asked for). Weâ€™re halfway through the third attempt and Iâ€™m having a good feeling about it.&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ•…äº‹å‘Šè¯‰äº†æˆ‘ä»¬ç¬¬äºŒä¸ª â€œ3â€ ä¹‹è§„åˆ™â€”â€”åœ¨ç³»ç»Ÿè®¾è®¡ä¸Šï¼Œç›´åˆ°ç¬¬ä¸‰æ¬¡ä½ æ‰èƒ½å¤Ÿåšå¯¹ã€‚&lt;/p&gt;
&lt;p&gt;æ›´é‡è¦çš„æ˜¯ï¼Œå¦‚æœä½ çš„ç¬¬ä¸€ç‰ˆæœ‰ä¸€äº›å¥‡æ€ªçš„ä½ç½®é—®é¢˜ï¼Œä¸è¦å‡è®¾ä½ éœ€è¦æå®šä»–ä»¬ã€‚èµ°æ·å¾„ã€‚ç»•å¼€å¥‡æ€ªçš„é—®é¢˜ã€‚ä¼°è®¡ä½ ä¹Ÿä¸ä¼šè¿è¡Œè¿™ä¸ªç³»ç»Ÿå¾ˆé•¿æ—¶é—´â€”â€”æ€»æœ‰ä¸€å¤©ä»–ä¼šåçš„ã€‚ç¬¬äºŒä¸ªç‰ˆæœ¬å¤§å¤šæ•°æ—¶å€™ä¹Ÿæ˜¯åçš„ã€‚ç¬¬ä¸‰ä¸ªç‰ˆæœ¬å€¼å¾—ä½ æŠŠå®ƒé›•ç¢åˆ°å®Œç¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="three cupcakes" src="https://erikbern.com/assets/three-cupcakes.jpg"&gt;&lt;/p&gt;
&lt;p&gt;åŸæ–‡ï¼šhttps://erikbern.com/amp/2017/08/29/the-software-engineering-rule-of-3.html&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 23 Jun 2018 02:48:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-23:/posts/ruan-jian-gong-cheng-zhong-de-3-de-gui-ze.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­å¦‚ä½•å‹ç¼©æ–‡ä»¶</title><link>/posts/python-zhong-ru-he-ya-suo-wen-jian.html</link><description>&lt;p&gt;basic usage&lt;/p&gt;
&lt;p&gt;import gzip/bz2
with gzip.open('file.gz', 'rt') as f:
    text = f.read()&lt;/p&gt;
&lt;p&gt;NOTE: the default mode is binary.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 14:02:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/python-zhong-ru-he-ya-suo-wen-jian.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>curio çš„ http åº“ asks ä»£ç è§£æ</title><link>/posts/curio-de-http-ku-asks-dai-ma-jie-xi.html</link><description>&lt;p&gt;asks æ˜¯ Python çš„å¼‚æ­¥æ¡†æ¶ curio ä¸­çš„ ä¸€ä¸ª http åº“ã€‚&lt;/p&gt;
&lt;h1&gt;&lt;strong&gt;init&lt;/strong&gt;.py&lt;/h1&gt;
&lt;p&gt;init å‡½æ•°ï¼Œåˆå§‹åŒ– curio æˆ–è€… trio åº“&lt;/p&gt;
&lt;h1&gt;auth.py&lt;/h1&gt;
&lt;p&gt;auth ç›¸å…³å‡½æ•°&lt;/p&gt;
&lt;h1&gt;base_funcs.py&lt;/h1&gt;
&lt;p&gt;asks.request å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªsessionï¼Œç„¶ååšè¯·æ±‚ï¼Œä¹‹åå†ä¸¢å¼ƒæ‰è¿™ä¸ªsession&lt;/p&gt;
&lt;h1&gt;cookie_utils.py&lt;/h1&gt;
&lt;h2&gt;CookieTrackerç±»&lt;/h2&gt;
&lt;p&gt;å¯¹å¤–çš„æ–¹æ³•ä¸»è¦æœ‰ä¸¤ä¸ª get_additional_cookies ç”¨äºè·å–åŸŸåå¯¹åº”çš„cookieï¼Œ_store_cookies ç”¨äºæ·»åŠ cookie&lt;/p&gt;
&lt;p&gt;errors.py æŠ›å‡ºçš„å¼‚å¸¸çš„ç±»&lt;/p&gt;
&lt;h1&gt;req_structs.py&lt;/h1&gt;
&lt;h2&gt;SocketQ&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ª socket çš„è¿æ¥æ± ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä¸€ä¸ªdequeä½œä¸ºå­˜å‚¨ï¼Œå®é™…ä¸Šç›¸å½“äºåˆæ¨¡æ‹Ÿäº†ä¸€ä¸ªå­—å…¸{netloc =&amp;gt; socket}ï¼ˆæ€è€ƒï¼šä¸ºä»€ä¹ˆä¸ä½¿ç”¨OrderedDictå‘¢ï¼Ÿï¼‰
æ˜¯dequeçš„å­ç±»ã€‚indexè¿”å›æŒ‡å®šhostlocå¯¹åº”çš„indexã€‚pullå¼¹å‡ºæŒ‡å®šindexçš„socketã€‚__contains__éå†çœ‹æ˜¯å¦åŒ…å«å¯¹åº”çš„socket&lt;/p&gt;
&lt;p&gt;CaseIncesitiveDict å¯¹å¤§å°å†™ä¸æ•æ„Ÿçš„è¯å…¸&lt;/p&gt;
&lt;h1&gt;request.py&lt;/h1&gt;
&lt;h2&gt;Request ç±»&lt;/h2&gt;
&lt;p&gt;make_request æ–¹æ³•ã€‚hconnectionå®šä¹‰å’Œä½¿ç”¨çš„åœ°æ–¹ç›¸è·å¤ªè¿œäº†ã€‚cookieçš„ç”Ÿæˆåº”è¯¥ä½¿ç”¨joinã€‚ä¹‹åè°ƒç”¨_request_io å‘é€è¯·æ±‚&lt;/p&gt;
&lt;p&gt;_request_io è°ƒç”¨ é¦–å…ˆæ‰ç”¨_send, ç„¶åè°ƒç”¨_catch_response&lt;/p&gt;
&lt;p&gt;_catch_response è°ƒç”¨recv_event&lt;/p&gt;
&lt;p&gt;_recv_event ä¸æ–­è°ƒç”¨ _async_lib.recv(self.sock, 10000) ä»è€Œä¸æ–­äº§ç”Ÿæ•°æ®ï¼ŒçŸ¥é“è¯»å®Œä¸ºä¹‹&lt;/p&gt;
&lt;h2&gt;session ç±»&lt;/h2&gt;
&lt;p&gt;request è°ƒç”¨ grab_connection è·å–ä¸€ä¸ªsocketï¼Œç„¶åæŠŠè¿™ä¸ªsocketäº¤ç»™Requestå¯¹è±¡
grab_connection è°ƒç”¨ checkout_connection è·å¾—ä¸€ä¸ªsocketæˆ–è€…ï¼Œè°ƒç”¨make_connectionäº§ç”Ÿä¸€ä¸ªæ–°çš„socketï¼Œæ³¨æ„å…¶ä¸­æœ‰ä¸€ä¸ªå¥‡æ€ªçš„ await sleep(0)ï¼Œå¯èƒ½æ„æ€æ˜¯æŠŠå¾ªç¯äº¤å›ç»™event loop&lt;/p&gt;
&lt;p&gt;make_connection è°ƒç”¨_connect æ–¹æ³•ï¼Œå¹¶æŠŠhostå’Œportä½œä¸ºå±æ€§å†™åˆ°socketä¸Š&lt;/p&gt;
&lt;p&gt;session ä¸­æœ‰ä¸¤ä¸ªSocketQçš„ç±»ï¼Œconn_pool, checked_out_sockets åˆ†åˆ«ç”¨æ¥ä¿å­˜å·²è¿æ¥æœªä½¿ç”¨çš„socketå’Œæ­£åœ¨ä½¿ç”¨ä¸­çš„socket&lt;/p&gt;
&lt;p&gt;Asks çš„è¿æ¥æ± &lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨ä»£ç†çš„è¯&lt;/p&gt;
&lt;h1&gt;curio çš„ç½‘ç»œé€šä¿¡&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆï¼Œéœ€è¦å¼•å…¥curio.socket è€Œä¸æ˜¯ä½¿ç”¨å†…ç½®çš„socket
TCPé€šä¿¡ï¼Œä½¿ç”¨sock.bind/listen/acceptç­‰å»ºç«‹æœåŠ¡å™¨ï¼Œä½¿ç”¨recvå’Œsendallå‘é€æ¥æ”¶æ¶ˆæ¯
UDPé€šä¿¡ï¼Œä½¿ç”¨recvfromå’Œsendtoå‡½æ•°é€šä¿¡&lt;/p&gt;
&lt;p&gt;ä½œä¸ºå®¢æˆ·ç«¯ä½¿ç”¨curio.open_connection æ‰“å¼€åˆ°æœåŠ¡å™¨çš„é“¾æ¥ï¼Œå…¶ä¸­ssl=Trueæ‰“å¼€çš„æ˜¯HTTPSè¿æ¥è¯¶&lt;/p&gt;
&lt;p&gt;å¯¹äºå…¶ä»–è¦ä½¿ç”¨sslçš„æƒ…å†µï¼Œåº”è¯¥ä½¿ç”¨curio.sslè€Œä¸æ˜¯æ ‡å‡†åº“çš„ssl&lt;/p&gt;
&lt;p&gt;curio.network.&lt;/p&gt;
&lt;p&gt;ssl.wrap_socket ä¸æ”¯æŒserver_hostname sslcontext.wrap_socket æ”¯æŒ&lt;/p&gt;
&lt;p&gt;ä¸è¦æŠŠ proxies ä¼ é€’ç»™request å¯¹è±¡&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 10:23:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/curio-de-http-ku-asks-dai-ma-jie-xi.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python æ“ä½œ ssh</title><link>/posts/python-cao-zuo-ssh.html</link><description>&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;paramiko&lt;/span&gt;
&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;server ip&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;
&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;username&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;password&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;some useful command&amp;#39;&lt;/span&gt; 
&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSHClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_missing_host_key_policy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AutoAddPolicy&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;outlines&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outlines&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 10:21:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/python-cao-zuo-ssh.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python è½¬ä¹‰ html å®ä½“å­—ç¬¦</title><link>/posts/python-zhuan-yi-html-shi-ti-zi-fu.html</link><description>&lt;p&gt;åœ¨ç½‘é¡µä¸­ç»å¸¸å‡ºç° &lt;code&gt;&amp;amp;lt;&lt;/code&gt;, &lt;code&gt;&amp;amp;amp;&lt;/code&gt;, &lt;code&gt;&amp;amp;0x0026;&lt;/code&gt; è¿™äº›ç‰¹æ®Šå­—ç¬¦ï¼Œè¿™æ˜¯ html å®ä½“å­—ç¬¦è½¬ä¹‰ï¼Œç”¨äºé˜²æ­¢ XSS æ”»å‡»ã€‚Python3 æ ‡å‡†åº“ä¸­åŒ…å«äº† html.entities æ¨¡å—ï¼Œå¯ä»¥ç”¨äºè½¬ä¹‰å’Œåè½¬ä¹‰è¿™äº›å­—ç¬¦ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;html.entities.entitydefs ä¸­åŒ…å«äº†åç§°åˆ°ç¬¦å·çš„æ˜ å°„ï¼šæ¯”å¦‚{&amp;#39;amp&amp;#39;: &amp;#39;&amp;amp;&amp;#39;}
html.entities.name2codepoint ä¸­åŒ…å«äº†åç§°åˆ°æ•°å­—çš„æ˜ å°„ï¼šæ¯”å¦‚ {&amp;#39;amp&amp;#39;: 0x0026}
html.entities.codepoint2name ä¸­åŒ…å«äº†æ•°å­—åˆ°åç§°çš„æ˜ å°„ï¼šæ¯”å¦‚ {0x0026: &amp;#39;amp&amp;#39;}
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 10:21:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/python-zhuan-yi-html-shi-ti-zi-fu.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­çš„ queue æ¨¡å—</title><link>/posts/python-zhong-de-queue-mo-kuai.html</link><description>&lt;p&gt;åœ¨Pythonä¸­å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡å¯ä»¥ä½¿ç”¨é˜Ÿåˆ—ï¼Œæ ‡å‡†åº“ä¸­å®ç°äº†ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„åº“ queue.Queueï¼Œå’Œè¿›ç¨‹å®‰å…¨çš„åº“ multiprocessing.Queue&lt;/p&gt;
&lt;p&gt;There are 3 kind of queues: `Queue LifoQueue HeapQueue&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;q = Queue(size)

get(block=True) return a object
get_nowait()
put(item, block=True) put a object 

qsize()
empty()
full()

task_done() # indicate one item process finished raise ValueError
join() # wait until all item processed

Queue.Empty
Queue.Full
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;How to iterate a queue?&lt;/p&gt;
&lt;p&gt;by using &lt;code&gt;iter(q, None)&lt;/code&gt;, note that you have to put a sentinel value manually&lt;/p&gt;
&lt;p&gt;Queue vs multiprocessing.Queue&lt;/p&gt;
&lt;p&gt;despite their similar api, their implementation is completely different&lt;/p&gt;
&lt;p&gt;http://stackoverflow.com/questions/925100&lt;/p&gt;
&lt;p&gt;å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨äº†å¼‚æ­¥ä»£ç ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½å¿…é¡»ä½¿ç”¨å¼‚æ­¥æ“ä½œï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„æ“ä½œéƒ½éœ€è¦æˆ–è€…èƒ½å¤Ÿä½¿ç”¨å¼‚æ­¥æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å¼‚æ­¥çº¿ç¨‹å’ŒåŒæ­¥çº¿ç¨‹ä¹‹é—´åˆ†äº«æ•°æ®éœ€è¦ä½¿ç”¨ä¸€ä¸ªå…±ç”¨çš„queue&lt;/p&gt;
&lt;p&gt;å¦‚æœéœ€è¦æŠŠå¼‚æ­¥æ“ä½œåˆ†å¸ƒå¼ä¸ç†Ÿä½¿ç”¨ï¼Œåœ¨å¼‚æ­¥çš„äº‹ä»¶å¾ªç¯ä¹‹é—´åˆ†äº«æ•°æ®ä¹Ÿéœ€è¦ä½¿ç”¨ä¸€ä¸ªqueue&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 09:20:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/python-zhong-de-queue-mo-kuai.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>é˜…è¯»ã€ŠPython hitchhikerã€‹ç¬”è®°</title><link>/posts/yue-du-python-hitchhiker-bi-ji.html</link><description>&lt;p&gt;Package&lt;/p&gt;
&lt;p&gt;A fileÂ modu.pyÂ in the directoryÂ pack/Â is imported with the statementÂ importÂ pack.modu. This statement will look for anÂ &lt;strong&gt;init&lt;/strong&gt;.pyÂ file inÂ pack, execute all of its top-level statements. Then it will look for a file namedÂ pack/modu.pyÂ and execute all of its top-level statements. After these operations, any variable, function, or class defined inÂ modu.pyÂ is available in the pack.modu namespace.&lt;/p&gt;
&lt;p&gt;A commonly seen issue is to add too much code toÂ &lt;strong&gt;init&lt;/strong&gt;.pyÂ files. When the project complexity grows, there may be sub-packages and sub-sub-packages in a deep directory structure. In this case, importing a single item from a sub-sub-package will require executing allÂ &lt;strong&gt;init&lt;/strong&gt;.pyfiles met while traversing the tree.&lt;/p&gt;
&lt;p&gt;This and other issues led to the idea that using stateless functions is a better programming paradigm.
Another way to say the same thing is to suggest using functions and procedures with as few implicit contexts and side-effects as possible. A functionâ€™s implicit context is made up of any of the global variables or items in the persistence layer that are accessed from within the function. Side-effects are the changes that a function makes to its implicit context. If a function saves or deletes data in a global variable or in the persistence layer, it is said to have a side-effect.&lt;/p&gt;
&lt;p&gt;Pure functions&lt;/p&gt;
&lt;p&gt;â€¢ Pure functions are deterministic: given a fixed input, the output will always be the same.
â€¢ Pure functions are much easier to change or replace if they need to be refactored or optimized.
â€¢ Pure functions are easier to test with unit-tests: There is less need for complex context setup and data cleaning afterwards.
â€¢ Pure functions are easier to manipulate, decorate, and pass around.&lt;/p&gt;
&lt;p&gt;However, it may be a good discipline to avoid assigning to a variable more than once, and it helps in grasping the concept of mutable and immutable types.&lt;/p&gt;
&lt;p&gt;AÂ LICENSEÂ file shouldÂ alwaysÂ be present and specify the license under which the software is made available to the public.
AÂ TODOÂ file or aÂ TODOÂ section inÂ READMEÂ should list the planned development for the code.
AÂ CHANGELOGÂ file or section inÂ READMEÂ should compile a short overview of the changes in the code base for the latest versions.
Project Publication
Depending on the project, your documentation might include some or all of the following components:
    â€¢ AnÂ introductionÂ should show a very short overview of what can be done with the product, using one or two extremely simplified use cases. This is the thirty-second pitch for your project.
    â€¢ AÂ tutorialÂ should show some primary use cases in more detail. The reader will follow a step-by-step procedure to set-up a working prototype.
    â€¢ AnÂ API referenceÂ is typically generated from the code (seeÂ docstrings). It will list all publicly available interfaces, parameters, and return values.
    â€¢ Developer documentationÂ is intended for potential contributors. This can include code convention and general design strategy of the project.&lt;/p&gt;
&lt;p&gt;put project/ tests/ docs/ directory in side the project&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 09:06:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/yue-du-python-hitchhiker-bi-ji.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>Python functools ä¸­æœ‰ç”¨çš„ä¸€äº›å‡½æ•°</title><link>/posts/python-functools-zhong-you-yong-de-yi-xie-han-shu.html</link><description>&lt;p&gt;functools&lt;/p&gt;
&lt;p&gt;partial partial(fn, &lt;em&gt;args, &lt;/em&gt;*kwargs)&lt;/p&gt;
&lt;h1&gt;lru_cache&lt;/h1&gt;
&lt;p&gt;Decorator to wrap a function with a memoizing callable that saves up to theÂ maxsizeÂ most recent calls. It can save time when an expensive or I/O bound function is periodically called with the same arguments.
Since a dictionary is used to cache results, the positional and keyword arguments to the function must be hashable.
IfÂ maxsizeÂ is set toÂ None, the LRU feature is disabled and the cache can grow without bound. The LRU feature performs best whenÂ maxsizeÂ is a power-of-two.
IfÂ typedÂ is set to true, function arguments of different types will be cached separately. For example,Â f(3)Â andÂ f(3.0)Â will be treated as distinct calls with distinct results.
To help measure the effectiveness of the cache and tune theÂ maxsizeÂ parameter, the wrapped function is instrumented with aÂ cache_info()Â function that returns aÂ named tupleÂ showingÂ hits,Â misses,Â maxsizeÂ andÂ currsize. In a multi-threaded environment, the hits and misses are approximate.
The decorator also provides aÂ cache_clear()Â function for clearing or invalidating the cache.&lt;/p&gt;
&lt;h1&gt;singledispatch&lt;/h1&gt;
&lt;p&gt;To define a generic function, decorate it with theÂ @singledispatchÂ decorator. Note that the dispatch happens on the type of the first argument, create your function accordingly&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;@singledispatch
def fun()
    pass

@fun.register(int)
def fun_int()
    pass
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;to get the dispatched func. use fun.dispatch(type)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 08:59:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/python-functools-zhong-you-yong-de-yi-xie-han-shu.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>çŸ­è§†é¢‘ä¸æœºå™¨å­¦ä¹ </title><link>/posts/duan-shi-pin-yu-ji-qi-xue-xi.html</link><description>&lt;p&gt;æœºå™¨å­¦ä¹ éœ€è¦ Ground Truth
modalityæ˜¯ä»€ä¹ˆæ„æ€...&lt;/p&gt;
&lt;h1&gt;æµ…åº¦å­¦ä¹ &lt;/h1&gt;
&lt;h2&gt;çŸ­è§†é¢‘å¦‚ä½•ç«&lt;/h2&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆ: å¤§å¤šæ•°çš„çŸ­è§†é¢‘1å¤©ä¹‹åéƒ½é”€å£°åŒ¿è¿¹äº†
æ•°æ®é›†: 10ä¸ªvineç”¨æˆ·çš„followerå¹¿åº¦ä¼˜å…ˆ, è·å¾—åä¸‡ç§å­ç”¨æˆ·&lt;/p&gt;
&lt;p&gt;å¤§Vå‘å¸ƒçš„(social), å£°éŸ³å¾ˆå¥½(audio), ç¾æ„Ÿå¾ˆå¥½(visual), #hashtagé€‰çš„å¥½(text)&lt;/p&gt;
&lt;p&gt;ä»ä»¥ä¸Šå››ä¸ªæ–¹é¢æŠ½å–ç‰¹å¾.&lt;/p&gt;
&lt;p&gt;social çš„å½±å“æœ€å¤§&lt;/p&gt;
&lt;h2&gt;é¢„æµ‹åœ°ç†æ ‡ç­¾&lt;/h2&gt;
&lt;p&gt;1.2%æ‰æœ‰åœ°ç†æ ‡ç­¾, é¢„æµ‹æ˜¯ä¼šè®®å®¤/ç¯®çƒåœº/å…¬å›­ç­‰, æœ€é‡è¦çš„æ˜¯visual feature&lt;/p&gt;
&lt;h1&gt;æ·±åº¦å­¦ä¹ &lt;/h1&gt;
&lt;h2&gt;å£°éŸ³ç›¸å…³&lt;/h2&gt;
&lt;p&gt;freesound æ˜¯ä¸€ä¸ªå…è´¹çš„å£°éŸ³åº“. ä»ä¸€ä¸ªæ ‡ç­¾å¼€å§‹, æŠ½ä¸åŒçš„æ ‡ç­¾çš„å£°éŸ³. æŸ¥æ‰¾ä¸åŒçš„å£°éŸ³&lt;/p&gt;
&lt;p&gt;æ·±åº¦å­¦ä¹ åŠ è¿ç§»å­¦ä¹ &lt;/p&gt;
&lt;p&gt;alexnet-7æ˜¯å•¥&lt;/p&gt;
&lt;h2&gt;sequential and sparse&lt;/h2&gt;
&lt;p&gt;å­—å…¸å­¦ä¹ æ˜¯å•¥?&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆäº‹å…±ç©ºé—´?&lt;/p&gt;
&lt;h1&gt;æœªæ¥&lt;/h1&gt;
&lt;p&gt;ç”¨æˆ·çš„å…´è¶£æ˜¯åŠ¨æ€çš„, ä½†æ˜¯æ¨èå´æ˜¯å›ºå®šçš„.&lt;/p&gt;
&lt;p&gt;æ— æ³•æœç´¢æ²¡æœ‰æ–‡å­—çš„è§†é¢‘ æ¯”å¦‚: å¯ä»¥æˆªä¸€å¸§ç„¶ååˆ°googleä¸Šæœç´¢&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·çš„å¹³å°å¯¹åº”å…³ç³», åˆ©ç”¨quoraç­‰, ç”¨æˆ·è‡ªå·±å…³æ³¨äº†&lt;/p&gt;
&lt;p&gt;ontology&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Ã˜ çŸ­è§†é¢‘çš„è¯„è®ºä¹Ÿæ˜¯æ–‡æœ¬ä¿¡æ¯å•Š
Ã˜ Q: çŸ­è§†é¢‘å’Œé•¿è§†é¢‘çš„åˆ†æåŒºåˆ«
Ã˜ A: followç­‰, åœ°ç†å±æ€§, è´¨é‡ä½
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 06:07:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/duan-shi-pin-yu-ji-qi-xue-xi.html</guid><category>talks</category></item><item><title>ã€Šç®—æ³•è®¾è®¡ä¸åˆ†æåŸºç¡€ã€‹ç¬”è®°</title><link>/posts/suan-fa-she-ji-yu-fen-xi-ji-chu-bi-ji.html</link><description>&lt;p&gt;http://blog.csdn.net/wangyunyun00/article/details/23464359&lt;/p&gt;
&lt;p&gt;å·®å€¼æŸ¥æ‰¾&lt;/p&gt;
&lt;p&gt;æŠ˜åŠæŸ¥æ‰¾è¿™ç§æŸ¥æ‰¾æ–¹å¼ï¼Œè¿˜æ˜¯æœ‰æ”¹è¿›ç©ºé—´çš„ï¼Œå¹¶ä¸ä¸€å®šæ˜¯æŠ˜åŠçš„ï¼
mid = ï¼ˆlow+highï¼‰/ 2, å³ mid = low + 1/2 * (high - low);
æ”¹è¿›ä¸º ä¸‹é¢çš„è®¡ç®—æœºæ–¹æ¡ˆï¼ˆä¸çŸ¥é“å…·ä½“è¿‡ç¨‹ï¼‰ï¼š
mid = low + (key - a[low]) / (a[high] - a[low]) * (high - low)ï¼Œ
ä¹Ÿå°±æ˜¯å°†ä¸Šè¿°çš„æ¯”ä¾‹å‚æ•°1/2æ”¹è¿›äº†ï¼Œæ ¹æ®å…³é”®å­—åœ¨æ•´ä¸ªæœ‰åºè¡¨ä¸­æ‰€å¤„çš„ä½ç½®ï¼Œè®©midå€¼çš„å˜åŒ–æ›´é è¿‘å…³é”®å­—keyï¼Œè¿™æ ·ä¹Ÿå°±é—´æ¥åœ°å‡å°‘äº†æ¯”è¾ƒæ¬¡ æ•°ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 05:46:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/suan-fa-she-ji-yu-fen-xi-ji-chu-bi-ji.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>Andrew Ng çš„å…¬å¼€è¯¾ç¬”è®°</title><link>/posts/andrew-ng-de-gong-kai-ke-bi-ji.html</link><description>&lt;p&gt;http://www.johnwittenauer.net/machine-learning-exercises-in-python-part-1/&lt;/p&gt;
&lt;p&gt;Andrew ng è¯¾ç¨‹çš„ python è§£æ³•&lt;/p&gt;
&lt;p&gt;æ‹Ÿåˆæ›²çº¿ä¹Ÿæ˜¯æœºå™¨å­¦ä¹ 
ICA independent component analysis ç”¨äºè§£å†³é¸¡å°¾é…’å®´ä¼šé—®é¢˜ï¼ˆåˆ†ç¦»ç‹¬ç«‹å£°æºï¼‰&lt;/p&gt;
&lt;p&gt;æ¢¯åº¦ä¸‹é™æ³•
ä¸¤ç§
Batch
Random&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 05:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/andrew-ng-de-gong-kai-ke-bi-ji.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>æœç´¢é˜…è¯»ç¬”è®°</title><link>/posts/sou-suo-yue-du-bi-ji.html</link><description>&lt;h1&gt;æ–‡æ¡£è¯„åˆ†&lt;/h1&gt;
&lt;h2&gt;ç´¢å¼•çš„ç±»å‹ï¼ˆå‚æ•°åŒ–ç´¢å¼•å’ŒåŸŸzoneç´¢å¼•ï¼‰&lt;/h2&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ªæ–‡æ¡£æ¥è¯´ï¼Œé™¤äº†ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºæ­£æ–‡ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„metadataï¼Œæ¯”å¦‚ä¸€ç¯‡æ–‡ç« å°±ä¼šæœ‰ title publish_time author ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ publish_time è¿™ç§æ˜¯æœ‰å–å€¼èŒƒå›´çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå‚æ•°åŒ–ç´¢å¼•ã€‚è€Œå¯¹äºtitleå’Œauthorè¿™ç§å¯ä»¥æ˜¯ä»»æ„çš„è‡ªæœ‰æ–‡æœ¬ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å®ƒå»ºç«‹å€’æ’ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œå»ºç«‹å€’æ’æœ‰ä¸¤ç§æ•°æ®ç»“æ„ï¼Œç›®çš„éƒ½æ˜¯æŠŠ term å’Œ zone éƒ½æ ‡æ³¨åˆ°å€’æ’ä¸Šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŠŠ term å’Œ zone åˆèµ·æ¥ä½œä¸ºæ–°çš„term&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wiliam.abstrct -&amp;gt; [11], [122], [1441]
william.title -&amp;gt; [2], [4], [8]
william.author -&amp;gt; [2], [3], [5]
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;æŠŠ zone å’Œ docID ä¸€èµ·è®°å½•&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;william -&amp;gt; [2.title, 2.author], [3.author], [4.title], ...
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;åŸŸåŠ æƒè¯„åˆ†&lt;/h3&gt;
&lt;p&gt;å¯¹æ¯ä¸ªåŸŸç»™å®šä¸€ä¸ªæƒé‡ï¼Œç„¶åä½¿ç”¨æ¯ä¸ªåŸŸæœ‰æ²¡æœ‰å‡ºç°ç›¸å…³å…³é”®è¯æ¥æ±‚å’Œè¯„åˆ†&lt;/p&gt;
&lt;h3&gt;æƒé‡çš„è®¾å®š&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;1. ä¸“å®¶è®¾å®š
2. ç”±äººå·¥æ ‡æ³¨ï¼Œç„¶åä½¿ç”¨æœºå™¨å­¦ä¹ æ¥è¯„åˆ†
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 05:18:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/sou-suo-yue-du-bi-ji.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>APUE é˜…è¯»ç¬”è®°</title><link>/posts/apue-yue-du-bi-ji.html</link><description>&lt;p&gt;ä½¿ç”¨sysconfæ¥åŠ¨æ€åœ°åœ¨è¿è¡Œæ—¶è·å– INT_MAX ç­‰å¸¸é‡åœ°å€¼&lt;/p&gt;
&lt;h1&gt;IO&lt;/h1&gt;
&lt;h2&gt;ä¸å¸¦ç¼“å†²çš„IO&lt;/h2&gt;
&lt;p&gt;read write open close lseek å‡½æ•°&lt;/p&gt;
&lt;h2&gt;stdio&lt;/h2&gt;
&lt;p&gt;æ ‡å‡†IOåº“æ˜¯å›´ç»•streamæ¥çš„ï¼Œè€Œread/write ç­‰ç³»ç»Ÿå‡½æ•°åˆ™æ˜¯é¢å‘æ–‡ä»¶æè¿°ç¬¦ã€‚&lt;/p&gt;
&lt;h3&gt;ç¼“å†²&lt;/h3&gt;
&lt;p&gt;ç¼“å†²åˆ†ä¸ºä¸‰ç§ï¼Œå…¨ç¼“å†²ã€è¡Œç¼“å†²ã€ä¸ç¼“å†²ã€‚æ ‡å‡†é”™è¯¯æ˜¯ä¸å¸¦ç¼“å†²çš„ï¼Œæ ‡å‡†è¾“å…¥è¾“å‡ºç­‰ç»ˆç«¯è®¾å¤‡æ˜¯è¡Œç¼“å†²çš„ï¼Œå…¶ä»–æ˜¯å…¨ç¼“å†²çš„ã€‚å¯ä»¥ä½¿ç”¨ setvbuf  å‡½æ•°æ›´æ”¹ç¼“å†²ç±»å‹ã€‚ä½¿ç”¨fflush å‡½æ•°å¼ºåˆ¶å†™å…¥ã€‚&lt;/p&gt;
&lt;h3&gt;æ–‡ä»¶æ“ä½œ&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ fopen/freopen/fdopen æ¥æ‰“å¼€æ–‡ä»¶ï¼Œä½¿ç”¨fcloseå…³é—­æ–‡ä»¶ã€‚ä½¿ç”¨fseekå’Œftellæ¥å®šä½æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h3&gt;å­—ç¬¦IO&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ getc/fgetc è¯»å–å•ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨ putc/fputc å†™å…¥å•ä¸ªå­—ç¬¦ã€‚æ³¨æ„å…¶ä¸­getc å¯ä»¥å®ç°ä¸ºå®ï¼Œè€Œfgetcå¾€å¾€å®ç°ä¸ºå‡½æ•°ï¼Œè¿™æ ·æ–¹ä¾¿ä¼ é€’æŒ‡é’ˆï¼Œä¸¤ä¸ªçš„åŠŸèƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚
å¦å¤–è¿˜æœ‰å‡½æ•° ungetc ç”¨äºå›é€€ä¸€ä¸ªå­—ç¬¦åˆ°è¯»å–çš„æ–‡ä»¶ä¸­ã€‚ungetc å’Œ putc çš„åŒºåˆ«åœ¨äºï¼Œä¸€ä¸ªæ˜¯å›é€€æ–‡ä»¶åˆ°è¯»æ¨¡å¼çš„æ–‡ä»¶ä¸­ï¼Œä¸€ä¸ªæ˜¯å†™å…¥åˆ°å†™æ¨¡å¼çš„æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;
&lt;h3&gt;è¡ŒIO&lt;/h3&gt;
&lt;p&gt;åƒä¸‡ä¸è¦ä½¿ç”¨getså’Œputså‡½æ•°ï¼å¯èƒ½é€ æˆç¼“å†²åŒºæº¢å‡ºæ”»å‡»ã€‚
fgetsä¼šè¯»å…¥n-1ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬æ¢è¡Œï¼‰ï¼ŒåŒæ—¶æŠŠæœ€åä¸€ä¸ªå­—ç¬¦ç½®ä¸ºnullã€‚fputsæŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å‡ºåˆ°æµä¸­ï¼Œä¸åŒ…æ‹¬ç»“å°¾çš„nullï¼Œä¹Ÿä¸ä¼šé¢å¤–è¾“å‡ºæ¢è¡Œã€‚&lt;/p&gt;
&lt;h3&gt;äºŒè¿›åˆ¶IO&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨freadå’Œfwriteå‡½æ•°æ¥å®ç°ç›´æ¥ä»æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªç»“æ„ç­‰æ•°æ®ç±»å‹ã€‚&lt;/p&gt;
&lt;h3&gt;æ ¼å¼åŒ–IO&lt;/h3&gt;
&lt;p&gt;printf/dprintf/fprintf/snprintf å‡½æ•°ï¼Œæ³¨æ„ä¸è¦ä½¿ç”¨sprintfå‡½æ•°ï¼Œå¯èƒ½é€ æˆç¼“å†²åŒºæº¢å‡ºæ”»å‡»ã€‚
è¿˜æœ‰vå¼€å¤´çš„å‡½æ•°ç»„ç”¨æ¥ä½¿ç”¨å•ä¸ªå‚æ•°ä»£æ›¿ vargsã€‚ä½¿ç”¨scanf/fscanf/sscanfè¯»å–æ•°æ®&lt;/p&gt;
&lt;h2&gt;ä¸´æ—¶æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ tmpname/tmpfile åˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚ä½¿ç”¨ mkdtempå’Œmkstempåˆ›å»ºä¸´æ—¶ç›®å½•ã€‚ä¸è¿‡å°½é‡ä½¿ç”¨tmpfileå’Œmkstempï¼Œä»¥é¿å…æ–‡ä»¶è¢«å ç”¨ã€‚&lt;/p&gt;
&lt;h2&gt;å†…å­˜æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨fmemopenæ¥åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ã€‚ä½†æ˜¯è¿™æ ·åˆ›å»ºçš„æ–‡ä»¶ä¼šè‡ªåŠ¨å†™å…¥nullï¼Œä¸é€‚åˆäºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨å¦å¤–ä¸¤ä¸ªå‡½æ•°ç”¨äºåˆ›å»ºå†…å­˜æ–‡ä»¶ï¼Œopen_memstream å’Œ open_wmemstreamã€‚è¿™ä¸¤ä¸ªå‡½æ•°åˆ›å»ºçš„æµåªèƒ½æ˜¯å†™æ‰“å¼€ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç›´æ¥è®¿é—®ç¼“å†²åŒºæ¥è¯»å–æ–‡ä»¶å†…å®¹ã€‚éå¸¸é€‚ç”¨äºåˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œæå‡æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h1&gt;æ–‡ä»¶ä¸ç›®å½•&lt;/h1&gt;
&lt;h2&gt;æ¦‚è¿°&lt;/h2&gt;
&lt;p&gt;æ¥è‡ªå¤´æ–‡ä»¶ sys/stat.h è°ƒç”¨ stat å‡½æ•°è¿”å› struct stat ç»“æ„ã€‚
ä½¿ç”¨S_ISXXX(st.st_mode)å®æ¥åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œæ˜¯å¦æ˜¯å¸¸è§„æ–‡ä»¶ã€ç›®å½•ç­‰ã€‚
st_modeä¸­è¿˜åŒ…å«äº†rwxç­‰æƒé™ï¼Œä½¿ç”¨S_IRUSR, S_IRGRP ç­‰å®æµ‹è¯•ã€‚&lt;/p&gt;
&lt;h2&gt;suid å’Œ sgid&lt;/h2&gt;
&lt;p&gt;åœ¨st_mode ä¸­åˆ†åˆ«æœ‰ä¸¤ä½ä»£è¡¨äº† st_uid å’Œ st_gidï¼Œåˆ†åˆ«è¡¨ç¤ºå½“æ‰§è¡Œæ­¤æ–‡ä»¶æ—¶ï¼Œå°†è¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ·IDè®¾ç½®ä¸ºæ–‡ä»¶æ‰€æœ‰è€…çš„ç”¨æˆ·IDï¼Œå¯ä»¥ä½¿ç”¨ S_ISUID, S_ISGID æµ‹è¯•ã€‚å¦å¤–å¯ä»¥ä½¿ç”¨ access å‡½æ•°æµ‹è¯•æ–‡ä»¶çš„å®é™…ç”¨æˆ·ID&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚/usr/bin/passwdç¨‹åºå…è®¸ä»»æ„ç”¨æˆ·æ›´æ”¹è‡ªå·±çš„å¯†ç ï¼Œä½†æ˜¯/etc/passwd è¿™ä¸ªæ–‡ä»¶åˆæ˜¯rootæ‰€æœ‰çš„ï¼Œè¿™æ—¶å€™å› ä¸º/usr/bin/passwdç¨‹åºè®¾ç½®äº†set_uidï¼Œæ™®é€šç”¨æˆ·è¿è¡Œpasswdç¨‹åºæ—¶å°±æ‹¥æœ‰äº†rootæƒé™ï¼Œä»è€Œå¯ä»¥æ›´æ”¹ /etc/passwd æ–‡ä»¶&lt;/p&gt;
&lt;h2&gt;æ–°æ–‡ä»¶çš„æƒé™&lt;/h2&gt;
&lt;p&gt;æ–°æ–‡ä»¶çš„ uid è®¾ç½®ä¸ºè¿›ç¨‹çš„æœ‰æ•ˆuidã€‚æ–°æ–‡ä»¶çš„ç»„IDå¯ä»¥æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿›ç¨‹çš„æœ‰æ•ˆgid&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶æ‰€åœ¨ç›®å½•çš„gidã€‚å¦‚æœæ‰€åœ¨ç›®å½•è®¾ç½®äº† set_gidã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;æƒé™æ“ä½œ&lt;/h2&gt;
&lt;h3&gt;umask&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨umaskæ¥è®¾å®šåˆ›å»ºæ–‡ä»¶çš„é»˜è®¤æƒé™ã€‚å¯ä»¥åœ¨shell ä¸­ä½¿ç”¨umask å‘½ä»¤æ¥è®¾å®šã€‚æˆ–è€…ä½¿ç”¨ umask å‡½æ•°ï¼š
mode_t umask(mode_t cmask); æ³¨æ„è¿™ä¸ªå‡½æ•°æ˜¯ä¸ºæ•°ä¸å¤šä¸åæ‚”é”™è¯¯ç çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;h3&gt;æ›´æ”¹æ–‡ä»¶å±æ€§&lt;/h3&gt;
&lt;p&gt;chmod å’Œ chown&lt;/p&gt;
&lt;h2&gt;é»ç€ä½&lt;/h2&gt;
&lt;p&gt;ä¸»è¦ç”¨äºå¯¹ç›®å½•æ“ä½œï¼Œå¦‚æœç›®å½•è®¾ç½®äº†é»ç€ä½ï¼Œåªæœ‰è¯¥æ–‡ä»¶çš„æ‹¥æœ‰è€…æˆ–è€…ç›®å½•çš„æ‹¥æœ‰è€…æ‰èƒ½å¤Ÿåˆ é™¤è¯¥æ–‡ä»¶ï¼Œæ¯”å¦‚ /tmp å¤§å®¶éƒ½å¯ä»¥å†™ï¼Œä½†æ˜¯ä¸èƒ½åˆ é™¤åˆ«äººçš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h1&gt;ç³»ç»Ÿæ•°æ®&lt;/h1&gt;
&lt;h1&gt;passwd æ–‡ä»¶&lt;/h1&gt;
&lt;p&gt;/etc/passwd ä¿å­˜äº†ç³»ç»Ÿä¸­çš„ç”¨æˆ·ç›¸å…³ä¿¡æ¯ï¼Œè™½ç„¶è¿™ä¸ªä¿¡æ¯æ˜¯çº¯æ–‡æœ¬çš„ï¼Œä½†æ˜¯éœ€è¦ä½¿ç”¨ç³»ç»Ÿå‡½æ•°æ¥è§£æï¼Œè€Œä¸æ˜¯è‡ªå·±è§£æè¿™ä¸ªæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;#include&amp;lt;pwd.h&amp;gt;
struct passwd *getpwuid(uid_t uid);
struct passwd *getpwnam(const char* name);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœéœ€è¦éå†è¿™ä¸ªæ–‡ä»¶çš„è¯ï¼Œä½¿ç”¨ getpwdent/setpwent/endpwent ä¸‰ä¸ªå‡½æ•°ã€‚entæ˜¯entryçš„ç¼©å†™ã€‚getpwentè·å¾—ä¸‹ä¸€ä¸ªé…ç½®é¡¹ï¼Œsetpwentè¿”å›ç¬¬ä¸€ä¸ªé…ç½®é¡¹ï¼Œendpwentå…³é—­æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç°ä»£çš„æ“ä½œç³»ç»Ÿï¼Œé€šå¸¸å°†çœŸå®çš„å¯†ç æ”¾åœ¨ /etc/shadow æ–‡ä»¶ä¸­ï¼Œä»è€Œé¿å…å¯†ç ç ´è§£ã€‚è€Œä½¿ç”¨æ•°æ®ç»“æ„ struct spwd æ¥å­˜å‚¨ç›¸å…³ä¿¡æ¯ã€‚ä¸ä¹‹å¯¹åº”ï¼Œå¯ä»¥ä½¿ç”¨ getspnam/getspent/setspent/endspent å‡½æ•°æ¥æ“ä½œè¿™ä¸ªæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2&gt;group æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;/etc/group æ–‡ä»¶ä¿å­˜äº†ç³»ç»Ÿä¸­çš„ç»„ç›¸å…³ä¿¡æ¯ã€‚åœ¨Cä¸­ä½¿ç”¨ struc group æ¥ä»£è¡¨è¿™ä¸ªç»“æ„ã€‚å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„å‡½æ•°æ¥è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼šgetgrpid getgrpnam getgrent/setgrent/endgrent&lt;/p&gt;
&lt;p&gt;ç°ä»£çš„unixæ“ä½œç³»ç»Ÿä¸­éƒ½åŒ…å«äº†è¾…åŠ©ç»„ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¿™äº›å‡½æ•°æ¥è®¿é—®è¾…åŠ©ç»„ä¿¡æ¯
getgroups/setgroups/initgroups&lt;/p&gt;
&lt;h2&gt;å…¶ä»–æ•°æ®åº“æ–‡ä»¶&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/etc/hosts/ &amp;lt;netdb.h&amp;gt; hostent | getnameinfo/getaddrinfo
/etc/networks &amp;lt;netdb.h&amp;gt; netent | getnetbyname/getnetbyaddr
/etc/protocols &amp;lt;netdb.h&amp;gt; protoent | getprotobyname/getprotobynumber
/etc/services &amp;lt;netdb.h&amp;gt; servent | getservbyname/get servbyport
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;hostname&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨unameå’Œgethostname/sethostnameæ¥æ“ä½œç›¸å…³æ•°æ®&lt;/p&gt;
&lt;h2&gt;æ—¶é—´å’Œæ—¥æœŸ&lt;/h2&gt;
&lt;p&gt;timeå‡½æ•°è¿”å›å½“å‰æ—¶é—´æˆ³ã€‚å¦ä¸€ä¸ªå¤šåŠŸèƒ½çš„å‡½æ•°æ˜¯clock_gettimeã€‚å¯ä»¥ä½¿ç”¨clockidæ¥åˆ¶å®šä¸åŒçš„åŠŸèƒ½ï¼Œå½“ä½¿ç”¨clock_gettime(CLOCK_REALTIME, tsp) æ—¶ï¼Œè¿”å›æ›´é«˜ç²¾åº¦çš„æ—¶é—´ã€‚åä¸€ä¸ªå‚æ•°æ˜¯timespecç±»å‹çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;struct timespec {
    time_t tv_sec;
    long tv_nsec;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ gettimeofday å’Œ struct timeval éƒ½å·²ç»åºŸå¼ƒäº†ï¼Œå»ºè®®ä½¿ç”¨clock_gettimeã€‚å¦å¤–ç›¸å…³çš„å‡½æ•°è¿˜æœ‰ clock_settime å’Œ clock_getresã€‚å¯ä»¥ä½¿ç”¨gmtimeå’Œlocaltimeæ¥å®šä¹‰struct tmï¼Œæ³¨æ„åœ¨struct tmä¸­æ²¡æœ‰æ—¶åŒºä¿¡æ¯ã€‚ä½¿ç”¨mktimeå¯ä»¥ä»struct tmè½¬æ¢åˆ°time_t æˆ–è€… timespecã€‚æ³¨æ„è¿™é‡Œæ˜¯ä»æœ¬åœ°æ—¶é—´è½¬æ¢ã€‚mktimeå‚è€ƒTZå˜é‡&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨strftimeå’Œstrftime_læ¥æŠŠstruct tm è½¬æ¢ä¸ºäººçœ¼å¯è¯»çš„å­—ç¬¦ä¸²ã€‚ä¸åŒçš„æ˜¯ï¼Œstrtimeåªä»TZç¯å¢ƒå˜é‡ä¸­è¯»å–æ—¶é—´ä¿¡æ¯ã€‚è€Œstrftime_låˆ™å¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®šã€‚&lt;/p&gt;
&lt;h1&gt;è¿›ç¨‹ç®¡ç†&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨atexitå¯ä»¥æ³¨å†Œåœ¨ç¨‹åºé€€å‡ºæ—¶è¿è¡Œçš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;h2&gt;Cç¨‹åºçš„å†…å­˜å¸ƒå±€&lt;/h2&gt;
&lt;p&gt;æ­£æ–‡æ®µtextã€å…¨å±€å¸¸é‡dataã€æœªåˆå§‹åŒ–æ•°æ®æ®µbssã€å †ã€æ ˆã€å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚åœ°å€ç”±ä½åˆ°é«˜ã€‚ä½¿ç”¨malloc/calloc/reallocå‡½æ•°åˆ†é…å†…å­˜ï¼Œä½¿ç”¨freeå‡½æ•°é‡Šæ”¾å†…å­˜ã€‚å †ä»ä½åœ°å€å‘é«˜åœ°å€å¢é•¿ï¼Œæ ˆä»é«˜åœ°å€å‘ä½åœ°å€å¢é•¿ã€‚&lt;/p&gt;
&lt;h2&gt;ç¯å¢ƒå˜é‡&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨å…¨å±€å¸¸é‡environè®¿é—®æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ï¼Œä½†æ˜¯å½“éœ€è¦è®¿é—®ä¸€ä¸ªå€¼çš„æ—¶å€™ï¼Œä½¿ç”¨getenvã€‚ä½¿ç”¨setenv/putenv/unsetenvç­‰å‡½æ•°æ›´æ–°ç¯å¢ƒå˜é‡ã€‚&lt;/p&gt;
&lt;h2&gt;éå±€éƒ¨è·³è½¬&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ setjmp è®¾å®šè·³è½¬çš„ä½ç½®ã€‚åœ¨ç¨‹åºæ­£å¸¸æ‰§è¡Œæ—¶ï¼Œsetjmpè¿”å›0ï¼Œå½“å‘ç”Ÿé”™è¯¯æ—¶ï¼Œè°ƒç”¨longjmpï¼ŒåŒæ—¶è®¾ç½®è¿”å›å€¼ï¼Œè¿™æ—¶å€™ä¼šå†æ¬¡è¿”å›åˆ°setjmpçš„ä½ç½®ï¼Œè¿”å›å€¼æ˜¯åˆšåˆšè®¾å®šçš„è¿”å›å€¼ã€‚jmp_buf ä¸€èˆ¬è®¾å®šä¸ºå…¨å±€å˜é‡&lt;/p&gt;
&lt;h2&gt;èµ„æºæ§åˆ¶&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ getrlimit/setrlimit ä¸¤ä¸ªå‡½æ•°&lt;/p&gt;
&lt;h1&gt;è¿›ç¨‹æ§åˆ¶&lt;/h1&gt;
&lt;h2&gt;pidç›¸å…³å‡½æ•°&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;getpid/getppid/getuid/geteuid/getgid/getegid
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åˆ›å»ºå­è¿›ç¨‹&lt;/h2&gt;
&lt;p&gt;fork åˆ›å»ºæ–°çš„è¿›ç¨‹ï¼Œå¹¶æŠŠçˆ¶è¿›ç¨‹çš„å±æ€§éƒ½å¤åˆ¶ä¸€ä»½ç»™å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹éšåå¯ä»¥æ‰§è¡Œç›¸åŒçš„ä»£ç ï¼ˆæ¯”å¦‚webæœåŠ¡å™¨ï¼‰ï¼Œæˆ–è€…è°ƒç”¨execæ‰§è¡Œæ–°çš„ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;linuxä¸Šè¿˜æœ‰æ›´é«˜çº§çš„clone è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;exec ä½¿ç”¨æ–‡ä»¶åå’Œå‚æ•°åˆ—è¡¨ä½œä¸ºå‚æ•°ï¼Œæ‰§è¡Œä¸€ä¸ªæ–°çš„ç¨‹åºã€‚è¿˜å¯ä»¥ä¼ é€’ç¯å¢ƒå˜é‡ã€‚å…¶ä¸­execveæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œå…¶ä»–å‡½æ•°åˆ™æ˜¯åº“å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨setuidå’Œsetgidæ¥æ”¹å˜è¿›ç¨‹çš„uidå’Œgidï¼Œä½†æ˜¯ä»…é™äºå®é™…uidå’Œæ–‡ä»¶çš„setuidã€‚&lt;/p&gt;
&lt;p&gt;systemå‡½æ•°ç›´æ¥æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œå¹¶è¿”å›æ‰§è¡Œç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåƒä¸‡ä¸è¦åœ¨setuidçš„ç¨‹åºä¸­ä½¿ç”¨systemå‡½æ•°ï¼Œè¿™æ ·ä¼šå¯¼è‡´systemè°ƒç”¨çš„å‘½ä»¤æƒé™è¿‡å¤§ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡niceå‡½æ•°å¯ä»¥è°ƒèŠ‚è¿›ç¨‹çš„niceå€¼ï¼Œniceå€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§æœˆåº•&lt;/p&gt;
&lt;h2&gt;è¿›ç¨‹é€€å‡º&lt;/h2&gt;
&lt;p&gt;åœ¨Unixä¸Šï¼Œexitæ˜¯ä¸€ä¸ªåº“å‡½æ•°ï¼Œ_exitæ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚æ‰€æœ‰çˆ¶è¿›ç¨‹ç»“æŸçš„è¿›ç¨‹ï¼Œä»–ä»¬çš„çˆ¶è¿›ç¨‹ä¼šå˜ä¸ºinitè¿›ç¨‹ã€‚çˆ¶è¿›ç¨‹æœ‰ä¹‰åŠ¡å¤„ç†å­è¿›ç¨‹çš„ç°åœºï¼Œå¯¹äºå·²ç»é€€å‡ºï¼Œä½†æ˜¯çˆ¶è¿›ç¨‹è¿˜æ²¡æœ‰å¤„ç†çš„è¿›ç¨‹ï¼Œç§°ä¹‹ä¸ºåƒµå°¸è¿›ç¨‹ï¼Œè€Œinitè¿›ç¨‹æ€»ä¼šå›æ”¶ä»–çš„å­è¿›ç¨‹ï¼Œé¿å…é€ æˆåƒµå°¸è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿›ç¨‹é€€å‡ºåï¼Œç³»ç»Ÿä¼šå‘çˆ¶è¿›ç¨‹å‘é€ä¿¡å·ï¼Œçˆ¶è¿›ç¨‹å¯ä»¥åœ¨è¿™æ—¶å€™å›æ”¶è¿›ç¨‹ã€‚å¯ä»¥ä½¿ç”¨wait/waitpid/waitid æ¥è·å–é€€å‡ºçš„è¿›ç¨‹çš„IDï¼Œä»è€Œè¿›è¡Œç›¸åº”çš„æ¸…ç†ã€‚å…¶ä¸­waitid åº”è¯¥æ˜¯æœ€å¥½çš„ï¼Œä½†æ˜¯ä¼¼ä¹æ¯”è¾ƒæ–°ï¼Œæ–‡æ¡£ä¸å¤š&lt;/p&gt;
&lt;p&gt;ä¿¡å·å®šä¹‰çš„å¤´æ–‡ä»¶æ˜¯ singal.h &lt;/p&gt;
&lt;p&gt;restrict keyword&lt;/p&gt;
&lt;p&gt;restrict says that the pointer is the only thing that accesses the underlying object. It eliminates the potential for pointer aliasing, enabling better optimization by the compiler.
For instance, suppose I have a machine with specialized instructions that can multiply vectors of numbers in memory, and I have the following code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;void MultiplyArrays(int* dest, int* src1, int* src2, int n) {
    for(int i = 0; i &amp;lt; n; i++) {
        dest[i] = src1[i]*src2[i];
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The compiler needs to properly handle if dest, src1, and src2 overlap, meaning it must do one multiplication at a time, from start to the end. By having restrict, the compiler is free to optimize this code to using the vector instructions.
EDIT: Wikipedia has an entry on restrict, with another example, here.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 04:50:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/apue-yue-du-bi-ji.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>å­¦ä¹  Startup Engineering</title><link>/posts/xue-xi-startup-engineering.html</link><description>&lt;p&gt;https://gist.github.com/dideler/5796745&lt;/p&gt;
&lt;p&gt;Startups vs. Small Businessesï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A startup is about growth and usually involves new technology and unproven business models.&lt;/li&gt;
&lt;li&gt;A small business, by contrast, does not have ambitions of world domination and is usually geared towards a particular geographical area or limited market where it has some degree of monopoly through virtue of sheer physical presence.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Shift per-unit costs into fixed costs (e.g. via software).
Costly up-front software development can pay off in the long run.&lt;/p&gt;
&lt;p&gt;Pricing is important; to the extent that you are not constrained by competition, you really do want toÂ charge the highest possible price at the beginningÂ to get into the black as soon as possible.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Figure out the precise minimum scope of what you want to create&lt;/li&gt;
&lt;li&gt;Calculate how much money is required to achieve that minimum goal&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;50 ç¾å…ƒçš„å®šä»·æ˜¯æ¯”è¾ƒå¥½&lt;/p&gt;
&lt;p&gt;Measure growth rate per week, but only after you've launched. A good growth rate (during YC) isÂ 5-7% a week. If you can hit 10% a week you're doing exceptionally well. If you can only manage 1%, it's a sign you haven't yet figured out what you're doing.
Focus on just hitting a growth rate every week. This focus reduces the otherwise bewilderingly multifarious problem of starting a startup to a single problem.Â Use that target growth rate to make all your decisions for you. Having to hit a growth number every week forces founders to act. Nine times out of ten, sitting aroundÂ strategizing is just a form of procrastination.
Best thing to measure growth rate of isÂ revenueÂ for startups that charge initially, andÂ active usersÂ for startups that do not.&lt;/p&gt;
&lt;p&gt;Be aggressive when recruiting new users.Â Manually and individually recruit your initial users; go out to a coffee shop and have people try your product. Go door-to-door. Have people sign up for your beta in person. The numbers will seem small at first, but don't be fooled by compound growth - it starts slow.&lt;/p&gt;
&lt;p&gt;One advantage of being small:Â you can provide a level of service no big company can.&lt;/p&gt;
&lt;p&gt;Sometimes the right unscalable trick is toÂ focus on a deliberately narrow market. It's always worth asking if there's a subset of the market in which you can get a critical mass of users quickly.&lt;/p&gt;
&lt;p&gt;TL;DR recruit users manually and give them an overwhelmingly good experience, and founders need to work hard&lt;/p&gt;
&lt;p&gt;YNï¼šæˆ‘æ€»æ˜¯æƒ³ç€èƒ½å¤Ÿè‡ªåŠ¨åŒ–åœ°å¤§è§„æ¨¡æ‹›å‹Ÿç”¨æˆ·ï¼Œè¿™æ˜¯é”™çš„ã€‚åœ¨å‘å±•åˆ°ä¸€å®šé˜¶æ®µä»¥åæ‰éœ€è¦ã€‚&lt;/p&gt;
&lt;p&gt;TL;DR recruit users manually and give them an overwhelmingly good experience, and founders need to work hard&lt;/p&gt;
&lt;p&gt;You want to find aÂ small marketÂ to quicklyÂ create a monopoly, and then expand. You've found it whenÂ people depend on itÂ even when it's still a crappy incomplete product.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 04:41:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/xue-xi-startup-engineering.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>æŠ€æœ¯é€‰å‹çš„æŠ€å·§</title><link>/posts/ji-zhu-xuan-xing-de-ji-qiao.html</link><description>&lt;h1&gt;ä¸è¦é­”æ”¹åŸç³»ç»Ÿ&lt;/h1&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬çš„å»ºè®®æ˜¯ä¸è¦æ”¹åŠ¨åŸç³»ç»Ÿï¼Œè€Œæ˜¯è¦å¼€å‘è¾…åŠ©ç³»ç»Ÿ:ç›‘æ§ï¼ŒæŠ¥è­¦ï¼Œè´Ÿè½½å‡è¡¡ï¼Œç®¡ç†ç­‰ã€‚ä»¥Redisä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¢åŠ é›†ç¾¤åŠŸèƒ½ï¼Œä¸è¦å»æ”¹åŠ¨Redisæœ¬èº«çš„å®ç°ï¼Œè€Œæ˜¯å¢åŠ ä¸€ä¸ªproxyå±‚æ¥å®ç°ï¼ŒTwitterçš„Twemproxyå°±æ˜¯è¿™æ ·åšçš„ï¼Œè€ŒRedisåˆ°äº†3.0åæœ¬èº«æä¾›äº†é›†ç¾¤åŠŸèƒ½ï¼ŒåŸæœ‰çš„æ–¹æ¡ˆç®€å•åˆ‡æ¢åˆ°Redis3.0å³å¯ã€‚è¯¦ç»†å¯å‚è€ƒ(http://www.cnblogs.com/gomysql/p/4413922.html)&lt;/p&gt;
&lt;p&gt;å¦‚æœå®åœ¨æƒ³æ”¹åˆ°åŸæœ‰ç³»ç»Ÿï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬çš„å»ºè®®æ˜¯ç›´æ¥ç»™å¼€æºé¡¹ç›®æéœ€æ±‚æˆ–è€…bugï¼Œä½†å¼Šç«¯å°±æ˜¯å“åº”æ¯”è¾ƒç¼“æ…¢ï¼Œè¿™ä¸ªå°±è¦çœ‹ä¸šåŠ¡ç´§æ€¥ç¨‹åº¦äº†ï¼Œå¦‚æœå®åœ¨å¤ªæ€¥é‚£å°±åªèƒ½è‡ªå·±æ”¹äº†ï¼Œä¸è¿‡ä¸æ˜¯å¤ªæ€¥ï¼Œå»ºè®®åšå¥½å¤‡ä»½æˆ–è€…åº”æ€¥æ‰‹æ®µå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰é’±æœ‰äººæœ‰æ—¶é—´ï¼ŒæŠ•å…¥äººåŠ›å»é‡å¤å‘æ˜å®Œç¾ç¬¦åˆè‡ªå·±ä¸šåŠ¡ç‰¹ç‚¹çš„è½®å­ä¹Ÿæ˜¯å¾ˆå¥½çš„é€‰æ‹©ï¼æ¯•ç«Ÿï¼ŒåœŸè±ªä»¬ï¼ˆBAT......ç­‰ï¼‰å¾ˆå¤šéƒ½æ˜¯è¿™æ ·åšçš„ï¼Œå¦åˆ™çš„è¯æˆ‘ä»¬ä¹Ÿå°±æ²¡æœ‰é‚£ä¹ˆå¤šå¥½ç”¨çš„å¼€æºé¡¹ç›®äº† :)&lt;/p&gt;
&lt;p&gt;é­”æ”¹ç³»ç»Ÿçš„å¦ä¸€ä¸ªä¸å¥½æ˜¯å‘˜å·¥çš„ä¸æ»¡ã€‚å¯¹äºå‘˜å·¥æ¥è¯´ï¼Œè‡ªç„¶å¸Œæœ›èƒ½å¤Ÿåœ¨ç®€å†ä¸Šå†™ä¸Šä¸€äº›é€šç”¨çš„æŠ€èƒ½ï¼Œè€Œä½¿ç”¨å…¬å¸å†…éƒ¨å·¥å…·çš„åŒ–ï¼Œå¯¹å‘˜å·¥çš„å‘å±•ä¹Ÿä¸åˆ©ã€‚&lt;/p&gt;
&lt;p&gt;æ¥æºï¼šhttps://book.douban.com/review/6456359/&lt;/p&gt;
&lt;p&gt;çªç„¶æƒ³èµ·æ¥æˆ‘ä»¬ä¹‹å‰ä¸€ä¸ªç»éªŒæ¯”è¾ƒä¸°å¯Œçš„åŒäº‹å‘Šè¯‰æˆ‘ï¼Œä»–å­¦ä¹ çš„æ–¹æ³•å°±æ˜¯ä¸€ä»¶äº‹æƒ…å…ˆæ‰¾åˆ°æ–¹æ³•ç»™å¹²æ‰ï¼Œå…ˆçŸ¥é“æ€ä¹ˆç”¨ï¼Œå†ç³»ç»Ÿçš„çœ‹ä¹¦å­¦ä¹ ï¼Œå€Ÿæ­¤å’Œå¤§å®¶åˆ†äº«ã€‚&lt;/p&gt;
&lt;h1&gt;ä¸è¦é€‰æ‹©è¿‡äºå°ä¼—çš„æŠ€æœ¯&lt;/h1&gt;
&lt;p&gt;å¦‚æœä½ æ˜¯ä½ ä»¬æ–°ç”¨æˆ·æœ€å¤§çš„ç”¨æˆ·ï¼Œé‚£ä¹ˆä½ é‡åˆ°çš„é—®é¢˜å°†ä¼šæ˜¯æœ€å¤§çš„&lt;/p&gt;
&lt;p&gt;Maturity = (Blood + Sweat) / Complexity&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Jun 2018 04:39:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-22:/posts/ji-zhu-xuan-xing-de-ji-qiao.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>mysql åŸºç¡€çŸ¥è¯†(8) - ä¸»ä»å¤åˆ¶</title><link>/posts/mysql-ji-chu-zhi-shi-8-zhu-cong-fu-zhi.html</link><description>&lt;p&gt;mysql æœ‰ä¸‰ç§ä¸»ä»å¤åˆ¶æ–¹å¼&lt;/p&gt;
&lt;p&gt;MySQLä¼ ç»Ÿçš„é«˜å¯ç”¨è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡binlogå¤åˆ¶æ¥æ­å»ºä¸»ä»æˆ–ä¸€ä¸»å¤šä»çš„æ•°æ®åº“é›†ç¾¤ã€‚ä¸»ä»ä¹‹é—´çš„å¤åˆ¶æ¨¡å¼æ”¯æŒå¼‚æ­¥æ¨¡å¼(async replication)å’ŒåŠåŒæ­¥æ¨¡å¼(semi-sync replication)ã€‚æ— è®ºå“ªç§æ¨¡å¼ä¸‹ï¼Œéƒ½æ˜¯ä¸»åº“masteræä¾›è¯»å†™äº‹åŠ¡çš„èƒ½åŠ›ï¼Œè€Œslaveåªèƒ½æä¾›åªè¯»äº‹åŠ¡çš„èƒ½åŠ›ã€‚åœ¨masterä¸Šæ‰§è¡Œçš„æ›´æ–°äº‹åŠ¡é€šè¿‡binlogå¤åˆ¶çš„æ–¹å¼ä¼ é€ç»™slaveï¼Œslaveæ”¶åˆ°åå°†äº‹åŠ¡å…ˆå†™å…¥relay logï¼Œç„¶åé‡æ”¾äº‹åŠ¡ï¼Œå³åœ¨slaveä¸Šé‡æ–°æ‰§è¡Œä¸€æ¬¡äº‹åŠ¡ï¼Œä»è€Œè¾¾åˆ°ä¸»ä»æœºäº‹åŠ¡ä¸€è‡´çš„æ•ˆæœã€‚Â &lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tNc79gy1fsfd8akzrlj30o108at9e.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä»–æ–‡æ¡£ï¼š&lt;/p&gt;
&lt;p&gt;http://mysql.taobao.org/monthly/2017/08/01/
http://blog.csdn.net/d6619309/article/details/53691352
http://blog.51cto.com/wangwei007/1893703
https://www.digitalocean.com/community/tutorials/how-to-configure-mysql-group-replication-on-ubuntu-16-04
http://blog.csdn.net/d6619309/article/details/53691352
http://mysql.taobao.org/monthly/2017/08/01/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 18 Jun 2018 07:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-18:/posts/mysql-ji-chu-zhi-shi-8-zhu-cong-fu-zhi.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>ä½¿ç”¨ Ansible éƒ¨ç½²æœåŠ¡</title><link>/posts/shi-yong-ansible-bu-shu-fu-wu.html</link><description>&lt;p&gt;ansible çš„æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è¿›è¡Œä»»æ„æ¬¡æ“ä½œè€Œä¸ä¼šé€ æˆå‰¯ä½œç”¨ã€‚ansible åŸºäº sshï¼Œä¸éœ€è¦åœ¨ç›®æ ‡æœºå™¨ä¸Šè¿è¡Œä»»ä½•ç‰¹æ®Šçš„ agentã€‚&lt;/p&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo pip3 install ansible
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Hosts æ–‡ä»¶&lt;/h1&gt;
&lt;p&gt;ansible ä½¿ç”¨ &lt;code&gt;hosts&lt;/code&gt; æ–‡ä»¶æ¥ç®¡ç†ä¸»æœºï¼Œæ¯ä¸ªHostsä¸­å®šä¹‰å¤šä¸ª Inventoryï¼Œå¯ä»¥è®¤ä¸ºæ˜¯åˆ†ç»„çš„ä¸»æœº&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä½ç½®: &lt;code&gt;/etc/ansible/hosts&lt;/code&gt;ã€‚å¯ä»¥ä½¿ç”¨ &lt;code&gt;-i&lt;/code&gt; æ¥æŒ‡å®š Inventory æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;format&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[inventory_name]&lt;/span&gt;
&lt;span class="na"&gt;192.168.0.1&lt;/span&gt;
&lt;span class="c1"&gt;# æˆ–è€…åŸŸå&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœéœ€è¦æ”¹å˜ç™»å½•ä½¿ç”¨çš„ç”¨æˆ·åï¼Œå¯ä»¥åœ¨å½“å‰ç›®å½•çš„ &lt;code&gt;ansible.cfg&lt;/code&gt; æˆ–è€… &lt;code&gt;$HOME/.ansible.cfg&lt;/code&gt; æˆ–è€… &lt;code&gt;/etc/ansible/ansible.cfg&lt;/code&gt; ä¸­æŒ‡å®šï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[defaults]&lt;/span&gt;
&lt;span class="na"&gt;remote_user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;rabbit&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åŠ¨æ€ Inventory&lt;/h2&gt;
&lt;p&gt;see ec2.py&lt;/p&gt;
&lt;h2&gt;Builtin Variables&lt;/h2&gt;
&lt;p&gt;see https://github.com/lorin/ansible-quickref&lt;/p&gt;
&lt;h1&gt;è¿è¡Œå‘½ä»¤&lt;/h1&gt;
&lt;p&gt;ansible ä½¿ç”¨moduleæ¥ç»„ç»‡å‘½ä»¤ã€‚&lt;/p&gt;
&lt;h2&gt;é€‰é¡¹&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-m  module to run
-s  use sudo
-k  ask for key/password
-u  user
-a  ä¼ é€’ç»™ module çš„å‚æ•°
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä¾‹å­&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ansible -i ./hosts all -m ping 
ansible -i ./hosts all -m shell -a &amp;#39;apt-get install nginx&amp;#39;
ansible -i ./hosts all -s -m apt -a &amp;#39;pkg=nginx state=installed update_cache=true&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å“åº”&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;host | state &amp;gt;&amp;gt; {
    &amp;quot;changed&amp;quot;: false # whether the host is affected by the command
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ansible å†…ç½®çš„ module æœ‰: ping, shell&lt;/p&gt;
&lt;h1&gt;Playbook&lt;/h1&gt;
&lt;p&gt;ansible å¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œä½¿ç”¨ï¼Œä½†æ˜¯æœ€ç»ˆéœ€è¦çš„å‘½ä»¤å¯èƒ½å¾ˆé•¿ï¼Œä¸è¿‡æœ€å¥½çš„æ–¹å¼è¿˜æ˜¯ä½¿ç”¨ playbook æ¥æŠŠéœ€è¦è¿è¡Œçš„å‘½ä»¤å†™æˆ yaml æ–‡ä»¶ã€‚å°±åƒæ˜¯ docker ç›¸å…³çš„å‘½ä»¤å¯ä»¥å†™æˆ docker-compose çš„é…ç½®æ–‡ä»¶ä¸€æ ·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;- hosts: local&lt;/span&gt;
&lt;span class="x"&gt;  # define variables&lt;/span&gt;
&lt;span class="x"&gt;Â  vars:&lt;/span&gt;
&lt;span class="x"&gt;Â Â  - docroot: /var/www/serversforhackers.com/public&lt;/span&gt;
&lt;span class="x"&gt;  # more options goes here&lt;/span&gt;
&lt;span class="x"&gt;  # ...&lt;/span&gt;

&lt;span class="x"&gt;  # tasks are the basic action unit&lt;/span&gt;
&lt;span class="x"&gt;Â  tasks:&lt;/span&gt;
&lt;span class="x"&gt;Â Â  - name: Add Nginx Repository&lt;/span&gt;
&lt;span class="x"&gt;     # module apt_repository&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  apt_repository: repo=&amp;#39;ppa:nginx/stable&amp;#39; state=present&lt;/span&gt;
&lt;span class="x"&gt;     # register an event&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  register: ppastable&lt;/span&gt;

&lt;span class="x"&gt;Â Â  - name: Install Nginx&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  apt: pkg=nginx state=installed update_cache=true&lt;/span&gt;
&lt;span class="x"&gt;     # listen an event, run only it happens&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  when: ppastable|success&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  register: nginxinstalled&lt;/span&gt;
&lt;span class="x"&gt;    # notify calles handlers&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  notify:&lt;/span&gt;
&lt;span class="x"&gt;Â  Â  Â  - Start Nginx&lt;/span&gt;

&lt;span class="x"&gt;Â Â  - name: Create Web Root&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  when: nginxinstalled|success&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  file: dest=&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{{&amp;#39;&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt; docroot &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;}}&amp;#39;&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt; mode=775 state=directory owner=www-data group=www-data&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  notify:&lt;/span&gt;
&lt;span class="x"&gt;Â  Â  Â  - Reload Nginx&lt;/span&gt;

&lt;span class="x"&gt;  # handlers are like functions, called by `notify`&lt;/span&gt;
&lt;span class="x"&gt;Â  handlers:&lt;/span&gt;
&lt;span class="x"&gt;Â Â  - name: Start Nginx&lt;/span&gt;
&lt;span class="x"&gt;Â Â  Â  service: name=nginx state=started&lt;/span&gt;

&lt;span class="x"&gt;Â  Â  - name: Reload Nginx&lt;/span&gt;
&lt;span class="x"&gt;Â  Â  Â  service: name=nginx state=reloaded&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;éƒ¨ç½² docker&lt;/h1&gt;
&lt;p&gt;&lt;a href="http://yifei.me/note/569"&gt;ä½¿ç”¨ ansible éƒ¨ç½² docker é•œåƒ&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;REF&lt;/h1&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« ä¸»è¦å‚è€ƒ&lt;a href="https://serversforhackers.com/c/an-ansible2-tutorial"&gt;è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 18 Jun 2018 03:16:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-18:/posts/shi-yong-ansible-bu-shu-fu-wu.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>tmux cheatsheet</title><link>/posts/tmux-cheatsheet.html</link><description>&lt;p&gt;if you use set mouse off, then you could use system mark and copy, or if you are  in Mac, you could use Option + Mouse Select&lt;/p&gt;
&lt;h1&gt;æŒ‰é”®ç»‘å®š&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;C-b         å‘é€ Ctrl-b æŒ‰é”®
C-z         æš‚åœï¼ˆsuspendï¼‰ tmux å®¢æˆ·ç«¯
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;çª—å£åˆ›å»ºä¸ç®¡ç†&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;!           æŠŠå½“å‰åˆ†åŒºç‹¬ç«‹å‡ºæ¥ä½œä¸ºå•ç‹¬çš„çª—å£
&amp;quot;           æ¨ªå‘åˆ†éš”ï¼Œå˜æˆä¸Šçº¿ä¸¤ä¸ªåˆ†åŒº
%           çºµå‘åˆ†éš”ï¼Œå˜æˆå·¦å³ä¸¤ä¸ªåˆ†åŒº
&amp;amp;           å…³é—­å½“å‰çª—å£ï¼ˆwindowï¼‰ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰çš„åˆ†åŒº                    
.           Prompt for an index to move the current window.
c           åˆ›å»ºä¸€ä¸ªæ–°çª—å£
x           å…³é—­å½“å‰åˆ†åŒºï¼ˆpaneï¼‰
{           Swap the current pane with the previous pane.
}           Swap the current pane with the next pane.
C-o         Rotate the panes in the current window forwards.
M-o         Rotate the panes in the current window backwards.
C-Up, C-Down
C-Left, C-Right
            Resize the current pane in steps of one cell.
M-Up, M-Down
M-Left, M-Right
            Resize the current pane in steps of five cells.
M-1 to M-5  Arrange panes in one of the five preset layouts: even-horizontal, even-vertical, main-horizontal, main-vertical, or tiled.
Space       Arrange the current window in the next preset layout.
M-n         Move to the next window with a bell or activity marker.
M-p         Move to the previous window with a bell or activity marker.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;copy and paste&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;#           List all paste buffers.
-           Delete the most recently copied buffer of text.
=           Choose which buffer to paste interactively from a list.
[           Enter copy mode to copy text or view the history.
]           Paste the most recently copied buffer of text.
Page Up     Enter copy mode and scroll one page up.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;rename&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$           Rename the current session.
,           Rename the current window.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;é€‰æ‹©çª—å£&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;#39;           Prompt for a window index to select.
(           Switch the attached client to the previous session.
)           Switch the attached client to the next session.
0 to 9      Select windows 0 to 9.
l           Move to the previously selected window. remapped to \
n           Change to the next window.
o           Select the next pane in the current window.
p           Change to the previous window.
s           Select a new session for the attached client interactively.
w           Choose the current window interactively.
;           Move to the previously active pane.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å…¶ä»–&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;:           Enter the tmux command prompt.
?           List all key bindings.
D           Choose a client to detach.
L           Switch the attached client back to the last session.        
d           Detach the current client.
f           Prompt to search for text in open windows.
i           Display some information about the current window.
q           Briefly display pane indexes.
r           Force redraw of the attached client.
m           Mark the current pane (see select-pane -m).
M           Clear the marked pane.
t           Show the time
z           Toggle zoom state of the current pane.
           ~           Show previous messages from tmux, if any.

           Up, Down
           Left, Right
                       Change to the pane above, below, to the left, or to the right of the current pane.
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;dtach&lt;/h1&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼ tmux çš„å‘½ä»¤ dtachï¼Œä¸è¿‡åæ¥æ²¡æ€ä¹ˆç”¨äº†ï¼Œç¬”è®°è¿˜æ˜¯ç•™åœ¨è¿™é‡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dtach&lt;/code&gt; is used to detach and attach to a session.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dtach&lt;/code&gt; works with a session file, and can detach and attach to a session, but it has no functionality of terminal multiplexing.&lt;/p&gt;
&lt;p&gt;Formula
    dtach [mode] [session_file] [options] [command]&lt;/p&gt;
&lt;p&gt;&lt;code&gt;dtach&lt;/code&gt; modes are &lt;code&gt;-a&lt;/code&gt; attach, &lt;code&gt;-A&lt;/code&gt; attach or create, &lt;code&gt;-c&lt;/code&gt; creates a new session and attach, &lt;code&gt;-n&lt;/code&gt; creates without attach.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 18 Jun 2018 00:54:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-18:/posts/tmux-cheatsheet.html</guid><category>å°å·¥å…·</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>Python çš„å†…ç½®ç±»å‹å’Œå‡½æ•°</title><link>/posts/python-de-nei-zhi-lei-xing-he-han-shu.html</link><description>&lt;h1&gt;å†…ç½®ç±»å‹&lt;/h1&gt;
&lt;p&gt;Pythonçš„å†…ç½®ç±»å‹æŒ‰ç…§ç±»æ¥åˆ†ï¼ŒåŒ…æ‹¬äº† numerics, sequences, mappings, files, classes, instances å’Œ exceptions
ã€‚å¯¹ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹çš„å®ä¾‹ï¼Œå¦‚æœ__nonzero__æˆ–è€…__len__è¿”å›æ˜¯ 0 æˆ– False ä¼šè¢«è®¤ä¸ºæ˜¯å‡ã€‚&lt;/p&gt;
&lt;h2&gt;æ³¨æ„æµ…æ‹·è´&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; lists = [[]] * 3
&amp;gt;&amp;gt;&amp;gt; lists
[[], [], []]
&amp;gt;&amp;gt;&amp;gt; lists[0].append(3)
&amp;gt;&amp;gt;&amp;gt; lists
[[3], [3], [3]]
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å­—å…¸çš„ä¸€äº›æ–¹æ³•&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;keys()/values()
iterkeys()/itervalues()
items()/iteritems()
update()
get(key, default)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯èƒ½ä¼šæŠ›å‡º&lt;/p&gt;
&lt;p&gt;read/readline/readlines
write/writelines&lt;/p&gt;
&lt;h2&gt;å­—ç¬¦ä¸²æ–¹æ³•&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;str.capitalize()    é¦–å­—æ¯å¤§å†™
center/ljust/rjust(width, filled_char)  æ‰©å……å¹¶ä½¿å¾—åŸå­—ç¬¦ä¸²å±…ä¸­
decode(codecsm, how_to_handle_erroe)    throws UnicodeError
encode(codecs, how_to_handle_error)     throws UnicodeError
startswith(string or tuple) 
endswith(seq, start, end)   
find(seq, start, end)   
isalnum/isalpha/isdigit/islower/isupper/isspace 
lower()/upper()/title() 
strip/lstrip/rstrip(chars)  
partition(seq)  è¿”å›ä¸€ä¸ªä¸‰å…ƒç»„å‰åŠéƒ¨åˆ†ï¼Œseqï¼ŒååŠéƒ¨åˆ†
replace(old, new, count)    
split(seq, count)   
splitlines(keepends)    
zfill(width)    å·¦è¾¹å¡«é›¶
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å†…ç½®å‡½æ•°&lt;/h1&gt;
&lt;h2&gt;å‡½æ•°å¼ç¼–ç¨‹å¯¹åº”çš„å†…ç½®å‡½æ•°&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;all
any
callable
filter
iter
map
next
reduce(fn, iter, init)
reload
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ“ä½œå±æ€§çš„å‡½æ•°&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;delattr 
dir return a object&amp;#39;s attributes
getattr(object, name, default)  when default supplied, no exception thrown
hasattr 
globals 
locals
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å†…ç½®æ•°å­¦åº“&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;compile 
complex 
bin Convert an integer number to a binary string
abs 
divmod  
enumerate   
eval    
execfile    
file    
hex     
max/min 
oct 
pow
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ç±»å‹&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;frozenset   
bool    
dict    
float   note float(&amp;#39;NaN&amp;#39;), float(&amp;#39;-inf&amp;#39;)     
int(x, base=10) 
list    
long    
object
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;bytearrayå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªå¯å˜çš„ string&lt;/li&gt;
&lt;li&gt;frozensetæ˜¯ä¸€ä¸ªimmutable, hashableçš„ set&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å…¶ä»–å‡½æ•°&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;format
enumerate
id
input/raw_inoput
isinstance(object, class/class_tuple)
insubclass(class, class)
len
open
print
range/xrange(start, stop, step)
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 18 Jun 2018 00:16:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-18:/posts/python-de-nei-zhi-lei-xing-he-han-shu.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>django å•å…ƒæµ‹è¯•</title><link>/posts/django-dan-yuan-ce-shi.html</link><description>&lt;p&gt;å’Œæ™®é€šçš„å•å…ƒæµ‹è¯•ä¸åŒçš„æ˜¯ï¼Œdjango å•ç‹¬æä¾›äº†ä¸€ä¸ªæµ‹è¯•æ¨¡å—ï¼Œæ‰€æœ‰çš„ TestCase éœ€è¦ç»§æ‰¿ django.test.TestCaseã€‚&lt;/p&gt;
&lt;h2&gt;ç®€å•çš„æµ‹è¯•&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.test&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TestCase&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;myapp.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Animal&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AnimalTestCase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;setUp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;Animal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;lion&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sound&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;roar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;Animal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sound&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;meow&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_animals_can_speak&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Animals that can speak are correctly identified&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;lion&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Animal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;lion&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Animal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lion&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;speak&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;The lion says &amp;quot;roar&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;speak&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;The cat says &amp;quot;meow&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯¹äºéœ€è¦æµ‹è¯•æœåŠ¡å™¨çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;django.test.Client&lt;/code&gt; ç±»&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.test&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TestCase&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SimpleTest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_details&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/customer/details/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/customer/index/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Jun 2018 23:39:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-17:/posts/django-dan-yuan-ce-shi.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>django å›½é™…åŒ–</title><link>/posts/django-guo-ji-hua.html</link><description>&lt;p&gt;settings.py ä¸­çš„è®¾ç½®ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;MIDDLEWARE_CLASSES = (
    ...
    &amp;#39;django.middleware.locale.LocaleMiddleware&amp;#39;,
)


LANGUAGE_CODE = &amp;#39;en&amp;#39;
TIME_ZONE = &amp;#39;UTC&amp;#39;
USE_I18N = True
USE_L10N = True
USE_TZ = True

LANGUAGES = (
    (&amp;#39;en&amp;#39;, (&amp;#39;English&amp;#39;)),
    (&amp;#39;zh-hans&amp;#39;, (&amp;#39;ä¸­æ–‡ç®€ä½“&amp;#39;)),
    (&amp;#39;zh-hant&amp;#39;, (&amp;#39;ä¸­æ–‡ç¹é«”&amp;#39;)),
)

#ç¿»è¯‘æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œéœ€è¦æ‰‹å·¥åˆ›å»º
LOCALE_PATHS = (
    os.path.join(BASE_DIR, &amp;#39;locale&amp;#39;),
)

TEMPLATE_CONTEXT_PROCESSORS = (
    ...
    &amp;quot;django.core.context_processors.i18n&amp;quot;,
)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç”Ÿæˆéœ€è¦ç¿»è¯‘çš„æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py makemessages -l zh_hans
python manage.py makemessages -l zh_hant
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç¿»è¯‘å…¶ä¸­çš„ django.po æ–‡ä»¶ï¼Œæ³¨æ„&lt;code&gt;.po&lt;/code&gt;æ–‡ä»¶æ˜¯ä¸€ç§é€šç”¨çš„æ ¼å¼ï¼Œæœ‰å¾ˆå¤šä¸“é—¨çš„ç¼–è¾‘å™¨&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘ç¿»è¯‘å¥½çš„æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py compilemessages
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Jun 2018 23:07:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-17:/posts/django-guo-ji-hua.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>django é¡µé¢ç¼“å­˜</title><link>/posts/django-ye-mian-huan-cun.html</link><description>&lt;p&gt;django ä½œä¸ºä¸€ä¸ªåŠ¨æ€çš„ç½‘ç«™ç³»ç»Ÿï¼Œåœ¨å¹¶å‘è®¿é—®é‡å¤§çš„æ—¶å€™ä¼šé‡åˆ°æ€§èƒ½é—®é¢˜ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ç¼“å­˜æ¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;settings.py ä¸­çš„é…ç½®&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ django-redis æ¥ä½¿ç”¨redisä½œä¸ºç¼“å­˜ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install django-redis
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CACHES = {
    &amp;quot;default&amp;quot;: {
        &amp;quot;BACKEND&amp;quot;: &amp;quot;django_redis.cache.RedisCache&amp;quot;,
        &amp;quot;LOCATION&amp;quot;: &amp;quot;redis://127.0.0.1:6379/1&amp;quot;,
        &amp;quot;OPTIONS&amp;quot;: {
            &amp;quot;CLIENT_CLASS&amp;quot;: &amp;quot;django_redis.client.DefaultClient&amp;quot;,
        }
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é…ç½®éœ€è¦ç¼“å­˜çš„å‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.decorators.cache&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;cache_page&lt;/span&gt;

&lt;span class="nd"&gt;@cache_page&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# ç§’æ•°ï¼Œè¿™é‡ŒæŒ‡ç¼“å­˜ 15 åˆ†é’Ÿï¼Œä¸ç›´æ¥å†™900æ˜¯ä¸ºäº†æé«˜å¯è¯»æ€§&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# è¯»å–æ•°æ®åº“ç­‰ å¹¶æ¸²æŸ“åˆ°ç½‘é¡µ&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;index.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;queryset&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;queryset&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Jun 2018 15:08:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-17:/posts/django-ye-mian-huan-cun.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>django é™æ€æ–‡ä»¶</title><link>/posts/django-jing-tai-wen-jian.html</link><description>&lt;h1&gt;settings.py ä¸­çš„ç›¸å…³é…ç½®&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;STATIC_URL = &amp;#39;/static/&amp;#39;
STATIC_ROOT = os.path.join(BASE_DIR,&amp;#39;static&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬åªè¦æŠŠé™æ€æ–‡ä»¶æ”¾åœ¨ APP ä¸­çš„ static ç›®å½•ä¸‹ï¼Œéƒ¨ç½²æ—¶ç”¨ &lt;code&gt;python manage.py collectstatic&lt;/code&gt; å°±å¯ä»¥æŠŠé™æ€æ–‡ä»¶æ”¶é›†åˆ°ï¼ˆå¤åˆ¶åˆ°ï¼‰ STATIC_ROOT ç›®å½•ï¼Œä½†æ˜¯æœ‰æ—¶æˆ‘ä»¬æœ‰ä¸€äº›å…±ç”¨çš„é™æ€æ–‡ä»¶ï¼Œè¿™æ—¶å€™å¯ä»¥è®¾ç½® STATICFILES_DIRS å¦å¤–å¼„ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;STATICFILES_DIRS = (
    os.path.join(BASE_DIR, &amp;quot;common_static&amp;quot;),
    &amp;#39;/var/www/static/&amp;#39;,
)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠé™æ€æ–‡ä»¶æ”¾åœ¨ common_static å’Œ /var/www/static/ä¸­äº†ï¼ŒDjangoä¹Ÿèƒ½æ‰¾åˆ°å®ƒä»¬ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;MEDIA_URL = &amp;#39;/media/&amp;#39;
MEDIA_ROOT = os.path.join(BASE_DIR,&amp;#39;media&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;mediaæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶&lt;/p&gt;
&lt;h1&gt;nginx éƒ¨ç½²æ—¶çš„é…ç½®&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;location /media  {
    alias /path/to/project/media;
}

location /static {
    alias /path/to/project/collected_static;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åœ¨æ¨¡æ¿ä¸­å¼•å…¥é™æ€æ–‡ä»¶&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;{% load static %}
&amp;lt;img src=&amp;quot;{% static &amp;quot;img/example.jpg&amp;quot; %}&amp;quot; alt=&amp;quot;My image&amp;quot;/&amp;gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Jun 2018 12:48:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-17:/posts/django-jing-tai-wen-jian.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Django views è§†å›¾</title><link>/posts/django-views-shi-tu.html</link><description>&lt;p&gt;django ä½¿ç”¨æ­£åˆ™æŒ‡å®šè·¯å¾„ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†å¯¹åº”çš„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;h1&gt;å®šä¹‰å“åº”å‡½æ•°&lt;/h1&gt;
&lt;p&gt;å“åº”å‡½æ•°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# views.py&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.shortcuts&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.http&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„æ¯ä¸ªå‡½æ•°éƒ½éœ€è¦æ¥å— request ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ŒGETå‚æ•°å’ŒPOSTå‚æ•°éƒ½å¯ä»¥ä» request ä¸­è¯»å–ã€‚å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨ä» url path ä¸­è¯»å–æ•°æ®ï¼Œè¿™äº›å‚æ•°ä½œä¸ºå½¢å‚ä¼ é€’ç»™å¯¹åº”çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;h1&gt;å®šä¹‰ URL è·¯ç”±&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# urls.py&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;calc&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;calc_views&lt;/span&gt;

&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;add/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;calc_views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;add&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;  &lt;span class="c1"&gt;# new&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;admin/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;add/&amp;lt;int:a&amp;gt;/&amp;lt;int:b&amp;gt;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;calc_views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;add2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;  &lt;span class="c1"&gt;# django 2.0 çš„æ–°è¯­æ³•ï¼Œä»¥å‰éƒ½æ˜¯ç”¨æ­£åˆ™åˆ†ç»„&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­çš„ name å¯ä»¥ç”¨åœ¨æ¨¡æ¿ä¸­ï¼Œè¿™æ ·å°±ä¸ç”¨å†™æ­» url äº†ã€‚&lt;code&gt;&amp;lt;a href="{% url 'add2' 4 5 %}"&amp;gt;link&amp;lt;/a&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;è®¾å®šå“åº”çš„ headers&lt;/h2&gt;
&lt;p&gt;response å¯¹è±¡å¯ä»¥å½“åšå­—å…¸ä½¿ç”¨ï¼Œå‘å…¶ä¸­å¤åˆ¶å°±å¯ä»¥è®¾å®šå“åº”çš„å¤´éƒ¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.http&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Powered-By&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;url reverse&lt;/h2&gt;
&lt;p&gt;åœ¨ urls.py ä¸­å¯ä»¥è®¾å®š url åˆ°å…·ä½“å‡½æ•°çš„æ˜ å°„ï¼Œä½†æ˜¯ url ä¹Ÿæ˜¯ç»å¸¸è¦éšä¸šåŠ¡æ”¹åŠ¨çš„ï¼Œæ¯”å¦‚ä» &lt;code&gt;add/&lt;/code&gt; å˜æˆäº† &lt;code&gt;plus/&lt;/code&gt;ã€‚å½“æˆ‘ä»¬åœ¨æŸä¸ªç½‘é¡µä¸­éœ€è¦é“¾æ¥åˆ°æŸä¸ªé¡µé¢çš„æ—¶å€™ï¼Œä¸å¸Œæœ›å†™æ­» urlï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ url reverse çš„åŠŸèƒ½ï¼Œä½¿ç”¨ name åå‘è·å– urlã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# urls.py&lt;/span&gt;
&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;add/&amp;lt;int:a&amp;gt;/&amp;lt;int:b&amp;gt;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;calc_views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;add2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# other.py&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;
&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;add2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Jun 2018 08:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-17:/posts/django-views-shi-tu.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>çŸ¥ä¹æ¨å¹¿çš„ä¸€äº›å°æŠ€å·§</title><link>/posts/zhi-hu-tui-yan-de-yi-xie-xiao-ji-qiao.html</link><description>&lt;p&gt;è½¬è½½è‡ªï¼š&lt;a href="https://mp.weixin.qq.com/s?__biz=MzAwMDA3ODc2NQ==&amp;amp;mid=2650452037&amp;amp;idx=2&amp;amp;sn=626e4f2d597e2664a9163ea99300449d&amp;amp;chksm=82e07687b597ff91f6d6d7e13f9621f2baafcfd58b076e4aa591e54679b5f2c5b302f131255a&amp;amp;mpshare=1&amp;amp;scene=1&amp;amp;srcid=120442SC5YQtAnPiRwsPpCpR#rd"&gt; å§‘å©†é‚£äº›äº‹å„¿&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ–‡ç« æ‰“å¼€ç‡è¶Šæ¥è¶Šä½ï¼Œä»0èµ·æ­¥çš„å…¬ä¼—å·å¾€å¾€æ˜¯è¿è¥æœ€éš¾è·¨è¶Šçš„é¸¿æ²Ÿã€‚åˆšèµ·æ­¥çš„å¾®ä¿¡å…¬ä¼—å·ï¼Œæ²¡äººå…³æ³¨æ€ä¹ˆåŠï¼Ÿæ€æ ·è·å¾—åˆå§‹çš„1000ä¸ªç²‰ä¸ï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;ç”±äºå¾®ä¿¡çš„é—­ç¯ç‰¹æ€§ï¼Œæ‰€ä»¥å¤§é‡ç²‰ä¸éœ€è¦ä»å¤–éƒ¨æ¸ é“å¯¼å…¥ã€‚ç²‰ä¸æ¸ é“æ¥æºå¹¶ä¸æ˜¯å•ä¸€çš„ï¼Œå¦‚æœæˆ‘åœ¨å…¶ä»–è‡ªåª’ä½“å¹³å°åŒæ—¶é‡‡ç”¨ä¸€å®šç­–ç•¥å¸å¼•ç²‰ä¸ã€‚è¿™æ ·ç®—ä¸‹æ¥å‡å®šåŠå¹´ç›®æ ‡æ˜¯å¸å¼•1ä¸‡ç²‰ä¸ï¼Œæ¯å¤©å¸å¼•55ä¸ªå°±å¯ä»¥äº†ï¼Œè¿™55ä¸ªç²‰ä¸çš„ä¸»è¦æ¥æºæ˜¯çŸ¥ä¹ã€ä»Šæ—¥å¤´æ¡ã€æœ‹å‹åœˆï¼Œæ¯ä¸ªæ¸ é“æ¯å¤©èƒ½å¸å¼•18å°±è¶³å¤Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;è€ŒçŸ¥ä¹ä½œä¸ºé«˜è´¨é‡çš„æµé‡èšé›†åœ°æ˜¯éå¸¸å¥½çš„å¼•æµé€‰æ‹©ï¼Œç›®å‰å¾ˆå¤šäººå¯¹çŸ¥ä¹çš„æµé‡æŒ–æ˜å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œä¸‹é¢æœ‰ä¸€äº›åŸºæœ¬çš„æ–¹æ³•åˆ†äº«ç»™å¤§å®¶ã€‚&lt;/p&gt;
&lt;h1&gt;æ—¥å¸¸è¿è¥&lt;/h1&gt;
&lt;p&gt;4ã€ä¸€ä¸ªé«˜èµçš„ç­”æ¡ˆå›ç­”å­—æ•°æ§åˆ¶åœ¨800-1500å­—å·¦å³ï¼Œå›ç­”å½¢å¼å¤šé‡‡ç”¨å›¾æ–‡å¼å›å¤ã€æ•°æ®åˆ†æå¼å›å¤ã€å¼•ç”¨ä½è¯å¼å›å¤ï¼ŒçŸ¥ä¹ç”¨æˆ·é‡é€»è¾‘è½»æ„Ÿæƒ…ã€‚&lt;/p&gt;
&lt;p&gt;çŸ¥ä¹ç”¨æˆ·å°¤å…¶æ’æ–¥è½¯æ–‡å¹¿å‘Šï¼Œå†…å®¹ä¸Šå¹²è´§ä»·å€¼+äº²èº«ç»å†+å¹½é»˜é£è¶£è°ƒä¾ƒè¯­æ°”+æœ€åä¸€æ®µç¥æ¥ä¹‹ç¬”+é€»è¾‘æ¨ç†å°æ¸…æ–°+åˆ†æ®µåˆ†ç‚¹è®ºè¿°æœ€èƒ½å¾—åˆ°ä»–ä»¬çš„é’çã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·çš„å›å¤æ‰èƒ½è·å–ç‚¹èµã€æ”¶è—ã€è¯„è®ºï¼Œä¹Ÿå®¹æ˜“æŠŠä½ æ¨åˆ°è¯é¢˜å›å¤ç¬¬ä¸€åçš„ä½ç½®ã€‚è¿™æ—¶ä½ å°±è·å¾—äº†ä»–ä»¬çš„è®¤å¯ï¼Œç²‰ä¸å…³æ³¨ï¼Œè‡ªç„¶é€šè¿‡ä½ çš„è”ç³»æ–¹å¼è”ç³»ä½ ã€‚&lt;/p&gt;
&lt;p&gt;5ã€å›ç­”é—®é¢˜æ—¶ä¸€å®šè¦æŒ‘é€‰çŸ¥ä¹çƒ­é—¨è¯é¢˜ï¼Œè¿™äº›è¯é¢˜æµé‡å¤§å…³æ³¨äººæ•°å¤šï¼Œå¦‚æœåªå›ç­”ä¸€äº›å†·é—¨è¯é¢˜é‚£ä¹ˆå¾ˆé•¿ä¸€æ®µæ—¶é—´å†…éƒ½ä¸ä¼šæœ‰äººçœ‹åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å›ç­”å†…å®¹ä¸€å®šè¦æœ‰äº‰è®®æœ‰ä»·å€¼ï¼Œå³ä½¿æŠ–æœºçµä¹Ÿè¦æŠ–å‡ºæ–°é«˜åº¦ã€‚å›ç­”ä¸‹æ–¹çš„è¯„è®ºåŒºä¹Ÿè¦å……åˆ†åˆ©ç”¨ï¼Œå’Œç²‰ä¸ä¿æŒé«˜äº’åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;6ã€åŒæ ·çš„å›ç­”å†…å®¹å°½é‡ä¸è¦ç”¨å¤šæ¬¡ï¼Œå¦‚æœè¢«ç³»ç»Ÿæ£€æµ‹åˆ°å¾ˆå®¹æ˜“å—åˆ°å¤„ç½šï¼Œé¦–æ¬¡è¿è§„å°ç¦ä¸€å¤©ï¼Œæˆ–ä¸ƒå¤©ï¼Œç”šè‡³æ¸…é™¤å±è”½ç”¨æˆ·çš„æ•°æ®æ‰€æœ‰å›ç­”ã€‚å¯ä»¥åœ¨ç­”æ¡ˆä¸­ç•™ä¸‹é“¾æ¥å¼•å¯¼ç”¨æˆ·æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;7ã€å›ç­”ä¸­ä¸è¦ç•™å¤ªæ˜¾çœ¼çš„è”ç³»æ–¹å¼æˆ–è€…å…¬ä¼—å·äºŒç»´ç ï¼ŒçŸ¥ä¹å¯¹å¤§Vç•™è”ç³»æ–¹å¼æ˜¯é»˜è®¸çš„ï¼Œä½†å¯¹æ™®é€šç”¨æˆ·æˆ–è€…å°Vè¢«å‘ç°æˆ–è€…è¢«ä¸¾æŠ¥å°±ä¼šå¤„ä»¥ç¦è¨€ã€‚&lt;/p&gt;
&lt;p&gt;8ã€å½“ä½ åœ¨çŸ¥ä¹å·²ç»æœ‰äº†ä¸€å®šé‡çš„å›ç­”é‡ï¼Œç²‰ä¸ä¹Ÿæœ‰äº†ä¸€äº›ç§¯ç´¯ã€‚å¯ä»¥åšåˆæ­¥çš„å¯¼æµå‡†å¤‡äº†ã€‚è¿™æ—¶å€™ä¿®æ”¹è‡ªå·±çš„å¸å·èµ„æ–™ï¼Œåœ¨ä¸Šé¢å¢åŠ è‡ªå·±çš„è”ç³»æ–¹å¼ï¼Œæ•°é‡ä¸è¦å¤šé¿å…è¥é”€çš„å«Œç–‘ã€‚&lt;/p&gt;
&lt;p&gt;9ã€çŸ¥ä¹ç³»ç»Ÿæœ‰ä¸ªç‰¹ç‚¹ï¼Œä¸€å¤©å½“ä¸­å¦‚æœå›ç­”æ•°é‡è¶…è¿‡åä¸ªæˆ–è€…é•¿æœŸå›ç­”æ•°é‡è¿‡å¤šï¼Œç³»ç»Ÿä¼šæç¤ºæ“ä½œé¢‘ç¹ã€‚ä¸ºäº†é¿å…ä¸å¿…è¦çš„éº»çƒ¦ä¸€å¤©æœ€ä½³å›ç­”æ•°é‡åº”è¯¥æ§åˆ¶åœ¨5-7ä¹‹é—´ã€‚&lt;/p&gt;
&lt;p&gt;10ã€çŸ¥ä¹ç”¨æˆ·çš„æ´»è·ƒæ—¶é—´æ®µåœ¨ä¸­åˆ12ï¼š00-14ï¼š00åŠæ™šä¸Š19ï¼š00-23ï¼š00ï¼Œä¸€èˆ¬åœ¨æ­¤æ—¶é—´æ®µå†…å›ç­”é—®é¢˜è¿è§„è¢«å¤„ç½šçš„æƒ…å†µä¼šå¾ˆå°‘å‘ç”Ÿã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Jun 2018 07:01:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-17:/posts/zhi-hu-tui-yan-de-yi-xie-xiao-ji-qiao.html</guid><category>åˆ›ä¸š</category><category>è¿è¥ä¸äº§å“</category></item><item><title>ä½¿ç”¨ docker-compose ç¼–æ’å®¹å™¨è¿è¡Œ</title><link>/posts/shi-yong-docker-compose-bian-pai-rong-qi-yun-xing.html</link><description>&lt;p&gt;ä½¿ç”¨ docker run è¿è¡Œå®¹å™¨çš„æ—¶å€™ç»å¸¸éœ€è¦åŠ å¾ˆå¤šçš„å‚æ•°ï¼Œæ¯æ¬¡éƒ½è¾“å…¥è¿™ä¹ˆå¤šå‚æ•°å¾ˆå®¹æ˜“å‡º
é”™ã€‚å¦å¤–æˆ‘ä»¬ç»å¸¸éœ€è¦åŒæ—¶è¿è¡Œè‹¥å¹²ä¸ªå®¹å™¨æ¥æ„æˆä¸€ä¸ªæœåŠ¡ï¼Œæ­¤æ—¶è¿˜æ˜¯æ¶‰åŠåˆ°ç½‘ç»œçš„è”é€šç­‰
æ“ä½œã€‚docker compose å¯ä»¥æŠŠdockeræ‰§è¡Œæ—¶çš„å‚æ•°å†™æˆyamlæ–‡ä»¶ï¼Œè¿è¡Œçš„æ—¶å€™åªéœ€è¦
&lt;code&gt;docker-compose up&lt;/code&gt; ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¯ä¸å¤šè¯´ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥å­¦ä¹ ä¸€ä¸‹ docker-compose.yml æ–‡ä»¶çš„è¯­æ³•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;version: &amp;quot;3&amp;quot;
services:
  web:
    build: .
    depends_on:
      - db
      - redis
  redis:
    image: redis
    ports:
     - &amp;quot;3000&amp;quot;
     - &amp;quot;3000-3005&amp;quot;
     - &amp;quot;8000:8000&amp;quot;
     - &amp;quot;9090-9091:8080-8081&amp;quot;
     - &amp;quot;49100:22&amp;quot;
     - &amp;quot;127.0.0.1:8001:8001&amp;quot;
     - &amp;quot;127.0.0.1:5000-5010:5000-5010&amp;quot;
     - &amp;quot;6060:6060/udp&amp;quot; 
  db:
    image: postgres
    volumes:
      - &amp;quot;/var/run/postgres/postgres.sock:/var/run/postgres/postgres.sock&amp;quot;
      - &amp;quot;dbdata:/var/lib/postgresql/data&amp;quot;

volumes:
  - dbdata
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;version æŒ‡å®šäº†å½“å‰ docker-compose æ–‡ä»¶çš„ç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;services æœåŠ¡åˆ—è¡¨ï¼Œæ˜¯ä¸€ä¸ª "æœåŠ¡åï¼šé…ç½®" çš„å­—å…¸ã€‚è¿™é‡Œå®šä¹‰äº†ä¸‰ä¸ªæœåŠ¡ï¼š
   web/redis/db&lt;/li&gt;
&lt;li&gt;buildï¼Œdocker build å‘½ä»¤çš„å‚æ•°ï¼Œç”¨æ¥æŒ‡å®šéœ€è¦æ„å»ºçš„ dockerfile&lt;/li&gt;
&lt;li&gt;imageï¼Œå¦‚æœé•œåƒä¸éœ€è¦è‡ªå·±æ„å»ºï¼Œè€Œæ˜¯ä½¿ç”¨dockerhubä¸Šçš„åŸºç¡€é•œåƒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨
   image æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;depends_on æŒ‡å®šå½“å‰çš„æœåŠ¡ä¾èµ–çš„æœåŠ¡ï¼Œä»è€Œç¡®å®šå¯åŠ¨é¡ºåº&lt;/li&gt;
&lt;li&gt;ports å¼€æ”¾çš„ç«¯å£çš„æ•°ç»„ï¼Œæœ‰ä¸‰ç§å½¢å¼ï¼š&lt;ol&gt;
&lt;li&gt;"3000" å®¹å™¨ä¸­å¼€æ”¾çš„ç«¯å£&lt;/li&gt;
&lt;li&gt;"3000:3000" å¼€æ”¾å®¹å™¨ä¸­çš„ç«¯å£åˆ°å®¿ä¸»æœº&lt;/li&gt;
&lt;li&gt;"127.0.0.1:3000:3000" å¼€æ”¾å®¹å™¨ä¸­çš„ç«¯å£åˆ°å®¿ä¸»æœºå¹¶ç»‘å®šIP&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;environment ç¯å¢ƒå˜é‡&lt;/li&gt;
&lt;li&gt;volumes æŒ‚è½½çš„å·ï¼Œå¯ä»¥ä½¿ç”¨named volumeæˆ–è€…æ˜¯æŒ‚è½½ç›®å½•ï¼Œå»ºè®®ä¸è¦ä½¿ç”¨åŒ¿åå·ã€‚å¦‚
   æœä½¿ç”¨ named volumeï¼Œå¿…é¡»åœ¨volumesä¸‹å£°æ˜&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;docker-compose æœ‰ä»¥ä¸‹3ä¸ªå¸¸ç”¨å‘½ä»¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;docker-compose up [-d] SERVICE&lt;/li&gt;
&lt;li&gt;docker-compose run&lt;/li&gt;
&lt;li&gt;docker-compose stop&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Jun 2018 02:11:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-17:/posts/shi-yong-docker-compose-bian-pai-rong-qi-yun-xing.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category><category>Docker</category></item><item><title>ä½¿ç”¨ Python æå–å­—å¹•æ–‡ä»¶</title><link>/posts/shi-yong-python-ti-qu-zi-mu-wen-jian.html</link><description>&lt;p&gt;æœ€è¿‘æ‰“ç®—åšä¸€ä¸ªå­—å¹•ç›¸å…³çš„ appï¼Œéœ€è¦ä»å­—å¹•æ–‡ä»¶ä¸­æå–å‡ºå•è¯ã€‚å¯¹æ¯”äº†å‡ ä¸ªåº“ä¹‹åï¼Œå‘ç° PySubs2 è¿˜ä¸é”™ï¼Œä¸»è¦åŸå› æ˜¯ä»–æ”¯æŒä¸‰ç§ä¸»æµçš„å­—å¹•æ–‡ä»¶ &lt;code&gt;.srt&lt;/code&gt;, &lt;code&gt;.ass&lt;/code&gt;, &lt;code&gt;.ssa&lt;/code&gt;ã€‚è€Œå…¶ä»–çš„åº“å¾€å¾€åªæ”¯æŒå…¶ä¸­ä¸€ä¸ªï¼Œå®é™…ä½¿ç”¨è¿˜éœ€è¦ä¸¤ä¸ªåº“é…åˆï¼Œæ‰€ä»¥ä¸å¦‚ç›´æ¥ä½¿ç”¨ PySubs 2.&lt;/p&gt;
&lt;h1&gt;ç”¨æ³•&lt;/h1&gt;
&lt;p&gt;å› ä¸ºæˆ‘çš„éœ€æ±‚ä¸»è¦æ˜¯è§£ææå–å­—å¹•æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œåªè®¨è®ºç›¸å…³é—®é¢˜ã€‚å¯¹äºå­—å¹•æ—¶é—´è½´å’Œæ ·å¼çš„ç¼–è¯‘ï¼Œå¯ä»¥æŸ¥çœ‹ pysubs2 çš„å®˜æ–¹æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºå­—å¹•æ–‡ä»¶æœ¬èº«ç»“æ„ä¹Ÿæ¯”è¾ƒç®€å•ï¼ŒPySubs2 ä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ï¼Œæ ¸å¿ƒåªæœ‰ä¸¤ä¸ªç±»ï¼š SSAFile å’Œ SSAEventã€‚å…¶ä¸­ SSAFile æŒ‡çš„æ˜¯ä¸€ä¸ªå­—å¹•æ–‡ä»¶ï¼Œå®ƒåƒä¸€ä¸ªæ•°ç»„ä¸€æ ·ï¼ŒåŒ…å«äº†å¤šä¸ª SSAEventã€‚ä¸‹é¢ç›´æ¥çœ‹ä»£ç å§ï¼š&lt;/p&gt;
&lt;h2&gt;å®‰è£…&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ pip&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install pysubs2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªsrtæ ¼å¼çš„å­—å¹•æ–‡ä»¶ subtitles.srtï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; SIMPLE_FILE = &amp;quot;&amp;quot;&amp;quot;\
... 1
... 00:00:00,000 --&amp;gt; 00:01:00,000
... Once upon a time,
...
... 2
... 00:01:00,000 --&amp;gt; 00:02:00,000
... there was a SubRip file
... &lt;span class="nt"&gt;&amp;lt;i&amp;gt;&lt;/span&gt;with&lt;span class="nt"&gt;&amp;lt;/i&amp;gt;&lt;/span&gt; two subtitles.
... &amp;quot;&amp;quot;&amp;quot;
&amp;gt;&amp;gt;&amp;gt; with open(&amp;quot;subtitles.srt&amp;quot;, &amp;quot;w&amp;quot;) as fp:
...      fp.write(SIMPLE_FILE)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯ä»¥ä½¿ç”¨ SSAFile.load æˆ–è€… from_string åŠ è½½&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pysubs2&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SSAFile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SSAEvent&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;make_time&lt;/span&gt;
&lt;span class="n"&gt;subs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SSAFile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;subtitle.srt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# æˆ–è€…ä»å­—ç¬¦ä¸²ä¸­è¯»å–&lt;/span&gt;
&lt;span class="c1"&gt;# subs = SSAFile.from_string(å­—å¹•æ•°æ®)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯ä»¥æŠŠ SSAFile å½“åšæ•°ç»„ä½¿ç”¨ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª SSAEventï¼Œä¹Ÿå°±æ˜¯ä¸€æ¡å­—å¹•ã€‚SSAEvent æä¾›äº†ä¸å°‘æ–¹ä¾¿çš„å±æ€§ç”¨äºè¯»å–ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;subs[0].text  å­—å¹•æ–‡å­—ï¼ŒåŒ…å«äº†æ ·å¼
subs[0].start å­—å¹•å¼€å§‹æ—¶é—´ï¼Œå•ä½æ¯«ç§’
subs[0].end   å­—å¹•ç»“æŸæ—¶é—´
subs[0].plaintext çº¯æ–‡æœ¬

&amp;gt;&amp;gt;&amp;gt; for line in subs:
...     print(line.text)
&amp;quot;Once upon a time,&amp;quot;
&amp;quot;there was a SubRip file\\N&lt;span class="nt"&gt;&amp;lt;i&amp;gt;&lt;/span&gt;with&lt;span class="nt"&gt;&amp;lt;/i&amp;gt;&lt;/span&gt; two subtitles.&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„å…¶ä¸­ text ä¸­åŒ…å«å„ç§æ ¼å¼ä¿¡æ¯ï¼Œæ¢è¡Œæ˜¯ä½¿ç”¨ \N è¡¨ç¤ºçš„ã€‚å¦‚æœéœ€è¦æå–çº¯æ–‡æœ¬ï¼Œå¯ä»¥ä½¿ç”¨ plaintextã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 13 Jun 2018 01:07:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-13:/posts/shi-yong-python-ti-qu-zi-mu-wen-jian.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>çˆ¬è™«åˆ©å™¨ Chrome Headless å’Œ Puppeteer æœ€ä½³å®è·µ</title><link>/posts/pa-chong-li-qi-chrome-headless-he-puppeteer-zui-jia-shi-jian.html</link><description>&lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘è‡ªï¼šhttps://docs.browserless.io/blog/2018/06/04/puppeteer-best-practices.html&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;browserless å·²ç»è¿è¡Œäº†200ä¸‡æ¬¡çš„ chrome headless è¯·æ±‚ï¼Œä¸‹é¢æ˜¯ä»–ä»¬æ€»ç»“å‡ºæ¥çš„æœ€ä½³å®è·µï¼š&lt;/p&gt;
&lt;h1&gt;ä¸€ã€ä¸è¦ä½¿ç”¨æ— å¤´æµè§ˆå™¨&lt;/h1&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tNc79gy1fs056p3uvaj319w0fcacy.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æ— å¤´ Chrome å ç”¨çš„å¤§é‡èµ„æº&lt;/p&gt;
&lt;p&gt;æ— è®ºå¦‚ä½•ï¼Œåªè¦å¯ä»¥çš„è¯ï¼Œä¸è¦è¿è¡Œæ— å¤´æµè§ˆå™¨ã€‚ç‰¹åˆ«æ˜¯åƒä¸‡åˆ«åœ¨ä½ è·‘å…¶ä»–åº”ç”¨çš„æœåŠ¡å™¨ä¸Šè·‘ã€‚æ— å¤´æµè§ˆå™¨çš„è¡Œä¸ºéš¾ä»¥é¢„æµ‹ï¼Œå¯¹èµ„æºå ç”¨éå¸¸å¤šï¼Œå°±åƒæ˜¯ Rick and Morty é‡Œé¢çš„ Meseeksï¼ˆç¾å›½åŠ¨ç”»ç‰‡ã€Šç‘å…‹å’Œè«è’‚ã€‹ä¸­ï¼Œå¬å”¤å‡ºäº†è¿‡å¤šçš„ Meseeks å¯¼è‡´å‡ºäº†å¤§é—®é¢˜ï¼‰ã€‚å‡ ä¹æ‰€æœ‰ä½ æƒ³é€šè¿‡æµè§ˆå™¨ç”¨çš„äº‹æƒ…ï¼ˆæ¯”å¦‚è¯´è¿è¡Œ JavaScriptï¼‰éƒ½å¯ä»¥ä½¿ç”¨ç®€å•çš„ Linux å·¥å…·æ¥å®ç°ã€‚&lt;code&gt;Cheerio&lt;/code&gt; å’Œå…¶ä»–çš„åº“æä¾›äº†ä¼˜é›…çš„ Node API æ¥å®ç° HTTP è¯·æ±‚å’Œé‡‡é›†ç­‰éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œä½ å¯ä»¥åƒè¿™æ ·è·å–ä¸€ä¸ªé¡µé¢å¹¶æŠ½å–å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;cheerio&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cheerio&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;fetch&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;node-fetch&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="n"&gt;function&lt;/span&gt; &lt;span class="n"&gt;getPrice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cheerio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;buy-now.price&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;getPrice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://my-cool-website.com/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ˜¾ç„¶è¿™è‚¯å®šä¸èƒ½è¦†ç›–æ‰€æœ‰çš„æ–¹é¢ï¼Œå¦‚æœä½ æ­£åœ¨è¯»è¿™ç¯‡æ–‡ç« çš„è¯ï¼Œä½ å¯èƒ½éœ€è¦ä¸€ä¸ªæ— å¤´æµè§ˆå™¨ï¼Œæ‰€ä»¥æ¥ç€çœ‹å§ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Don't run a headless browser when you don't need to
äºŒã€ä¸è¦åœ¨ä¸éœ€è¦çš„æ—¶å€™è¿è¡Œæ— å¤´æµè§ˆå™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We've ran into numerous users that attempt to keep the browser open, even when not in use, so that it's always available for connections. While this might be a good strategy to help expedite session launch it'll only end in misery after a few hours. This is largely because browsers like to cache stuff and slowly eat more memory. Any time you're not actively using the browser, close it!&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é‡åˆ°è¿‡å¥½å¤šå®¢æˆ·å°è¯•åœ¨ä¸ä½¿ç”¨çš„æ—¶å€™ä¹Ÿä¿æŒæµè§ˆå™¨å¼€ç€ï¼Œè¿™æ ·ä»–ä»¬å°±æ€»èƒ½å¤Ÿç›´æ¥è¿ä¸Šæµè§ˆå™¨ã€‚å°½ç®¡è¿™æ ·èƒ½å¤Ÿæœ‰æ•ˆåœ°åŠ å¿«è¿æ¥é€Ÿåº¦ï¼Œä½†æ˜¯æœ€ç»ˆä¼šåœ¨å‡ ä¸ªå°æ—¶å†…å˜ç³Ÿã€‚å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å› ä¸ºæµè§ˆå™¨æ€»ä¼šå°è¯•ç¼“å­˜å¹¶ä¸”æ…¢æ…¢åœ°åƒæ‰å†…å­˜ã€‚åªè¦ä½ ä¸æ˜¯åœ¨æ´»è·ƒåœ°ä½¿ç”¨æµè§ˆå™¨ï¼Œå°±å…³æ‰å®ƒã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;puppeteer&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;puppeteer&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="n"&gt;function&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;puppeteer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;launch&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newPage&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;goto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://www.example.com/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="n"&gt;More&lt;/span&gt; &lt;span class="n"&gt;stuff&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt; &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;Always&lt;/span&gt; &lt;span class="n"&gt;do&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;At browserless we generally try to cover this error internally by always having some kind of session-timer, and closing the browser whenever the WebSocket is disconnected. However, if you're not using the service or the backing docker image, then be sure that something is closing the browser, otherwise you'll have a pretty awful time debugging the issue when you're paged in the middle of the night.&lt;/p&gt;
&lt;p&gt;åœ¨ browserlessï¼Œæˆ‘ä»¬ä¼šç»™æ¯ä¸ªä¼šè¯è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè€Œä¸”åœ¨WebSocketé“¾æ¥å…³é—­çš„æ—¶å€™å…³é—­æµè§ˆå™¨ã€‚ä½†æ˜¯å¦‚æœä½ ä½¿ç”¨è‡ªå·±ç‹¬ç«‹çš„æµè§ˆå™¨çš„è¯ï¼Œè®°å¾—ä¸€å®šè¦å…³é—­æµè§ˆå™¨ï¼Œå¦åˆ™ä½ å¾ˆå¯èƒ½åœ¨åŠå¤œè¿˜è¦é™·å…¥æ¶å¿ƒçš„è°ƒè¯•ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‰ã€ &lt;code&gt;page.evaluate&lt;/code&gt; æ˜¯ä½ çš„å¥½æœ‹å‹&lt;/p&gt;
&lt;p&gt;puppeteer has a lot of cool sugar methods that let you do things like save DOM selectors or more in the Node runtime. While this is of great convenience, you can easily shoot yourself in the foot if something happens on the page that mutates that DOM node in some fashion. As much as it feels "hacky" it's actualy just better to all your browser-side work in the context of the browser. This generally means loading up page.evaulate with all the work that needs to be done.&lt;/p&gt;
&lt;p&gt;Puppeteer æœ‰ä¸€äº›å¾ˆé…·çš„è¯­æ³•ç³–ï¼Œæ¯”å¦‚å¯ä»¥ä¿å­˜ DOM é€‰æ‹©å™¨ç­‰ç­‰ä¸œè¥¿åˆ° Node è¿è¡Œæ—¶ä¸­ã€‚å°½ç®¡è¿™å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å½“æœ‰è„šæœ¬åœ¨å˜æ¢ DOM èŠ‚ç‚¹çš„æ—¶å€™å¾ˆå¯èƒ½å‘ä½ ä¸€æŠŠã€‚å°½ç®¡çœ‹èµ·æ¥æœ‰ä¸€äº› hackyï¼Œä½†æ˜¯æœ€å¥½è¿˜æ˜¯åœ¨æµè§ˆå™¨ä¸­è¿è¡Œæµè§ˆå™¨è¿™è¾¹çš„å·¥ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨ &lt;code&gt;page.evaluate&lt;/code&gt; æ¥æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;For instance, instead of doing something like this (which has 3 async actions):&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œä¸è¦ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹æ³•ï¼ˆä½¿ç”¨äº†ä¸‰ä¸ª async åŠ¨ä½œï¼‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;const $anchor = await page.$(&amp;#39;a.buy-now&amp;#39;);
const link = await $anchor.getProperty(&amp;#39;href&amp;#39;);
await $anchor.click();

return link;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·åšï¼Œä½¿ç”¨äº†ä¸€ä¸ª async åŠ¨ä½œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;await page.evaluate(() =&amp;gt; {
    const $anchor = document.querySelector(&amp;#39;a.buy-now&amp;#39;);
    const text = $anchor.href;
    $anchor.click();
});
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The other pro about doing it in an evaluate call is that it's portable: meaning you can run this code inside of a browser to test versus trying to rewrite the Node code. Of course, you should always use the debugger where possible to shorten development time.&lt;/p&gt;
&lt;p&gt;A quick rule-of-thumb is to count the number of await's or then's happening in your code and if there's more than one then you're probably better off running the code inside a page.evaluate call. The reason here is that all async actions have to go back-and-forth between Node's runtime and the browser's, which means all the JSON serialization and deserializiation. While it's not a huge amount of parsing (since it's all backed by WebSockets) it still is taking up time that could better be spent doing something else.&lt;/p&gt;
&lt;p&gt;å¦å¤–çš„å¥½å¤„æ˜¯è¿™æ ·åšæ˜¯å¯ç§»æ¤çš„ï¼šä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œè¿™ä¸ªä»£ç æ¥æµ‹è¯•ä¸‹æ˜¯ä¸æ˜¯éœ€è¦é‡å†™ä½ çš„ node ä»£ç ã€‚å½“ç„¶ï¼Œèƒ½ç”¨è°ƒè¯•å™¨è°ƒè¯•çš„æ—¶å€™è¿˜æ˜¯ç”¨è°ƒè¯•å™¨æ¥ç¼©çŸ­å¼€å‘æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;æœ€é‡è¦çš„è§„åˆ™å°±æ˜¯æ•°ä¸€ä¸‹ä½ æ˜¯ç”¨çš„ await çš„æ•°é‡ï¼Œå¦‚æœè¶…è¿‡ 1 äº†ï¼Œé‚£ä¹ˆè¯´æ˜ä½ æœ€å¥½æŠŠä»£ç å†™åœ¨ page.evaluate ä¸­ã€‚åŸå› åœ¨äºï¼Œæ‰€æœ‰çš„ async å‡½æ•°éƒ½å¿…é¡»åœ¨ Node å’Œ æµè§ˆå™¨ç›´æ¥ä¼ æ¥ä¼ å»ï¼Œä¹Ÿå°±æ˜¯éœ€è¦ä¸åœåœ° json åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚å°½ç®¡è¿™äº›è§£ææˆæœ¬ä¹Ÿä¸æ˜¯å¾ˆé«˜ï¼ˆæœ‰ WebSocket æ”¯æŒï¼‰ï¼Œä½†æ˜¯æ€»è¿˜æ˜¯è¦èŠ±è´¹æ—¶é—´çš„ã€‚&lt;/p&gt;
&lt;p&gt;å››ã€å¹¶è¡ŒåŒ–æµè§ˆå™¨ï¼Œè€Œä¸æ˜¯é¡µé¢&lt;/p&gt;
&lt;p&gt;Since we've determined that it's not good to run a browser, and that we should only run one when absolutely necessary, the next best-practice is to run only one session through each browser. While you actually might save some overhead by parallelizing work through pages, if one page crashes it can bring down the entire browser with it. That, plus each page isn't guaranteed to be totally clean (cookies and storage might bleed-through as seen here).&lt;/p&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬å·²ç»è¯´è¿‡å°½é‡ä¸è¦ä½¿ç”¨æµè§ˆå™¨ï¼Œè€Œä¸”åªåœ¨éœ€è¦çš„æ—¶å€™æ‰æ‰“å¼€æµè§ˆå™¨ï¼Œä¸‹é¢çš„è¿™æ¡æœ€ä½³å®è·µæ˜¯â€”â€”åœ¨ä¸€ä¸ªæµè§ˆå™¨ä¸­åªä½¿ç”¨ä¸€ä¸ªä¼šè¯ã€‚å°½ç®¡é€šè¿‡é¡µé¢æ¥å¹¶è¡ŒåŒ–å¯èƒ½ä¼šç»™ä½ çœä¸‹ä¸€äº›æ—¶é—´ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢å´©æºƒäº†ï¼Œå¯èƒ½ä¼šæŠŠæ•´ä¸ªæµè§ˆå™¨éƒ½å¸¦ç¿»è½¦ã€‚è€Œä¸”ï¼Œæ¯ä¸ªé¡µé¢éƒ½ä¸èƒ½ä¿è¯æ˜¯å®Œå…¨å¹²å‡€çš„ï¼ˆcookies å’Œå­˜å‚¨å¯èƒ½ä¼šäº’ç›¸æ¸—é€ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Instead of this:&lt;/p&gt;
&lt;p&gt;ä¸è¦è¿™æ ·ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;puppeteer&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;puppeteer&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="n"&gt;Launch&lt;/span&gt; &lt;span class="n"&gt;one&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;capture&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;promise&lt;/span&gt;
&lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;puppeteer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;launch&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;runJob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="n"&gt;Re&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="n"&gt;here&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newPage&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;goto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¦è¿™æ ·ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;puppeteer&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;puppeteer&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;runJob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="n"&gt;Launch&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;clean&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;every&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;job&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;puppeteer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;launch&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newPage&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;goto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Each new browser instance gets a clean --user-data-dir (unless otherwise specified), which means it's treated as a fresh session entirely. If Chrome crashes for whatever reason, it won't bring down any other sessions that are happening as well.&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ªæ–°çš„æµè§ˆå™¨å®ä¾‹éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå¹²å‡€çš„ &lt;code&gt;--user-data-dir&lt;/code&gt; ï¼ˆé™¤éä½ æ‰‹å·¥è®¾å®šï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ä¼šæ˜¯ä¸€ä¸ªå®Œå…¨æ–°çš„ä¼šè¯ã€‚å¦‚æœ Chrome å´©æºƒäº†ï¼Œä¹Ÿä¸ä¼šå§å…¶ä»–çš„ä¼šè¯ä¸€èµ·å¹²æ‰ã€‚&lt;/p&gt;
&lt;p&gt;äº”ã€é˜Ÿåˆ—å’Œé™åˆ¶å¹¶å‘&lt;/p&gt;
&lt;p&gt;browserless çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½æ˜¯æ— ç¼é™åˆ¶å¹¶è¡Œå’Œä½¿ç”¨é˜Ÿåˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´æ¶ˆè´¹ç¨‹åºå¯ä»¥ç›´æ¥ä½¿ç”¨ puppeteer.connect è€Œä¸éœ€è¦è‡ªå·±å®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚è¿™é¿å…äº†å¤§é‡çš„é—®é¢˜ï¼Œå¤§éƒ¨åˆ†æ˜¯å¤ªå¤šçš„ Chrome å®ä¾‹æ€æ‰äº†ä½ çš„åº”ç”¨çš„å¯ç”¨èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;The best, and easiest way, is to pull our docker image and run it with the parameters you'd like:&lt;/p&gt;
&lt;p&gt;æœ€å¥½ä¹Ÿæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ browserless æä¾›çš„é•œåƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;# Pull in Puppeteer@1.4.0 support&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;docker&lt;/span&gt; &lt;span class="n"&gt;pull&lt;/span&gt; &lt;span class="n"&gt;browserless&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nl"&gt;chrome&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="k"&gt;release&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;puppeteer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.4.0&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;docker&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;MAX_CONCURRENT_SESSIONS=10&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;browserless&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nl"&gt;chrome&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="k"&gt;release&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;puppeteer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.4.0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This limits the number of concurrent requests that can run to 10 (including debug sessions and more). You can also configure how much you'd like to queue as well with the MAX_QUEUE_LENGTH variable. As a general rule, you can typically run roughly 10 concurrent requests per GB of memory. CPU usage can spike for various things, but for the most part you'll need lots and lots of RAM.&lt;/p&gt;
&lt;p&gt;ä¸Šé¢é™åˆ¶äº†å¹¶å‘è¿æ¥æ•°åˆ°10ï¼Œè¿˜å¯ä»¥ä½¿ç”¨&lt;code&gt;MAX_QUEUE_LENGTH&lt;/code&gt;æ¥é…ç½®é˜Ÿåˆ—çš„é•¿åº¦ã€‚æ€»ä½“æ¥è¯´ï¼Œ&lt;strong&gt;æ¯1GBå†…å­˜å¯ä»¥å¹¶è¡Œè¿è¡Œ10ä¸ªè¯·æ±‚&lt;/strong&gt;ã€‚CPU æœ‰æ—¶å€™ä¼šå ç”¨è¿‡å¤šï¼Œä½†æ˜¯æ€»çš„æ¥è¯´ç“¶é¢ˆè¿˜æ˜¯åœ¨å†…å­˜ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;å…­ã€ä¸è¦å¿˜è®° &lt;code&gt;page.waitForNavigation&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœç‚¹å‡»äº†é“¾æ¥ä¹‹åï¼Œéœ€è¦ä½¿ç”¨ page.waitForNavigation æ¥ç­‰å¾…é¡µé¢åŠ è½½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªä¸è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;await&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;goto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://example.com&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="nt"&gt;await&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;click&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="nt"&gt;const&lt;/span&gt; &lt;span class="nt"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;await&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;title&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="nt"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;log&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªå¯ä»¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;await&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;goto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://example.com&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;click&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="nt"&gt;await&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;waitForNavigation&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="nt"&gt;const&lt;/span&gt; &lt;span class="nt"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;await&lt;/span&gt; &lt;span class="nt"&gt;page&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;title&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
&lt;span class="nt"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;log&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸ƒã€ä½¿ç”¨ docker æ¥ç®¡ç† Chrome&lt;/p&gt;
&lt;p&gt;Chrome é™¤äº†æµè§ˆä¹‹å¤–ï¼Œè¿˜ä¼šæœ‰å¥½å¤šçš„è«åå…¶å¦™çš„çº¿ç¨‹ï¼Œæ‰€ä»¥æœ€å¥½ä½¿ç”¨ docker æ¥ç®¡ç†&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 04 Jun 2018 19:04:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-04:/posts/pa-chong-li-qi-chrome-headless-he-puppeteer-zui-jia-shi-jian.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>Pythonçˆ¬è™«åˆ©å™¨â€”â€”lxml å’Œ xpath è¡¨è¾¾å¼</title><link>/posts/pythonpa-chong-li-qi-lxml-he-xpath-biao-da-shi.html</link><description>&lt;p&gt;æœ€è¿‘è¦åšä¸‹å¾®ä¿¡çˆ¬è™«ï¼Œä¹‹å‰å†™ä¸ªå°ä¸œè¥¿éƒ½æ˜¯ç›´æ¥ç”¨æ­£åˆ™æå–æ•°æ®å°±ç®—äº†ï¼Œå¦‚æœéœ€è¦æ›´ç¨³å®šçš„æå–æ•°æ®ï¼Œè¿˜æ˜¯ä½¿ç”¨ xpath å®šä½å…ƒç´ æ¯”è¾ƒå¯é ã€‚å‘¨æœ«æ²¡äº‹ï¼Œä»çˆ¬è™«çš„è§’åº¦ç ”ç©¶äº†ä¸€ä¸‹ python xml/html ç›¸å…³çš„åº“ã€‚&lt;/p&gt;
&lt;p&gt;Python æ ‡å‡†åº“ä¸­è‡ªå¸¦äº† xml æ¨¡å—ï¼Œä½†æ˜¯æ€§èƒ½ä¸å¤Ÿå¥½ï¼Œè€Œä¸”ç¼ºä¹ä¸€äº›äººæ€§åŒ–çš„ APIã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç¬¬ä¸‰æ–¹åº“ lxml æ˜¯ç”¨ Cython å®ç°çš„ï¼Œè€Œä¸”å¢åŠ äº†å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½ï¼Œå¯è°“çˆ¬è™«å¤„ç†ç½‘é¡µæ•°æ®çš„ä¸€ä»¶åˆ©å™¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¥æ ¼æ¥è¯´ï¼Œhtml å¹¶ä¸æ˜¯ xml çš„ä¸€ç§ï¼Œä¸è¿‡ lxml å¯¹äº xml å’Œ html éƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œåˆ†åˆ«ä½¿ç”¨ &lt;code&gt;lxml.etree&lt;/code&gt; å’Œ &lt;code&gt;lxml.html&lt;/code&gt;ä¸¤ä¸ªæ¨¡å—ã€‚&lt;/p&gt;
&lt;h1&gt;è§£æ&lt;/h1&gt;
&lt;p&gt;ç½‘é¡µä¸‹è½½ä¸‹æ¥ä»¥åæ˜¯ä¸ª bytes çš„å½¢å¼ï¼Œéœ€è¦æ„é€  DOM æ ‘ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="s1"&gt;   ...: &amp;lt;p&amp;gt;hello&amp;lt;span id=&amp;#39;world&amp;#39;&amp;gt;world&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;span class="s1"&gt;   ...: &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;lxml.html&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;doc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lxml&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;doc&lt;/span&gt;
&lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Element&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="mh"&gt;0x1059aa408&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Element ç»“æ„&lt;/h1&gt;
&lt;p&gt;ç”Ÿæˆçš„æ ‘æ˜¯ä¸€ä¸ªè®¾è®¡å¾ˆç²¾å¦™çš„ç»“æ„ï¼Œå¯ä»¥æŠŠå®ƒå½“åšä¸€ä¸ªå¯¹è±¡è®¿é—®å½“å‰èŠ‚ç‚¹è‡ªèº«çš„æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¯ä»¥æŠŠä»–å½“åšä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ å°±æ˜¯ä»–çš„å­èŠ‚ç‚¹ï¼Œå¯ä»¥æŠŠå®ƒå½“åšä¸€ä¸ªå­—å…¸ï¼Œä»è€Œéå†å®ƒçš„å±æ€§ï¼Œä¸‹é¢æ¼”ç¤ºäº† lxml çš„å¸¸è§ç”¨æ³•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;In [5]: doc.text
Out[5]: &amp;#39;hello&amp;#39;

In [6]: doc.tag
Out[6]: &amp;#39;p&amp;#39;

In [7]: doc[0].tag
Out[7]: &amp;#39;span&amp;#39;

In [11]: for k, v in doc[0].items():
    ...:     print(k, v)
    ...:
id world

In [12]: doc[0].get(&amp;#39;id&amp;#39;)
Out[12]: &amp;#39;world&amp;#39;

In [13]: doc[0].attrib
Out[13]: {&amp;#39;id&amp;#39;: &amp;#39;world&amp;#39;}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;éå†æ ‘çš„æ–¹æ³•&lt;/h1&gt;
&lt;p&gt;doc æ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œå¯ä»¥é€šè¿‡ä¸€äº›æ–¹æ³•è®¿é—®æ ‘ä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;In [14]: doc.getroottree()  # è¿”å›æ ‘
Out[14]: &lt;span class="nt"&gt;&amp;lt;lxml.etree._ElementTree&lt;/span&gt; &lt;span class="err"&gt;at&lt;/span&gt; &lt;span class="err"&gt;0x105360708&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;

In [19]: doc.getroottree().getroot()  # è¿”å›æ ¹èŠ‚ç‚¹ï¼Œè¿™é‡Œæ˜¯ lxml è‡ªåŠ¨ç”Ÿæˆçš„ html èŠ‚ç‚¹
Out[19]: &lt;span class="nt"&gt;&amp;lt;Element&lt;/span&gt; &lt;span class="err"&gt;html&lt;/span&gt; &lt;span class="err"&gt;at&lt;/span&gt; &lt;span class="err"&gt;0x10599da98&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;

In [20]: doc.getparent()  # lxml è‡ªåŠ¨ç”Ÿæˆçš„ body èŠ‚ç‚¹
Out[20]: &lt;span class="nt"&gt;&amp;lt;Element&lt;/span&gt; &lt;span class="err"&gt;body&lt;/span&gt; &lt;span class="err"&gt;at&lt;/span&gt; &lt;span class="err"&gt;0x1059a87c8&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;

In [21]: doc.getprevious()

In [22]: doc.getnext()

In [23]: doc.text_content()
Out[23]: &amp;#39;helloworld&amp;#39;

In [25]: lxml.html.tostring(doc, pretty_print=True, encoding=&amp;#39;utf-8&amp;#39;)
Out[25]: b&amp;#39;&lt;span class="nt"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;hello&lt;span class="nt"&gt;&amp;lt;span&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;world&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;world&lt;span class="nt"&gt;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&lt;/span&gt;\n&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„å› ä¸ºæˆ‘ä»¬ç»™çš„æ˜¯ä¸€ä¸ª html çš„ç‰‡æ®µï¼ˆ&lt;code&gt;&amp;lt;p&amp;gt;...&amp;lt;/p&amp;gt;&lt;/code&gt;ï¼‰ï¼Œæ‰€ä»¥ lxml è‡ªåŠ¨ç”Ÿæˆäº† html å’Œ body ç­‰èŠ‚ç‚¹å·²æ„æˆå®Œæ•´çš„ html æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœéœ€è¦æ˜¾å¼åœ°æŒ‡å®šç”Ÿæˆä¸€ä¸ª html ç‰‡æ®µæ–‡æ¡£è¿˜æ˜¯å®Œæ•´æ–‡æ¡£ï¼Œå¯ä»¥åˆ†åˆ«ä½¿ç”¨ï¼šlxml.html.fragment_fromstring å’Œ lxml.html.document_fromstring ä¸¤ä¸ªæ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;lxml è¿˜æœ‰å…¶ä»–ä¸€äº›æ–¹æ³•ï¼Œéƒ½åˆ—åœ¨ä¸‹é¢äº†ï¼š&lt;/p&gt;
&lt;p&gt;Element.tail    &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Element.append(Element)   æ·»åŠ ä¸€ä¸ªå­å…ƒç´ &lt;/li&gt;
&lt;li&gt;Element.set('attr', value) è®¾ç½®å±æ€§&lt;/li&gt;
&lt;li&gt;Element.iter(tag_name) éå†æ‰€æœ‰åç³»å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;*&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;ElementTree.getelementpath(Element)   &lt;/li&gt;
&lt;li&gt;Element.getroottree() è¿”å›å¯¹åº”çš„æ ‘&lt;/li&gt;
&lt;li&gt;ElementTree.getpath(Element)  è¿”å›ä¸€ä¸ªå…ƒç´ çš„ xpath&lt;/li&gt;
&lt;li&gt;ElementTree.getroot() è¿”å›æ ¹èŠ‚ç‚¹&lt;/li&gt;
&lt;li&gt;HtmlElement.drop_tree() åˆ é™¤å½“å‰èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œä½†æ˜¯ä¿ç•™text&lt;/li&gt;
&lt;li&gt;HtmlElement.drop_tag() åˆ é™¤å½“å‰èŠ‚ç‚¹ï¼Œä½†æ˜¯ä¿ç•™å®ƒçš„å­èŠ‚ç‚¹å’Œtext&lt;/li&gt;
&lt;li&gt;HtmlElement.classes è¿”å›ç±»&lt;/li&gt;
&lt;li&gt;HtmlElement.find_class(class_name) æŒ‰ç…§ class æŸ¥æ‰¾ tag&lt;/li&gt;
&lt;li&gt;HtmlElement.get_element_by_id(id, *default) æŒ‰ç…§ id æŸ¥æ‰¾å…ƒç´ &lt;/li&gt;
&lt;li&gt;HtmlElement.iterlinks() éå†æ‰€æœ‰è¿æ¥&lt;/li&gt;
&lt;li&gt;HtmlElement.make_links_absolute(base_url=None, resolve_base_href=True) æŠŠæ‰€æœ‰è¿æ¥å˜æˆç»å¯¹é“¾æ¥&lt;/li&gt;
&lt;li&gt;HtmlElement.resolve_base_href() è§£æ base æ ‡ç­¾&lt;/li&gt;
&lt;li&gt;HtmlElement.rewrite_links(link_repl_func) æ›¿æ¢æ‰€æœ‰çš„é“¾æ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;XPath&lt;/h1&gt;
&lt;p&gt;XPath å®åœ¨å¤ªå¼ºå¤§äº†ï¼Œåœ¨å®šä½å…ƒç´ æ–¹é¢ç»å¯¹æ˜¯ç§’æ€ CSS é€‰æ‹©å™¨ã€‚åœ¨ lxml ä¸­ï¼ŒèŠ‚ç‚¹å’Œæ ‘åˆ†åˆ«å…·æœ‰xpath å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;lxml ä¸­çš„ xpath æ–¹æ³•ï¼Œå¯¹äº xpath è¡¨è¾¾å¼åº”è¯¥è¿”å›å…ƒç´ ï¼Œæ€»æ˜¯è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªå…ƒç´ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;In [24]: doc.xpath(&amp;#39;//span/text()&amp;#39;)
Out[24]: [&amp;#39;world&amp;#39;]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;lxml ä¸­çš„ xpath å‡½æ•°æ”¯æŒå˜é‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;print(root.xpath(&amp;quot;$text&amp;quot;, text = &amp;quot;Hello World!&amp;quot;))
Hello World!
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;xpath may return _ElementStringResult, which is not picklable, use xpath(smart_strings=False) to avoid this http://lxml.de/xpathxslt.html#xpath-return-values&lt;/p&gt;
&lt;p&gt;lxml è¿˜æ”¯æŒå‡ ä¸ªå‡½æ•° &lt;code&gt;find/findall&lt;/code&gt;ï¼Œä»–ä»¬ä½¿ç”¨ ElementPathï¼Œæ˜¯ä¸€ç§ç±»ä¼¼ xpath çš„è¯­è¨€ï¼Œæ„Ÿè§‰å¾ˆæ˜¯å¥‡æ€ªï¼Œlxml çš„æ–‡æ¡£æè¿°ä»–æ˜¯ xpath çš„ä¸€ä¸ªå­é›†ï¼Œæš‚æ—¶ä¸çœ‹äº†ã€‚&lt;/p&gt;
&lt;h1&gt;å¸¸è§é—®é¢˜&lt;/h1&gt;
&lt;p&gt;lxml åœ¨é‡åˆ°å°äºå·çš„æ—¶å€™ä¼šå‡ºé—®é¢˜ï¼ˆæŒ‰ç…§æ ‡å‡†ï¼Œåº”è¯¥ç¼–ç ä¸º &lt;code&gt;&amp;amp;lt;&lt;/code&gt;ï¼‰ï¼Œç›´æ¥æŠŠåé¢çš„æ–‡æ¡£éƒ½ä¸¢äº†ï¼Œä½†æ˜¯æµè§ˆå™¨å…¼å®¹æ€§æ¯”è¾ƒå¥½ï¼Œä¸ä¼šæœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;by default, the lxml parser is not very error-proof, the html5parser lib is behaves more like your web browser.&lt;/p&gt;
&lt;p&gt;lxml.html.html5parser provides same interface with lxml.html&lt;/p&gt;
&lt;p&gt;tricks and traps&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 02 Jun 2018 16:29:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-06-02:/posts/pythonpa-chong-li-qi-lxml-he-xpath-biao-da-shi.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>ä½¿ç”¨ supervisord éƒ¨ç½²æœåŠ¡</title><link>/posts/shi-yong-supervisord-bu-shu-fu-wu.html</link><description>&lt;p&gt;åœ¨æŸä¸€åˆ»ä½ ä¼šæ„è¯†åˆ°ä½ éœ€è¦å†™ä¸€ä¸ªé•¿æœŸè¿è¡Œçš„æœåŠ¡ã€‚å¦‚æœæœ‰é”™è¯¯ï¼Œè¿™äº›è„šæœ¬ä¸åº”è¯¥åœæ­¢è¿è¡Œï¼Œè€Œä¸”å½“ç³»ç»Ÿé‡å¯çš„æ—¶å€™åº”è¯¥è‡ªåŠ¨æŠŠè¿™äº›è„šæœ¬æ‹‰èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›ä¸œè¥¿æ¥ç›‘æ§è„šæœ¬ã€‚è¿™äº›å·¥å…·åœ¨è„šæœ¬æŒ‚æ‰çš„æ—¶å€™é‡å¯ä»–ä»¬ï¼Œå¹¶ä¸”åœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™æ‹‰èµ·ä»–ä»¬ã€‚&lt;/p&gt;
&lt;h1&gt;è„šæœ¬&lt;/h1&gt;
&lt;p&gt;è¿™æ ·çš„å·¥å…·åº”è¯¥æ˜¯æ€æ ·çš„å‘¢ï¼Ÿæˆ‘ä»¬å®‰è£…çš„å¤§å¤šæ•°ä¸œè¥¿éƒ½å¸¦äº†æŸç§è¿›ç¨‹ç›‘æ§çš„æœºåˆ¶ã€‚æ¯”å¦‚è¯´Upstartå’ŒSystemdã€‚è¿™äº›å·¥å…·è¢«è®¸å¤šç³»ç»Ÿç”¨åŠ›å•Šç›‘æ§é‡è¦çš„è¿›ç¨‹ã€‚å½“æˆ‘ä»¬å®‰è£…php5-fpmï¼ŒApache å’Œnginxçš„æ—¶å€™ï¼Œä»–ä»¬é€šå¸¸å·²ç»å’Œç³»ç»Ÿé›†æˆå¥½äº†ï¼Œä»¥ä¾¿äºä»–ä»¬ä¸ä¼šé»˜é»˜æŒ‚æ‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œæˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦ä¸€äº›ç®€å•ç‚¹å„¿çš„è§£å†³æ–¹æ¡ˆã€‚æ¯”å¦‚è¯´æˆ‘ç»å¸¸å†™ä¸€äº› nodejs çš„è„šæœ¬æ¥ç›‘æ§githubä¸Šçš„æŸä¸ªåŠ¨æ€å¹¶ä½œç›¸åº”çš„åŠ¨ä½œã€‚nodeå¯ä»¥å¤„ç† httpè¯·æ±‚å¹¶ä¸”åŒæ—¶å¤„ç†ä»–ä»¬ï¼Œä¹Ÿå°±æ˜¯å¾ˆé€‚åˆä½œä¸ºä¸€ä¸ªä¸€æ¬¡æ€§è¿è¡Œçš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›å°çš„è„šæœ¬å¯èƒ½ä¸å€¼å¾—ä½¿ç”¨ Upstart æˆ–è€… Systemd è¿™ç§é‡é‡çº§çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯æˆ‘ä»¬ç”¨æ¥ä¸¾ä¾‹çš„è„šæœ¬ æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨ /srv/http.js ä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;serve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;port&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createServer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;req&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;writeHead&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\nSome Secrets:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;SECRET_PASSPHRASE&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;SECRET_TWO&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;end&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\nThere&amp;#39;s no place like &amp;quot;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;port&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;listen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;port&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Server running at http://&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;ip&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;port&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// Create a server listening on all networks&lt;/span&gt;
&lt;span class="nx"&gt;serve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9000&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;All this service does is take a web request and print out a message. It's not useful in reality, but good for our purposes. We just want a service to run and monitor.&lt;/p&gt;
&lt;p&gt;Note that the service prints out two environmental variables: "SECRET_PASSPHRASE" and "SECRET_TWO". We'll see how we can pass these into a watched process.&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæœåŠ¡ä»…ä»…æ˜¯æ¥å—ä¸€ä¸ª http è¯·æ±‚å¹¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚åœ¨ç°å®ä¸­å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ï¼Œä½†æ˜¯ç”¨æ¥æ¼”ç¤ºå¾ˆå¥½ã€‚æˆ‘ä»¬åªæ˜¯éœ€è¦ä¸€ä¸ªæœåŠ¡æ¥è¿è¡Œå’Œç›‘æ§ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°è¿™ä¸ªæœåŠ¡æ‰“å°ä¸¤ä¸ªå˜é‡ "SECRET_PASSPHRASE" å’Œ "SECRET_TWO"ã€‚æˆ‘ä»¬å°†ä¼šæ¼”ç¤ºå¦‚ä½•æŠŠè¿™ä¸ªä¼ é€’ä¸ªè¢«ç›‘æ§çš„è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h1&gt;Supervisord&lt;/h1&gt;
&lt;p&gt;Supervisord is a simple and popular choice for process monitoring.&lt;/p&gt;
&lt;p&gt;Supervisord æ˜¯ä¸€ä¸ªä½¿ç”¨å¾ˆå¹¿ä¹Ÿå¾ˆç®€å•çš„è¿›ç¨‹ç›‘æ§å·¥å…·ã€‚&lt;/p&gt;
&lt;h2&gt;å®‰è£…&lt;/h2&gt;
&lt;p&gt;å»ºè®®ä½¿ç”¨ç³»ç»Ÿçš„åŒ…ç®¡ç†å™¨å®‰è£…ï¼Œè™½ç„¶å¯èƒ½ç‰ˆæœ¬ç¨å¾®è€ä¸€ç‚¹ï¼Œä½†æ˜¯ã€‚ä¸è¿‡ supervisor è¿˜ä¸æ”¯æŒ python 3ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ python 2 ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;brew install supervisor
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ linux ä¸Šå¯ä»¥é€šè¿‡apt-getæ¥å®‰è£… supervisorï¼ŒåŒæ ·çš„å‘½ä»¤ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;apt-get install supervisor
service supervisor start
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;é…ç½®&lt;/h2&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥é…ç½®ä¸€ä¸ª supervisor æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“å¼€ /etc/supervisor/supervisord.confï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€åä¸€è¡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[include]&lt;/span&gt;
&lt;span class="na"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;/etc/supervisor/conf.d/*.conf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠæˆ‘ä»¬çš„é…ç½®æ–‡ä»¶æ”¾åœ¨ /etc/supervisor/conf.d æ–‡ä»¶å¤¹ä¸‹å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[program:nodehook]&lt;/span&gt;
&lt;span class="na"&gt;command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/usr/bin/node /srv/http.js&lt;/span&gt;
&lt;span class="na"&gt;directory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/srv&lt;/span&gt;
&lt;span class="na"&gt;autostart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="na"&gt;autorestart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="na"&gt;startretries&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;3&lt;/span&gt;
&lt;span class="na"&gt;stderr_logfile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/var/log/webhook/nodehook.err.log&lt;/span&gt;
&lt;span class="na"&gt;stdout_logfile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/var/log/webhook/nodehook.out.log&lt;/span&gt;
&lt;span class="na"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;www-data&lt;/span&gt;
&lt;span class="na"&gt;environment&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;SECRET_PASSPHRASE=&amp;#39;this is secret&amp;#39;,SECRET_TWO=&amp;#39;another secret&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¯ä¸ªé€‰é¡¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;[program:nodehook] å®šä¹‰è¿è¡Œçš„æœåŠ¡çš„åå­—ã€‚&lt;/li&gt;
&lt;li&gt;command å¯åŠ¨è¢«ç›‘æ§çš„æœåŠ¡çš„å‘½ä»¤ï¼Œå¦‚æœä½ éœ€è¦ä¼ é€’å‘½ä»¤è¡Œå‚æ•°çš„è¯ï¼Œä¹Ÿæ”¾åœ¨è¿™é‡Œ&lt;/li&gt;
&lt;li&gt;directory è®¾å®šè¿›ç¨‹çš„è¿è¡Œç›®å½•&lt;/li&gt;
&lt;li&gt;autostart æ˜¯å¦éœ€è¦åœ¨ supervisord å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨æ‹‰èµ·&lt;/li&gt;
&lt;li&gt;autorestart æ˜¯å¦åœ¨ç¨‹åºæŒ‚æ‰çš„æ—¶å€™è‡ªåŠ¨é‡æ–°æ‹‰èµ·&lt;/li&gt;
&lt;li&gt;startretries å¦‚æœå¯åŠ¨å¤±è´¥ï¼Œé‡è¯•å¤šå°‘æ¬¡&lt;/li&gt;
&lt;li&gt;stderr_logfile æ ‡å‡†é”™è¯¯è¾“å‡ºå†™å…¥åˆ°å“ªä¸ªæ–‡ä»¶&lt;/li&gt;
&lt;li&gt;stdout_logfile æ ‡å‡†è¾“å‡ºå†™å…¥åˆ°å“ªä¸ªæ–‡ä»¶&lt;/li&gt;
&lt;li&gt;user è¿è¡Œè¿›ç¨‹çš„ç”¨æˆ·&lt;/li&gt;
&lt;li&gt;environment ä¼ é€’ç»™è¿›ç¨‹çš„ç¯å¢ƒå˜é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œsupervisor ä¸ä¼šè‡ªåŠ¨åˆ›å»ºæ—¥å¿—æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬é¦–å…ˆåˆ›å»ºå¥½ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mkdir /var/log/webhook
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;supervisor é…ç½®æ–‡ä»¶çš„æœç´¢è·¯å¾„åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/usr/local/etc/supervisord.conf
/usr/local/supervisord.conf
supervisord.conf  # å½“å‰ç›®å½•
etc/supervisord.conf
/etc/supervisord.conf
/etc/supervisor/supervisord.conf
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ§åˆ¶è¿›ç¨‹&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ supervisorctl æ¥æ§åˆ¶å¯¹åº”çš„æœåŠ¡äº†ã€‚ä¸è¿‡éœ€è¦é¦–å…ˆå¯åŠ¨ supervisord çš„daemon æ‰è¡Œã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;supervisorctl reread
supervisorctl update
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ ·å°±å¯ä»¥å¯åŠ¨åˆšåˆšå®šä¹‰çš„æœåŠ¡ã€‚supervisorctl çš„å…¶ä»–åŠŸèƒ½å¯ä»¥æŸ¥çœ‹å¸®åŠ©&lt;/p&gt;
&lt;h1&gt;Web ç•Œé¢&lt;/h1&gt;
&lt;p&gt;We can configure a web interface which comes with Supervisord. This lets us see a list of all processes being monitored, as well as take action on them (restarting, stopping, clearing logs and checking output).&lt;/p&gt;
&lt;p&gt;supervisor è‡ªå¸¦äº†ä¸€ä¸ª web ç•Œé¢ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æµè§ˆå™¨æ¥ç®¡ç†è¿›ç¨‹äº†ã€‚&lt;/p&gt;
&lt;p&gt;Inside of /etc/supervisord.conf, add this:&lt;/p&gt;
&lt;p&gt;åœ¨ /etc/supervisord.conf ä¸­æ·»åŠ ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[inet_http_server]&lt;/span&gt;
&lt;span class="na"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;9001&lt;/span&gt;
&lt;span class="na"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;user # Basic auth username&lt;/span&gt;
&lt;span class="na"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;pass # Basic auth password&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If we access our server in a web browser at port 9001, we'll see the web interface:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tNc79ly1frmjham7zcj319i0c2mz7.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ref: https://serversforhackers.com/c/monitoring-processes-with-supervisord&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 24 May 2018 00:32:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-05-24:/posts/shi-yong-supervisord-bu-shu-fu-wu.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>mysql åŸºç¡€çŸ¥è¯†(7) - JSON å­—æ®µ</title><link>/posts/mysql-ji-chu-zhi-shi-7-json-zi-duan.html</link><description>&lt;p&gt;åœ¨å‰å…¬å¸çš„æ—¶å€™ï¼Œå¤§å®¶ä¹ æƒ¯åœ¨æ¯ä¸ªè¡¨åŠ ä¸€ä¸ª extra å­—æ®µæ¥è¡¨ç¤ºä¸€äº›é¢å¤–çš„å­—æ®µï¼Œç„¶ååœ¨ ORM ä¸­ä½¿ç”¨çš„æ—¶å€™å†è§£æå‡ºæ¥ï¼Œæ–¹ä¾¿äº†æ‰©å±•å­—æ®µï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œextra å­—æ®µåªèƒ½è¯»å–è€Œæ— æ³•è¿›è¡ŒæŸ¥è¯¢ã€‚MySQL 5.7 ç»ˆäºæ”¯æŒäº† json å­—æ®µï¼Œç›¸å½“äºåŠ å…¥äº†ä¸€äº› NoSQL çš„ç‰¹æ€§ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿å¾—æŸ¥è¯¢äº†ã€‚&lt;/p&gt;
&lt;h1&gt;json å­—æ®µçš„ä½¿ç”¨&lt;/h1&gt;
&lt;p&gt;å»ºè¡¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CREATE TABLE `book` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,
  `title` varchar(200) NOT NULL,
  `tags` json DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç›´æ¥ä½¿ç”¨ json ç±»å‹å°±å¯ä»¥äº†ã€‚æ³¨æ„ json å­—æ®µä¸å¯ä»¥ä½œä¸ºä¸»é”®ï¼Œä¸å¯ä»¥ä½œä¸ºå¤–é”®ï¼Œä¸è¿‡æ—¢ç„¶æ˜¯ json å­—æ®µäº†ï¼Œè°ä¼šè¿™ä¹ˆåšå‘¢ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æ’å…¥ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;INSERT INTO `book` (`title`, `tags`)
VALUES (
  &amp;#39;ECMAScript 2015: A SitePoint Anthology&amp;#39;,
  &amp;#39;[&amp;quot;JavaScript&amp;quot;, &amp;quot;ES2015&amp;quot;, &amp;quot;JSON&amp;quot;]&amp;#39;
);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ä¸€ä¸ª json å­—ç¬¦ä¸²ä½œä¸ºå€¼æ’å…¥å³å¯ã€‚æˆ–è€…ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ json ç›¸å…³çš„å‡½æ•°æ¥è¡¨ç¤ºjsonã€‚&lt;/p&gt;
&lt;h1&gt;json ç›¸å…³å‡½æ•°&lt;/h1&gt;
&lt;h2&gt;json path&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- returns &amp;quot;SitePoint&amp;quot;:
SELECT JSON_EXTRACT(
  &amp;#39;{&amp;quot;id&amp;quot;: 1, &amp;quot;website&amp;quot;: &amp;quot;SitePoint&amp;quot;}&amp;#39;, 
  &amp;#39;$.website&amp;#39;
);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;json path çš„è¯­æ³•ï¼Œç”¨ $ å¼€å¤´ï¼Œç„¶åè·Ÿç€ä¸‹é¢çš„é€‰æ‹©å™¨:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.&lt;/code&gt; ç‚¹åé¢è·Ÿç€è·Ÿç€ä¸€ä¸ªå­—å…¸é‡Œçš„åå­—, æ¯”å¦‚ $.website&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[N]&lt;/code&gt; è¡¨ç¤ºæ•°ç»„é‡Œçš„ç¬¬ N ä¸ªå…ƒç´ &lt;/li&gt;
&lt;li&gt;&lt;code&gt;.[*]&lt;/code&gt; è¡¨ç¤ºé€‰æ‹©å­—å…¸é‡Œçš„æ‰€æœ‰å…ƒç´ &lt;/li&gt;
&lt;li&gt;&lt;code&gt;[*]&lt;/code&gt; è¡¨ç¤ºé€‰æ‹©æ•°ç»„é‡Œçš„æ‰€æœ‰å…ƒç´ &lt;/li&gt;
&lt;li&gt;&lt;code&gt;prefix**suffix&lt;/code&gt; è¡¨ç¤ºä»¥ prefix å¼€å¤´ï¼Œsuffix ç»“å°¾çš„æ‰€æœ‰è·¯å¾„&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸¾ä¸ªæ —å­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;{
  &amp;quot;a&amp;quot;: 1,
  &amp;quot;b&amp;quot;: 2,
  &amp;quot;c&amp;quot;: [3, 4],
  &amp;quot;d&amp;quot;: {
    &amp;quot;e&amp;quot;: 5,
    &amp;quot;f&amp;quot;: 6
  }
}
the following paths:

$.a returns 1
$.c returns [3, 4]
$.c[1] returns 4
$.d.e returns 5
$**.e returns [5]
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ„é€ ã€ä¿®æ”¹ json çš„å‡½æ•°&lt;/h2&gt;
&lt;p&gt;å‡½æ•°éƒ½æ¯”è¾ƒç®€å•ï¼Œçœ‹æ³¨é‡Šå°±æ˜ç™½äº†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- returns [1, 2, &amp;quot;abc&amp;quot;]:
SELECT JSON_ARRAY(1, 2, &amp;#39;abc&amp;#39;);

-- returns {&amp;quot;a&amp;quot;: 1, &amp;quot;b&amp;quot;: 2}:
SELECT JSON_OBJECT(&amp;#39;a&amp;#39;, 1, &amp;#39;b&amp;#39;, 2);

-- returns [&amp;quot;a&amp;quot;, 1, {&amp;quot;key&amp;quot;: &amp;quot;value&amp;quot;}]:
SELECT JSON_MERGE(&amp;#39;[&amp;quot;a&amp;quot;, 1]&amp;#39;, &amp;#39;{&amp;quot;key&amp;quot;: &amp;quot;value&amp;quot;}&amp;#39;);

-- returns ARRAY:
SELECT JSON_TYPE(&amp;#39;[1, 2, &amp;quot;abc&amp;quot;]&amp;#39;);

-- returns OBJECT:
SELECT JSON_TYPE(&amp;#39;{&amp;quot;a&amp;quot;: 1, &amp;quot;b&amp;quot;: 2}&amp;#39;);

-- returns an error:
SELECT JSON_TYPE(&amp;#39;{&amp;quot;a&amp;quot;: 1, &amp;quot;b&amp;quot;: 2&amp;#39;);

-- returns 1:
SELECT JSON_VALID(&amp;#39;[1, 2, &amp;quot;abc&amp;quot;]&amp;#39;);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿˜æœ‰å…¶ä»–ä¸€äº›å‡½æ•°ï¼Œå¯ä»¥æŸ¥çœ‹æ–‡æ¡£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;JSON_SET(doc, path, val[, path, val]...) â€”
inserts or updates data in the document&lt;/li&gt;
&lt;li&gt;JSON_INSERT(doc, path, val[, path, val]...) â€”
inserts data into the document&lt;/li&gt;
&lt;li&gt;JSON_REPLACE(doc, path, val[, path, val]...) â€”
replaces data in the document&lt;/li&gt;
&lt;li&gt;JSON_MERGE(doc, doc[, doc]...) â€”
merges two or more documents&lt;/li&gt;
&lt;li&gt;JSON_ARRAY_APPEND(doc, path, val[, path, val]...) â€”
appends values to the end of an array&lt;/li&gt;
&lt;li&gt;JSON_ARRAY_INSERT(doc, path, val[, path, val]...) â€”
inserts an array within the document&lt;/li&gt;
&lt;li&gt;JSON_REMOVE(doc, path[, path]...) â€”
removes data from the document.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;æŸ¥è¯¢ json å‡½æ•°&lt;/h2&gt;
&lt;h3&gt;ç”¨äº where å­å¥ä¸­çš„å‡½æ•°&lt;/h3&gt;
&lt;p&gt;json_contains ç”¨äºé€‰å–æ•°ç»„ä¸­åŒ…å«æŸä¸ªå…ƒç´ çš„è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- all books with the &amp;#39;JavaScript&amp;#39; tag:
SELECT * FROM `book` 
WHERE JSON_CONTAINS(tags, &amp;#39;[&amp;quot;JavaScript&amp;quot;]&amp;#39;);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;json_search ç”¨äºé€‰å–å­—å…¸ä¸­åŒ…å«æŸä¸ªå€¼çš„è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- all books with tags starting &amp;#39;Java&amp;#39;:
SELECT * FROM `book` 
WHERE JSON_SEARCH(tags, &amp;#39;one&amp;#39;, &amp;#39;Java%&amp;#39;) IS NOT NULL;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ç”¨äº select å­å¥ä¸­çš„ json å‡½æ•°&lt;/h3&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ json path è¯­æ³•ä»å¾—åˆ°çš„ json æ–‡æ¡£ä¸­æŠ½å–å‡ºæŸä¸ªå€¼ã€‚&lt;/p&gt;
&lt;h2&gt;select è¯­å¥&lt;/h2&gt;
&lt;p&gt;è¦æƒ³åœ¨selectè¯­å¥ä¸­ä½¿ç”¨ json path æŠ½å–å…ƒç´ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•ï¼Œä¹Ÿå°±æ˜¯ &lt;code&gt;column-&amp;gt;path&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SELECT
  name,
  tags-&amp;gt;&amp;quot;$[0]&amp;quot; AS `tag1`
FROM `book`;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸€ä¸ªæ›´å¤æ‚ä¸€ç‚¹çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;name&lt;/th&gt;
&lt;th&gt;profile&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Craig&lt;/td&gt;
&lt;td _craigbuckler_="â€œcraigbucklerâ€" _craigbuckler_facebook_:="â€œ@craigbucklerâ€,â€œfacebookâ€:" _craigbuckler_googleplus_:="â€œcraigbucklerâ€,â€œgoogleplusâ€:" _twitter_:="â€œtwitterâ€:"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;SitePoint&lt;/td&gt;
&lt;td _sitepointdotcom_="â€œ@sitepointdotcomâ€" _twitter_:="â€œtwitterâ€:"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SELECT
  name, profile-&amp;gt;&amp;quot;$.twitter&amp;quot; AS `twitter`
FROM `user`;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SELECT
  name, profile-&amp;gt;&amp;quot;$.twitter&amp;quot; AS `twitter`
FROM `user`
WHERE
  profile-&amp;gt;&amp;quot;$.twitter&amp;quot; IS NOT NULL;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;REF:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://www.sitepoint.com/use-json-data-fields-mysql-databases/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 20 May 2018 03:39:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-05-20:/posts/mysql-ji-chu-zhi-shi-7-json-zi-duan.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>å¦‚ä½•å‘å¸ƒ Python ä»£ç åˆ° PyPI ä¸Šï¼ˆ2018ï¼‰</title><link>/posts/ru-he-fa-bu-python-dai-ma-dao-pypi-shang-2018.html</link><description>&lt;p&gt;PyPI æ˜¯ Python çš„é›†ä¸­ä»“åº“ã€‚é€šè¿‡æŠŠä»£ç ä¸Šä¼ åˆ° PyPIï¼Œå…¶ä»–äººå°±å¯ä»¥ä½¿ç”¨ä½¿ç”¨ &lt;code&gt;pip install xxx&lt;/code&gt; å®‰è£…ä»£ç äº†ã€‚&lt;/p&gt;
&lt;p&gt;Python çš„å®‰è£…å·¥å…·ä¸€ç›´åœ¨ä¸æ–­æ¼”å˜ï¼ŒPyPI çš„åœ°å€ä¹Ÿä» pypi.python.org å˜åˆ°äº† pypi.orgï¼Œå› æ­¤ç½‘ä¸Šçš„æ•™ç¨‹å¤§å¤šæ•°éƒ½è¿‡æ—¶äº†ï¼Œå®˜æ–¹æ–‡æ¡£æ›´æ–°æ¯”è¾ƒåŠæ—¶ï¼Œä½†æ˜¯ä¹Ÿç•¥è¿‡ç¹çï¼Œè¿™é‡Œå†™ä¸€ç¯‡ç®€è¦çš„æ•™ç¨‹ä»¥é£¨è¯»è€…ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä»¥ä½œè€…çš„åº“ &lt;a href="https://github.com/yifeikong/aioify"&gt;aioify&lt;/a&gt; ä¸ºä¾‹&lt;/p&gt;
&lt;h1&gt;æ–‡ä»¶ç»“æ„&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;.
â”œâ”€â”€ LICENSE.txt
â”œâ”€â”€ MANIFEST.in
â”œâ”€â”€ README.md
â”œâ”€â”€ aioify
â”‚Â Â  â””â”€â”€ __init__.py
â”œâ”€â”€ setup.cfg
â””â”€â”€ setup.py
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;LICENSE.txt&lt;/h2&gt;
&lt;p&gt;åº“çš„å¼€æºåè®®ï¼Œå»ºè®®ä½¿ç”¨ Apacheã€MIT ç­‰&lt;/p&gt;
&lt;h2&gt;MANIFEST.in&lt;/h2&gt;
&lt;p&gt;æ‰“åŒ…è¦åŒ…å«çš„æ–‡ä»¶ï¼ŒPython æ–‡ä»¶ä¼šè‡ªåŠ¨åŒ…æ‹¬åœ¨å†…ï¼Œä½†æ˜¯ README.md ä¸åŒ…å«åœ¨å†…ï¼Œæ‰€ä»¥éœ€è¦ç‰¹åˆ«æ³¨æ˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;include *.md
include LICENSE.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…·ä½“è¯­æ³•å‚è§&lt;/p&gt;
&lt;h2&gt;README.md&lt;/h2&gt;
&lt;p&gt;è¯´æ˜æ–‡ä»¶ï¼Œä¸å¤šæ•°äº†&lt;/p&gt;
&lt;h2&gt;aioify&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯å…·ä½“çš„ä»£ç çš„ä»“åº“&lt;/p&gt;
&lt;h2&gt;setup.cfg&lt;/h2&gt;
&lt;p&gt;ç”¨äºæŒ‡å®š setup.py çš„é»˜è®¤å‚æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[metadata]&lt;/span&gt;
&lt;span class="na"&gt;description-file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;README.md&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;setup.py&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªæ–‡ä»¶æ˜¯æ•´ä¸ªæ‰“åŒ…è¿‡ç¨‹çš„å…³é”®æ‰€åœ¨äº†ã€‚è¯·å‚è€ƒä¸‹é¢çš„æ³¨é‡Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;distutils.core&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;setup&lt;/span&gt;

&lt;span class="c1"&gt;# å¯é€‰ï¼Œè¯»å– README ä½œä¸ºä¸‹é¢çš„ long_description&lt;/span&gt;
&lt;span class="n"&gt;here&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abspath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dirname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__file__&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;here&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;README.md&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;long_description&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;aioify&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="c1"&gt;# åŒ…çš„åå­—&lt;/span&gt;
    &lt;span class="n"&gt;packages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;aioify&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;   &lt;span class="c1"&gt;# åŒä¸Š&lt;/span&gt;
    &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0.1.3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;    &lt;span class="c1"&gt;# å½“å‰ç‰ˆæœ¬&lt;/span&gt;
    &lt;span class="n"&gt;description&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Make every python function async/await&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# æè¿°&lt;/span&gt;
    &lt;span class="n"&gt;long_description&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;long_description&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# é•¿æè¿°ï¼Œä¼šæ˜¾ç¤ºåœ¨ PyPI ä¸»é¡µä¸Š&lt;/span&gt;
    &lt;span class="n"&gt;long_description_content_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;text/markdown&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# é•¿æè¿°çš„æ ¼å¼ï¼Œä¸è¿‡å¥½åƒmarkdownæ”¯æŒè¿˜ä¸æ˜¯å¾ˆå¥½&lt;/span&gt;
    &lt;span class="n"&gt;author&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Yifei Kong&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# ä½œè€…&lt;/span&gt;
    &lt;span class="n"&gt;author_email&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;kongyifei@gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# ä½œè€…é‚®ä»¶&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://github.com/yifeikong/aioify&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# é¡¹ç›®åœ°å€&lt;/span&gt;
    &lt;span class="n"&gt;download_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://github.com/yifeikong/aioify/archive/0.1.3.tar.gz&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# ä¸‹è½½é“¾æ¥ï¼Œå¯é€‰&lt;/span&gt;
    &lt;span class="n"&gt;keywords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;async&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;await&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wrap&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;  &lt;span class="c1"&gt;# å…³é”®è¯&lt;/span&gt;
    &lt;span class="c1"&gt;# åˆ†ç±»å™¨ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ PyPI çš„ä¸€äº›æ ç›®ï¼Œå»ºè®®å‚è€ƒæ–‡æ¡£å¡«å†™ï¼Œå¯é€‰&lt;/span&gt;
    &lt;span class="n"&gt;classifiers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Development Status :: 3 - Alpha&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Intended Audience :: Developers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;License :: OSI Approved :: MIT License&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Programming Language :: Python :: 3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Programming Language :: Python :: 3.5&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Programming Language :: Python :: 3.6&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;Programming Language :: Python :: 3.7&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;python_requires&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;gt;=3.5&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# æœ€ä½ Python ç‰ˆæœ¬&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;ä¸Šä¼ &lt;/h1&gt;
&lt;h2&gt;æœ¬åœ°æµ‹è¯•&lt;/h2&gt;
&lt;p&gt;åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ pip å®‰è£…æµ‹è¯•ä¸€ä¸‹ï¼Œçœ‹ setup.py ç­‰æ–‡ä»¶æ˜¯å¦æœ‰é—®é¢˜&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install -e .
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ³¨å†Œè´¦æˆ·&lt;/h2&gt;
&lt;p&gt;åœ¨ pypi.org æ³¨å†Œä¸€ä¸ªè´¦æˆ·ã€‚å¦å¤–ï¼Œåœ¨ test.pypi.org å†æ³¨å†Œä¸€ä¸ªæµ‹è¯•è´¦æˆ·ï¼Œå› ä¸ºä¸¤ä¸ªç«™ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥å¾—æ³¨å†Œä¸¤æ¬¡ã€‚&lt;/p&gt;
&lt;h2&gt;é…ç½® .pypirc æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;æ‰“å¼€ ~/.pypirc è¾“å…¥ä¸€ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[distutils]&lt;/span&gt;
&lt;span class="na"&gt;index-servers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&lt;/span&gt;
&lt;span class="s"&gt;  pypi&lt;/span&gt;
&lt;span class="s"&gt;  testpypi&lt;/span&gt;

&lt;span class="k"&gt;[pypi]&lt;/span&gt;
&lt;span class="na"&gt;username: ä½ çš„ç”¨æˆ·å&lt;/span&gt;
&lt;span class="na"&gt;password: å¯†ç &lt;/span&gt;

&lt;span class="k"&gt;[testpypi]&lt;/span&gt;
&lt;span class="na"&gt;repository:https://test.pypi.org/legacy/&lt;/span&gt;
&lt;span class="na"&gt;username: åŒä¸Š&lt;/span&gt;
&lt;span class="na"&gt;password: åŒä¸Š&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä¸Šä¼ åˆ° test.pypi.org&lt;/h2&gt;
&lt;p&gt;test.pypi.org æ˜¯ä¸“é—¨ç”¨æ¥åœ¨æ­£å¼ä¸Šä¼ å‰æµ‹è¯•çš„æœåŠ¡å™¨ï¼Œä»¥å…æ“ä½œå¤±è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰“åŒ…&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python setup.py sdist
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åå¯ä»¥çœ‹åˆ°å¤šå‡ºäº† dist/ ç›®å½•&lt;/p&gt;
&lt;p&gt;ä¸Šä¼ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install twine  # ç°åœ¨å®˜æ–¹æ¨èä½¿ç”¨twineå·¥å…·
twine upload dist/* --repository testpypi
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶ååˆ° test.pypi.org/projects/xxx å°±å¯ä»¥çœ‹åˆ°ä½ çš„ä»£ç äº†~&lt;/p&gt;
&lt;h2&gt;ä¸Šä¼ åˆ° pypi&lt;/h2&gt;
&lt;p&gt;ä¸€åˆ‡éªŒè¯æ— è¯¯ä¹‹åï¼Œå°±å¯ä»¥ä¸Šä¼ åˆ° PyPI äº†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;twine upload dist/*
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ›´å¤šç»†èŠ‚ä»‹ç»è¯·å‚è§å®˜æ–¹æ–‡æ¡£ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://packaging.python.org/tutorials/distributing-packages/&lt;/li&gt;
&lt;li&gt;https://packaging.python.org/guides/using-testpypi/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 19 May 2018 11:01:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-05-19:/posts/ru-he-fa-bu-python-dai-ma-dao-pypi-shang-2018.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Go è¯­è¨€åˆä½“éªŒ</title><link>/posts/go-yu-yan-chu-ti-yan.html</link><description>&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;å®‰è£… go å¾ˆç®€å•ï¼Œåœ¨ mac ä¸Šç›´æ¥ä½¿ç”¨ &lt;code&gt;brew install go&lt;/code&gt; å°±å¯ä»¥äº†ã€‚æ³¨æ„çš„æ˜¯éœ€è¦è®¾å®šGOPATHè¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œè¿™é‡Œè®¾å®šåˆ°äº† ~/.go è¿™ä¸ªç›®å½•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;export GOPATH=$HOME/.go
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;è¯­æ³•å’Œé£æ ¼&lt;/h1&gt;
&lt;p&gt;Golangçš„æ•´ä¸ªè¯­æ³•è¿˜æ˜¯æå…¶ç®€å•çš„ï¼ŒåŸºæœ¬æ˜¯ C å’Œ Python çš„æ··åˆä½“ã€‚Go è¯­è¨€è¯¦å°½åœ°è§„å®šäº†ä»£ç çš„é£æ ¼ï¼Œæ‰€ä»¥å°±ä¸ç”¨ä¸ºäº†å¤§æ‹¬å·ç©¶ç«Ÿæ˜¯æ”¾åœ¨å“ªå„¿è€Œå¼€å§‹åœ£æˆ˜äº†ã€‚Go è¯­è¨€å¯¹ç¨‹åºå‘˜çš„çº¦æŸå¾ˆå¼ºï¼Œä¸å®¹æ˜“çŠ¯é”™&lt;/p&gt;
&lt;p&gt;Go è¯­è¨€å®˜æ–¹æä¾›äº†ä¸€ä¸ªå·¥å…· goimports ç”¨æ¥ç®¡ç† import è¯­å¥ï¼Œè¿˜ä¸é”™ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚importè¿›æ¥çš„åŒ…å¿…é¡»ä½¿ç”¨ï¼Œå£°æ˜çš„å˜é‡ä¹Ÿå¿…é¡»ä½¿ç”¨ã€‚import è¯­å¥å¿…é¡»åœ¨ package è¯­å¥åé¢.è™½ç„¶æœ‰å¤§æ‹¬å·ï¼Œä½†æ˜¯å¤§æ‹¬å·çš„ä½ç½®ä¹Ÿæ˜¯æŒ‡å®šçš„ã€‚&lt;/p&gt;
&lt;h1&gt;ç±»å‹&lt;/h1&gt;
&lt;p&gt;å‡ ä¹æ‰€æœ‰çš„å€¼æä¾›äº†é»˜è®¤éƒ½ä¼šåˆå§‹åŒ–åˆ°å¯¹åº”çš„é›¶å€¼ï¼Œå³ä½¿æ²¡æœ‰åˆå§‹åŒ–ï¼Œä¸å°‘å‡½æ•°å¤„ç† nil çš„æ—¶å€™ä¹Ÿæ˜¯æŒ‰ç…§é›¶å€¼å¤„ç†ï¼Œè¿™æ ·é¿å…äº†å¥½å¤šæ— è°“çš„å¼‚å¸¸æŠ›å‡ºã€‚åœ¨goä¸­ä¹Ÿä¸ä¼šé‡åˆ°len(None)è¿™ç§é—®é¢˜ï¼Œå³ä½¿len(nil)ä¹Ÿä¼šè¿”å›0ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—ä¸€æçš„æ˜¯ Go ä¸­çš„å­—ç¬¦ä¸²ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ª byte çš„åªè¯»æ•°ç»„ï¼Œå¦‚æœä½¿ç”¨ç´¢å¼•è®¿é—®çš„è¯ï¼Œæ˜¯æŒ‰ç…§ byte ä¸ºå•ä½æ¥è®¿é—®çš„ã€‚ä½†æ˜¯åœ¨æ‰“å°å’Œ range çš„æ—¶å€™ä¼šç›´æ¥æŒ‰ç…§ utf-8 è§£ç è¾“å‡ºã€‚å¦‚æœéœ€è¦æŒ‰ç…§ runeï¼ˆGo è¯­è¨€å¯¹ unicode code point çš„ç§°å‘¼ï¼‰æ¥éå†ï¼Œéœ€è¦ä½¿ç”¨ &lt;code&gt;unicode/utf8&lt;/code&gt; è¿™ä¸ªåŒ…ä¸­çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å³ä½¿å­—ç¬¦ä¸²ä¸æ˜¯ utf-8çš„ï¼Œæˆ–è€…ä¸ç®¡æ€æ ·ç”¨é”™äº†ç¼–ç ï¼Œè‡³å°‘ä¸ä¼španicï¼Œè€Œpythonä¸­æ—¶ä¸æ—¶å°±ä¼šæŠ›å‡ºUnicodeDecodeError ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ç”¨æ€è€ƒè›‹ç–¼çš„ Unicode é—®é¢˜ï¼Œä¸è¿‡è™½ç„¶ Go çš„stringæ˜¯ utf-8 çš„ï¼Œä½†æ˜¯ä½¿ç”¨ä¸‹æ ‡è®¿é—®çš„æ˜¯å­—èŠ‚ï¼Œè€Œä½¿ç”¨ for range è®¿é—®çš„åˆæ˜¯ rune&lt;/p&gt;
&lt;h2&gt;å¤åˆç±»å‹&lt;/h2&gt;
&lt;p&gt;åƒæ˜¯ C è¯­è¨€ä¸€æ ·ï¼ŒGo ä¸­ä¹Ÿæœ‰å®šé•¿æ•°ç»„ï¼Œ&lt;code&gt;var a [3]int&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Go ä¸­ç»å¸¸ä½œä¸ºå˜é•¿æ•°ç»„ä½¿ç”¨çš„æ˜¯ Sliceã€‚Slice æŒ‡çš„æ˜¯ä¸€ä¸ªæ•°ç»„çš„ä¸€ä¸ªåˆ‡ç‰‡ã€‚åœ¨ Go è¯­è¨€ä¸­ï¼Œé»˜è®¤çš„å‡½æ•°è°ƒç”¨éƒ½æ˜¯å€¼ä¼ é€’çš„ï¼Œä½†æ˜¯ Slice åšå‚æ•°çš„æ—¶å€™ä¼ é€’çš„æ˜¯ä¸€ä¸ª Slice Headerï¼Œä¹Ÿå°±ç›¸å½“äºæŒ‰ç…§å¼•ç”¨ä¼ é€’ã€‚&lt;/p&gt;
&lt;p&gt;Map ç±»å‹æ˜¯å¼•ç”¨ç±»å‹ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°è°ƒç”¨çš„æ—¶å€™æ˜¯æŒ‰ç…§å¼•ç”¨ä¼ é€’çš„ã€‚nil map å¯ä»¥åƒç©ºmapä¸€æ ·ä½¿ç”¨ï¼Œä½†æ˜¯æ’å…¥çš„æ—¶å€™ä¼š panicï¼Œå› ä¸ºæ²¡æœ‰ç»™ä»–åˆ†é…å†…å­˜ï¼Œæ‰€ä»¥ map ç±»å‹ä¸€èˆ¬ä½¿ç”¨ make åˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;m := make(map[string]int)
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å¾ªç¯&lt;/h2&gt;
&lt;p&gt;go è¿˜ä» C ä¸­ ç»§æ‰¿äº† &lt;code&gt;if (p = fopen("xxx", "w")) != NULL&lt;/code&gt; è¿™ç§åœ¨æŠŠèµ‹å€¼è¯­å¥å†™åœ¨ifä¸­çš„å†™æ³•ï¼Œä¸è¿‡å¥½åœ¨ Go è¯­è¨€ä¸­å¯ä»¥å†™åšä¸¤å¥ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;if err := r.ParseForm(); err != nil {
      //...
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦å¤– switch è¯­å¥é»˜è®¤å°±ä¼š break äº†ï¼Œè€Œä¸æ˜¯ fall through äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¾ªç¯è¯­å¥å¾ˆæœ‰æ„æ€ï¼ŒGo è¯­è¨€ç›´æ¥æŠŠ while å…³é”®å­—æ‰”æ‰äº†ï¼Œåªç”¨ for æœ¬èº«å°±å¤Ÿäº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;for {
// ...
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å°±ç›¸å½“äºå…¶ä»–è¯­è¨€ä¸­çš„ while(true) äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ç®¡æ˜¯ Python ä¸­çš„ for...in... è¿˜æ˜¯ JavaScript ä¸­çš„ for...of... è¯­å¥ï¼Œè¿­ä»£æ•°ç»„å’Œå­—å…¸çš„æ—¶å€™å¤šå°‘æ„Ÿåˆ°ä¸€äº›ä¸ä¸€è‡´ã€‚åœ¨ Go è¯­è¨€ä¸­ï¼Œè¿˜æ˜¯æ¯”è¾ƒç»Ÿä¸€çš„ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šè¿”å›ä¸¤ä¸ªå€¼ï¼škeyï¼Œ valueã€‚&lt;/p&gt;
&lt;p&gt;è¿­ä»£ slice&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;words := []string{&amp;quot;a&amp;quot;, &amp;quot;b&amp;quot;}
for i, word := range words {
    fmt.Printf(&amp;quot;%d -&amp;gt; %s&amp;quot;, i, word)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿­ä»£ map&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;words := make(map[string]string)
words[&amp;quot;a&amp;quot;] = &amp;quot;a&amp;quot;
words[&amp;quot;b&amp;quot;] = &amp;quot;b&amp;quot;
for k, v := range words {
    fmt.Printf(&amp;quot;%s -&amp;gt; %s&amp;quot;, k, v)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;goroutine&lt;/h1&gt;
&lt;p&gt;goroutine ç›¸å¯¹äº Python çš„ coroutine çš„å¥½å¤„å°±åœ¨äºå®ƒæ˜¯æŠ¢å çš„ï¼Œä¸ç”¨ä¸»åŠ¨äº¤å‡ºã€‚&lt;/p&gt;
&lt;p&gt;Python çš„ coroutine éœ€è¦ç‰¹åˆ«å°å¿ƒä¸è¦è°ƒç”¨é˜»å¡æ€§çš„å‡½æ•°ï¼Œæ¯”å¦‚ time.sleepï¼Œè€Œè¦ä½¿ç”¨asyncio.sleepï¼Œæ‰€ä»¥å†™èµ·æ¥ä¸æ˜¯éå¸¸å¾—æ–¹ä¾¿ã€‚Pythonå¿…é¡»ä½¿ç”¨ await æ¥æ˜¾å¼äº¤å‡ºæ§åˆ¶ï¼Œè€Œ Go ä¸­åˆ™æ²¡æœ‰è¿™ç§é™åˆ¶ã€‚&lt;/p&gt;
&lt;h2&gt;Timers and tickers&lt;/h2&gt;
&lt;p&gt;Timers å®šä¹‰åœ¨ä½ åœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´æƒ³è¦å»åšä¸€æ¬¡æŸä»¶äº‹ã€‚è€Œ Tickers åˆ™æ˜¯å®šæœŸæ‰§è¡ŒæŸä¸€ä¸ªåŠ¨ä½œã€‚è¿™ä¸¤ä¸ªæœ‰ç‚¹åƒæ˜¯ js é‡Œé¢çš„ setTimeout å’Œ setInterval ä¸¤ä¸ªå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;defer å®é™…ä¸Šå°±ç›¸å½“äº C++ ä¸­çš„RAIIï¼Œå’ŒPythonä¸­çš„ with è¯­å¥&lt;/p&gt;
&lt;p&gt;Go çš„ç±»å‹æ€»ä½“æ¥è¯´ï¼Œå’Œ Python çš„ duck type æœ‰ç‚¹åƒï¼Œè€Œå’Œ Java ä¸¥æ ¼çš„ç»§æ‰¿åˆ™æ˜¯å®Œå…¨èƒŒé“è€Œé©°çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç”Ÿèµ‹å€¼æ—¶å€™ä¼šä¸ä¼šæ£€æŸ¥ç±»å‹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;interface{}&lt;/p&gt;
&lt;h1&gt;io&lt;/h1&gt;
&lt;p&gt;ä¸€èˆ¬è¯»å–ç»Ÿä¸€ä» io.Reader ç±»å‹ä¸­è¯»å–&lt;/p&gt;
&lt;p&gt;è®°å¾—ä¸€å®šè¦ä½¿ç”¨appendå‡½æ•°ï¼Œè€Œä¸è¦ç›´æ¥åœ¨sliceçš„ç»“å°¾é€šè¿‡ä¸‹æ ‡æ·»åŠ å­—ç¬¦ï¼Œè¿™æ ·å¯èƒ½ä¼španic&lt;/p&gt;
&lt;p&gt;å‡½æ•°åº”è¯¥æ¥å— interface ä½œä¸ºå‚æ•°ï¼Œå¹¶ä½¿ç”¨ struct ä½œä¸ºè¿”å›å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰ä¸ºæ­¢æœ‰å‡ ä¸ªä¸çˆ½çš„åœ°æ–¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;nil å­—å…¸ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼Œä½†æ˜¯ nil slice å¯ä»¥ append&lt;/li&gt;
&lt;li&gt;interface çš„ nil å§‹ç»ˆæ²¡æœ‰ææ˜ç™½ã€‚empty slice(a[0:0]) å’Œ nil ä¹Ÿä¸ä¸€æ ·&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„åŒ…ç®¡ç†å·¥å…·ï¼ŒåˆšåˆšèŠ±ä¸€ä¸‹åˆæ—¶é—´å­¦ä¹ äº† depï¼Œå·ç§°æ˜¯å®˜æ–¹çš„è¯•éªŒï¼Œç»“æœåˆçœ‹åˆ°ä¸€ç¯‡æ–‡ç« è¯´ vgo è¦å–ä»£ depï¼ŒWTF&lt;/li&gt;
&lt;li&gt;defer æ‰§è¡Œçš„åœ°æ–¹æ˜¯å‡½æ•°çš„ç»“å°¾ï¼Œè€Œä¸æ˜¯å—çš„ç»“å°¾&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/18058164/is-a-go-goroutine-a-coroutine&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 02 May 2018 02:54:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-05-02:/posts/go-yu-yan-chu-ti-yan.html</guid><category>golang</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python urllib æ¨¡å—</title><link>/posts/python-urllib-mo-kuai.html</link><description>&lt;p&gt;YNï¼šç½‘ç»œè®¿é—®çš„æ—¶å€™ä¸€å®šè¦è®°å¾—è®¾ç½®ä¸€ä¸ªåˆç†çš„è¶…æ—¶&lt;/p&gt;
&lt;p&gt;åœ¨ Python2 ä¸­ï¼Œæœ‰ä¸¤ä¸ªurllibï¼šurllib å’Œ urllib2ï¼ŒurllibåŸºæœ¬åªä½¿ç”¨urllib.urlencode(), urllib.quoteå‡½æ•°ï¼Œå…¶ä»–åŠŸèƒ½éƒ½è¢«å¯¹åº”çš„ urllib2ä¸­çš„å‡½æ•°æ›¿ä»£äº†ã€‚&lt;/p&gt;
&lt;p&gt;Python3 æŠŠè¿™ä¸¤ä¸ªæ¨¡å—è¿›è¡Œäº†åˆå¹¶å¹¶æ‹†åˆ†æˆäº†å­æ¨¡å—ï¼Œåªä½¿ç”¨ urllib å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;h1&gt;å‘é€ http è¯·æ±‚&lt;/h1&gt;
&lt;h2&gt;ç›´æ¥ä½¿ç”¨ urlopen&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;urllib.request.urlopen(url,Â data=None,Â [timeout,Â ] *, context) -&amp;gt; http.client.HTTPResponse
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç”¨äºå‘é€ GET æˆ–è€… POST è¯·æ±‚ï¼Œå¦‚æœæœ‰dataï¼Œåˆ™å‘é€çš„æ˜¯ POST è¯·æ±‚.è¿”å›ä¸€ä¸ª file-likeçš„http.client.HTTPResponseå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ª context managerã€‚&lt;/p&gt;
&lt;p&gt;info() | è¿”å›headers
gerurl() | è¿”å› urlï¼Œå¸¸ç”¨äºåˆ¤å®šæ˜¯å¦è¢«é‡å®šå‘
getcode() | 
read()/readlines() | è¿”å›æ–‡ä»¶å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib.request&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://www.python.org/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;!DOCTYPE html PUBLIC &amp;quot;-//W3C//DTD XHTML 1.0 Transitional//EN&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;&amp;quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;\&lt;span class="n"&gt;n&lt;/span&gt;\&lt;span class="n"&gt;n&lt;/span&gt;\&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;
&lt;span class="n"&gt;xmlns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.w3.org/1999/xhtml&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;xml&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;\&lt;span class="n"&gt;n&lt;/span&gt;\&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;\&lt;span class="n"&gt;n&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;meta&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;\&lt;span class="n"&gt;n&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Python&lt;/span&gt; &lt;span class="n"&gt;Programming&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä½¿ç”¨ Request å¯¹è±¡&lt;/h2&gt;
&lt;p&gt;å¦‚æœéœ€è¦æ›´æ”¹é»˜è®¤çš„ header ç­‰æ•°æ®æˆ–è€…ä½¿ç”¨ PUTã€DELETE ç­‰æ–¹æ³•ï¼Œurlopen è¿˜å¯ä»¥æ¥å—ä¸€ä¸ª Requestå¯¹è±¡ï¼Œå¯ä»¥åœ¨ Request å¯¹è±¡ä¸­æ›´æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;Request å¯¹è±¡çš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt;Â &lt;span class="nx"&gt;urllib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;Â &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;Â &lt;span class="nx"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{},&lt;/span&gt;Â &lt;span class="nx"&gt;origin_req_host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;Â &lt;span class="nx"&gt;unverifiable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;Â &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸€ä¸ª requestå¯ä»¥æŒ‡å®š methodï¼Œ urlï¼Œå¯ä»¥ä½¿ç”¨ req.add_headeræ·»åŠ headerã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ add_header æ–¹æ³•å†æ·»åŠ é¢å¤–çš„headerï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ set_headerï¼Œå¹¶ä¸èƒ½æ·»åŠ é‡å¤çš„ï¼Œä¸è¦è¢«åå­—è¿·æƒ‘äº†ã€‚&lt;/p&gt;
&lt;h2&gt;ä½¿ç”¨ Opener&lt;/h2&gt;
&lt;p&gt;urilib2.build_opener è¿”å›ä¸€ä¸ªæ‰“å¼€å™¨(OpenerDirector)ï¼Œç”¨äºè®¾å®šå‘å‡ºè¯·æ±‚è¦ç»è¿‡çš„ä¸€äº›å¤„ç†ï¼Œå¯ä»¥è®¾å®šä»£ç†ï¼Œå¤„ç† cookie ç­‰ã€‚OpenerDirectoræœ‰ä¸€ä¸ªå±æ€§addheadersï¼ŒæŠŠä»–è®¾å®šä¸ºä¸€ä¸ªåŒ…å«é”®å€¼ tuple çš„ listï¼Œè¿™æ ·ä½¿ç”¨ opener å‘é€çš„æ¯ä¸€ä¸ªè¯·æ±‚éƒ½ä¼šæ·»åŠ ä¸Šè¿™ä¸ª headerã€‚&lt;/p&gt;
&lt;p&gt;Then you could use opener.open instead of urllib2.urlopen&lt;/p&gt;
&lt;p&gt;Typical usage:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib2&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;cookielib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;CookieJar&lt;/span&gt;
&lt;span class="n"&gt;cj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CookieJar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;opener&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;build_opener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTTPCookieProcessor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cj&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="c1"&gt;# input-type values from the html form&lt;/span&gt;
&lt;span class="n"&gt;formdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;username&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;password&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;form-id&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1234&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;data_encoded&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlencode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;formdata&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;opener&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https://page.com/login.php&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data_encoded&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib.request&lt;/span&gt;
&lt;span class="n"&gt;opener&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;build_opener&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;opener&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addheaders&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;User-agent&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Mozilla/5.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;opener&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://www.example.com/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;From &lt;a href="http://stackoverflow.com/questions/3334809/python-urllib2-how-to-send-cookie-with-urlopen-request"&gt;http://stackoverflow.com/questions/3334809/python-urllib2-how-to-send-cookie-with-urlopen-request&lt;/a&gt; &lt;/p&gt;
&lt;h1&gt;å¼‚å¸¸ï¼šURLError HTTPError&lt;/h1&gt;
&lt;p&gt;URLErroræ˜¯ IOError çš„å­ç±», HTTPError.code is the http code &lt;/p&gt;
&lt;h1&gt;urllib.parse&lt;/h1&gt;
&lt;p&gt;urlparse and urlunparse is not as good as urlsplit&lt;/p&gt;
&lt;h2&gt;urlsplit&lt;/h2&gt;
&lt;p&gt;return a five element tuple by scheme://netloc/path?query#fragment&lt;/p&gt;
&lt;p&gt;Attribute   Index   Value   Value if not present
scheme  0   URL scheme specifier    schemeÂ parameter
netloc  1   Network location part   empty string
path    2   Hierarchical path   empty string
query   3   Query component empty string
fragment    4   Fragment identifier empty string
username    Â    User name   None
password    Â    Password    None
hostname    Â    Host name (lower case)  None
port    Â    Port number as integer, if present  None&lt;/p&gt;
&lt;p&gt;noteï¼Œthe netloc contains domain and port&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; urlsplit(&amp;#39;www.cwi.nl/%7Eguido/Python.html&amp;#39;)
SplitResult(scheme=&amp;#39;&amp;#39;, netloc=&amp;#39;&amp;#39;, path=&amp;#39;www.cwi.nl/%7Eguido/Python.html&amp;#39;, query=&amp;#39;&amp;#39;, fragment=&amp;#39;&amp;#39;)
# notice the netloc will be wrong if &amp;quot;//&amp;quot; is missing
&amp;gt;&amp;gt;&amp;gt; urlsplit(&amp;#39;//www.cwi.nl/%7Eguido/Python.html&amp;#39;)
SplitResult(scheme=&amp;#39;&amp;#39;, netloc=&amp;#39;www.cwi.nl&amp;#39;, path=&amp;#39;/%7Eguido/Python.html&amp;#39;, query=&amp;#39;&amp;#39;, fragment=&amp;#39;&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;urlunsplit join the parse resultã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;parse_qs(qs, keep_blank_values=False, encoding=&amp;#39;utf-8&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;parse a query string to { key: [values] } pair, note without '?'&lt;/p&gt;
&lt;p&gt;parse_qsl&lt;/p&gt;
&lt;p&gt;return a list of k,v tuple&lt;/p&gt;
&lt;p&gt;quote/quote_plus&lt;/p&gt;
&lt;p&gt;unquote&lt;/p&gt;
&lt;p&gt;urlencode&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 01 May 2018 14:36:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-05-01:/posts/python-urllib-mo-kuai.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­çš„ iterator å’Œ generator</title><link>/posts/python-zhong-de-iterator-he-generator.html</link><description>&lt;p&gt;è¿™ç¯‡æ–‡ç« é‡Œé¢æœ‰ä¸å°‘æ¦‚å¿µéƒ½æ˜¯é”™çš„ï¼Œéœ€è¦æ”¹è¿›&lt;/p&gt;
&lt;h1&gt;è¿­ä»£å™¨&lt;/h1&gt;
&lt;p&gt;In Python, iterable and iterator have specific meanings.&lt;/p&gt;
&lt;p&gt;An iterable is an object that has an &lt;strong&gt;iter&lt;/strong&gt; method which returns an iterator, or which defines a &lt;strong&gt;getitem&lt;/strong&gt; method that can take sequential indexes starting from 0 (and raises an IndexError when the indexes are no longer valid). So an iterable is an object that you can get an iterator from.&lt;/p&gt;
&lt;p&gt;calling iter(iterable) will return a iterator&lt;/p&gt;
&lt;p&gt;An iterator is an object with a next (Python 2) or &lt;strong&gt;next&lt;/strong&gt; (Python 3) method. 
Whenever you use a for loop, or map, or a list comprehension, etc. in Python, the next method is called automatically to get each item from the iterator, thus going through the process of iteration.&lt;/p&gt;
&lt;h1&gt;Generators&lt;/h1&gt;
&lt;p&gt;Generators are iterators, but you can only iterate over them once. It's because they do not store all the values in memory, they generate the values on the fly. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def generator_function():
    for i in [0, 1, 2]:
        yield i * 2
for item in generator_function():
    print(item)
# Output: 0
# 2
# 4
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;as you can see, generators are typically a filter or mapper between sequences&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def fib(n):
    a = b = 1
    for i in range(n):
        yield a
        a, b = b, a + b
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;From &lt;a href="http://book.pythontips.com/en/latest/generators.html"&gt;http://book.pythontips.com/en/latest/generators.html&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;è¿­ä»£å™¨åè®®&lt;/h1&gt;
&lt;p&gt;with open('file') as f:
    try:
        while True:
            value = next(f)
            print value
    except StopIteration:        pass&lt;/p&gt;
&lt;p&gt;The word â€œgeneratorâ€ is confusingly used to mean both the function that generates and what it generates. In this chapter, Iâ€™ll use the word â€œgeneratorâ€ to mean the genearted object and â€œgenerator functionâ€ to mean the function that generates it.&lt;/p&gt;
&lt;p&gt;Can you think about how it is working internally?&lt;/p&gt;
&lt;p&gt;When a generator function is called, it returns a generator object without even beginning execution of the function. WhenÂ nextÂ method is called for the first time, the function starts executing until it reachesÂ yieldÂ statement. The yielded value is returned by theÂ nextÂ call.
The following example demonstrates the interplay betweenÂ yieldÂ and call toÂ nextÂ method on generator object.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 01 May 2018 06:19:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-05-01:/posts/python-zhong-de-iterator-he-generator.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>django forms</title><link>/posts/django-forms.html</link><description>&lt;p&gt;django ä¸­çš„ form å’Œ model çš„ç”¨æ³•å¾ˆåƒï¼Œéƒ½æ˜¯å®šä¹‰ä¸€ä¸ªç±»ï¼Œç„¶åæŒ‡å®šä¸€äº›å­—æ®µå°±å¯ä»¥äº†&lt;/p&gt;
&lt;p&gt;æœ€ç®€å•çš„form&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ContactForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;subject&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;email&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EmailField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Textarea&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clean_message&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;num_words&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;num_words&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ValidationError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Not enough words!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def contact(request):
    if request.method == &amp;#39;POST&amp;#39;:
        form = ContactForm(request.POST)
        if form.is_valid():
            cd = form.cleaned_data
            send_mail(
                cd[&amp;#39;subject&amp;#39;],
                cd[&amp;#39;message&amp;#39;],
                cd.get(&amp;#39;email&amp;#39;, &amp;#39;noreply@example.com&amp;#39;),
                [&amp;#39;siteowner@example.com&amp;#39;],
            )
            return HttpResponseRedirect(&amp;#39;/contact/thanks/&amp;#39;)
    else:
        form = ContactForm()
        return render(request, &amp;#39;contact_form.html&amp;#39;, {&amp;#39;form&amp;#39;: form})
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;form&lt;/span&gt; &lt;span class="na"&gt;action=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;method=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;post&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;table&amp;gt;&lt;/span&gt;
        &lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;form.as_table&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/table&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;csrf_token&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;input&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;submit&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Submit&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/form&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ–¹æ³•&lt;/th&gt;
&lt;th&gt;ç”¨æ³•&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;form.&lt;strong&gt;str&lt;/strong&gt;()&lt;/td&gt;
&lt;td&gt;return table representation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;form.as_p()&lt;/td&gt;
&lt;td&gt;return p representation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;form.as_li()&lt;/td&gt;
&lt;td&gt;return li representation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;form.&lt;strong&gt;getitem&lt;/strong&gt;()&lt;/td&gt;
&lt;td&gt;return element tag&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;form.&lt;strong&gt;init&lt;/strong&gt;(dict)&lt;/td&gt;
&lt;td&gt;fill values&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;form.is_bound&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;form.is_valid()&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;form.cleaned_data&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Note not include table/ul/form tags, just the inside tags&lt;/p&gt;
&lt;h1&gt;ajax&lt;/h1&gt;
&lt;h2&gt;ajax ä¸­å¦‚ä½•æŒ‡å®š crsf token&lt;/h2&gt;
&lt;p&gt;axios ä¸­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;axios&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;axios&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;axios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;defaults&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xsrfHeaderName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;X-CSRFTOKEN&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;axios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;defaults&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xsrfCookieName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;csrftoken&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;settings.py ä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CSRF_COOKIE_NAME = &amp;quot;csrftoken&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;a href="https://stackoverflow.com/questions/39254562/csrf-with-django-reactredux-using-axios"&gt;å‚è€ƒ&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 01 May 2018 04:52:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-05-01:/posts/django-forms.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Python time æ¨¡å—</title><link>/posts/python-time-mo-kuai.html</link><description>&lt;p&gt;æ—¶é—´æˆ³ï¼Œstruct_time å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªè¡¨ç¤ºæ—¶é—´çš„æ•´æ•°åºåˆ—ï¼Œä¸€å…±9é¡¹å¯¹åº”äº C ä¸­å¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œæ³¨æ„å…¶ä¸­ä¸åŒ…å«æ—¶åŒºä¿¡æ¯&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‡½æ•°&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;time.time&lt;/td&gt;
&lt;td&gt;è·å–å½“å‰æ—¶é—´æˆ³ï¼Œå³ GMT çš„ epoch ç§’æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;time.clock()&lt;/td&gt;
&lt;td&gt;è·å–è¿›ç¨‹æ—¶é—´ï¼Œå³ä»è¿›ç¨‹å¼€å§‹æ‰§è¡Œçš„æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;time.sleep()&lt;/td&gt;
&lt;td&gt;åœæ­¢å½“å‰çº¿ç¨‹è‹¥å¹²ç§’&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;time.strftime&lt;/td&gt;
&lt;td&gt;äº§ç”Ÿå¯è¯»æ—¶é—´å­—ç¬¦ä¸²&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;time.strptime&lt;/td&gt;
&lt;td&gt;parse time&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;time.strftime()/time.mktime()/time.asctime()&lt;/td&gt;
&lt;td&gt;å‡æ¥å— struct_time ä½œä¸ºå‚æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;time.gmtime()/time.localtime()/time.strptime()&lt;/td&gt;
&lt;td&gt;è¿”å›çš„æ˜¯å¯¹åº”æ—¶é—´çš„struct_time&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;time.time vs time.clock&lt;/h1&gt;
&lt;p&gt;time.clock measures the cpu time spent, if you code does heavy IO or GPU computing, the result is WRONGï¼Œ time.time is not precise but works all the time~&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 30 Apr 2018 14:40:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-30:/posts/python-time-mo-kuai.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>å¾®ä¿¡å¼€å‘ç¬”è®°</title><link>/posts/wei-xin-kai-fa-bi-ji.html</link><description>&lt;p&gt;å¯ä»¥ä½¿ç”¨å¾®ä¿¡çš„æµ‹è¯•å·å­¦ä¹ å¦‚ä½•å¼€å‘
http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login&lt;/p&gt;
&lt;p&gt;å…¬ä¼—å·å¯¹äºæ¶ˆæ¯çš„å¤„ç†ç›¸å½“äºä½¿ç”¨äº†å¾®ä¿¡çš„æœåŠ¡å™¨åšè½¬å‘ä»£ç†, å‘é€åˆ°å…¬ä¼—å·çš„åç«¯æœåŠ¡å™¨, è€Œä¸€æ—¦è¿›å…¥ç½‘é¡µå°±ç›¸å½“äºç›´æ¥åŒæœåŠ¡å™¨é€šä¿¡äº†.  å¾®ä¿¡ä¼šä½¿ç”¨ POST å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¶ˆæ¯çš„å¤„ç†æœ‰ä¸€ä¸ªç­¾åçš„è¿‡ç¨‹, è¿™æ ·åç«¯æœåŠ¡å™¨å¯ä»¥åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦æ¥è‡ªå¾®ä¿¡, ä»è€Œé˜²æ­¢ API è¢«æ¶æ„æ»¥ç”¨ç›—ç”¨.&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¿™äº›ç¹æ‚çš„äº‹æƒ…ä¸å¦‚äº¤ä¸ªæ¡†æ¶å»å¤„ç†&lt;/p&gt;
&lt;p&gt;APPID/APPSECRET ç›¸å½“äºå…¬ä¼—å·çš„è´¦å·å’Œå¯†ç , é€šè¿‡è¿™ä¸¤ä¸ªç»„åˆè·å–ä¸€ä¸ª access_token ç”¨äºå¹³æ—¶è®¿é—®, access_token æ˜¯æœ‰æœ‰æ•ˆæœŸçš„, å³ä½¿æ˜æ–‡ä¼ é€è¢«æ³„éœ²äº†ä¹Ÿé—®é¢˜ä¸å¤§&lt;/p&gt;
&lt;p&gt;é—®é¢˜æ˜¯, æœåŠ¡å™¨éœ€è¦è®°å¾—å»åˆ·æ–°è¿™ä¸ª token, æ‰€ä»¥è¿™äº›ä¸œè¥¿åº”è¯¥äº¤ç»™æ¡†æ¶æœ€å¥½äº†&lt;/p&gt;
&lt;p&gt;å¾®ä¿¡å¼€æ”¾äº† JS SDK å¯ä»¥ä½¿ç”¨å›¾ç‰‡è¯­éŸ³åœ°å›¾ç­‰ä¸€ç³»åˆ—çš„åº”ç”¨, ä¸é”™&lt;/p&gt;
&lt;p&gt;å¸¸ç”¨çš„ä¸€äº› meta æ ‡ç­¾&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;metaÂ content=â€width=device-width,Â initial-scale=1.0,Â maximum-scale=1.0,Â user-scalable=0;â€Â name=â€viewportâ€Â /&gt;Â &lt;/li&gt;
&lt;li&gt;&lt;metaÂ content=â€yesâ€Â name=â€apple-mobile-web-app-capableâ€Â /&gt;Â  &lt;!--å…è®¸å…¨å±æ¨¡å¼æµè§ˆ--&gt;&lt;/li&gt;
&lt;li&gt;&lt;metaÂ content=â€blackâ€Â name=â€apple-mobile-web-app-status-bar-styleâ€Â /&gt;Â  &lt;!--æ»šåŠ¨æ¡æ ·å¼--&gt;&lt;/li&gt;
&lt;li&gt;&lt;metaÂ content=â€telephone=noâ€Â name=â€format-detectionâ€Â /&gt;Â  &lt;!--ç¦æ­¢è¯†åˆ«ç”µè¯å·ç --&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;iOSä¸­æµè§ˆå™¨ç›´æ¥è®¿é—®ç«™ç‚¹æ—¶ï¼Œnavigator.standaloneä¸ºfalse,ä» ä¸»å±å¯åŠ¨webappÂ æ—¶ï¼Œnavigator.standaloneä¸ºtrue
ç§»åŠ¨ç‰ˆæœ¬webkit ä¸ºÂ inputå…ƒç´ æä¾›äº†autocapitalizeå±æ€§ï¼Œé€šè¿‡æŒ‡å®šautocapitalize=â€offâ€æ¥å…³é—­é”®ç›˜é»˜è®¤é¦–å­—æ¯å¤§å†™
å¼€å‘è€…æŒ‡å®š çš„Â targetå±æ€§å°±å¤±æ•ˆäº†ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡æŒ‡å®šå½“å‰å…ƒç´ çš„-webkit-touch-calloutæ ·å¼å±æ€§ä¸ºnoneæ¥ç¦æ­¢iOSå¼¹å‡ºè¿™äº›æŒ‰é’®&lt;/p&gt;
&lt;p&gt;åŒæ ·ä¸ºä¸€ä¸ªimgæ ‡ç­¾æŒ‡å®š-webkit-touch-calloutä¸ºnoneä¹Ÿä¼šç¦æ­¢è®¾å¤‡å¼¹å‡ºåˆ—è¡¨æŒ‰é’®ï¼Œè¿™æ ·ç”¨æˆ·å°±æ— æ³•ä¿å­˜ï¼¼å¤åˆ¶ä½ çš„å›¾ç‰‡äº†
æŒ‡å®šæ–‡å­—æ ‡ç­¾çš„-webkit-user-selectå±æ€§ä¸ºnoneä¾¿å¯ä»¥ç¦æ­¢iOSç”¨æˆ·é€‰ä¸­æ–‡å­—&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 30 Apr 2018 10:05:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-30:/posts/wei-xin-kai-fa-bi-ji.html</guid><category>åˆ›ä¸š</category><category>æœºå™¨äººæ¨å¹¿</category><category>è¿è¥ä¸äº§å“</category></item><item><title>django dump to csv</title><link>/posts/django-dump-to-csv.html</link><description>&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;csv&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db.models.loading&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_model&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfile_path&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Takes in a Django queryset and spits out a CSV file.&lt;/span&gt;

&lt;span class="sd"&gt;    Usage::&lt;/span&gt;

&lt;span class="sd"&gt;        &amp;gt;&amp;gt; from utils import dump2csv&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;gt;&amp;gt; from dummy_app.models import *&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;gt;&amp;gt; qs = DummyModel.objects.all()&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;gt;&amp;gt; dump2csv.dump(qs, &amp;#39;./data/dump.csv&amp;#39;)&lt;/span&gt;

&lt;span class="sd"&gt;    Based on a snippet by zbyte64::&lt;/span&gt;

&lt;span class="sd"&gt;        http://www.djangosnippets.org/snippets/790/&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;
    &lt;span class="n"&gt;writer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;csv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outfile_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_meta&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writerow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;getattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;callable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;unicode&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writerow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 30 Apr 2018 09:59:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-30:/posts/django-dump-to-csv.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>CSS å¸ƒå±€åŸºç¡€çŸ¥è¯†</title><link>/posts/css-bu-ju-ji-chu-zhi-shi.html</link><description>&lt;h1&gt;å¸ƒå±€&lt;/h1&gt;
&lt;p&gt;ç½‘é¡µçš„å¸ƒå±€æ˜¯é¢å‘æ–‡æ¡£æµçš„ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå…ƒç´ é»˜è®¤éƒ½æ˜¯ä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ’åˆ—çš„ã€‚å½“ç„¶å°±åƒæ–‡ç« ä¸€æ ·ï¼Œæœ‰äº›å…ƒç´ æ¯”å¦‚æ ‡é¢˜é»˜è®¤å°±ä¼šå¦èµ·ä¸€è¡Œï¼Œå¹¶ä¸”å•ç‹¬å æ®è¿™ä¸€è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰çš„å…ƒç´ éƒ½åˆ†ä¸ºä¸‰ç±»ï¼šinlineã€inline-blockã€å’Œ blockã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ block å…ƒç´ å æ®äº†ä¸€è¡Œçš„ä½ç½®ï¼Œå³ä½¿ä»–ä»¬çš„å®½åº¦ä¸å¤Ÿä¸€è¡Œï¼Œå¹¶ä¸”ä»–ä»¬æœ‰è‡ªå·±çš„å®½åº¦å’Œé«˜åº¦ï¼Œæ¯”å¦‚ h1 å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;inline-block ç»“åˆäº† inline å’Œ block å…ƒç´ çš„ç‰¹æ€§ï¼Œé¦–å…ˆä»–å¸ƒå±€æ˜¯ inline çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šå¦èµ·ä¸€è¡Œï¼Œä½†æ˜¯åˆå¯ä»¥è®¾å®šå•ç‹¬çš„é«˜åº¦å’Œå®½åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;display: none&lt;/code&gt; å°†ä¼šå®Œå…¨ä¸æ¸²æŸ“è¯¥å…ƒç´ , &lt;code&gt;visibility: hidden&lt;/code&gt; ä¼šæ¸²æŸ“è¿™ä¸ªå…ƒç´ ï¼Œåªæ˜¯åœ¨è¯¥æ˜¾å¼çš„åœ°æ–¹ç•™ä¸‹ç©ºç™½&lt;/p&gt;
&lt;h2&gt;ä½¿ç”¨ inline-box çš„å¸ƒå±€&lt;/h2&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tKfTcly1fquqqp791hj30kr0i1gpe.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;å®šä½&lt;/h1&gt;
&lt;p&gt;CSS ä¸­å…ƒç´ çš„å®šä½æœ‰å¦‚ä¸‹å‡ ç§ï¼Œå¯ä»¥ä½¿ç”¨ position æŒ‡å®š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ–¹æ³•&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;static&lt;/td&gt;
&lt;td&gt;é»˜è®¤çš„å®šä½æ–¹æ³•ï¼ŒæŒ‡çš„æ˜¯åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®æ˜¯é™æ€çš„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;relative&lt;/td&gt;
&lt;td&gt;relative to its static positions, if set(top, left, bottom, right)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;fixed&lt;/td&gt;
&lt;td&gt;fixed to the viewport, if set(top, left, bottom, right)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;absolute&lt;/td&gt;
&lt;td&gt;behaves like fixed, but relative to nearest non-static ancestor&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;float&lt;/td&gt;
&lt;td&gt;floated element will become a block element, but it will not occupy one row&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä½¿ç”¨ float çš„å¸ƒå±€&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tKfTcly1fsktnrsi5dj30kc0hp781.jpg"&gt;&lt;/p&gt;
&lt;h3&gt;åç»­å…ƒç´ æ²¡æœ‰å æ®æŒ‡å®šç©ºé—´&lt;/h3&gt;
&lt;p&gt;å…ƒç´ æµ®åŠ¨ä¹‹åï¼Œå®ƒåé¢çš„å…ƒç´ å°±ä¼šå»å æ®å®ƒçš„ä½ç½®ï¼Œç„¶è€Œæˆ‘ä»¬å¾€å¾€å¹¶ä¸æƒ³å½±å“åˆ°åé¢çš„å…ƒç´ ï¼Œæ‰€ä»¥åº”è¯¥æŒ‡å®šå®ƒåé¢çš„å…ƒç´ æ¸…é™¤æµ®åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;not stretching parent element
floating elements will also not stretching the element containing it, to fix that, add overflow: auto to the parent element&lt;/p&gt;
&lt;h1&gt;ç›’æ¨¡å‹&lt;/h1&gt;
&lt;h2&gt;è®¨åŒçš„ content-box æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;width set width of the content, and &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;padding will push out the border... &lt;/li&gt;
&lt;li&gt;background-color only set for content area&lt;/li&gt;
&lt;li&gt;entire width is for border&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tKfTcly1fqurrspk7ej30ah09gq39.jpg"&gt;&lt;/p&gt;
&lt;h2&gt;ç¬¦åˆç›´è§‰çš„ border-box æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;as shown by the picture, border-box width sets the entire width, contains border + padding + content&lt;/p&gt;
&lt;p&gt;å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œborder-box æ¨¡å‹è®¾å®šçš„å¿«è¯»åŒ…å«äº† &lt;strong&gt;border + padding + content&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tKfTcly1fqurs7z1chj30ge094wgg.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;responsive design&lt;/h1&gt;
&lt;p&gt;query device width&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;@media screen and (mid/max-width: xxxpx)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;set viewport&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;width=device-width/320, initial-scale=0.5, maximum-scale=1, minimum-scale=3, user-scalable=no&amp;quot; /&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;è®°å½• CSS çš„ä¸€ä¸ªå‘&lt;/h1&gt;
&lt;h2&gt;åœ¨ td å…ƒç´ ä¸Šæ— æ³•ä½¿ç”¨ width&lt;/h2&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡æŒ‡å®šï¼š table-layout: fixed è§£å†³&lt;/p&gt;
&lt;h2&gt;centering&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;margin&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;css columns&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;column-count&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;x&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="nt"&gt;column-gap&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;xpx&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;é€šè¿‡ js è·å¾—æœ€ç»ˆ CSS å±æ€§&lt;/h2&gt;
&lt;p&gt;https://developer.mozilla.org/zh-CN/docs/Web/API/Window/getComputedStyle&lt;/p&gt;
&lt;h1&gt;reference&lt;/h1&gt;
&lt;p&gt;[1] http://learnlayout.com&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 30 Apr 2018 07:56:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-30:/posts/css-bu-ju-ji-chu-zhi-shi.html</guid><category>CSS</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Python coroutine ä»¥åŠå’Œ Goroutine çš„å¯¹æ¯”</title><link>/posts/python-coroutine-yi-ji-he-goroutine-de-dui-bi.html</link><description>&lt;h1&gt;Python ä¸­çš„ coroutine&lt;/h1&gt;
&lt;p&gt;Python 3.5 ä¸­ç»ˆäºå¼•å…¥äº† &lt;code&gt;async&lt;/code&gt; å’Œ &lt;code&gt;await&lt;/code&gt; å…³é”®å­—ï¼Œç®—æ˜¯åœ¨è¯­è¨€å±‚æ¬¡ä¸Šæ”¯æŒäº† coroutineã€‚&lt;/p&gt;
&lt;h2&gt;coroutine åŸºç¡€&lt;/h2&gt;
&lt;p&gt;coroutine åˆè¢«ç§°ä¸ºç”¨æˆ·çº§çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨ä¸€ä¸ªç³»ç»Ÿçº¿ç¨‹ä¸­æ¨¡æ‹Ÿå¤šä¸ªçº¿ç¨‹æ„æˆçš„å¹¶å‘æ“ä½œï¼Œå¯¹äºæœ‰ GIL çš„ Python æ¥è¯´ï¼Œåæ­£çº¿ç¨‹ä¹Ÿæ˜¯è´¹äº†ï¼Œä¸å¤±ä¸ºå¤šäº†ä¸€ç§é€‰æ‹©ï¼Œä½¿ç”¨ asyncio æ¥çˆ¬å–ç½‘é¡µå¯ä»¥è¿™æ ·å†™ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œ&lt;code&gt;pip install pulsar lxml&lt;/code&gt;ã€‚pulsar æ˜¯ä¸€ä¸ªå¼‚æ­¥ç‰ˆçš„ http åº“ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pulsar.apps&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;

&lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://toutiao.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„å…¶ä¸­æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;async def&lt;/code&gt; å®šä¹‰äº†ä¸€ä¸ª &lt;code&gt;coroutine function&lt;/code&gt;ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­è°ƒç”¨ï¼ˆawaitï¼‰äº†å¦ä¸€ä¸ª coroutine functionã€‚åœ¨ Python ä¸­åªæœ‰åœ¨ä½¿ç”¨ async def å®šä¹‰çš„å‡½æ•°ä¸Šä¸‹æ–‡ä¸­æ‰èƒ½ä½¿ç”¨ awaitã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬éœ€è¦ä¸‹è½½å¤šä¸ªç½‘å€å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;coroutine å¹¶å‘&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;lxml.html&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pulsar.apps&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;


&lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HttpClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;doc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lxml&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xpath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;//title/text()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://www.toutiao.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://www.douban.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://www.sina.com.cn&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;futures&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;future&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ensure_future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gather&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pages&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ for å¾ªç¯ä½¿ç”¨ &lt;code&gt;asyncio.ensure_future&lt;/code&gt; åˆ›å»ºäº†ä¸‰ä¸ª Future å¯¹è±¡ã€‚Future å¯¹è±¡æŒ‡çš„æ˜¯å¯ä»¥åœ¨æœªæ¥ï¼ˆfutureï¼‰çš„æŸä¸ªæ—¶é—´è·å¾—ç»“æœçš„ä¸€ä¸ªå¯¹è±¡ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;asyncio.gather&lt;/code&gt; æ¥åŒæ—¶ &lt;code&gt;await&lt;/code&gt; äº†è¿™ä¸‰ä¸ª Futureã€‚åœ¨æˆ‘ä»¬ await çš„æ—¶å€™ï¼Œå¯ä»¥è®¤ä¸ºè¿™ä¸‰ä¸ª future æ˜¯"å¹¶å‘"æ‰§è¡Œçš„ã€‚å¦‚æœä½ äº†è§£ JavaScript çš„è¯ï¼Œå¯ä»¥çœ‹å‡ºæ¥ Future å°±ç›¸å½“äº JS ä¸­çš„ Promise å¯¹è±¡ã€‚æ³¨æ„è¿™é‡Œçš„å¹¶å‘æŒ‡çš„æ˜¯ IO ä¸Šå¯ä»¥å¹¶å‘åŠ é€Ÿï¼Œå¦‚æœä» CPU ä¸Šè€ƒè™‘çš„è¯ï¼Œå› ä¸ºéƒ½æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œä¹Ÿå°±æ²¡æœ‰æ€§èƒ½æå‡çš„ï¼Œæ‰€ä»¥è¯´åç¨‹ç‰¹åˆ«é€‚åˆäº IO å¯†é›†çš„åº”ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œç»å¸¸ä¼šç›´æ¥ await æ¯ä¸€ä¸ªåç¨‹ï¼Œå¯¼è‡´å®é™…ä¸Šæ²¡æœ‰ä»»ä½•å¹¶å‘ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç å°±æ˜¯é”™è¯¯çš„ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;async def main():
    urls = [&amp;#39;https://www.toutiao.com&amp;#39;, &amp;#39;https://www.douban.com&amp;#39;, &amp;#39;https://www.sina.com.cn&amp;#39;]
    for url in urls:
        page = await fetch(url)
        print(page)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸Šé¢è¿™ç§é”™è¯¯æœ‰äººç§°ä½œ async/await hellï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š&lt;a href="https://www.zcfy.cc/article/how-to-escape-async-await-hell"&gt;å¦‚ä½•é¿å…async/awaitåœ°ç‹±&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;åç¨‹çš„è°ƒåº¦&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“çº¿ç¨‹æ˜¯å†…æ ¸è¿›è¡ŒæŠ¢å å¼çš„è°ƒåº¦çš„ï¼Œè¿™æ ·å°±ç¡®ä¿äº†æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰æ‰§è¡Œçš„æœºä¼šã€‚è€Œ coroutine è¿è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œç”±è¯­è¨€çš„è¿è¡Œæ—¶ä¸­çš„ EventLoopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰æ¥è¿›è¡Œè°ƒåº¦ã€‚å’Œå¤§å¤šæ•°è¯­è¨€ä¸€æ ·ï¼Œåœ¨ Python ä¸­ï¼Œåç¨‹çš„è°ƒåº¦æ˜¯éæŠ¢å å¼çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªåç¨‹å¿…é¡»ä¸»åŠ¨è®©å‡ºæ‰§è¡Œæœºä¼šï¼Œå…¶ä»–åç¨‹æ‰æœ‰æœºä¼šè¿è¡Œã€‚è®©å‡ºæ‰§è¡Œçš„å…³é”®å­—å°±æ˜¯ &lt;code&gt;await&lt;/code&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªåç¨‹å¦‚æœé˜»å¡äº†ï¼ŒæŒç»­ä¸è®©å‡º CPUï¼Œé‚£ä¹ˆæ•´ä¸ªçº¿ç¨‹å°±å¡ä½äº†ï¼Œæ²¡æœ‰ä»»ä½•å¹¶å‘ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="n"&gt;time_sleep&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_work&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;future&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ensure_future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;do_work&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gather&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;time_sleep&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;no_concurrent&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;  &lt;span class="mf"&gt;0.13&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="mf"&gt;0.03&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cpu&lt;/span&gt; &lt;span class="mf"&gt;3.173&lt;/span&gt; &lt;span class="n"&gt;total&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è™½ç„¶æˆ‘ä»¬ä½¿ç”¨äº† asyncio.gather æ¥å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥çœ‹åˆ°æ‰§è¡Œæ—¶é—´æ˜¯ 3.173sã€‚å› ä¸º time.sleep æ˜¯ä¸€ä¸ªé˜»å¡æ€§çš„æ“ä½œï¼Œåªèƒ½é¡ºåºæ‰§è¡Œï¼Œæ‰€ä»¥æ•´ä¸ªè¿è¡Œæ—¶é—´å°±æ˜¯ 3sã€‚å¦‚æœè¦ä¿®å¤è¿™ä¸ªç¨‹åºå¯ä»¥æ”¹æˆè¿™æ ·ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% cat aio_sleep.py&lt;/span&gt;

&lt;span class="c"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="n"&gt;def&lt;/span&gt; &lt;span class="n"&gt;do_work&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c"&gt;...&lt;/span&gt;

&lt;span class="c"&gt;% time python aio_sleep.py&lt;/span&gt;
&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;aio_sleep&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;  &lt;span class="mf"&gt;0.13&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="mf"&gt;0.03&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt; &lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="c"&gt;% cpu 1.166 total&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ asyncio.sleep æ›¿æ¢äº†é˜»å¡çš„ time.sleepï¼Œæ‰§è¡Œæ—¶é—´æ˜¯ 1.166sã€‚è¿™æ ·æš´éœ²ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Python æ•´ä¸ªå¼‚æ­¥ç¼–ç¨‹ç”Ÿæ€çš„é—®é¢˜ï¼Œä¹‹å‰æ ‡å‡†åº“å’Œå„ç§ç¬¬ä¸‰æ–¹åº“çš„é˜»å¡æ€§å‡½æ•°éƒ½ä¸èƒ½ç”¨äº†ï¼Œrequests ä¸èƒ½ç”¨äº†ï¼Œredis.py ä¸èƒ½ç”¨äº†ï¼Œç”šè‡³ open å‡½æ•°éƒ½ä¸èƒ½ç”¨äº†ã€‚æ‰€ä»¥ Python çš„æœ€å¤§é—®é¢˜ä¸æ˜¯ä¸å¥½ç”¨ï¼Œè€Œæ˜¯ç”Ÿæ€ç¯å¢ƒä¸å¥½ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€æ—¦å¼€å§‹é‡‡ç”¨ async å‡½æ•°ï¼Œé‚£ä¹ˆä½ æ•´ä¸ªç¨‹åºéƒ½å¿…é¡»æ˜¯ async çš„ï¼Œä¸ç„¶æ€»ä¼šæœ‰é˜»å¡çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯è¯´ async å…·æœ‰ä¼ æŸ“æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™ä¸¤ç‚¹ç»“åˆåœ¨ä¸€èµ·å¯¼è‡´æƒ³è¦å†™ä¸€ä¸ªå®Œå…¨å¼‚æ­¥çš„ Python ç¨‹åºè¿˜æ˜¯æœ‰ä¸€å®šæŒ‘æˆ˜çš„ã€‚&lt;/p&gt;
&lt;h1&gt;Goroutine&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘é—²æš‡æ—¶é—´çœ‹äº†çœ‹ Go è¯­è¨€ç›¸å…³çš„ä¸œè¥¿ã€‚å‘ç° Go åŸç”Ÿçš„å¹¶å‘æ¨¡å‹éå¸¸å¥½ç”¨ã€‚Go ä¸­çš„ goroutine ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„ corouineï¼Œæœ€é‡è¦çš„æ˜¯ goroutine æ˜¯ go ä¸ç”Ÿä¿±æ¥çš„ç‰¹æ€§ï¼Œæ‰€ä»¥å‡ ä¹æ‰€æœ‰åº“éƒ½æ˜¯å¯ä»¥ç›´æ¥ç”¨çš„ï¼Œé¿å…äº† Python ä¸­éœ€è¦æŠŠæ‰€æœ‰åº“é‡å†™ä¸€éçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨ Go æ¥é‡å†™ä¸€ä¸‹å¹¶å‘ä¸‹è½½ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;package&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;io/ioutil&amp;quot;&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;log&amp;quot;&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;net/http&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt; &lt;span class="n"&gt;chan&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;&lt;span class="n"&gt;byte&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;nil&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Fatalf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;error &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;defer&lt;/span&gt; &lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Body&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ioutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReadAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;bodies&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;https://www.toutiao.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s2"&gt;&amp;quot;https://www.douban.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s2"&gt;&amp;quot;https://www.sina.com.cn&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;bodies&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;chan&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;&lt;span class="n"&gt;byte&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;go&lt;/span&gt; &lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;)[:&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;--------------------&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Goroutine çš„è°ƒåº¦&lt;/h2&gt;
&lt;p&gt;Goroutine ä¸­ä¸éœ€è¦æ˜¾å¼ä½¿ç”¨ await äº¤å‡ºæ§åˆ¶æƒï¼Œä½†æ˜¯ Go ä¹Ÿä¸ä¼šä¸¥æ ¼æŒ‰ç…§æ—¶é—´ç‰‡å»è°ƒåº¦ goroutineï¼Œè€Œæ˜¯ä¼šåœ¨å¯èƒ½é˜»å¡çš„åœ°æ–¹æ’å…¥è°ƒåº¦ã€‚Goroutine çš„è°ƒåº¦å¯ä»¥çœ‹åšæ˜¯åŠæŠ¢å å¼çš„ã€‚&lt;/p&gt;
&lt;h2&gt;å’Œç³»ç»Ÿçº¿ç¨‹ä¹‹é—´çš„æ˜ å°„å…³ç³»&lt;/h2&gt;
&lt;p&gt;Python ä¸­çš„åç¨‹æ˜¯ä¸¥æ ¼çš„ 1:N å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å¯¹åº”äº†å¤šä¸ªåç¨‹ã€‚è€Œ Go ä¸­æ˜¯ M:N çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ N ä¸ªåç¨‹ä¼šæ˜ å°„åˆ†é…åˆ° M ä¸ªçº¿ç¨‹ä¸Šï¼Œè¿™æ ·å¸¦æ¥äº†ä¸¤ç‚¹å¥½å¤„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CPU å¯†é›†çš„åº”ç”¨ä½¿ç”¨ goroutine ä¹Ÿä¼šè·å¾—åŠ é€Ÿï¼›&lt;/li&gt;
&lt;li&gt;å³ä½¿æœ‰å°‘é‡é˜»å¡çš„æ“ä½œï¼Œä¹Ÿåªä¼šé˜»å¡æŸä¸ª worker çº¿ç¨‹ï¼Œè€Œä¸ä¼šæŠŠæ•´ä¸ªç¨‹åºé˜»å¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œåœ¨é«˜å¹¶å‘æ–¹é¢ï¼ŒGo è¯­è¨€çš„ç¡®æœ‰ä¸å°‘ä¼˜åŠ¿ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 29 Apr 2018 05:44:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-29:/posts/python-coroutine-yi-ji-he-goroutine-de-dui-bi.html</guid><category>golang</category><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ Pattern Matching (æ¨¡å¼åŒ¹é…)</title><link>/posts/han-shu-shi-bian-cheng-zhong-de-pattern-matching-mo-shi-pi-pei.html</link><description>&lt;p&gt;ä»¥ haskell ä¸ºä¾‹ï¼Œç®€å•æ¥è¯´ï¼Œpattern å°±åƒæ˜¯æ•°å­¦ä¸­çš„åˆ†æ®µå‡½æ•°ã€‚é€šè¿‡ä½¿ç”¨ pattern matchingï¼Œå°±å¯ä»¥å¯¹ä¸åŒçš„å‚æ•°å®šä¹‰ä¸åŒçš„å‡½æ•°ä½“ã€‚å½“è°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å¯¹æ¯”å®å‚å’Œå½¢å‚çš„æ¨¡å¼å°±å¯ä»¥é€‰æ‹©æ­£ç¡®çš„å‡½æ•°ä½“ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src="https://ws3.sinaimg.cn/large/006tKfTcly1fqq6q36pkij30aq02cglo.jpg" max-width="400px" /&gt;&lt;/p&gt;
&lt;p&gt;å’Œå¯¹åº”çš„ haskell ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;fib 0 = 1
fib 1 = 1
fib n | n &amp;gt;= 2 
      = fib (n-1) + fib (n-2)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„åœ¨åˆ†æ®µå‡½æ•°ä¸­ "n â‰¥ 2" è¿™ä¸ªæ¡ä»¶åœ¨ haskell ä¸­å˜æˆäº†ä¸€ä¸ª guardã€‚ä½†æ˜¯å¦å¤–ä¸¤ä¸ªæ¡ä»¶å°±æ˜¯ç®€å•çš„ patternã€‚Pattern å°±æ˜¯å¯ä»¥æµ‹è¯•å€¼å’Œç»“æ„çš„æ¡ä»¶ï¼Œæ¯”å¦‚ &lt;code&gt;x:xs&lt;/code&gt;, &lt;code&gt;(x, y, z)&lt;/code&gt;, æˆ–è€… &lt;code&gt;x&lt;/code&gt;ã€‚åœ¨ä¸€ä¸ªåˆ†æ®µå‡½æ•°å®šä¹‰ä¸­ï¼ŒåŸºäº &lt;code&gt;=&lt;/code&gt; æˆ–è€… &lt;code&gt;âˆˆ&lt;/code&gt; çš„æ¡ä»¶ä¼šå˜æˆç®€å•çš„ patternï¼Œè€Œå…¶ä»–çš„æ›´å¹¿ä¹‰çš„æ¡ä»¶ä¼šå˜æˆ guardã€‚å¦‚æœç”¨ guard æ¥é‡å†™ä¸€ä¸‹ä¸Šé¢çš„å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;fib n | n == 0 = 1
      | n == 1 = 1
      | n &amp;gt;= 2 = fib (n-1) + fib (n-2)
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å’Œ switch/ifelse è¯­å¥çš„åŒºåˆ«&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;ç¼–è¯‘å™¨å¯ä»¥æ›¿ä½ æ£€æŸ¥ä½ æ˜¯å¦è¦†ç›–äº†æ‰€æœ‰æƒ…å½¢&lt;/li&gt;
&lt;li&gt;å¯ä»¥ç›´æ¥æŠŠ pattern match ä½œä¸ºä¸€ä¸ªèµ‹å€¼è¯­å¥&lt;/li&gt;
&lt;li&gt;å¦‚æœä½ æœ‰ä¸€ä¸ªä¸åŒç±»å‹å¤åˆçš„å˜é‡ï¼Œæ¯ä¸€ä¸ªåŒ¹é…ç»“æœéƒ½ä¼šæœ‰ä¸åŒçš„ç±»å‹&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ pattern matching åœ¨æŸäº›æƒ…å†µä¸‹è¦ç®€æ´å¾—å¤š[4]&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;REF&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/2225774/haskell-pattern-matching-what-is-it&lt;/li&gt;
&lt;li&gt;https://www.zhihu.com/question/22344888&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/199918/explaining-pattern-matching-vs-switch&lt;/li&gt;
&lt;li&gt;https://hongjiang.info/scala-pattern-matching-1/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 26 Apr 2018 09:18:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-26:/posts/han-shu-shi-bian-cheng-zhong-de-pattern-matching-mo-shi-pi-pei.html</guid><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>[è¯‘] ç”¨ Python ç¼–å†™ä¸€ä¸ªæ¨¡æ¿å¼•æ“</title><link>/posts/yi-yong-python-bian-xie-yi-ge-mo-ban-yin-qing.html</link><description>&lt;p&gt;ä¸€ç›´å¯¹æ¨¡æ¿å¼•æ“çš„å®ç°å¾ˆå¥½å¥‡ï¼Œæ­£å¥½çœ‹åˆ°äº†&lt;a href="http://alexmic.net/building-a-template-engine/"&gt;è¿™ç¯‡&lt;/a&gt;æ–‡ç« ï¼Œç¿»è¯‘ä¸€ä¸‹ï¼Œä¾›å¤§å®¶å­¦ä¹ ã€å‚è€ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæœ€ç®€å•çš„æ¨¡æ¿å¼•æ“ï¼Œå¹¶ä¸”æ¢ç´¢ä¸€ä¸‹å®ƒçš„åº•å±‚å®ç°ã€‚å¦‚æœä½ æƒ³ç›´æ¥çœ‹ä»£ç çš„è¯ï¼Œ&lt;a href="https://github.com/alexmic/microtemplates"&gt;GitHub&lt;/a&gt; æ˜¯ä½ çš„å¥½æœ‹å‹&lt;/p&gt;
&lt;h1&gt;è¯­è¨€è®¾è®¡&lt;/h1&gt;
&lt;p&gt;è¿™é‡Œè®¾è®¡çš„æ¨¡æ¿è¯­è¨€éå¸¸åŸºç¡€ã€‚ä½¿ç”¨ä¸¤ç§æ ‡ç­¾ï¼Œå˜é‡å’Œå—ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- å˜é‡ä½¿ç”¨ `&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt; &lt;span class="err"&gt;å’Œ&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="c"&gt;` ä½œä¸ºæ ‡è¯†--&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;my_var&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

&lt;span class="c"&gt;&amp;lt;!-- å—ä½¿ç”¨ `{%` å’Œ `%}` ä½œä¸ºæ ‡è¯†--&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;each&lt;/span&gt; &lt;span class="nv"&gt;items&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¤§å¤šæ•°çš„å—éœ€è¦ä½¿ç”¨å…³é—­æ ‡ç­¾ï¼Œå…³é—­æ ‡ç­¾ä½¿ç”¨&lt;code&gt;{% end %}&lt;/code&gt;è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ¨¡æ¿å¼•æ“èƒ½å¤Ÿå¤„ç†åŸºæœ¬çš„å¾ªç¯å’Œæ¡ä»¶è¯­å¥ï¼Œè€Œä¸”ä¹Ÿæ”¯æŒåœ¨å—ä¸­ä½¿ç”¨ callableã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œèƒ½å¤Ÿåœ¨æ¨¡æ¿ä¸­è°ƒç”¨ä»»æ„çš„ Python å‡½æ•°éå¸¸æ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;h1&gt;å¾ªç¯&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨å¾ªç¯å¯ä»¥éå†é›†åˆæˆ–è€… iterableã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;each&lt;/span&gt; &lt;span class="nv"&gt;people&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;it.name&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;

&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;each&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;

&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;each&lt;/span&gt; &lt;span class="nv"&gt;records&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;&lt;span class="nv"&gt;.name&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ä¸Šé¢çš„ä¾‹å­é‡Œé¢ï¼Œpeople æ˜¯ä¸€ä¸ªé›†åˆï¼Œ&lt;code&gt;it&lt;/code&gt; æŒ‡å‘äº†å½“å‰è¿­ä»£çš„å…ƒç´ ã€‚ä½¿ç”¨ç‚¹åˆ†éš”çš„è·¯å¾„ä¼šè¢«è§£ææˆå­—å…¸å±æ€§ã€‚ä½¿ç”¨ &lt;code&gt;..&lt;/code&gt; å¯ä»¥è®¿é—®å¤–éƒ¨ä¸Šä¸‹æ–‡ä¸­çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h1&gt;æ¡ä»¶è¯­å¥&lt;/h1&gt;
&lt;p&gt;æ¡ä»¶è¯­å¥ä¸éœ€è¦å¤šè§£é‡Šã€‚è¿™ä¸ªè¯­è¨€æ”¯æŒ if å’Œ else ç»“æ„ï¼Œè€Œä¸”æ”¯æŒ &lt;code&gt;==&lt;/code&gt;, &lt;code&gt;&amp;lt;=&lt;/code&gt;, &lt;code&gt;&amp;gt;=&lt;/code&gt;, &lt;code&gt;!=&lt;/code&gt;, &lt;code&gt;is&lt;/code&gt;, &lt;code&gt;&amp;lt;&lt;/code&gt;, &lt;code&gt;&amp;gt;&lt;/code&gt; è¿™å‡ ä¸ªæ“ä½œç¬¦ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;num&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;more than 5&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;less than or equal to 5&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;è°ƒç”¨å—&lt;/h1&gt;
&lt;p&gt;Callable å¯ä»¥é€šè¿‡æ¨¡æ¿ä¸Šä¸‹æ–‡ä¼ é€’ï¼Œå¹¶ä¸”ä½¿ç”¨æ™®é€šä½ç½®å‚æ•°æˆ–è€…å…·åå‚æ•°è°ƒç”¨ã€‚è°ƒç”¨å—ä¸éœ€è¦ä½¿ç”¨ end å…³é—­ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- ä½¿ç”¨æ™®é€šå‚æ•°... --&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;date&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;{% call prettify date_created %}&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;&amp;lt;!-- ...ä½¿ç”¨å…·åå‚æ•° --&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;{% call log &amp;#39;here&amp;#39; verbosity=&amp;#39;debug&amp;#39; %}&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åŸç†&lt;/h1&gt;
&lt;p&gt;åœ¨æ¢ç´¢å¼•æ“æ˜¯å¦‚ä½•ç¼–è¯‘å’Œæ¸²æŸ“æ¨¡æ¿ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸‹åœ¨å†…å­˜ä¸­å¦‚ä½•è¡¨ç¤ºä¸€ä¸ªç¼–è¯‘å¥½çš„æ¨¡æ¿ã€‚&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘å™¨ä½¿ç”¨æŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstract Syntax Tree, ASTï¼‰æ¥è¡¨ç¤ºè®¡ç®—æœºç¨‹åºã€‚AST æ˜¯å¯¹æºä»£ç è¿›è¡Œè¯æ³•åˆ†æï¼ˆlexical analysisï¼‰çš„ç»“æœã€‚AST ç›¸å¯¹æºä»£ç æ¥è¯´æœ‰å¾ˆå¤šå¥½å¤„ï¼Œæ¯”å¦‚è¯´å®ƒä¸åŒ…å«ä»»ä½•æ— å…³ç´§è¦çš„æ–‡æœ¬å…ƒç´ ï¼Œæ¯”å¦‚è¯´åˆ†éš”ç¬¦è¿™ç§ã€‚è€Œä¸”ï¼Œæ ‘ä¸­çš„èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨å±æ€§æ¥æ·»åŠ æ›´å¤šçš„åŠŸèƒ½ï¼Œè€Œä¸éœ€è¦æ”¹åŠ¨ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¼šè§£æå¹¶åˆ†ææ¨¡æ¿æ¥æ„é€ è¿™æ ·ä¸€æ£µæ ‘ï¼Œå¹¶ç”¨å®ƒæ¥è¡¨ç¤ºç¼–è¯‘åçš„æ¨¡æ¿ã€‚æ¸²æŸ“çš„æ—¶å€™ï¼Œéå†è¿™æ£µæ ‘ï¼Œä¼ ç»™å®ƒå¯¹åº”çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åè¾“å‡º HTMLã€‚&lt;/p&gt;
&lt;h1&gt;æ¨¡æ¿åˆ‡è¯ï¼ˆtokenizeï¼‰&lt;/h1&gt;
&lt;p&gt;è§£æçš„ç¬¬ä¸€æ­¥æ˜¯æŠŠå†…å®¹åˆ†éš”æˆä¸åŒçš„ç‰‡æ®µã€‚æ¯ä¸ªç‰‡æ®µå¯ä»¥æ˜¯ä»»æ„çš„ HTML æˆ–è€…æ˜¯ä¸€ä¸ªæ ‡ç­¾ã€‚è¿™é‡Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å’Œ &lt;code&gt;split()&lt;/code&gt; å‡½æ•°åˆ†éš”æ–‡æœ¬ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;VAR_TOKEN_START = &amp;#39;{{&amp;#39;
VAR_TOKEN_END = &amp;#39;}}&amp;#39;
BLOCK_TOKEN_START = &amp;#39;{%&amp;#39;
BLOCK_TOKEN_END = &amp;#39;%}&amp;#39;
TOK_REGEX = re.compile(r&amp;quot;(%s.*?%s|%s.*?%s)&amp;quot; % (
    VAR_TOKEN_START,
    VAR_TOKEN_END,
    BLOCK_TOKEN_START,
    BLOCK_TOKEN_END
))
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ TOK_REGEXã€‚å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ­£åˆ™çš„æ„æ€æ˜¯ TOK_REGEX è¦ä¹ˆæ˜¯ä¸€ä¸ªå˜é‡æ ‡ç­¾ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ªå—æ ‡ç­¾ï¼Œè¿™æ˜¯ä¸ºäº†è®©å˜é‡æ ‡ç­¾å’Œå—æ ‡ç­¾éƒ½èƒ½å¤Ÿåˆ†éš”æ–‡æœ¬ã€‚è¡¨è¾¾å¼çš„æœ€å¤–å±‚æ˜¯ä¸€ä¸ªæ‹¬å·ï¼Œç”¨æ¥æ•è·åŒ¹é…åˆ°çš„æ–‡æœ¬ã€‚å…¶ä¸­çš„ &lt;code&gt;?&lt;/code&gt; è¡¨ç¤ºéè´ªå©ªçš„åŒ¹é…ã€‚æˆ‘ä»¬æƒ³è®©æˆ‘ä»¬çš„æ­£åˆ™è¡¨è¾¾å¼æ˜¯æƒ°æ€§çš„ï¼Œå¹¶ä¸”åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…åˆ°çš„æ—¶å€™åœä¸‹æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªä¾‹å­å®é™…å±•ç¤ºäº†ä¸€ä¸‹ä¸Šé¢çš„æ­£åˆ™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; TOK_REGEX.split(&amp;#39;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;each&lt;/span&gt; &lt;span class="nv"&gt;vars&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;i&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/i&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endeach&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&amp;#39;)
[&amp;#39;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;each&lt;/span&gt; &lt;span class="nv"&gt;vars&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&amp;#39;, &amp;#39;&lt;span class="nt"&gt;&amp;lt;i&amp;gt;&lt;/span&gt;&amp;#39;, &amp;#39;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&amp;#39;, &amp;#39;&lt;span class="nt"&gt;&amp;lt;/i&amp;gt;&lt;/span&gt;&amp;#39;, &amp;#39;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endeach&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&amp;#39;]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æŠŠæ¯ä¸ªç‰‡æ®µå°è£…æˆ Fragment å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒ…å«äº†ç‰‡æ®µçš„ç±»å‹ï¼Œå¹¶ä¸”å¯ä»¥ä½œä¸ºç¼–è¯‘å‡½æ•°çš„å‚æ•°ã€‚ç‰‡æ®µæœ‰ä»¥ä¸‹å››ç§ç±»å‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;VAR_FRAGMENT = 0
OPEN_BLOCK_FRAGMENT = 1
CLOSE_BLOCK_FRAGMENT = 2
TEXT_FRAGMENT = 3
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æ„å»º AST&lt;/h1&gt;
&lt;p&gt;ä¸€æ—¦æˆ‘ä»¬åšå¥½äº†åˆ†è¯ï¼Œä¸‹ä¸€æ­¥å°±å¯ä»¥éå†æ¯ä¸ªç‰‡æ®µå¹¶æ„å»ºè¯­æ³•æ ‘äº†ã€‚æˆ‘ä»¬ä½¿ç”¨ Node ç±»æ¥ä½œä¸ºæ ‘çš„èŠ‚ç‚¹çš„åŸºç±»ï¼Œç„¶ååˆ›å»ºå¯¹æ¯ä¸€ç§èŠ‚ç‚¹ç±»å‹åˆ›å»ºå­ç±»ã€‚æ¯ä¸ªå­ç±»éƒ½å¿…é¡»æä¾› &lt;code&gt;process_fragment&lt;/code&gt; å’Œ &lt;code&gt;render&lt;/code&gt; æ–¹æ³•ã€‚&lt;code&gt;process_fragment&lt;/code&gt; ç”¨æ¥è¿›ä¸€æ­¥è§£æç‰‡æ®µçš„å†…å®¹å¹¶ä¸”æŠŠéœ€è¦çš„å±æ€§å­˜åˆ° &lt;code&gt;Node&lt;/code&gt; å¯¹è±¡ä¸Šã€‚&lt;code&gt;render&lt;/code&gt; æ–¹æ³•è´Ÿè´£ä½¿ç”¨æä¾›çš„ä¸Šä¸‹æ–‡è½¬æ¢å¯¹åº”çš„èŠ‚ç‚¹å†…å®¹åˆ° HTMLã€‚&lt;/p&gt;
&lt;p&gt;å­ç±»ä¹Ÿå¯ä»¥å®ç° &lt;code&gt;enter_scope&lt;/code&gt; å’Œ &lt;code&gt;exit_scope&lt;/code&gt; é’©å­æ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•ä¸æ˜¯å¿…é¡»çš„ã€‚åœ¨ç¼–è¯‘å™¨ç¼–è¯‘æœŸé—´ï¼Œä¼šè°ƒç”¨è¿™ä¸¤ä¸ªé’©å­å‡½æ•°ï¼Œä»–ä»¬åº”è¯¥è´Ÿè´£è¿›ä¸€æ­¥çš„åˆå§‹åŒ–å’Œæ¸…ç†å·¥ä½œã€‚å½“ä¸€ä¸ª &lt;code&gt;Node&lt;/code&gt; åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼ˆscopeï¼‰çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ &lt;code&gt;enter_scope&lt;/code&gt;ï¼Œå½“é€€å‡ºä½œç”¨åŸŸæ—¶ï¼Œä¼šè°ƒç”¨ &lt;code&gt;exit_scopeã€‚å…³äºä½œç”¨åŸŸ&lt;/code&gt;ï¼Œä¸‹é¢ä¼šè®²åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;Node åŸºç±»å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;_Node&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;fragment&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;children&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;creates_scope&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;False&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;process_fragment&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;fragment&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;process_fragment&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;fragment&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;pass&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;enter_scope&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;pass&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;pass&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;exit_scope&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;pass&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;render_children&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;children&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;children&lt;/span&gt; &lt;span class="nx"&gt;is&lt;/span&gt; &lt;span class="nx"&gt;None&lt;/span&gt;:
            &lt;span class="kt"&gt;children&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;children&lt;/span&gt;
        &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;render_child&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;child&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;child_html&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;child&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;not&lt;/span&gt; &lt;span class="nx"&gt;child_html&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="nx"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;child_html&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;render_child&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;children&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸‹é¢æ˜¯å˜é‡èŠ‚ç‚¹çš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;_Variable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;_Node&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;process_fragment&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;fragment&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;fragment&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;resolve_in_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸ºäº†ç¡®å®š Node çš„ç±»å‹ï¼ˆå¹¶ä¸”è¿›ä¸€æ­¥åˆå§‹åŒ–æ­£ç¡®çš„ç±»ï¼‰ï¼Œéœ€è¦æŸ¥çœ‹ç‰‡æ®µçš„ç±»å‹å’Œæ–‡æœ¬ã€‚æ–‡æœ¬å’Œå˜é‡ç‰‡æ®µç›´æ¥ç¿»è¯‘æˆæ–‡æœ¬èŠ‚ç‚¹å’Œå˜é‡èŠ‚ç‚¹ã€‚å—ç‰‡æ®µéœ€è¦ä¸€äº›é¢å¤–çš„å¤„ç† â€”â€” ä»–ä»¬çš„ç±»å‹æ˜¯ä½¿ç”¨å—å‘½ä»¤æ¥ç¡®å®šçš„ã€‚æ¯”å¦‚è¯´ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;{% each items %}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ˜¯ä¸€ä¸ª &lt;code&gt;each&lt;/code&gt; ç±»å‹çš„å—èŠ‚ç‚¹ï¼Œå› ä¸ºå—å‘½ä»¤æ˜¯ eachã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥åˆ›å»ºä½œç”¨åŸŸã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œæˆ‘ä»¬è®°å½•å½“å‰çš„ä½œç”¨åŸŸï¼Œå¹¶ä¸”æŠŠæ–°çš„èŠ‚ç‚¹ä½œä¸ºä½œä¸ºå½“å‰ä½œç”¨åŸŸçš„å­èŠ‚ç‚¹ã€‚ä¸€æ—¦é‡åˆ°ä¸€ä¸ªæ­£ç¡®çš„å…³é—­æ ‡ç­¾ï¼Œå…³é—­å½“å‰ä½œç”¨åŸŸï¼Œå¹¶ä¸”ä»ä½œç”¨åŸŸæ ˆä¸­æŠŠå½“å‰ä½œç”¨åŸŸ pop å‡ºæ¥ï¼Œä½¿ç”¨æ ˆé¡¶ä½œä¸ºæ–°çš„ä½œç”¨åŸŸã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def compile(self):
    root = _Root()
    scope_stack = [root]
    for fragment in self.each_fragment():
        if not scope_stack:
            raise TemplateError(&amp;#39;nesting issues&amp;#39;)
        parent_scope = scope_stack[-1]
        if fragment.type == CLOSE_BLOCK_FRAGMENT:
            parent_scope.exit_scope()
            scope_stack.pop()
            continue
        new_node = self.create_node(fragment)
        if new_node:
            parent_scope.children.append(new_node)
            if new_node.creates_scope:
                scope_stack.append(new_node)
                new_node.enter_scope()
    return root
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æ¸²æŸ“&lt;/h1&gt;
&lt;p&gt;ç®¡çº¿çš„æœ€åä¸€æ­¥å°±æ˜¯æŠŠ AST æ¸²æŸ“æˆ HTML äº†ã€‚è¿™ä¸€æ­¥è®¿é—® AST ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å¹¶ä¸”ä½¿ç”¨ä¼ é€’ç»™æ¨¡æ¿çš„ context å‚æ•°è°ƒç”¨ render æ–¹æ³•ã€‚åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œrender ä¸æ–­åœ°è§£æä¸Šä¸‹æ–‡å˜é‡çš„å€¼ã€‚å¯ä»¥ä½¿ç”¨ä½¿ç”¨ &lt;code&gt;ast.literal_eval&lt;/code&gt; å‡½æ•°ï¼Œå®ƒå¯ä»¥å®‰å…¨çš„æ‰§è¡ŒåŒ…å«äº† Python ä»£ç çš„å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def eval_expression(expr):
    try:
        return &amp;#39;literal&amp;#39;, ast.literal_eval(expr)
    except ValueError, SyntaxError:
        return &amp;#39;name&amp;#39;, expr
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸Šä¸‹æ–‡å˜é‡ï¼Œè€Œä¸æ˜¯å­—é¢é‡çš„è¯ï¼Œéœ€è¦åœ¨ä¸Šä¸‹æ–‡ä¸­æœç´¢æ¥æ‰¾åˆ°å®ƒçš„å€¼ã€‚åœ¨è¿™é‡Œéœ€è¦å¤„ç†åŒ…å«ç‚¹çš„å˜é‡åä»¥åŠä½¿ç”¨ä¸¤ä¸ªç‚¹è®¿é—®å¤–éƒ¨ä¸Šä¸‹æ–‡çš„å˜é‡ã€‚ä¸‹é¢æ˜¯ resolve å‡½æ•°ï¼Œä¹Ÿæ˜¯æ•´ä¸ªéš¾é¢˜çš„æœ€åä¸€éƒ¨åˆ†äº†~&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def resolve(name, context):
    if name.startswith(&amp;#39;..&amp;#39;):
        context = context.get(&amp;#39;..&amp;#39;, {})
        name = name[2:]
    try:
        for tok in name.split(&amp;#39;.&amp;#39;):
            context = context[tok]
        return context
    except KeyError:
        raise TemplateContextError(name)
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;ç»“è®º&lt;/h1&gt;
&lt;p&gt;æˆ‘å¸Œæœ›è¿™ä¸ªå°å°çš„å­¦æœ¯è”ç³»èƒ½å¤Ÿè®©ä½ å¯¹æ¨¡æ¿å¼•æ“æ˜¯æ€æ ·å·¥ä½œçš„æœ‰ä¸€ç‚¹åˆæ­¥çš„æ„Ÿè§‰ã€‚è¿™ä¸ªç”Ÿäº§çº§åˆ«çš„ä»£ç è¿˜å·®å¾—å¾ˆè¿œï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ä½œä¸ºä½ å¼€å‘æ›´å¥½çš„å·¥å…·çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°å®Œæ•´çš„ä»£ç ï¼Œä½ ä¹Ÿå¯ä»¥è¿›ä¸€æ­¥åœ¨ Hacker News ä¸Šè®¨è®ºã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ„Ÿè°¢ Nassos Hadjipapas, Alex Loizou, Panagiotis Papageorgiou and Gearoid Oâ€™Rourke å®¡é˜…æœ¬æ–‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 17 Apr 2018 07:08:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-17:/posts/yi-yong-python-bian-xie-yi-ge-mo-ban-yin-qing.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Linux ä¸Šçš„ DNS ç¼“å­˜</title><link>/posts/linux-shang-de-dns-huan-cun.html</link><description>&lt;p&gt;Linux å†…æ ¸ä¸­æ²¡æœ‰ DNS ç¼“å­˜&lt;/p&gt;
&lt;p&gt;Firefox å†…ç½®äº† DNS ç¼“å­˜&lt;/p&gt;
&lt;p&gt;&lt;code&gt;nscd&lt;/code&gt; å¯ä»¥æä¾›æœ¬åœ°çš„ DNS ç¼“å­˜ï¼Œå¥½å¤šæœºå™¨å¼€äº†ï¼Œä½†æ˜¯æ®è¯´è¿™ä¸ªæœåŠ¡æœ‰å¾ˆå¤šé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;Python ä½¿ç”¨äº† &lt;code&gt;getaddrinfo&lt;/code&gt; å‡½æ•°ï¼Œä¼šä½¿ç”¨ç³»ç»Ÿçš„ DNS ç¼“å­˜&lt;/p&gt;
&lt;p&gt;åƒ &lt;code&gt;nslookup&lt;/code&gt; å’Œæ˜¯digè¿™æ ·çš„å·¥å…·ä¼š bypass æ‰ DNS ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤– Go è¯­è¨€å¥½åƒä¹Ÿä¸ä¼šä½¿ç”¨æœ¬æœºçš„ DNS ç¼“å­˜ï¼Œå³ä½¿å¼€äº†&lt;/p&gt;
&lt;p&gt;https://wiki.archlinux.org/index.php/dnsmasq å¯ä»¥ç”¨æ¥åšæœ¬åœ°ç¼“å­˜&lt;/p&gt;
&lt;p&gt;è¿˜å¯ä»¥ä½¿ç”¨systemdæä¾›çš„resolved&lt;/p&gt;
&lt;p&gt;1 https://stackoverflow.com/questions/11020027/dns-caching-in-linux&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 13 Apr 2018 05:51:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-13:/posts/linux-shang-de-dns-huan-cun.html</guid><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>è¯»ã€ŠThe Anatomy of a large-scale hypertextual Web search engineã€‹</title><link>/posts/du-the-anatomy-of-a-large-scale-hypertextual-web-search-engine.html</link><description>&lt;p&gt;Google åœ¨1997å¹´çš„è®ºæ–‡[1], åˆ°ç°åœ¨(2017)çš„è¯, å·²ç»æœ‰äºŒåå¹´çš„å†å²äº†, ç„¶è€Œå¯¹äºç¼–å†™ä¸€ä¸ªå°çš„æœç´¢å¼•æ“, ä¾ç„¶æœ‰å¥½å¤šå…·æœ‰æŒ‡å¯¼æ„ä¹‰çš„åœ°æ–¹.&lt;/p&gt;
&lt;p&gt;The Anatomy of a large-scale hypertextual Web search engine è¿™ç¯‡è®ºæ–‡åº”è¯¥æ˜¯ä¸€ç‰‡æ€»ç»“æ€§è´¨çš„è®ºæ–‡, è€Œä¸”è®ºæ–‡å¹¶æ²¡æœ‰å¤šå°‘çš„å…³äºæ•°æ®ç»“æ„ç­‰çš„å®ç°ç»†èŠ‚. åªæ˜¯å¤§ä½“æç»˜äº†ä¸€ä¸‹æ¶æ„.&lt;/p&gt;
&lt;h1&gt;Googleçš„ç®—æ³•&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆ, Googleå¤§é‡ä½¿ç”¨äº†åœ¨è¶…æ–‡æœ¬ä¹Ÿå°±æ˜¯ç½‘é¡µä¸­å­˜åœ¨çš„ç»“æ„, ä¹Ÿå°±æ˜¯é”šæ–‡æœ¬å’Œé“¾æ¥. è¿˜æœ‰å°±æ˜¯å¦‚ä½•æœ‰æ•ˆçš„å¤„ç†åœ¨ç½‘é¡µä¸Š, æ‰€æœ‰äººéƒ½å¯ä»¥ä»»æ„å‘å¸ƒä»»ä½•æ–‡å­—çš„é—®é¢˜, Googleåœ¨è¿™ç‰‡æ–‡ç« é‡Œç»™çš„è§£å†³æ–¹æ¡ˆæ˜¯PageRank.&lt;/p&gt;
&lt;p&gt;åœ¨20å¹´å‰, ä¸»è¦é—®é¢˜æ˜¯, ç½‘é¡µå·²ç»å¼€å§‹å¿«é€Ÿå¢é•¿, ç„¶è€Œå½“æ—¶çš„æ‰€æœ‰æœç´¢å¼•æ“ç»™å‡ºçš„ç»“æœåªæ˜¯æœç´¢ç»“æœçš„æ•°é‡ä¹Ÿå¢é•¿äº†, å´æ²¡èƒ½æŠŠæœ€ç›¸å…³çš„ç»“æœæ”¾åœ¨é¦–é¡µ. å› ä¸ºäººä»¬å¹¶ä¸ä¼šå› ä¸ºç»™å‡ºç»“æœå¤šè€Œå»å¤šçœ‹å‡ é¡µ, æ‰€ä»¥è¿™æ ·çš„ç»“æœæ˜¯ä¸å¯å–çš„. åœ¨è®¾è®¡Googleçš„è¿‡ç¨‹ä¸­, Googleè¿˜è€ƒè™‘äº†éšç€webè§„æ¨¡çš„å¢é•¿, ä¼šå¯¹ç°æœ‰çš„ä½“ç³»é€ æˆçš„å½±å“ä»¥åŠå¦‚ä½•åº”å¯¹.&lt;/p&gt;
&lt;p&gt;Google è¿˜è¡¨è¾¾äº†å¯¹å½“æ—¶çš„æœç´¢å¼•æ“éƒ½æ˜¯å•†ä¸šåŒ–çš„, å› è€Œä¸€äº›è¯¸å¦‚ç”¨æˆ·æŸ¥è¯¢ä¹‹ç±»çš„ç»“æœæ— æ³•å…±å­¦æœ¯åº”ç”¨çš„æƒ…å†µè¡¨è¾¾äº†ä¸æ»¡. (å‘µå‘µ, Googleè¿™ä¸æ˜¯æ‰“è‡ªå·±çš„è„¸ä¹ˆ)&lt;/p&gt;
&lt;p&gt;å¯¹äº PageRank ç®—æ³•, æåˆ°äº†ç®€å•çš„å…¬å¼:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tKfTcly1fqazehy4zdj30im02mmxd.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­Txè¡¨ç¤ºçš„æ˜¯æŒ‡å‘Aé¡µé¢çš„æ‰€æœ‰é¡µé¢, Cè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªé¡µé¢ä¸Šæ‰€æœ‰çš„å¤–é“¾. å¯¹äºè¿™ä¸ªå…¬å¼çš„è§£é‡Šæ˜¯è¿™æ ·çš„. å‡è®¾æœ‰ä¸€ä¸ªéšæœºçš„æµè§ˆè€…, ä»–ä¸æ–­çš„ç‚¹å‡»ç½‘é¡µä¸­çš„é“¾æ¥, ä»ä¸ç‚¹åé€€, ç›´åˆ°ä»–æ„Ÿåˆ°çƒ¦äº†, ç„¶ååœ¨éšæœºçš„æ‹¿ä¸€ä¸ªç½‘é¡µå¼€å§‹ç‚¹å‡». å…¶ä¸­då°±è¡¨ç¤ºäº†è¿™ä¸ªäººä¼šæ„Ÿåˆ°çƒ¦äº†çš„æ¦‚ç‡. è¿™æ ·é€ æˆçš„ç»“æœå°±æ˜¯å¦‚æœä¸€ä¸ªç½‘é¡µæœ‰å¾ˆå¤šçš„çš„å¤–é“¾æŒ‡å‘ä»–çš„è¯, ä»–å°±æœ‰å¾ˆå¤§çš„æœºä¼šè·å¾—æ¯”è¾ƒé«˜çš„PR, æˆ–è€…å¦‚æœä¸€ä¸ªå¾ˆæƒå¨çš„ç«™ç‚¹æŒ‡å‘çš„ä»–çš„è¯, ä¹Ÿæœ‰å¾ˆå¤§æœºä¼šè·å¾—æ¯”è¾ƒé«˜çš„PR.&lt;/p&gt;
&lt;p&gt;å¯¹äºé”šæ–‡æœ¬, å¤§å¤šæ•°ç½‘ç«™éƒ½æ˜¯æŠŠä»–å’Œæ‰€åœ¨çš„é¡µè”ç³»èµ·æ¥, Googleè¿˜æŠŠé”šæ–‡æœ¬ä»¥åŠPRå€¼å’Œå®ƒæŒ‡å‘çš„é¡µé¢è”ç³»èµ·æ¥.&lt;/p&gt;
&lt;h1&gt;Googleçš„æ¶æ„&lt;/h1&gt;
&lt;p&gt;å…¶å®è¿™éƒ¨åˆ†æ‰æ˜¯æˆ‘æœ€æ„Ÿå…´è¶£çš„åœ°æ–¹. ä¹‹æ‰€ä»¥ä»Šå¤©ä¼šæŠ½å‡ºæ—¶é—´æ¥é˜…è¯»è¿™ç¯‡è®ºæ–‡, ä¸»è¦å°±æ˜¯æƒ³å†™ä¸ªå°çˆ¬è™«, ç„¶åå‘ç°å†™æ¥å†™å», å¤ªä¸ä¼˜é›…äº†, æ‰æƒ³èµ·ç¿»å‡ºGoogleçš„è®ºæ–‡è¯»ä¸€è¯».&lt;/p&gt;
&lt;h2&gt;Googleæ•´ä½“æ¶æ„&lt;/h2&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tKfTcly1fqazes7038j30gn0iitbl.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Googleçš„æ¶æ„éå¸¸çš„æ¨¡å—åŒ–, åŸºæœ¬ä¸Šå¯ä»¥çœ‹åˆ°æ•´ä¸ªå›¾, å°±çŸ¥é“æ¯ä¸ªæ¨¡å—æ˜¯è´Ÿè´£åšä»€ä¹ˆçš„. å¤§æ¦‚åˆ†æˆäº†å‡ ä¸ªéƒ¨åˆ†: çˆ¬è™«(ä¸‹è½½å™¨), indexer, barrel, sorter, å’Œ(searcher)å‰ç«¯æœåŠ¡. &lt;/p&gt;
&lt;p&gt;å…¶ä¸­&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çˆ¬è™«è´Ÿè´£ä¸‹è½½ç½‘é¡µ, å…¶ä¸­æ¯ä¸€ä¸ªurléƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„docID.&lt;/li&gt;
&lt;li&gt;indexerè´Ÿè´£è§£æç½‘é¡µä¸­çš„å•è¯, ç”Ÿæˆhitè®°å½•, å¹¶äº§ç”Ÿå‰å‘ç´¢å¼•. ç„¶åæŠ½å‡ºæ‰€æœ‰çš„é“¾æ¥.&lt;/li&gt;
&lt;li&gt;URLResolverä¼šæŠŠindexerç”Ÿæˆçš„é”šæ–‡æœ¬è¯»å–å¹¶æ”¾åˆ°é”šæ–‡æœ¬å’Œé“¾æ¥æ”¾åˆ°ç´¢å¼•ä¸­, ç„¶åç”Ÿæˆä¸€ä¸ªdocID -&amp;gt; docID çš„æ˜ å°„æ•°æ®åº“. è¿™ä¸ªæ•°æ®åº“ç”¨æ¥è®¡ç®—PageRank.&lt;/li&gt;
&lt;li&gt;sorteræ ¹æ®indexerç”Ÿæˆçš„æ­£å‘ç´¢å¼•, æ ¹æ®wordIDå»ºç«‹åå‘ç´¢å¼•. ä¸ºäº†èŠ‚çœå†…å­˜, è¿™å—æ˜¯inplaceåšçš„. å¹¶ä¸”äº§ç”Ÿäº†wordIDçš„åˆ—è¡¨å’Œåç§»&lt;/li&gt;
&lt;li&gt;searcherè´Ÿè´£æ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚, ç„¶åä½¿ç”¨DumpLexiconäº§ç”Ÿçš„lexiconå’Œå€’æ’å’ŒPageRankä¸€èµ·åšå‡ºå“åº”.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;ç”¨åˆ°çš„æ•°æ®ç»“æ„&lt;/h2&gt;
&lt;p&gt;ç”±äºä¸€ä¸ªç£ç›˜å¯»é“å°±ä¼šèŠ±è´¹ 10ms çš„æ—¶é—´(1997), æ‰€ä»¥Googleå‡ ä¹æ‰€æœ‰çš„æ•°æ®ç»“æ„éƒ½æ˜¯å­˜åœ¨å¤§æ–‡ä»¶ä¸­çš„. ä»–ä»¬å®ç°äº†åŸºäºå›ºå®šå®½åº¦ISAM, æŒ‰ç…§docIDæ’åºçš„documentç´¢å¼•, ç´¢å¼•ä¸­åŒ…å«äº†å½“å‰æ–‡ä»¶çŠ¶æ€, æŒ‡å‘repositoryçš„æŒ‡é’ˆ, æ–‡ä»¶çš„æ ¡éªŒå’Œ, ä¸åŒçš„ç»Ÿè®¡ä¿¡æ¯ç­‰. å˜é•¿ä¿¡æ¯, æ¯”å¦‚æ ‡é¢˜å’Œurlå­˜åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­. (YN: SSDå¯¹è¿™ä¸ªé—®é¢˜æœ‰ä»€ä¹ˆå½±å“å‘¢)&lt;/p&gt;
&lt;p&gt;hitlistæŒ‡çš„æ˜¯æŸä¸ªå•è¯åœ¨è°‹ç¯‡æ–‡æ¡£ä¸­å‡ºç°çš„ä½ç½®, å­—ä½“, å¤§å°å†™ç­‰ä¿¡æ¯. Googleæ‰‹å†™äº†ä¸€ä¸ªhtilistçš„ç¼–ç æ¨¡å¼, å¯¹äºæ¯ä¸ªhitèŠ±è´¹2byte&lt;/p&gt;
&lt;p&gt;barrelä¸­å­˜æ”¾æŒ‰ç…§docIDæ’åºå­˜æ”¾document&lt;/p&gt;
&lt;h2&gt;æ¨¡å—&lt;/h2&gt;
&lt;h3&gt;çˆ¬è™«&lt;/h3&gt;
&lt;p&gt;çˆ¬è™«åˆåˆ†ä¸ºäº†ä¸¤ä¸ªéƒ¨åˆ†, URLServer è´Ÿè´£åˆ†å‘URLç»™Crawler. Crawler æ˜¯åˆ†å¸ƒå¼çš„, æœ‰å¤šä¸ªå®ä¾‹, è´Ÿè´£ä¸‹è½½ç½‘é¡µ. æ¯è·å¾—ä¸€ä¸ªURLçš„æ—¶å€™, éƒ½ä¼šç”Ÿæˆä¸€ä¸ªdocID. Googleä½¿ç”¨äº†ä¸€ä¸ªURLServer å’Œ 3ä¸ªCrawler. æ¯ä¸€ä¸ªCrawlerå¤§æ¦‚ä¼šç»´æŒ300ä¸ªè¿æ¥, å¯ä»¥è¾¾åˆ°æ¯ç§’é’Ÿçˆ¬å–100ä¸ªç½‘é¡µ. å¹¶ä¸”ä½¿ç”¨äº†å¼‚æ­¥IOæ¥ç®¡ç†äº‹ä»¶.&lt;/p&gt;
&lt;h4&gt;DNS&lt;/h4&gt;
&lt;p&gt;GoogleæŒ‡å‡ºçˆ¬è™«çš„ä¸€ä¸ªç“¶é¢ˆåœ¨äºæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦å»è¯·æ±‚DNS. æ‰€ä»¥ä»–ä»¬åœ¨æ¯ä¸€ä¸ªCrawlerä¸Šéƒ½è®¾ç½®äº†DNS ç¼“å­˜.&lt;/p&gt;
&lt;p&gt;YN: å¯¹äºHTTP 1.1æ¥è¯´, é»˜è®¤è¿æ¥éƒ½æ˜¯keep-aliveçš„, å¯¹äºURLServeråˆ†å‘è¿æ¥åº”è¯¥åº”è¯¥åŒä¸€ä¸ªåŸŸåå°½é‡åˆ†å‘åˆ°åŒä¸€ä¸ªcrawlerä¸Š, è¿™æ ·å¯ä»¥å°½é‡é¿å…å»ºç«‹è¿æ¥çš„å¼€é”€.&lt;/p&gt;
&lt;p&gt;indexerä¼šæŠŠä¸‹è½½åˆ°çš„ç½‘é¡µåˆ†è§£æˆhitè®°å½•,æ¯ä¸€ä¸ªhitè®°å½•äº†å•è¯, åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®, å’Œå¤§æ¦‚çš„å­—ä½“å¤§å°å’Œæ˜¯å¦æ˜¯å¤§å†™ç­‰å› ç´ . indexerè¿˜ä¼šæŠŠæ‰€æœ‰çš„é“¾æ¥éƒ½æŠ½å–å‡ºæ¥, å¹¶å­˜åˆ°ä¸€ä¸ªanchoræ–‡ä»¶ä¸­. è¿™ä¸ªæ–‡ä»¶ä¿å­˜äº†é“¾æ¥çš„æŒ‡å‘å’Œé”šæ–‡æœ¬ç­‰å…ƒç´ .&lt;/p&gt;
&lt;h2&gt;rank&lt;/h2&gt;
&lt;p&gt;Googleå¹¶æ²¡æœ‰æ‰‹å·¥ä¸ºæ¯ä¸€ä¸ªå› ç´ æŒ‡å®šå¤šå°‘æƒé‡, è€Œæ˜¯è®¾è®¡äº†ä¸€å¥—åé¦ˆç³»ç»Ÿæ¥å¸®åŠ©æˆ‘ä»¬è°ƒèŠ‚å‚æ•°.&lt;/p&gt;
&lt;h1&gt;ç»“æœè¯„ä¼°&lt;/h1&gt;
&lt;p&gt;Googleè®¤ä¸ºä»–ä»¬çš„æœç´¢èƒ½å¤Ÿäº§ç”Ÿæœ€å¥½çš„ç»“æœçš„åŸå› æ˜¯å› ä¸ºä½¿ç”¨äº†PageRank. Googleåœ¨9å¤©å†…ä¸‹è½½äº†2600ä¸‡çš„ç½‘é¡µ, indexerçš„å¤„ç†èƒ½åŠ›åœ¨ 54qps, å…¶ä¸­&lt;/p&gt;
&lt;h1&gt;æ‹“å±•&lt;/h1&gt;
&lt;p&gt;query cacheing, smart disk allocation, subindices&lt;/p&gt;
&lt;p&gt;é“¾æ¥åˆé€‚åº”è¯¥é‡æ–°æŠ“å–, ä½•æ—¶åº”è¯¥æŠ“å–æ–°è¿æ¥&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨äº†NFS, æ€§èƒ½æœ‰é—®é¢˜&lt;/p&gt;
&lt;h2&gt;YN:&lt;/h2&gt;
&lt;p&gt;å¦‚ä½•åˆ¤å®šä¸ºä¸€ä¸ªhubä¹Ÿ -&amp;gt; è¯†åˆ«åˆ—è¡¨
hubé¡µçš„é“¾æ¥äº§å‡ºç‡ -&amp;gt; æ ¹æ®ä¸€ä¸ªåˆ—è¡¨é¡µæ˜¯å¦äº§ç”Ÿæ–°è¿æ¥æ¥åŠ¨æ€çš„è°ƒæ•´hubé¡µçš„æŠ“å–é¢‘ç‡&lt;/p&gt;
&lt;p&gt;[1] http://infolab.stanford.edu/~backrub/google.html&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 13 Apr 2018 05:48:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-13:/posts/du-the-anatomy-of-a-large-scale-hypertextual-web-search-engine.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>çˆ¬è™« IP å°ç¦ä¸åå°ç¦</title><link>/posts/pa-chong-ip-feng-jin-yu-fan-feng-jin.html</link><description>&lt;p&gt;åçˆ¬è™«çš„æ ¸å¿ƒåœ¨äºåŒºåˆ†å¼€æ­£å¸¸ç”¨æˆ·è®¿é—®å’Œæ¶æ„çˆ¬è™«ç”¨æˆ·ã€‚æ¥æº IP æ˜¯è®¿é—®å¾ˆé‡è¦çš„ä¸€ä¸ªç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥ä»æ¥æº IP çš„è§’åº¦æ¥åšå‡ºä¸å°‘åçˆ¬è™«ç­–ç•¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¯å¦æ˜¯ä»£ç†IP&lt;/li&gt;
&lt;li&gt;æ˜¯å¦æ˜¯æ°‘ç”¨IP&lt;/li&gt;
&lt;li&gt;IP åœ°ç†ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œå¤§è§„æ¨¡çš„çˆ¬è™«æˆ‘ä»¬éƒ½ä¼šæ”¾åˆ°æœåŠ¡å™¨ä¸Šå»è·‘ï¼Œæ­å»ºä»£ç†é›†ç¾¤ä¹Ÿä¼šåœ¨æœåŠ¡å™¨ä¸Šï¼Œè€Œæ­£å¸¸ç”¨æˆ·çš„IPåœ°å€åˆ™æ¥è‡ªå®¶ç”¨IPèŒƒå›´å†…ã€‚è¿™å°±ç»™åçˆ¬è™«çš„ä¸€æ–¹æä¾›äº†ä¾¿åˆ©ï¼Œå¯¹äºæ¥è‡ªæ•°æ®ä¸­å¿ƒçš„è¯·æ±‚å¯ä»¥ç›´æ¥é™åˆ¶è®¿é—®ç”šè‡³ç›´æ¥å±è”½æ‰ï¼Œè€Œå¯¹äºå®¶ç”¨çš„IPåœ°å€åˆ™å®½å®¹ä¸€äº›ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå®ä¾‹&lt;/p&gt;
&lt;h1&gt;ç›´æ¥çˆ¬å–ç½‘ç«™&lt;/h1&gt;
&lt;p&gt;ä¸€èˆ¬æ­£å¸¸ç”¨æˆ·çš„é¡µé¢è®¿é—®é‡å¾ˆå°ï¼Œå¦‚æœå‘ç°æŸä¸ª IP çš„è®¿é—®é‡ç‰¹åˆ«å¤§ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯çˆ¬è™«ï¼Œç›´æ¥å°ç¦å³å¯ï¼Œæˆ–è€…æ¯æ¬¡éƒ½éœ€è¦è¾“å…¥éªŒè¯ç è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;IP è¢«å°ç¦åä¸€èˆ¬ä¸ä¼šè¢«è§£å°ï¼Œæˆ–è€…éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œè¿™æ—¶å€™åªæœ‰ä¸¤ç§æ€è·¯ï¼Œè¦ä¹ˆé™ä½é¢‘ç‡ï¼Œæ›´æ”¹è‡ªå·±çš„è¡Œä¸ºç‰¹å¾ï¼Œé¿å…è¢«å°ï¼Œè¦ä¹ˆæ›´æ¢ IPã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸ç®¡æ€æ ·æ›´æ”¹è‡ªå·±çš„è¡Œä¸ºï¼Œè®¿é—®é‡è¿˜æ˜¯å¾ˆéš¾é™ä¸‹æ¥çš„ï¼Œè¿™æ—¶å€™åªèƒ½æ¢ä¸€ä¸ª IP ç»§ç»­çˆ¬ã€‚&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨ä»£ç†ç½‘ç«™æä¾›çš„ä»£ç†IP&lt;/h1&gt;
&lt;p&gt;ä¸€äº›é»‘å®¢ä¼šä½¿ç”¨ç«¯å£æ‰«æå™¨æ‰«æäº’è”ç½‘ä¸Šçš„å¼€æ”¾ä»£ç†ï¼Œç„¶åå…è´¹æˆ–è€…ä»˜è´¹æä¾›ç»™å…¶ä»–ç”¨æˆ·ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™äº›ç½‘ç«™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="å…è´¹ä»£ç†" src="https://ws2.sinaimg.cn/large/006tNbRwly1fu6vtfrvgvj30zy0pgn3y.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿™äº›ç½‘ç«™çš„ä»£ç†ä¸­èƒ½ç›´æ¥ä½¿ç”¨çš„å¯èƒ½ä¸åˆ°10%ï¼Œè€Œä¸”å¤±æ•ˆæ—¶é—´å¾ˆçŸ­ã€‚æ‰€ä»¥è¦ä½¿ç”¨è¿™äº›ä»£ç† IPï¼Œéœ€è¦é¦–å…ˆçˆ¬å–è¿™äº›ç½‘ç«™ï¼Œç„¶åéšå–éšç”¨ã€‚&lt;/p&gt;
&lt;h1&gt;åˆ©ç”¨ ADSL æœåŠ¡å™¨æ›´æ¢ IP&lt;/h1&gt;
&lt;p&gt;ç½‘ä¸Šæœ‰ä¸€äº›å°çš„å‚å•†ä»£ç†äº†å„åœ°è¿è¥å•†çš„æœåŠ¡ï¼Œæ­å»ºäº†ä¸€äº›å°çš„æœåŠ¡å™¨ï¼Œä¸€èˆ¬å†…å­˜åªæœ‰ 512Mï¼Œè€Œç¡¬ç›˜åªæœ‰ 8Gï¼Œä½†æ˜¯å¥½å¤„æ˜¯é€šè¿‡ ADSL ä¸Šç½‘ï¼Œå› æ­¤å¯ä»¥éšæ—¶æ›´æ¢ IPã€‚æ¯”å¦‚ç¬”è€…æ­å»ºçš„è¿™ä¸ªåŠ¨æ€ä»£ç†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="ADSL" src="https://ws4.sinaimg.cn/large/006tNbRwly1fu6vpix9s0j30wq0aa77o.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸‰ååˆ†é’Ÿæ›´æ¢ä¸€æ¬¡ IPï¼Œè€Œè¿™äº›æœåŠ¡å™¨ä¹Ÿå¾ˆä¾¿å®œï¼Œåœ¨ 100-200 æ¯æœˆï¼Œæ‰€ä»¥å¤§å¯ä»¥æ­å»ºä¸€ä¸ªé›†ç¾¤ï¼Œè¿™æ ·åŸºæœ¬ä¸Šä¸€ä¸ª IP è¢«å°ä¹‹å‰ä¹ŸåŸºæœ¬è¢«æ¢æ‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¦å°ç¦è¿™ç§ç”¨æˆ·ä¹Ÿå¾ˆç®€å•ï¼Œå¯ä»¥çœ‹å‡ºè™½ç„¶ IP åœ¨æ›´æ¢ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šè¿˜æ˜¯åœ¨ä¸€ä¸ª B æ®µä¹‹å†…ï¼Œä¸€ä¸ª B æ®µä¹Ÿå°±6wä¸ªç”¨æˆ·ï¼Œç›´æ¥å°äº†å°±è¡Œäº†&lt;/p&gt;
&lt;h1&gt;åˆ©ç”¨æ•°æ®ä¸­å¿ƒæä¾›çš„æ›´æ¢ IP æ¥å£æ¥&lt;/h1&gt;
&lt;p&gt;æœ‰äº›çˆ¬è™«ä¼šåˆ©ç”¨é˜¿é‡Œäº‘æˆ–è€…AWSçš„å¼¹æ€§ IP æ¥çˆ¬æ•°æ®ï¼Œåçˆ¬è™«çš„ç¬¬ä¸€æ­¥å¯ä»¥æŠŠé˜¿é‡Œäº‘çš„ IP éƒ½å±è”½æ‰ï¼Œæ­£å¸¸ç”¨æˆ·ä¸€èˆ¬æ˜¯ä¸ä¼šç”¨è¿™äº› IP æ¥è®¿é—®çš„ã€‚&lt;/p&gt;
&lt;h1&gt;é™„å½•&lt;/h1&gt;
&lt;p&gt;é˜¿é‡Œäº‘çš„å‡ºå£ IP åˆ—è¡¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;deny 42.96.128.0/17;
deny 42.120.0.0/16;
deny 42.121.0.0/16;
deny 42.156.128.0/17;
deny 110.75.0.0/16;
deny 110.76.0.0/19;
deny 110.76.32.0/20;
deny 110.76.48.0/20;
deny 110.173.192.0/20;
deny 110.173.208.0/20;
deny 112.74.0.0/16;
deny 112.124.0.0/16;
deny 112.127.0.0/16;
deny 114.215.0.0/16;
deny 115.28.0.0/16;
deny 115.29.0.0/16;
deny 115.124.16.0/22;
deny 115.124.20.0/22;
deny 115.124.24.0/21;
deny 119.38.208.0/21;
deny 119.38.216.0/21;
deny 119.42.224.0/20;
deny 119.42.242.0/23;
deny 119.42.244.0/22;
deny 120.24.0.0/14;
deny 120.24.0.0/16;
deny 120.25.0.0/18;
deny 120.25.64.0/19;
deny 120.25.96.0/21;
deny 120.25.108.0/24;
deny 120.25.110.0/24;
deny 120.25.111.0/24;
deny 121.0.16.0/21;
deny 121.0.24.0/22;
deny 121.0.28.0/22;
deny 121.40.0.0/14;
deny 121.42.0.0/18;
deny 121.42.0.0/24;
deny 121.42.64.0/18;
deny 121.42.128.0/18;
deny 121.42.192.0/19;
deny 121.42.224.0/19;
deny 121.196.0.0/16;
deny 121.197.0.0/16;
deny 121.198.0.0/16;
deny 121.199.0.0/16;
deny 140.205.0.0/16;
deny 203.209.250.0/23;
deny 218.244.128.0/19;
deny 223.4.0.0/16;
deny 223.5.0.0/16;
deny 223.5.5.0/24;
deny 223.6.0.0/16;
deny 223.6.6.0/24;
deny 223.7.0.0/16;
101.200.0.0/15Â 
101.37.0.0/16Â 
101.37.0.0/17Â 
101.37.0.0/24Â 
101.37.128.0/17Â 
103.52.196.0/22Â 
103.52.196.0/23Â 
103.52.196.0/24Â 
103.52.198.0/23Â 
106.11.0.0/16Â 
106.11.0.0/17Â 
106.11.0.0/18Â 
106.11.1.0/24Â 
106.11.128.0/17Â 
106.11.32.0/22Â 
106.11.36.0/22Â 
106.11.48.0/21Â 
106.11.56.0/21Â 
106.11.64.0/19Â 
110.173.192.0/20Â 
110.173.196.0/24Â 
110.173.208.0/20Â 
110.75.0.0/16Â 
110.75.236.0/22Â 
110.75.239.0/24Â 
110.75.240.0/20Â 
110.75.242.0/24Â 
110.75.243.0/24Â 
110.75.244.0/22Â 
110.76.0.0/19Â 
110.76.21.0/24Â 
110.76.32.0/20Â 
110.76.48.0/20Â 
112.124.0.0/16Â 
112.125.0.0/16Â 
112.126.0.0/16Â 
112.127.0.0/16Â 
112.74.0.0/16Â 
112.74.0.0/17Â 
112.74.116.0/22Â 
112.74.120.0/22Â 
112.74.128.0/17Â 
112.74.32.0/19Â 
112.74.64.0/22Â 
112.74.68.0/22Â 
114.215.0.0/16Â 
114.55.0.0/16Â 
114.55.0.0/17Â 
114.55.128.0/17Â 
115.124.16.0/22Â 
115.124.20.0/22Â 
115.124.24.0/21Â 
115.28.0.0/16Â 
115.29.0.0/16Â 
118.190.0.0/16Â 
118.190.0.0/17Â 
118.190.0.0/24Â 
118.190.128.0/17Â 
118.31.0.0/16Â 
118.31.0.0/17Â 
118.31.0.0/24Â 
118.31.128.0/17Â 
119.38.208.0/21Â 
119.38.216.0/21Â 
119.38.219.0/24Â 
119.42.224.0/20Â 
119.42.242.0/23Â 
119.42.244.0/22Â 
119.42.248.0/21Â 
120.24.0.0/14Â 
120.24.0.0/15Â 
120.25.0.0/18Â 
120.25.104.0/22Â 
120.25.108.0/24Â 
120.25.110.0/24Â 
120.25.111.0/24Â 
120.25.112.0/23Â 
120.25.115.0/24Â 
120.25.136.0/22Â 
120.25.64.0/19Â 
120.25.96.0/21Â 
120.27.0.0/17Â 
120.27.128.0/17Â 
120.27.128.0/18Â 
120.27.192.0/18Â 
120.55.0.0/16Â 
120.76.0.0/15Â 
120.76.0.0/16Â 
120.77.0.0/16Â 
120.78.0.0/15Â 
121.0.16.0/21Â 
121.0.24.0/22Â 
121.0.28.0/22Â 
121.196.0.0/16Â 
121.197.0.0/16Â 
121.198.0.0/16Â 
121.199.0.0/16Â 
121.40.0.0/14Â 
121.42.0.0/18Â 
121.42.0.0/24Â 
121.42.128.0/18Â 
121.42.17.0/24Â 
121.42.192.0/19Â 
121.42.224.0/19Â 
121.42.64.0/18Â 
123.56.0.0/15Â 
123.56.0.0/16Â 
123.57.0.0/16Â 
139.129.0.0/16Â 
139.129.0.0/17Â 
139.129.128.0/17Â 
139.196.0.0/16Â 
139.196.0.0/17Â 
139.196.128.0/17Â 
139.224.0.0/16Â 
139.224.0.0/17Â 
139.224.128.0/17Â 
140.205.0.0/16Â 
140.205.128.0/18Â 
140.205.192.0/18Â 
140.205.32.0/19Â 
140.205.76.0/24Â 
182.92.0.0/16Â 
203.107.0.0/24Â 
203.107.1.0/24Â 
203.209.224.0/19Â 
218.244.128.0/19Â 
223.4.0.0/16Â 
223.5.0.0/16Â 
223.5.5.0/24Â 
223.6.0.0/16Â 
223.6.6.0/24Â 
223.7.0.0/16Â 
39.100.0.0/14Â 
39.104.0.0/14Â 
39.104.0.0/15Â 
39.104.0.0/24Â 
39.106.0.0/15Â 
39.108.0.0/16Â 
39.108.0.0/17Â 
39.108.0.0/24Â 
39.108.128.0/17Â 
39.96.0.0/13Â 
39.96.0.0/14Â 
39.96.0.0/24Â 
42.120.0.0/16Â 
42.121.0.0/16Â 
42.156.128.0/17Â 
42.96.128.0/17Â 
45.113.40.0/22Â 
45.113.40.0/23Â 
45.113.40.0/24Â 
45.113.42.0/23Â 
47.92.0.0/14Â 
47.92.0.0/15Â 
47.92.0.0/24Â 
47.94.0.0/15
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 13 Apr 2018 00:26:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-13:/posts/pa-chong-ip-feng-jin-yu-fan-feng-jin.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>The Problem with Pocket</title><link>/posts/the-problem-with-pocket.html</link><description>&lt;p&gt;I started using Pocket about six years ago. Back then it's a Firefox plugin named Read It Later. I saved about 1000+ articles to read-it-later. But until now, when I quit my job, I finally got some time to read those articles. Then I got this:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tKfTcly1fq9zaefzlnj31kw0zmdqu.jpg"&gt;&lt;/p&gt;
&lt;p&gt;I thought that pocket's server would retrive the article for me, and store the copy so that I can read it when ever I got time. It turns out that I was wrong, Pocket only fetches the article on the computer or phone, it only stores the url in the cloud. That's too bad, a lot of my saved pages have gone 404ed.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 12 Apr 2018 08:50:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-12:/posts/the-problem-with-pocket.html</guid><category>ä»–å±±ä¹‹çŸ³</category><category>åˆ›ä¸š</category></item><item><title>pv - åœ¨ Linux ä¸‹æŸ¥çœ‹å‘½ä»¤æ‰§è¡Œè¿›åº¦</title><link>/posts/pv-zai-linux-xia-cha-kan-ming-ling-zhi-xing-jin-du.html</link><description>&lt;p&gt;pv æ˜¯ Pipe Viewer çš„ç¼©å†™ï¼Œä¹Ÿå°±æ˜¯ç®¡é“æŸ¥çœ‹å™¨ã€‚æŒ¡åœ¨å‘½ä»¤è¡Œæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ pv æ¥æŒ‡å¯¼å½“å‰çš„è¿›åº¦ã€‚&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨&lt;/h1&gt;
&lt;h2&gt;æ›¿æ¢ cat&lt;/h2&gt;
&lt;p&gt;æ¯”å¦‚ä½ è¦æŠŠä¸€ä¸ªæ—¥å¿—æ‰“åŒ…å¥½ä¸‹è½½ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% gzip -c access.log &amp;gt; access.log.gz&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯ä»¥æ”¹æˆ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% cat access.log | gzip &amp;gt; access.log.gz&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ pv&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% pv access.log | gzip &amp;gt; access.log.gz&lt;/span&gt;
&lt;span class="mi"&gt;611&lt;/span&gt;&lt;span class="n"&gt;MB&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;58.3&lt;/span&gt;&lt;span class="n"&gt;MB&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[=&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;      &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="c"&gt;% ETA 0:00:59&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä½¿ç”¨å¤šä¸ª pv&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨å¤šä¸ª pv æ¥æŸ¥çœ‹åœ¨ä¸åŒé˜¶æ®µçš„é€Ÿç‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ pv -cN &lt;span class="nb"&gt;source&lt;/span&gt; access.log &lt;span class="p"&gt;|&lt;/span&gt; gzip &lt;span class="p"&gt;|&lt;/span&gt; pv -cN gzip &amp;gt; access.log.gz
source:  760MB &lt;span class="m"&gt;0&lt;/span&gt;:00:15 &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;37&lt;/span&gt;.4MB/s&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[=&lt;/span&gt;&amp;gt;     &lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="m"&gt;19&lt;/span&gt;% ETA &lt;span class="m"&gt;0&lt;/span&gt;:01:02
  gzip: &lt;span class="m"&gt;34&lt;/span&gt;.5MB &lt;span class="m"&gt;0&lt;/span&gt;:00:15 &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.74MB/s&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;  &amp;lt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;  &lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼Œ&lt;code&gt;-c&lt;/code&gt; æ˜¯ä¸ºäº†é˜²æ­¢ä¸¤ä¸ª pv çš„æ˜¾ç¤ºæ··åœ¨ä¸€èµ·ã€‚&lt;code&gt;-N&lt;/code&gt; è¡¨ç¤ºåå­—ã€‚å¯ä»¥çœ‹åˆ°è¯»å– access.log çš„é€Ÿç‡æ˜¯ 37.4 MB/sï¼Œè€Œå†™å…¥ gzip æ–‡ä»¶çš„é€Ÿç‡å¤§æ¦‚æ˜¯ 1.74 MB/sï¼Œæˆ‘ä»¬å¤§æ¦‚ä¹Ÿå¯ä»¥å¾—å‡ºå‹ç¼©ç‡å¤§æ¦‚æ˜¯21å€ã€‚&lt;/p&gt;
&lt;h2&gt;æŒ‡å®šæ–‡ä»¶çš„å¤§å°&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤å‹ç¼©ä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tar -czf - . &lt;span class="p"&gt;|&lt;/span&gt; pv &amp;gt; out.tgz
 117MB &lt;span class="m"&gt;0&lt;/span&gt;:00:55 &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.7MB/s&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&amp;gt;         &lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹é¢ gzip ä¸€è¡Œçš„è¾“å‡ºä¸­æ²¡æœ‰ç™¾åˆ†æ¯”ï¼Œå› ä¸º pv æ²¡æ³•çŸ¥é“ gzip ä¹‹åçš„æœ€ç»ˆå¤§å°ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•è®¡ç®—è¿›åº¦ã€‚å¯ä»¥ä½¿ç”¨ &lt;code&gt;-s&lt;/code&gt; æŒ‡å®šå¤§å°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ tar -cf - . &lt;span class="p"&gt;|&lt;/span&gt; pv -s &lt;span class="k"&gt;$(&lt;/span&gt;du -sb . &lt;span class="p"&gt;|&lt;/span&gt; awk &lt;span class="s1"&gt;&amp;#39;{print $1}&amp;#39;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; gzip &amp;gt; out.tgz
 253MB &lt;span class="m"&gt;0&lt;/span&gt;:00:05 &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;46&lt;/span&gt;.7MB/s&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&amp;gt;     &lt;span class="o"&gt;]&lt;/span&gt;  &lt;span class="m"&gt;1&lt;/span&gt;% ETA &lt;span class="m"&gt;0&lt;/span&gt;:04:49
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 12 Apr 2018 07:41:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-12:/posts/pv-zai-linux-xia-cha-kan-ming-ling-zhi-xing-jin-du.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>[è¯‘] CSS é€‰æ‹©å™¨å¤‡å¿˜å½•ï¼ˆcheatsheetï¼‰</title><link>/posts/yi-css-xuan-ze-qi-bei-wang-lu-cheatsheet.html</link><description>&lt;p&gt;è¿™ä¸¤å¤©æ‰“ç®—å†™å†™çˆ¬è™«ï¼Œå‡†å¤‡ç”¨ css é€‰æ‹©å™¨æ¥æŠ½å–å†…å®¹ï¼Œç¿»è¯‘äº†&lt;a href="http://butlerccwebdev.net/support/css-selectors-cheatsheet.html"&gt;ä¸€ç¯‡æ–‡ç« &lt;/a&gt;ï¼Œæ­£å¥½å¤ä¹ ä¸€ä¸‹ï¼Œè¿™ç¯‡æ–‡ç« éµå®ˆ CC-BY-NC-SA åè®®ã€‚&lt;/p&gt;
&lt;p&gt;å¤§å¤šæ•°çš„ web å¼€å‘è€…é¦–å…ˆå­¦ä¼šäº† CSSã€‚å› ä¸ºç»™ HTML å…ƒç´ å†™æ ·å¼è§„åˆ™çš„å…ƒç´ é€‰æ‹©å™¨éƒ½å¾ˆå®¹æ˜“ç†è§£å’Œè®°å¿†ã€‚ç»è¿‡ä¸€ç‚¹ç‚¹ç»ƒä¹ ä¹‹åï¼Œå°±ä¼šå‘ç°æˆç»„çš„ CSS è¡¨è¾¾å¼éå¸¸çš„æœ‰å¿…è¦ï¼Œæ¯”å¦‚ä½¿ç”¨ä¸€ä¸ªé€—å·åˆ†éš”å¼€é€‰æ‹©å™¨ï¼Œå°±å¯ä»¥æŠŠåŒä¸€ä¸ªæ ·å¼å±æ€§é™„åŠ åˆ°ä¸åŒçš„å¤šä¸ªå…ƒç´ äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨å’Œåˆ†ç»„çš„é€‰æ‹©å™¨å½“ç„¶ä¹Ÿæœ‰ä¸è¶³ï¼Œé‚£å°±æ˜¯ä»–ä»¬ä¼šåº”ç”¨åˆ°æ‰€æœ‰çš„æ ‡ç­¾ã€‚å¾ˆå¿«ä½ å°±ä¼šæ„è¯†åˆ°æœ‰æ—¶å€™éœ€è¦ç»™ä¸€ä¸ªç‰¹å®šçš„å…ƒç´ åŠ ä¸Šæ ·å¼ã€‚å¯¹äºå¤§å¤šæ•°å¼€å‘è€…æ¥è¯´ï¼Œæœ€ç®€å•çš„é€‰æ‹©å½“ç„¶æ˜¯ä½¿ç”¨ class å’Œ id é€‰æ‹©å™¨äº†ã€‚ä½†æ˜¯å¾ˆé—æ†¾çš„æ˜¯è¿™æ ·ä¸‹å»çš„è¯ï¼Œæ•´ä¸ªé¡µé¢å°±ä¼šå……æ»¡å„ç§å¥‡å¥‡æ€ªæ€ªçš„ç±»äº†ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†ä¸ç®¡çš„ç»™ HTML æ·»åŠ çº¯ç²¹ç”¨äºåº”ç”¨æ ·å¼çš„ class å’Œ id ä¹‹å¤–ï¼Œä½ ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨é«˜çº§çš„ CSS é€‰æ‹©å™¨æ¥ç»™æŒ‡å®šå…ƒç´ åº”ç”¨æ ·å¼ã€‚é«˜çº§çš„é€‰æ‹©å™¨å¤§è‡´å¯ä»¥åˆ†ç±»ä¸ºä¸Šä¸‹æ–‡é€‰æ‹©å™¨ã€å±æ€§é€‰æ‹©å™¨ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨å’Œä¼ªç±»é€‰æ‹©å™¨ã€‚&lt;/p&gt;
&lt;h1&gt;å…ƒç´ é€‰æ‹©å™¨&lt;/h1&gt;
&lt;p&gt;å…ƒç´ é€‰æ‹©å™¨æŠŠæ ·å¼åº”ç”¨åˆ°æ‰€æœ‰é€‰ä¸­å…ƒç´ ä¸Šï¼Œä¹Ÿæ˜¯è¢«ä½¿ç”¨æœ€å¹¿æ³›çš„é€‰æ‹©å™¨&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é€‰æ‹©å™¨&lt;/th&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;code&gt;h2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©é¡µé¢ä¸Šçš„æ‰€æœ‰ h2 å…ƒç´ ï¼Œ&lt;code&gt;h2 {text-align: center;}&lt;/code&gt; ä¼šæŠŠæ‰€æœ‰ h2 å…ƒç´ çš„æ–‡æœ¬å±…ä¸­å¯¹é½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åˆ†ç»„&lt;/td&gt;
&lt;td&gt;&lt;code&gt;h1,h2,h3&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©é¡µé¢ä¸Šæ‰€æœ‰çš„ h1, h2, h3 å…ƒç´ ï¼Œ&lt;code&gt;h1, h2, h3 {margin-bottom: .5em;}&lt;/code&gt; å°†ä¼šæŠŠ h1, h2, h3 æ ‡ç­¾çš„åº•éƒ¨ margin è®¾ç½®æˆ 0.5 em&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;class å’Œ id é€‰æ‹©å™¨&lt;/h1&gt;
&lt;p&gt;Class å’Œ id é€‰æ‹©å™¨æ˜¯ä½ èƒ½å¤ŸæŠŠæŸäº›å±æ€§åº”ç”¨åˆ°ä¸ªåˆ«å…ƒç´ ä¸Šè€Œä¸å½±å“å…¶ä»–çš„ã€‚Class è®©ä½ èƒ½å¤ŸæŒ‰ç…§æ¦‚å¿µåˆ†ç±»ã€‚ä¸¤ä¸ªæˆ–è€…æ›´å¤šå…ƒç´ å¯ä»¥å±äºåŒä¸€ä¸ªç»„ã€‚id ç»™ä¸€ä¸ªå…ƒç´ ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ï¼ŒåŒä¸€ä¸ª id æ¯ä¸ªé¡µé¢ä¸Šåªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é€‰æ‹©å™¨&lt;/th&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Class&lt;/td&gt;
&lt;td&gt;&lt;code&gt;.warning&lt;/code&gt; &lt;code&gt;p.warning&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‰è€…é€‰æ‹©æ‰€æœ‰å±äº warning ç±»çš„å…ƒç´ ï¼Œåè€…é€‰æ‹©æ‰€æœ‰å±äº warning ç±»çš„på…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;id&lt;/td&gt;
&lt;td&gt;&lt;code&gt;#title&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹© id ä¸º title çš„å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;ä¸Šä¸‹æ–‡é€‰æ‹©å™¨&lt;/h1&gt;
&lt;p&gt;Contextual selectors (combinators) target elements based on their relationships to other elements in the document's tree hierarchy, and use the same parent, child, sibling, and descendant terminology.&lt;/p&gt;
&lt;p&gt;ä¸Šä¸‹æ–‡é€‰æ‹©å™¨åŸºäºå…ƒç´ åœ¨ HTML æ–‡æ¡£ä¸­çš„ä¸Šä¸‹çº§æŒ‚ä½ æ¥é€‰æ‹©å…ƒç´ ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é€‰æ‹©å™¨&lt;/th&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;åä»£&lt;/td&gt;
&lt;td&gt;&lt;code&gt;#main li&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©ä¸€ä¸ªå…ƒç´ çš„åä»£å…ƒç´ ã€‚æ³¨æ„è¿™é‡Œä¸ä¸€å®šæ˜¯ç›´æ¥å­å…ƒç´ ï¼Œåä»£å³å¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç›¸é‚»å…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;code&gt;h2+p&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©ä¸€ä¸ªå…ƒç´ çš„ç›´æ¥ç›¸é‚»å…ƒç´ ï¼Œæ¯”å¦‚è¯´è¿™ä¸ªè¡¨è¾¾å¼åªé€‰æ‹© h2 çš„ç›´æ¥ç›¸é‚»å…ƒç´  p&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­å…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;code&gt;div&amp;gt;p&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©æ‰€æœ‰ç›´æ¥å­å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ‰€æœ‰ç›¸é‚»å…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;code&gt;h2~p&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©ä¸€ä¸ªå…ƒç´ çš„æ‰€æœ‰ç›¸é‚»å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;ä¼ªç±»é€‰æ‹©å™¨&lt;/h1&gt;
&lt;p&gt;ä¼ªç±»é€‰æ‹©å™¨åŸºäºæµè§ˆå™¨çŠ¶æ€æˆ–è€…æ–‡æ¡£ä¸­çš„ä½ç½®æ¥é€‰æ‹©å…ƒç´ ã€‚æµè§ˆå™¨åœ¨å¹•åä¿å­˜äº†å¥½å¤šçŠ¶æ€ï¼Œæ¯”å¦‚ä¸€ä¸ªé“¾æ¥æœ‰æ²¡æœ‰è¢«è®¿é—®è¿‡ï¼Œä¸€ä¸ªå…ƒç´ æœ‰æ²¡æœ‰è¢«é€‰ä¸­ï¼Œä¸€ä¸ªå…ƒç´ æ˜¯ä¸æ˜¯å®ƒè¿™ç§ç±»å‹çš„ç¬¬ä¸€ä¸ªæˆ–è€…æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç”šè‡³äºä¸€ä¸ªå…ƒç´ æ˜¯ä¸æ˜¯å®ƒçš„çˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰å¤„äºåŒä¸€ä¸ªçŠ¶æ€çš„å…ƒç´ è¢«çœ‹åšæ˜¯å±äºåŒä¸€ä¸ªä¼ªç±»ï¼Œå°½ç®¡åœ¨ HTML ä¸­å¹¶æ²¡æœ‰æ˜ç¡®å£°æ˜ç±»çš„åå­—ã€‚ä¼ªç±»æ ‡è¯†ç¬¦ç”¨å†’å· &lt;code&gt;:&lt;/code&gt; å¼€å¤´ï¼Œè€Œä¸”ä¸€èˆ¬æ˜¯å’Œå…ƒç´ åç§°æ”¾åœ¨ä¸€èµ·ç”¨çš„ã€‚&lt;/p&gt;
&lt;h2&gt;ç”¨ä½œé“¾æ¥å’Œç”¨æˆ·çŠ¶æ€çš„ä¼ªç±»&lt;/h2&gt;
&lt;p&gt;å½“ç»™ä¸€ä¸ªé“¾æ¥åº”ç”¨æ ·å¼çš„æ—¶å€™ï¼ŒæŒ‰ç…§ä¸‹é¢è¡¨ä¸­çš„é¡ºåºæ¥åˆ¶å®šæ ·å¼æ‰èƒ½è·å¾—é¢„æœŸæ•ˆæœã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é€‰æ‹©å™¨&lt;/th&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æœªè®¿é—®çš„é“¾æ¥&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:link&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©æœªè®¿é—®è¿‡çš„é“¾æ¥ï¼Œä¾‹å¦‚ &lt;code&gt;a:link&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è®¿é—®è¿‡çš„é“¾æ¥&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:visited&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©å·²ç»è®¿é—®è¿‡çš„é“¾æ¥ï¼Œä¾‹å¦‚ &lt;code&gt;a:visited&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç”¨æˆ·ç„¦ç‚¹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:focus&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©å½“å‰æ‹¥æœ‰ç”¨æˆ·å…‰æ ‡ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥çš„å…ƒç´ ï¼Œä¾‹å¦‚ &lt;code&gt;a:focus&lt;/code&gt; &lt;code&gt;input:focus&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ‚¬æµ®&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:hover&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©å½“å‰ç”¨æˆ·é¼ æ ‡æŒ‡é’ˆæ‚¬æµ®çš„å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¿€æ´»&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:active&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©å½“å‰ç”¨æˆ·æ­£åœ¨ç‚¹å‡»çš„å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;ç”¨äºé€‰æ‹©ç›¸é‚»å…ƒç´ çš„ä¼ªç±»&lt;/h2&gt;
&lt;p&gt;ä¸‹é¢çš„ 6 ä¸ªé€‰æ‹©å™¨ç”¨äºé€‰æ‹©æ‹¥æœ‰åŒä¸€ä¸ªçˆ¶èŠ‚ç‚¹çš„å…ƒç´ ä¸­ç¬¦åˆæŸç§æ¡ä»¶çš„å…ƒç´ ï¼Œç®—æ˜¯ä¸€ä¸ªæ–­è¨€ï¼ˆassertï¼‰å§ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é€‰æ‹©å™¨&lt;/th&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç¬¬ä¸€ä¸ªå…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;code&gt;:first-child&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœæŒ‡å®šçš„å…ƒç´ æ˜¯ä»–çš„çˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼Œé€‰æ‹©ç”Ÿæ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœ€åä¸€ä¸ªå…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;code&gt;:last-child&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœæŒ‡å®šçš„å…ƒç´ æ˜¯ä»–çš„çˆ¶å…ƒç´ çš„æœ€åä¸€ä¸ªå­å…ƒç´ ï¼Œé€‰æ‹©ç”Ÿæ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å”¯ä¸€å­å…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;code&gt;:only-child&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœæŒ‡å®šçš„å…ƒç´ æ˜¯ä»–çš„çˆ¶å…ƒç´ çš„å”¯ä¸€ä¸€ä¸ªå­å…ƒç´ ï¼Œé€‰æ‹©ç”Ÿæ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŒç±»å‹ç¬¬ä¸€ä¸ª&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:first-of-type&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœæŒ‡å®šçš„å…ƒç´ æ˜¯ä»–çš„çˆ¶å…ƒç´ çš„å­å…ƒç´ ä¸­åŒç±»å‹çš„ç¬¬ä¸€ä¸ªï¼Œé€‰æ‹©ç”Ÿæ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŒç±»å‹æœ€åä¸€ä¸ª&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:last-of-type&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœæŒ‡å®šçš„å…ƒç´ æ˜¯ä»–çš„çˆ¶å…ƒç´ çš„å­å…ƒç´ ä¸­åŒç±»å‹çš„æœ€åä¸€ä¸ªï¼Œé€‰æ‹©ç”Ÿæ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŒç±»å‹å”¯ä¸€ä¸€ä¸ª&lt;/td&gt;
&lt;td&gt;&lt;code&gt;:only-of-type&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¦‚æœæŒ‡å®šçš„å…ƒç´ æ˜¯ä»–çš„çˆ¶å…ƒç´ çš„å­å…ƒç´ ä¸­åŒç±»å‹çš„å”¯ä¸€ä¸€ä¸ªï¼Œé€‰æ‹©ç”Ÿæ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;éšç€å…ƒç´ å’Œ DOM æ ‘çš„æ›´æ–°ï¼Œè¿™äº›ä¼ªç±»èƒ½å¤Ÿåº”ç”¨çš„å…ƒç´ éƒ½æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚&lt;/p&gt;
&lt;h2&gt;CSS3 ä¸­çš„ç»“æ„ç›¸å…³ä¼ªç±»&lt;/h2&gt;
&lt;p&gt;CSS3 æä¾›äº†æ›´çµæ´»çš„é€‰æ‹©æ–¹å¼ï¼Œå¯ä»¥æ ¹æ®å…ƒç´ åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®é€‰æ‹©ä¸€ç³»åˆ—çš„å…ƒç´ ã€‚è¿™äº›é€‰æ‹©å™¨è¿˜å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;:nth-child(n)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çˆ¶å…ƒç´ çš„ç¬¬ n ä¸ªå­å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;:nth-last-child(n)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çˆ¶å…ƒç´ çš„å€’æ•°ç¬¬ n ä¸ªå­å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;:nth-of-type(n)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çˆ¶ç±»å‹å­å…ƒç´ ä¸­ï¼ŒåŒç±»å‹ä¸­çš„ç¬¬ n ä¸ª&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;:nth-last-of-type(n)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;çˆ¶ç±»å‹å­å…ƒç´ ä¸­ï¼ŒåŒç±»å‹ä¸­çš„å€’æ•°ç¬¬ n ä¸ª&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å…¶ä¸­çš„ n çš„å–å€¼å¾€å¾€å–å¦‚ä¸‹å‡ ç§&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å€¼&lt;/th&gt;
&lt;th&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;odd&lt;/code&gt; &lt;code&gt;2n+1&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¥‡æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;even&lt;/code&gt; &lt;code&gt;2n&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¶æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;2&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç¬¬äºŒä¸ª&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;ä¼ªå…ƒç´ é€‰æ‹©å™¨&lt;/h1&gt;
&lt;p&gt;ä¼ªå…ƒç´ é€‰æ‹©å™¨è®©ä½ èƒ½å¤Ÿç»™è™šæ„çš„å…ƒç´ å¢åŠ æ ·å¼ï¼Œè€Œä¸ç”¨åœ¨ HTML ä¸­çœŸçš„åˆ›å»ºä»–ä»¬ã€‚&lt;code&gt;::first-letter&lt;/code&gt; å’Œ &lt;code&gt;::first-line&lt;/code&gt; é€‰æ‹©äº†æ–‡æœ¬çš„ä¸€éƒ¨åˆ†ä»è€Œé¿å…äº†ä½¿ç”¨ &lt;code&gt;span&lt;/code&gt; å…ƒç´ ã€‚ &lt;code&gt;::before&lt;/code&gt; å’Œ &lt;code&gt;::after&lt;/code&gt; é€‰æ‹©å™¨ç”¨æ¥åœ¨å¹¶ä¸å­˜åœ¨çš„åœ°æ–¹åŠ¨æ€æ’å…¥æ–‡æœ¬ã€‚&lt;/p&gt;
&lt;p&gt;CSS3 uses a double colon for pseudo-elements. To provide backward compatibility for older browsers, omit one of the colons that precede the pseudo-elements (ie :first-letter)&lt;/p&gt;
&lt;p&gt;CSS3 ä½¿ç”¨ä¸¤ä¸ªå†’å·æ¥è¡¨ç¤ºä¼ªå…ƒç´ ã€‚ä¸ºäº†å…¼å®¹è€æµè§ˆå™¨ï¼Œå¯ä»¥çœç•¥ä¸€ä¸ªå†’å·ï¼ˆä¹Ÿå°±æ˜¯ &lt;code&gt;:first-letter&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é€‰æ‹©å™¨&lt;/th&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ç¬¬ä¸€ä¸ªå­—æ¯&lt;/td&gt;
&lt;td&gt;&lt;code&gt;::first-letter&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªå­—æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœ€åä¸€ä¸ªå…ƒç´ &lt;/td&gt;
&lt;td&gt;&lt;code&gt;::first-line&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¹‹å‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;::before&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©æŒ‡å®šå…ƒç´ ä¹‹å‰ç”Ÿæˆçš„ä¸€ä¸ªä¼ªå…ƒç´ ï¼Œå’Œå…ƒç´ æ˜¯ç›¸é‚»å…³ç³»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¹‹å&lt;/td&gt;
&lt;td&gt;&lt;code&gt;::after&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©æŒ‡å®šå…ƒç´ ä¹‹åç”Ÿæˆçš„ä¸€ä¸ªä¼ªå…ƒç´ ï¼Œå’Œå…ƒç´ æ˜¯ç›¸é‚»å…³ç³»&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;å±æ€§é€‰æ‹©å™¨&lt;/h1&gt;
&lt;p&gt;å±æ€§é€‰æ‹©å™¨åŸºäºå…ƒç´ æ—¶å€™æœ‰æŸä¸ªç‰¹å®šçš„å±æ€§è€Œå®šã€‚ä¸‹é¢çš„ 7 ä¸­é€‰æ‹©å™¨ä¸­ï¼Œåé¢ 3 ä¸­æ˜¯ CSS3 ä¸­æ–°å®šä¹‰çš„ï¼Œæµè§ˆå™¨ä»¬å¯èƒ½è¿˜æ²¡æœ‰å®Œå…¨æ”¯æŒã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é€‰æ‹©å™¨&lt;/th&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å­˜åœ¨&lt;/td&gt;
&lt;td&gt;&lt;code&gt;E[attr]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©åŒ…å«æŸä¸ªå±æ€§çš„å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç›¸ç­‰&lt;/td&gt;
&lt;td&gt;&lt;code&gt;E[attr='val']&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€‰æ‹©æŸä¸ªå±æ€§çš„å€¼ç­‰äº &lt;code&gt;xxx&lt;/code&gt; çš„å…ƒç´ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŒ…å«&lt;/td&gt;
&lt;td&gt;&lt;code&gt;E[attr~='val']&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¾ˆé¸¡è‚‹ï¼ŒæŠŠæŸä¸ªå…ƒç´ çš„å€¼æŒ‰ç©ºæ ¼åˆ†éš”ï¼Œå¦‚æœåŒ…å«ç»™å®šçš„å€¼ï¼Œé€‰ä¸­ã€‚ä¼˜ç‚¹ç±»ä¼¼äºç±»çš„åˆ†éš”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¼€å¤´&lt;/td&gt;
&lt;td&gt;&lt;code&gt;E[attr\|='val']&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¾ˆé¸¡è‚‹ï¼ŒæŸä¸ªå±æ€§çš„å€¼ä»¥ç»™å®šçš„å€¼ + &lt;code&gt;-&lt;/code&gt; å¼€å¤´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¼€å¤´&lt;/td&gt;
&lt;td&gt;&lt;code&gt;E[attr^='val']&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŸä¸ªå±æ€§çš„å€¼ä»¥ç»™å®šçš„å€¼å¼€å¤´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç»“å°¾&lt;/td&gt;
&lt;td&gt;&lt;code&gt;E[attr$='val']&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŸä¸ªå±æ€§çš„å€¼ä»¥ç»™å®šçš„å€¼ç»“å°¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åŒ…å«&lt;/td&gt;
&lt;td&gt;&lt;code&gt;E[attr*='val']&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æŸä¸ªå±æ€§çš„å€¼åŒ…å«ç»™å®šçš„å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 11 Apr 2018 09:51:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-11:/posts/yi-css-xuan-ze-qi-bei-wang-lu-cheatsheet.html</guid><category>CSS</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>mysql åŸºç¡€çŸ¥è¯†(6) - Join</title><link>/posts/mysql-ji-chu-zhi-shi-6-join.html</link><description>&lt;p&gt;çœ‹åˆ°ç½‘ä¸Š&lt;a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/"&gt;æœ‰ç¯‡æ–‡ç« &lt;/a&gt;ç”¨éŸ¦æ©å›¾æ¥è®²è§£äº†ä¸€ä¸‹ SQL çš„ join æ“ä½œï¼Œä½†æ˜¯æ„Ÿè§‰ä¸¾çš„ä¾‹å­ä¼¼ä¹ä¸å¤ªå®é™…ï¼Œé‚è‡ªå·±å†™äº†ä¸€ç¯‡ï¼Œå›¾æ˜¯ä»é‚£ç¯‡æ–‡ç« é‡Œé¢ç›—çš„ï¼ˆé€ƒ&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æœ‰ä¸‹é¢ä¸¤å¼ è¡¨ï¼Œä¸Šè¾¹çš„æ˜¯è¡¨ userï¼Œä¸‹è¾¹çš„æ˜¯ packageï¼Œè¡¨ç¤ºæ¯ä¸ªç”¨æˆ·å¯¹åº”çš„åŒ…è£¹&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Luke&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Leia&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;Anakin&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;Padem&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;content&lt;/th&gt;
&lt;th&gt;user_id&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;droid&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;lightsaber&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;blaster&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;R2D2&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;åˆ›å»ºè¿™ä¸¤ä¸ªè¡¨çš„è¯­å¥åˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;create table user (id integer, name string);
create table package (id integer, content string, user_id integer);
insert into user (id, name) values (1, &amp;#39;Luke&amp;#39;);
insert into user (id, name) values (2, &amp;#39;Leia&amp;#39;);
insert into user (id, name) values (3, &amp;#39;Anakin&amp;#39;);
insert into user (id, name) values (4, &amp;#39;Padme&amp;#39;);
insert into package (id, content, user_id) values (1, &amp;#39;droid&amp;#39;, 3);
insert into package (id, content, user_id) values (2, &amp;#39;lightsaber&amp;#39;, 2);
insert into package (id, content, user_id) values (3, &amp;#39;blaster&amp;#39;, 1);
insert into package (id, content, user_id) values (4, &amp;#39;R2D2&amp;#39;, 5);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Veen diagramï¼ˆéŸ¦æ©å›¾ï¼‰æ˜¯ä¸€ç§è¡¨ç¤ºé›†åˆçš„å›¾å½¢è¯­è¨€ã€‚SQL çš„ join æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä»é›†åˆè®ºé‡Œé¢æ¥çš„ï¼Œå¯ä»¥ä»é›†åˆè®ºçš„è§’åº¦æ¥å­¦ä¹ å’Œè®°å¿† Join çš„è¯­æ³•ã€‚&lt;/p&gt;
&lt;h1&gt;Inner Join&lt;/h1&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬è¦é€‰å‡ºæ¯ä¸ªæœ‰åŒ…è£¹çš„äººï¼Œä»¥åŠå¯¹åº”çš„åŒ…è£¹ï¼Œå¯ä»¥ä½¿ç”¨ inner joinã€‚å†…è¿æ¥ï¼ˆinner joinï¼‰è®¡ç®—çš„æ˜¯ä¸¤ä¸ªè¡¨çš„äº¤é›†ï¼Œä¹Ÿå°±æ˜¯ &lt;code&gt;A âˆ© B&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select
user.id, user.name, package.id, package.content 
from
user inner join package
on user.id == package.user_id;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="https://blog.codinghorror.com/content/images/uploads/2007/10/6a0120a85dcdae970b012877702708970c-pi.png"&gt;&lt;/p&gt;
&lt;p&gt;ç»“æœä¸€å…±æœ‰3åˆ—ï¼Œæ¯ä¸ªè¡¨ä¸­çš„ç¬¬å››åˆ—éƒ½å› ä¸ºåœ¨å¯¹æ–¹è¡¨ä¸­æ²¡æœ‰è€Œæ²¡æœ‰å‡ºç°åœ¨ç»“æœé‡Œã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;id          name        id          content
----------  ----------  ----------  ----------
1           Luke        3           blaster
2           Leia        2           lightsaber
3           Anakin      1           droid
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Full Outer Join&lt;/h1&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬æƒ³è¦é€‰å‡ºæ‰€æœ‰çš„ä»»ä½•åŒ…è£¹çš„å¯¹åº”å…³ç³»ï¼Œå“ªæ€•æ˜¯å¯¹åº”å¾—äººæˆ–è€…åŒ…è£¹ä¸å­˜åœ¨çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ full outer joinã€‚å…¨è¿æ¥è®¡ç®—çš„æ˜¯ä¸¤ä¸ªè¡¨çš„å¹¶é›†ï¼Œä¹Ÿå°±æ˜¯ &lt;code&gt;A âˆª B&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select
user.id, user.name, package.id, package.content
from
user full outer join package
on user.id == package.user_id;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="https://blog.codinghorror.com/content/images/uploads/2007/10/6a0120a85dcdae970b012877702725970c-pi.png"&gt;&lt;/p&gt;
&lt;p&gt;ç»“æœä¸€å…±æœ‰6åˆ—ï¼Œæ³¨æ„å…¶ä¸­ç¼ºå­—æ®µçš„åœ°æ–¹è¢«è¡¥ä¸Šäº† nullã€‚å¦å¤– SQLite ä¸æ”¯æŒ full outer joinã€‚æ„Ÿè§‰è¿™ä¸ª Join ä¼¼ä¹ç”¨çš„ä¸æ˜¯å¤ªå¤šï¼Œå› ä¸ºå®é™…æƒ…å†µä¸­ï¼Œå¾€å¾€ package.user_id æ˜¯ user.id çš„å¤–é”®ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç° user_id ä¸å­˜åœ¨çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;// ç»“æœçœç•¥
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Left Outer Join&lt;/h1&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬è¦å–å‡ºæ¯ä¸ªäººçš„åŒ…è£¹æƒ…å†µï¼Œæ²¡æœ‰åŒ…è£¹çš„ä¹Ÿå†™ä¸Š nullï¼Œé‚£ä¹ˆè¿™ç”¨æƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨ left outer joinã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select
user.id, user.name, package.id, package.content
from
user left outer join package
on user.id == package.user_id;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="" src="https://blog.codinghorror.com/content/images/uploads/2007/10/6a0120a85dcdae970b01287770273e970c-pi.png"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;id          name        id          content
----------  ----------  ----------  ----------
1           Luke        3           blaster
2           Leia        2           lightsaber
3           Anakin      1           droid
4           Padme       NULL        NULL
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Cross Join&lt;/h1&gt;
&lt;p&gt;è¦è·å¾—Aè¡¨å’ŒBè¡¨å·¦å³å¯èƒ½çš„äº¤å‰ç»„åˆçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ cross joinï¼Œä¹Ÿå°±æ˜¯ç¬›å¡å°”ä¹˜ç§¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select
user.id, user.name, package.id, package.content
from
user cross join package;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç»“æœå¦‚ä¸‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;id          name        id          content
----------  ----------  ----------  ----------
1           Luke        1           droid
1           Luke        2           lightsaber
1           Luke        3           blaster
1           Luke        4           R2D2
2           Leia        1           droid
2           Leia        2           lightsaber
2           Leia        3           blaster
2           Leia        4           R2D2
3           Anakin      1           droid
3           Anakin      2           lightsaber
3           Anakin      3           blaster
3           Anakin      4           R2D2
4           Padme       1           droid
4           Padme       2           lightsaber
4           Padme       3           blaster
4           Padme       4           R2D2
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 11 Apr 2018 02:16:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-11:/posts/mysql-ji-chu-zhi-shi-6-join.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>Go è¯­è¨€å’Œçˆ¬è™«</title><link>/posts/go-yu-yan-he-pa-chong.html</link><description>&lt;h1&gt;çˆ¬è™«çš„ç®—æ³•&lt;/h1&gt;
&lt;h2&gt;å¹¿åº¦éå†&lt;/h2&gt;
&lt;p&gt;å¦‚æœæŠŠæ¯ä¸€ä¸ªé¡µé¢çœ‹åšä¸€ä¸ªèŠ‚ç‚¹ï¼ŒæŠŠæ¯ä¸ªé“¾æ¥çœ‹åšä¸€ä¸ªæœ‰å‘è¾¹ï¼Œé‚£ä¹ˆç½‘é¡µä¹‹é—´å°±æ„æˆäº†ä¸€ä¸ªæœ‰å‘å›¾ã€‚çˆ¬è™«çš„æ ¸å¿ƒå°±æ˜¯å¯¹è¿™ä¸ªå›¾åšä¸€ä¸ªå¹¿åº¦ä¼˜å…ˆçš„éå†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;func breadthFirst(visit func(item, string) []string, worklist []string) {
    seen := make(map[string]bool)
    for len(worklist) &amp;gt; 0 {
        items := worklist
        worklist = nil
        for _, items := range items {
            if !seen[item] {
                seen[item] = true
                worklist = append(worklist, visit(item)...)
            }
        }
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ç»ˆæ­¢æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸€ä¸ªæœ‰é™çš„å›¾ï¼Œé‚£ä¹ˆç”¨å¹¿åº¦éå†ä¸€å®šå¯ä»¥åœä¸‹æ¥ã€‚ä½†æ˜¯å¯¹äºäº’è”ç½‘æ¥è¯´ï¼Œç”šè‡³äºå¯¹äºæŸä¸ªç½‘ç«™æ¥è¯´ï¼Œé¡µé¢çš„æ•°é‡éƒ½å¯èƒ½æ˜¯æ— é™çš„ï¼Œæˆ–è€…è¯´æ²¡å¿…è¦çˆ¬éæ‰€æœ‰é¡µé¢ã€‚é‚£ä¹ˆéœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªé™åˆ¶æ¡ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¾¹ç•Œé™åˆ¶ï¼Œæ¯”å¦‚è¯´é™å®šä¸‹çˆ¬å»çš„åŸŸå&lt;/li&gt;
&lt;li&gt;æ·±åº¦ï¼Œæ¯”å¦‚è¯´é™å®šä¸‹çˆ¬å–çš„æ·±åº¦&lt;/li&gt;
&lt;li&gt;å¹¶å‘ï¼Œæ¯”å¦‚è¯´å¼€å¤šå°‘ä¸ªgoroutineï¼Ÿä»¥åŠå¦‚ä½•æ§åˆ¶å¹¶å‘&lt;/li&gt;
&lt;li&gt;å¦‚ä½•ç»ˆæ­¢ï¼Œç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œé™åˆ¶æŠ“å–çš„æ·±åº¦è¿˜æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;li&gt;ç­‰å¾…æ‰€æœ‰è¿›ç¨‹ç»ˆæ­¢ï¼Œå½“ç¨‹åºé€€å‡ºçš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰ wait å­è¿‡ç¨‹é€€å‡º&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;æŠ½å–æ•°æ®&lt;/h1&gt;
&lt;h2&gt;ä½¿ç”¨ CSS å®šä½å…ƒç´ ï¼Œè€Œä¸æ˜¯ XPath&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰è¿˜åœ¨ç”¨ Python å†™çˆ¬è™«çš„æ—¶å€™å–œæ¬¢ç”¨ XPathï¼Œä¸»è¦æ˜¯é€‰æ‹©è·¯å¾„æ¯” CSS è¡¨è¾¾å¼çœ‹èµ·æ¥æ›´æ¸…æ™°ï¼Œè€Œä¸” Python æœ‰ä¸€ä¸ªå¼ºå¤§çš„ lxml åº“ï¼Œå¯¹äº xpath çš„æ“ä½œéå¸¸ä¾¿æ·ã€‚ä¸è¿‡ä¹Ÿæœ‰äº›ç¼ºç‚¹ï¼Œxpath çš„åå¤„å°±æ˜¯æ²¡æœ‰åŠæ³•æŒ‰ç…§ç±»é€‰æ‹©ï¼Œè€Œåªèƒ½æŒ‰ç…§ class å½“åšä¸€ä¸ªå±æ€§æ¥é€‰æ‹©ã€‚è€Œç°åœ¨çš„å¸ƒå±€ä¹‹ç±»çš„å¥½å¤šéƒ½æ˜¯æŒ‰ç…§ç±»æ¥çš„ï¼Œæ‰€ä»¥å¯èƒ½è¿˜æ˜¯ä½¿ç”¨ CSS è¡¨è¾¾å¼æ¯”è¾ƒå¥½ã€‚ä¸¾ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;title col-sm-6&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Hello World&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¯”å¦‚è¯´ç½‘ç«™é‡‡ç”¨äº†ä¸Šé¢çš„æ ‡ç­¾æ¥è¡¨ç¤ºæ ‡é¢˜ï¼Œå…¶ä¸­çš„&lt;code&gt;col-sm-6&lt;/code&gt;å¯èƒ½æ˜¯ç”¨äºé¡µé¢å¸ƒå±€çš„ä¸€ä¸ªç±»ï¼Œå¾ˆæœ‰å¯èƒ½ç»å¸¸æ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦æŒ‰ç…§ title è¿™ä¸ªå±æ€§æ¥å®šä½è¿™ä¸ªå…ƒç´ ï¼Œå¦‚æœä½¿ç”¨ xpath çš„è¯ï¼Œéœ€è¦è¿™æ ·å†™ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;//div[contains(concat(&amp;#39; &amp;#39;, normalize-space(@class), &amp;#39; &amp;#39;), &amp;#39; title &amp;#39;)]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è€Œ CSS å¤©ç”Ÿå°±æ˜¯ä¸ºäº†å¸ƒå±€è€Œç”Ÿçš„ï¼Œæ‰€ä»¥è¦é€‰æ‹©è¿™ä¸ªå…ƒç´ ï¼Œç›´æ¥è¿™æ ·å°±å¯ä»¥äº†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;.title&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“ç„¶ CSS ä¹Ÿæœ‰ä¸€äº›ä¸æ–¹ä¾¿çš„æ—¶å€™ï¼Œæ¯”å¦‚ XPath ä½¿ç”¨ &lt;code&gt;//nav/span[2]&lt;/code&gt; å°±èƒ½è¡¨è¾¾æ¸…æ¥šçš„é€»è¾‘ï¼ŒCSS éœ€è¦ä½¿ç”¨ &lt;code&gt;nav&amp;gt;span:nth-child(2)&lt;/code&gt;ã€‚ç•¥æ˜¾é•¿ï¼Œä½†æ˜¯è¿˜å¥½ä¸åƒ XPath è¡¨è¾¾ç±»ï¼ˆclassï¼‰çš„æ—¶å€™é‚£ä¹ˆ trickã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼ŒXPath ä¸å…‰å¯ä»¥é€‰æ‹©å…ƒç´ ï¼Œè¿˜å¯ä»¥é€‰æ‹©å±æ€§ï¼Œæ¯”å¦‚ &lt;code&gt;//a/@href&lt;/code&gt;ï¼Œå¯ä»¥ç›´æ¥æ‹¿åˆ°&lt;code&gt;a&lt;/code&gt; çš„é“¾æ¥ï¼Œè€ŒCSSåˆ™åªèƒ½é€‰æ‹©æ ‡ç­¾ã€‚&lt;/p&gt;
&lt;h2&gt;goquery&lt;/h2&gt;
&lt;p&gt;åœ¨ Go è¯­è¨€ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ goquery æ¥é€‰å–å…ƒç´ ï¼Œä»–å®ç°äº†ç±»ä¼¼äº jQuery çš„è¯­æ³•ã€‚&lt;/p&gt;
&lt;p&gt;goquery æä¾›äº†ä¸¤ä¸ªç±»å‹ï¼ŒDocument å’Œ Selectorï¼Œä¸»è¦é€šè¿‡è¿™ä¸¤ä¸ªå¯¹è±¡çš„æ–¹æ³•æ¥é€‰æ‹©å…ƒç´ ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;type Document struct {
    *Selection
    Url *url.URL
    rootNode *html.Node // æ–‡æ¡£çš„æ ¹èŠ‚ç‚¹
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Document å†…åµŒäº† Selectionï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨Selection çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;type Selection struct {
    Nodes []*html.Node
    document *Document
    prevSel *Selection
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ Selection çš„ä¸å°‘æ–¹æ³•éƒ½æ˜¯å’Œ jQuery ä¸­ç±»ä¼¼çš„ï¼Œå†æ¬¡ä¸å†èµ˜è¿°ï¼Œåªåˆ—å‡ºæ¥å¯èƒ½å’ŒæŠ“å–ç›¸å…³çš„ä¸€äº›å‡½æ•°ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç”Ÿæˆæ–‡æ¡£&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;NewDocumentFromNode(root *html.Node) *Document&lt;/code&gt;: ä¼ å…¥ *html.Node å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æ ¹èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NewDocument(url string) (*Document, error)&lt;/code&gt;: ä¼ å…¥ URLï¼Œå†…éƒ¨ç”¨ http.Get è·å–ç½‘é¡µã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NewDocumentFromReader(r io.Reader) (*Document, error)&lt;/code&gt;: ä¼ å…¥ io.Readerï¼Œå†…éƒ¨ä» reader ä¸­è¯»å–å†…å®¹å¹¶è§£æã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NewDocumentFromResponse(res *http.Response) (*Document, error)&lt;/code&gt;: ä¼ å…¥ HTTP å“åº”ï¼Œå†…éƒ¨æ‹¿åˆ° res.Body(å®ç°äº† io.Reader) åçš„å¤„ç†æ–¹å¼ç±»ä¼¼ NewDocumentFromReader.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥æ‰¾èŠ‚ç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Find()&lt;/code&gt; æ ¹æ® CSS æŸ¥æ‰¾èŠ‚ç‚¹&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¾ªç¯éå†é€‰æ‹©çš„èŠ‚ç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Each(f func(int, *Selection)) *Selection&lt;/code&gt;: å…¶ä¸­å‡½æ•° f çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å½“å‰çš„ä¸‹æ ‡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“å‰çš„èŠ‚ç‚¹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;EachWithBreak(f func(int, *Selection) bool) *Selection&lt;/code&gt;: å’Œ Each ç±»ä¼¼ï¼Œå¢åŠ äº†ä¸­é€”è·³å‡ºå¾ªç¯çš„èƒ½åŠ›ï¼Œå½“ f è¿”å› false æ—¶ç»“æŸè¿­ä»£&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Map(f func(int, *Selection) string) (result []string)&lt;/code&gt;: f çš„å‚æ•°ä¸ä¸Šé¢ä¸€æ ·ï¼Œè¿”å›ä¸€ä¸ª string ç±»å‹ï¼Œæœ€ç»ˆè¿”å› []string.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è·å–èŠ‚ç‚¹çš„å±æ€§æˆ–è€…å†…å®¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Attr()&lt;/code&gt;: è·å¾—æŸä¸ªå±æ€§çš„å€¼&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Html()&lt;/code&gt;: è·å¾—å½“å‰èŠ‚ç‚¹çš„ html&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Length()&lt;/code&gt;: &lt;/li&gt;
&lt;li&gt;&lt;code&gt;Text()&lt;/code&gt;:&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ï¼ˆæœªå®Œå¾…ç»­ï¼‰&lt;/p&gt;
&lt;h1&gt;ref&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;http://liyangliang.me/posts/2016/03/zhihu-go-insight-parsing-html-with-goquery/&lt;/li&gt;
&lt;li&gt;http://blog.studygolang.com/2015/04/go-jquery-goquery/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 09 Apr 2018 08:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-09:/posts/go-yu-yan-he-pa-chong.html</guid><category>golang</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>mysql åŸºç¡€çŸ¥è¯†(5) - èšåˆè¯­å¥(group by)</title><link>/posts/mysql-ji-chu-zhi-shi-5-ju-he-yu-ju-group-by.html</link><description>&lt;p&gt;&lt;code&gt;Group by&lt;/code&gt; ç”¨æ¥æŒ‰ç…§æŸä¸€åˆ—æˆ–è€…æŸå‡ åˆ—çš„å€¼èšåˆæ•°æ®ã€‚&lt;code&gt;group by x&lt;/code&gt; æŒ‰ç…§ x ç›¸åŒçš„å€¼èšåˆï¼Œ&lt;code&gt;group by x, y&lt;/code&gt; æŒ‰ç…§ x å’Œ y éƒ½ç›¸åŒçš„å€¼èšåˆã€‚è€ŒæŸ¥è¯¢çš„åˆ—è¦ä¹ˆæ˜¯èšåˆçš„åˆ—ï¼Œè¦ä¹ˆåº”è¯¥é€šè¿‡èšåˆå‡½æ•°æ¥é€‰å–ä¸€åˆ—ã€‚è€Œä¸”æ‰€æœ‰çš„ null ä¼šè¢«èšåˆæˆä¸€è¡Œ&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ä¸‹é¢çš„æ•°æ®è¡¨ä¸­&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://daks2k3a4ib2z.cloudfront.net/589e47d231ee752554896f1f/58dc686fb5bd4cf41639ef71_Screen%20Shot%202017-03-29%20at%207.07.17%20PM.png"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- How many countries are in each continent?
select
  continent
  , count(*)
from 
  countries
group by 
  continent
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‰§è¡ŒæŸ¥è¯¢å¯ä»¥å¾—åˆ°æ¯ä¸ªæ´²çš„å›½å®¶çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;h1&gt;è¿‡æ»¤&lt;/h1&gt;
&lt;p&gt;åœ¨ SQL ä¸­ï¼ŒWhere å­å¥æ˜¯åœ¨ group å­å¥ä¹‹å‰è¿è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•é€šè¿‡ where æ¥è¿‡æ»¤ group ä¹‹åçš„ç»“æœï¼Œè€Œåº”è¯¥ä½¿ç”¨ having å­å¥æ¥è¿‡æ»¤ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select
 continent
  , max(area)
from 
  countries
group by 
  1
having
  max(area) &amp;gt;= 1e7
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;éšå¼èšåˆ&lt;/h1&gt;
&lt;p&gt;å½“ä½ æ²¡æœ‰ä½¿ç”¨ &lt;code&gt;group by&lt;/code&gt;ï¼Œè€Œä½¿ç”¨äº† maxã€minã€count ç­‰èšåˆå‡½æ•°çš„æ—¶å€™å·²ç»åœ¨èšåˆäº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- What is the largest and average country size in Europe?
select
  max(area) as largest_country
  , avg(area) as avg_country_area
from 
  countries
where 
  continent = &amp;#39;Europe&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;MySQL çš„ç‰¹æ®Šå¤„ç†&lt;/h1&gt;
&lt;p&gt;å¦‚æœåœ¨æŸ¥è¯¢ä¸­æœ‰æ²¡æœ‰èšåˆçš„åˆ—ï¼Œé‚£ä¹ˆ MySQL å°±ä¼šéšæœºé€‰å–ä¸€ä¸ªåˆ—ï¼Œæ¯”å¦‚ä¸‹é¢å°±ä¼šéšæœºé€‰å–ä¸€ä¸ªå·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select 
  country
  , state
  , count(*)
from
  countries
group by 
  country
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;ref&lt;/h1&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« ä¸»è¦å‚è€ƒè¿™é‡Œï¼šhttps://www.periscopedata.com/blog/everything-about-group-by&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 09 Apr 2018 01:48:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-09:/posts/mysql-ji-chu-zhi-shi-5-ju-he-yu-ju-group-by.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>å®Œå…¨ç†è§£ SQL çš„å†…åœ¨é€»è¾‘</title><link>/posts/wan-quan-li-jie-sql-de-nei-zai-luo-ji.html</link><description>&lt;p&gt;å¤ªå¤šçš„ç¨‹åºå‘˜è®¤ä¸ºSQLåƒæ˜¯æ´ªæ°´çŒ›å…½ä¸€æ ·ã€‚å®ƒæ˜¯å°‘æœ‰çš„å‡ ç§å£°æ˜å¼çš„è¯­è¨€ï¼Œå’Œå…¶ä»–çš„å‘½ä»¤ä¼¼çš„é¢å‘å¯¹è±¡çš„ç”šè‡³å‡½æ•°ä½¿å¾—è¯­è¨€å¤§ç›¸å¾„åº­ã€‚
æˆ‘æ¯å¤©éƒ½ä¼šå†™SQLè€Œä¸”åœ¨æˆ‘çš„å¼€æºé¡¹ç›®ä¸­å¤§é‡çš„ä½¿ç”¨SQLï¼Œå› æ­¤æˆ‘éå¸¸åœ°æƒ³è¦æŠŠSQLçš„ç¾å±•ç°ç»™ä½ ä»¬è¿™äº›è¿˜åœ¨æŒ£æ‰ç€ä½¿ç”¨å®ƒçš„æ¸£æ¸£ä»¬ã€‚ä¸‹é¢çš„æ•™ç¨‹é€‚åˆ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨è¿‡SQLä½†æ˜¯ä»æ¥æ²¡æœ‰å®Œå…¨ç†è§£ä»–çš„äºº&lt;/li&gt;
&lt;li&gt;å¾ˆäº†è§£SQLï¼Œä½†æ˜¯ä»æ¥æ²¡æœ‰æ€è€ƒè¿‡ä»–çš„è¯­æ³•çš„äºº&lt;/li&gt;
&lt;li&gt;æƒ³è¦æŠŠSQLäº¤ç»™å…¶ä»–äººçš„äºº&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™ä¸ªæ•™ç¨‹å°†ä¼šè¿™å…³æ³¨SELECTè¯­å¥ï¼Œå…¶ä»–çš„DMLå°†ä¼šåœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»&lt;/p&gt;
&lt;h1&gt;SQLæ˜¯å£°æ˜å¼çš„&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆè¦è®°ä½ï¼Œå£°æ˜å¼ã€‚å”¯ä¸€çš„ä¸€ç§èŒƒå¼å°±æ˜¯ä½ å¯ä»¥åªæ˜¯å£°æ˜ä½ æƒ³è¦çš„ç»“æœå°±å¾—åˆ°äº†ä»–ã€‚è€Œä¸æ˜¯å‘Šè¯‰ä½ çš„ç”µè„‘æ€æ ·å»æŠŠè¿™ä¸ªç»“æœè®¡ç®—å‡ºæ¥ï¼Œä¸é”™å§ï¼Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Select first_name, last_name FROM employees WHERE salary &amp;amp;gt; 100000
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¾ˆç®€å•ï¼Œä½ ä¸éœ€è¦å…³å¿ƒemployeeçš„è®°å½•æ˜¯å­˜åœ¨å“ªé‡Œçš„ï¼Œä½ åªæƒ³è¦çŸ¥é“é‚£äº›è–ªæ°´è¿˜ä¸é”™çš„äººã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æ­¤ç®€å•ï¼Œé‚£ä¹ˆé—®é¢˜åœ¨å“ªé‡Œå‘¢ï¼Ÿé—®é¢˜åœ¨äºæˆ‘ä»¬å¤§éƒ¨åˆ†æ—¶å€™æ˜¯åœ¨æŒ‰ç…§å‘½ä»¤å¼çš„ç¼–ç¨‹æ€ç»´åœ¨æ€è€ƒ,æ¯”å¦‚â€œæœºå™¨ï¼Œå¹²è¿™ä¸ªï¼Œç„¶åå¹²é‚£ä¸ªï¼Œä½†æ˜¯åœ¨è¿™ä¹‹å‰æ£€æŸ¥ä¸€ä¸‹ï¼Œå¦‚æœæ˜¯è¿™æ ·æˆ–è€…é‚£æ ·å°±ä¸è¡Œâ€ã€‚è¿™å…¶ä¸­åŒ…æ‹¬äº†å­˜å‚¨ä¸´æ—¶ç»“æœåœ¨å˜é‡é‡Œï¼Œå¾ªç¯ï¼Œè¿­ä»£ï¼Œè°ƒç”¨å‡½æ•°ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å¿˜æ‰é‚£äº›ä¸œè¥¿ï¼Œæ€è€ƒå¦‚ä½•å£°æ˜ä¸œè¥¿ï¼Œè€Œä¸æ˜¯å‘Šè¯‰æœºå™¨æ€æ ·å»è®¡ç®—ã€‚&lt;/p&gt;
&lt;h1&gt;SQLè¯­æ³•çš„é¡ºåºæœ‰äº›é—®é¢˜&lt;/h1&gt;
&lt;p&gt;å¸¸è§çš„æ··ä¹±çš„æ¥æºå¯èƒ½æ˜¯SQLè¯­æ³•å¹¶ä¸æ˜¯æŒ‰ä»–ä»¬çš„æ‰§è¡Œé¡ºåºæ¥æ’åºçš„ï¼Œè¯æ³•ï¼ˆLexicalï¼‰æ’åºæ˜¯&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;SELECT [DISTINCT]&lt;/li&gt;
&lt;li&gt;FROM&lt;/li&gt;
&lt;li&gt;WHERE&lt;/li&gt;
&lt;li&gt;GROUP BY&lt;/li&gt;
&lt;li&gt;HAVING&lt;/li&gt;
&lt;li&gt;UNION&lt;/li&gt;
&lt;li&gt;ORDER BY&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç®€æ´èµ·è§ï¼Œå¹¶æ²¡æœ‰åˆ—å‡ºæ‰€æœ‰è¯­å¥ï¼Œè€Œä»é€»è¾‘ä¸Šæ¥è¯´ï¼ŒçœŸæ­£çš„é€»è¾‘æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;FROM&lt;/strong&gt;ã€‚FROMåé¢çš„è¡¨æ ‡è¯†äº†è¿™æ¡è¯­å¥è¦æŸ¥è¯¢çš„æ•°æ®æºã€‚å’Œä¸€äº›å­å¥å¦‚ï¼Œï¼ˆ1-J1ï¼‰ç¬›å¡å°”ç§¯ï¼Œï¼ˆ1-J2ï¼‰ONè¿‡æ»¤ï¼Œï¼ˆ1-J3ï¼‰æ·»åŠ å¤–éƒ¨åˆ—ï¼Œæ‰€è¦åº”ç”¨çš„å¯¹è±¡ã€‚FROMè¿‡ç¨‹ä¹‹åä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿè¡¨VT1ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;(1-J1)ç¬›å¡å°”ç§¯&lt;/strong&gt; è¿™ä¸ªæ­¥éª¤ä¼šè®¡ç®—ä¸¤ä¸ªç›¸å…³è”è¡¨çš„ç¬›å¡å°”ç§¯(CROSS JOIN) ï¼Œç”Ÿæˆè™šæ‹Ÿè¡¨VT1-J1ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(1-J2)ONè¿‡æ»¤&lt;/strong&gt; è¿™ä¸ªæ­¥éª¤åŸºäºè™šæ‹Ÿè¡¨VT1-J1è¿™ä¸€ä¸ªè™šæ‹Ÿè¡¨è¿›è¡Œè¿‡æ»¤ï¼Œè¿‡æ»¤å‡ºæ‰€æœ‰æ»¡è¶³ON è°“è¯æ¡ä»¶çš„åˆ—ï¼Œç”Ÿæˆè™šæ‹Ÿè¡¨VT1-J2ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(1-J3)æ·»åŠ å¤–éƒ¨è¡Œ&lt;/strong&gt;  å¦‚æœä½¿ç”¨äº†å¤–è¿æ¥ï¼Œä¿ç•™è¡¨ä¸­çš„ä¸ç¬¦åˆONæ¡ä»¶çš„åˆ—ä¹Ÿä¼šè¢«åŠ å…¥åˆ°VT1-J2ä¸­ï¼Œä½œä¸ºå¤–éƒ¨è¡Œï¼Œç”Ÿæˆè™šæ‹Ÿè¡¨VT1-J3ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;WHERE&lt;/strong&gt; å¯¹VT1è¿‡ç¨‹ä¸­ç”Ÿæˆçš„ä¸´æ—¶è¡¨è¿›è¡Œè¿‡æ»¤ï¼Œæ»¡è¶³whereå­å¥çš„åˆ—è¢«æ’å…¥åˆ°VT2è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;GROUP BY&lt;/strong&gt; è¿™ä¸ªå­å¥ä¼šæŠŠVT2ä¸­ç”Ÿæˆçš„è¡¨æŒ‰ç…§GROUP BYä¸­çš„åˆ—è¿›è¡Œåˆ†ç»„ã€‚ç”ŸæˆVT3è¡¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;HAVING&lt;/strong&gt; è¿™ä¸ªå­å¥å¯¹VT3è¡¨ä¸­çš„ä¸åŒçš„ç»„è¿›è¡Œè¿‡æ»¤ï¼Œæ»¡è¶³HAVINGæ¡ä»¶çš„å­å¥è¢«åŠ å…¥åˆ°VT4è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SELECT&lt;/strong&gt; è¿™ä¸ªå­å¥å¯¹SELECTå­å¥ä¸­çš„å…ƒç´ è¿›è¡Œå¤„ç†ï¼Œç”ŸæˆVT5è¡¨ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;(5-1)è®¡ç®—è¡¨è¾¾å¼&lt;/strong&gt; è®¡ç®—SELECT å­å¥ä¸­çš„è¡¨è¾¾å¼ï¼Œç”ŸæˆVT5-1&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(5-2)DISTINCT&lt;/strong&gt; å¯»æ‰¾VT5-1ä¸­çš„é‡å¤åˆ—ï¼Œå¹¶åˆ æ‰ï¼Œç”ŸæˆVT5-2&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(5-3)TOP&lt;/strong&gt; ä»ORDER BYå­å¥å®šä¹‰çš„ç»“æœä¸­ï¼Œç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„åˆ—ã€‚ç”ŸæˆVT5-3è¡¨&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ORDER BY&lt;/strong&gt; ä»VT5-3ä¸­çš„è¡¨ä¸­ï¼Œæ ¹æ® ORDER BY å­å¥çš„æ¡ä»¶å¯¹ç»“æœè¿›è¡Œæ’åºï¼Œç”ŸæˆVC6è¡¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å½“ç„¶å¼ºå¤§çš„ SQL æ‰§è¡Œå¼•æ“åœ¨å®é™…æ‰§è¡Œè¿‡ç¨‹ç”¨ä¼šæœ‰å„ç§ä¼˜åŒ–ï¼Œä¸ä¸€å®šä¸¥æ ¼æŒ‰ç…§è¿™ä¸ªé¡ºåºæ¥ã€‚ä½†æ˜¯åœ¨å†™å’Œçœ‹ SQL çš„æ—¶å€™å¯ä»¥æŒ‰ç…§è¿™ä¸ªé€»è¾‘æ€è€ƒã€‚&lt;/p&gt;
&lt;h2&gt;ä¾‹å­&lt;/h2&gt;
&lt;p&gt;å¯ä»¥æ€è€ƒä¸€ä¸‹ä¸‹é¢è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SELECT C.customerid, COUNT(O.orderid) AS numorders
FROM dbo.Customers AS C
  LEFT OUTER JOIN dbo.Orders AS O
    ON C.customerid = O.customerid
WHERE C.city = &amp;#39;Madrid&amp;#39;
GROUP BY C.customerid
HAVING COUNT(O.orderid) &amp;lt; 3
ORDER BY numorders
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;SQLæ˜¯å…³äºè¡¨çš„ï¼ˆè€Œä¸æ˜¯åˆ—ï¼‰&lt;/h1&gt;
&lt;p&gt;å› ä¸ºè¯æ³•æ’åºå’Œé€»è¾‘æ’åºä¸Šçš„ä¸åŒï¼Œå¾ˆå¤šçš„åˆå­¦è€…è®¤ä¸ºåˆ—çš„å€¼æ˜¯SQLä¸­çš„ä¸€ç­‰å…¬æ°‘ï¼Œå®é™…ä¸Šï¼Œä¸æ˜¯ã€‚æœ€é‡è¦çš„æ˜¯è¡¨çš„å¼•ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FROM a,b
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¸ªè¯­å¥å®é™…ä¸Šæ˜¯ &lt;code&gt;a cross join b&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯ç¬›å¡å°”ä¹˜ç§¯ã€‚æ¯”å¦‚è¯´ï¼Œa ä¸­æœ‰3åˆ—3è¡Œæ•°æ®ï¼Œbä¸­æœ‰5åˆ—5è¡Œæ•°æ®ã€‚ä¸Šé¢çš„ä¸€å¥äº§ç”Ÿçš„ç»“æœæ˜¯ä¸€ä¸ª3+5=8åˆ—ï¼Œ3x5=15è¡Œçš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ï¼Œå°½é‡æ˜¾å¼ join çš„è¡¨ï¼Œè€Œä¸è¦ä½¿ç”¨é€—å·ã€‚&lt;/p&gt;
&lt;p&gt;SQL ä¸­è¡ç”Ÿçš„è¡¨å¯ä»¥çœ‹åšè¡¨çš„å˜é‡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- A derived table
FROM (SELECT * FROM author) a -- åè¾¹è¿™ä¸ªå˜é‡æ˜¯å¯é€‰çš„
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- Get authors&amp;#39; first and last names, and their age in days
SELECT first_name, last_name, age
FROM (
  SELECT first_name, last_name, current_date - date_of_birth age
  FROM author
)
-- If the age is greater than 10000 days
WHERE age &amp;gt; 10000
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨ MySQL 8.0 ä¸­è¿˜å¯ä»¥ä½¿ç”¨ with è¯­å¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;WITH a AS (
  SELECT first_name, last_name, current_date - date_of_birth age
  FROM author
)
SELECT *
FROM a
WHERE age &amp;gt; 10000
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;SQL ä¸­çš„ Select è¯­å¥åœ¨å…³ç³»ä»£æ•°ä¸­è¢«ç§°ä½œæŠ•å½±ï¼ˆprojectionï¼‰ã€‚ä¸€æ—¦ä½ ç”Ÿæˆäº†è¡¨çš„å¼•ç”¨ï¼Œç„¶åè¿‡æ»¤ï¼Œè½¬æ¢ï¼Œæ¥ç€ä½ å°±å¯ä»¥æŠŠå®ƒæŠ•å½±æˆå¦ä¸€ç§å½¢å¼ã€‚åœ¨ select è¯­å¥ä¸­ï¼Œä½ ç»ˆäºå¯ä»¥æŒ‰åˆ—æ“ä½œç”Ÿæˆçš„è¡¨äº†ã€‚ä¹Ÿå°±æ˜¯è¯´å…¶ä»–çš„è¯­å¥éƒ½æ˜¯æŒ‰è¡¨ï¼Œæˆ–è€…è¯´æŒ‰ç…§è¡Œæ“ä½œçš„ï¼Œåªæœ‰åˆ°äº† select è¯­å¥ä¸­ä½ æ‰å¯ä»¥æ“ä½œåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;æ‰§è¡Œå®Œäº† select è¯­å¥ä¹‹åï¼Œä½ å°±å¯ä»¥æ‰§è¡Œå…¶ä»–çš„é›†åˆæ’åºç­‰ç­‰æ“ä½œäº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;distinct åˆ é™¤é‡å¤çš„è¡Œ&lt;/li&gt;
&lt;li&gt;union æŠŠä¸¤ä¸ªæŸ¥è¯¢ç»„åˆèµ·æ¥ï¼Œå¹¶ä¸”åˆ é™¤é‡å¤çš„è¡Œ&lt;/li&gt;
&lt;li&gt;union all æŠŠä¸¤ä¸ªæŸ¥è¯¢ç»„åˆèµ·æ¥ï¼Œå¹¶ä¸”ä¸åˆ é™¤é‡å¤&lt;/li&gt;
&lt;li&gt;except åšå·®é›†å¹¶ä¸”åˆ é™¤é‡å¤çš„è¡Œ&lt;/li&gt;
&lt;li&gt;intersect æ±‚äº¤é›†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ORDER BY æ’åº&lt;/p&gt;
&lt;p&gt;Refï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://web.archive.org/web/20150424213133/http://tech.pro:80/tutorial/1555/10-easy-steps-to-a-complete-understanding-of-sql&lt;/li&gt;
&lt;li&gt;http://www.cnblogs.com/myprogram/archive/2013/01/24/2874666.html&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 08 Apr 2018 14:44:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-08:/posts/wan-quan-li-jie-sql-de-nei-zai-luo-ji.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>è·³è¡¨ï¼ˆskiplistï¼‰</title><link>/posts/tiao-biao-skiplist.html</link><description>&lt;p&gt;å¹³è¡¡äºŒå‰æ ‘å¯ä»¥å®ç° O(logn) çš„æŸ¥æ‰¾å¤æ‚åº¦ã€‚è·³è¡¨å¯ä»¥å®ç°ç›¸å½“äºå¹³è¡¡äºŒå‰æ ‘çš„å¤æ‚åº¦æŸ¥è¯¢æ•°æ®ï¼Œè€Œä»£ç å®ç°æ¯”è¾ƒç®€å•ã€‚åœ¨ Redis ä¸­ï¼Œzset å°±ç”¨åˆ°äº† skiplistã€‚&lt;/p&gt;
&lt;p&gt;è·³è¡¨æ˜¯ç”¨&lt;strong&gt;å¹¶è¿çš„é“¾è¡¨&lt;/strong&gt;æ¥å®ç°çš„æŸ¥è¯¢ç»“æ„&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tNc79gy1fq102txkvvj30hs07haaf.jpg"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªèŠ‚ç‚¹åŒ…å«çš„æŒ‡é’ˆçš„å±‚æ•°æ˜¯ç”±ä¸€ä¸ªéšæœºæ•°å†³å®šçš„ã€‚&lt;/li&gt;
&lt;li&gt;è·³è¡¨çš„æ—¶é—´å¤æ‚åº¦å’Œå¹³è¡¡äºŒå‰æ ‘ç›¸åŒï¼Œä½†æ˜¯åœ¨å®ç°ä¸Šè¦ç®€å•å¾ˆå¤šã€‚&lt;/li&gt;
&lt;li&gt;è·³è¡¨æ˜¯æœ‰åºçš„ï¼Œè·³è·ƒè¡¨çš„ç‰¹ç‚¹å°±æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥å¯¹äºä¸€äº›æœ‰åºç±»å‹çš„æ•°æ®ï¼Œæ¯”å¦‚æ•´æ•°ï¼Œæ—¥æœŸè¿™ç§ï¼Œç”¨è·³è·ƒè¡¨å¯ä»¥è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æ„å»ºè·³è·ƒè¡¨å’ŒæŸ¥è¯¢è·³è·ƒçš„å¤æ‚åº¦ä¸€è‡´ï¼Œæ‰€ä»¥ä¹Ÿæ¯”è¾ƒé€‚åˆäºåœ¨çº¿çš„å®æ—¶ç´¢å¼•æŸ¥è¯¢ï¼Œå¯ä»¥æ¥ä¸€ä¸ªæ–‡æ¡£ï¼Œä¸€è¾¹æŸ¥æ‰¾å°±ä¸€è¾¹çŸ¥é“è¦å¦‚ä½•è¿›è¡Œæ’å…¥æ“ä½œäº†ã€‚&lt;/li&gt;
&lt;li&gt;ä¿å­˜åˆ°ç£ç›˜å’Œä»ç£ç›˜è½½å…¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå› ä¸ºæœ¬è´¨ä¸Šæ˜¯å‡ ä¸ªé“¾è¡¨ï¼Œæ‰€ä»¥ä¿å­˜çš„æ—¶å€™å¯ä»¥æŒ‰ç…§æ•°ç»„çš„æ–¹å¼åˆ†åˆ«ä¿å­˜å‡ ä¸ªæ•°ç»„å°±å¯ä»¥äº†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;ä¸€äº›ä¼˜åŒ–&lt;/h1&gt;
&lt;p&gt;ç©ºé—´ä¼˜åŒ–ï¼ŒæŠŠåº•å±‚çš„è¡¨æ”¾åˆ°ç¡¬ç›˜é‡Œï¼Œå½±å“å¢åŠ åˆ é™¤èŠ‚ç‚¹çš„æ•ˆç‡&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tNc79gy1fq1043qhraj30hs06i3zn.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æ—¶é—´ä¼˜åŒ–ï¼Œç”¨æ•°ç»„ä»£æ›¿é“¾è¡¨ï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾è€Œééå†&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tNc79gy1fq104leytgj30hs06j0tf.jpg"&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºç±»ä¼¼æ—¶é—´è¿™ç§æ•°æ®ï¼Œæ¯”å¦‚24å°æ—¶å¯¹åº”1440åˆ†é’Ÿå¯¹åº”86400ç§’é’Ÿ&lt;/p&gt;
&lt;p&gt;ç”šè‡³å¯ä»¥å›ºå®šç›´æ¥ç”¨ç´¢å¼•éšæœºè®¿é—®&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tNc79gy1fq106sqt91j30hs06j758.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;å®ç°&lt;/h1&gt;
&lt;p&gt;https://github.com/begeekmyfriend/skiplist/blob/master/skiplist.h&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 06:36:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/tiao-biao-skiplist.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>Python Argparse åº“çš„ä½¿ç”¨</title><link>/posts/python-argparse-ku-de-shi-yong.html</link><description>&lt;h2&gt;åŸºæœ¬ç”¨æ³•&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;argparse&lt;/span&gt;
&lt;span class="n"&gt;parser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;argparse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ArgumentParser&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;--verbosity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;increase output verbosity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse_args&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;verbosity&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸¤ç§ä¸åŒçš„å‚æ•°æ¨¡å¼ï¼Œ &lt;code&gt;positional&lt;/code&gt;ï¼Œ&lt;code&gt;optional arguments&lt;/code&gt;ï¼Œæ„Ÿè§‰ä¹‹é—´çš„åŒºåˆ«æœ‰ç‚¹åƒ args å’Œ kwargs&lt;/p&gt;
&lt;h2&gt;subcommand&lt;/h2&gt;
&lt;p&gt;Actually, the argparse module is not ok with subcommand, mannually parse the first command and then pass the rest to argparse&lt;/p&gt;
&lt;h3&gt;add_argument çš„å‚æ•°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;name or flagsÂ - Either a name or a list of option strings, e.g.Â fooÂ orÂ `-f`,Â `--foo`.
actionÂ - The basic type of action to be taken when this argument is encountered at the command line. store/store_const/store_true/append/count
nargsÂ - The number of command-line arguments that should be consumed. N/?/*/+
constÂ - A constant value required by someÂ actionÂ andÂ nargsÂ selections.
defaultÂ - The value produced if the argument is absent from the command line.
typeÂ -  The type to which the command-line argument should be converted.
choicesÂ - A container of the allowable values for the argument. a list 
requiredÂ - Whether or not the command-line option may be omitted (optionals only).
helpÂ - A brief description of what the argument does.
metavarÂ - A name for the argument in usage messages.
destÂ - The name of the attribute to be added to the object returned byÂ parse_args().
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 06:23:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/python-argparse-ku-de-shi-yong.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Linux å‘½ä»¤è¡Œä¸­ä½¿ç”¨å¸¦é¢œè‰²çš„è¾“å‡º</title><link>/posts/linux-ming-ling-xing-zhong-shi-yong-dai-yan-se-de-shu-chu.html</link><description>&lt;p&gt;http://misc.flogisoft.com/bash/tip_colors_and_formatting&lt;/p&gt;
&lt;p&gt;We just have to use \033&lt;/p&gt;
&lt;p&gt;The most frequently used format would be \033[31mtext here \033[0m&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼šecho \033[31mtext here \033[0m&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 06:13:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/linux-ming-ling-xing-zhong-shi-yong-dai-yan-se-de-shu-chu.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Android SharedPreference</title><link>/posts/android-sharedpreference.html</link><description>&lt;p&gt;ç”¨æ¥åœ¨åº”ç”¨ä¸­å­˜å‚¨é”®å€¼å¯¹é…ç½®&lt;/p&gt;
&lt;p&gt;context.getSharedPreferences("prefName", Context.MODE_PRIVATE)  get SharedPreferecnes instance
sharedPref.getXXX("keyName", defaultValue)  get value from SharedPreferences
sharedPref.edit()   get editor(SharedPreference.Editor)
editor.putXXX("key-name", value)    put value
editor.commit() commit the changes&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 06:01:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/android-sharedpreference.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>Android å¼€å‘çš„ä¸€äº› tips</title><link>/posts/android-kai-fa-de-yi-xie-tips.html</link><description>&lt;p&gt;Prefer Maven dependency resolution instead of importing jar files.Â If you explicitly include jar files in your project, they will be of some specific frozen version, such asÂ 2.1.1. Downloading jars and handling updates is cumbersome, this is a problem that Maven solves properly, and is also encouraged in Android Gradle builds. For example:
dependencies {
    compile 'com.squareup.okhttp:okhttp:2.2.0'
    compile 'com.squareup.okhttp:okhttp-urlconnection:2.2.0'
}&lt;/p&gt;
&lt;p&gt;Use different package name for non-release buildsÂ UseÂ applicationIdSuffixÂ forÂ debugÂ build typeÂ to be able to install bothÂ debugÂ andÂ releaseÂ apk on the same device (do this also for custom build types, if you need any). This will be especially valuable later on in the app's lifecycle, after it has been published to the store.
android {
    buildTypes {
        debug {
            applicationIdSuffix '.debug'
            versionNameSuffix '-DEBUG'
        }
release {
            // ...
        }
    }
}&lt;/p&gt;
&lt;p&gt;Use different icons to distinguish the builds installed on a deviceâ€”for example with different colors or an overlaid "debug" label. Gradle makes this very easy: with default project structure, simply putÂ debugÂ icon inÂ app/src/debug/resÂ andÂ releaseÂ icon inÂ app/src/release/res. You could alsoÂ change app nameÂ per build type, as well asÂ versionNameÂ (as in the above example).&lt;/p&gt;
&lt;p&gt;use stetho&lt;/p&gt;
&lt;p&gt;ä¸è¦åœ¨applicationä¸­å­˜å‚¨å…¨å±€å˜é‡
å°½é‡å°‘ä½¿ç”¨globalobjectï¼Œæœ€å¥½ä½¿ç”¨intent&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 06:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/android-kai-fa-de-yi-xie-tips.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>Android è¿æ¥ WiFi</title><link>/posts/android-lian-jie-wifi.html</link><description>&lt;p&gt;https://stackoverflow.com/questions/4249911/android-how-to-create-eap-wifi-configuration-programmatically&lt;/p&gt;
&lt;p&gt;redirects to &lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/4374862/how-to-programmatically-create-and-read-wep-eap-wifi-configurations-in-android&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/19170260/how-to-connect-to-wpa-eap-wifi-on-android-with-4-3-api&lt;/p&gt;
&lt;p&gt;Android 6.0 changes&lt;/p&gt;
&lt;p&gt;https://developer.android.com/about/versions/marshmallow/android-6.0-changes.html#behavior-network&lt;/p&gt;
&lt;p&gt;working methods&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/12486441/how-can-i-set-proxysettings-and-proxyproperties-on-android-wi-fi-connection-usin&lt;/p&gt;
&lt;p&gt;get real ip https://stackoverflow.com/questions/39335525
connect to wifi https://stackoverflow.com/questions/8818290&lt;/p&gt;
&lt;p&gt;android added support to eap wifi in API 18 (4.3), a lot of tutorials online are outdated.&lt;/p&gt;
&lt;p&gt;use WifiEnterpiresConfiguration.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 06:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/android-lian-jie-wifi.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>Maven Basics</title><link>/posts/maven-basics.html</link><description>&lt;p&gt;From: http://tutorials.jenkov.com/maven/maven-tutorial.html&lt;/p&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Maven is built around the pom.xml file. In Maven, how to build your project is predefined in the Maven Build Life Cycles, Phases and Goals.  The POM file describes &lt;em&gt;what to build&lt;/em&gt;, but most often &lt;em&gt;not how to build it&lt;/em&gt;. How to build it is up to the Maven build phases and goals.&lt;/p&gt;
&lt;h1&gt;Minimal POM file&lt;/h1&gt;
&lt;p&gt;Here is a minimal POM file: &lt;/p&gt;
&lt;p&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;com.jenkov&lt;/groupId&gt;
&lt;artifactId&gt;java-web-crawler&lt;/artifactId&gt;
&lt;version&gt;1.0.0&lt;/version&gt;
&lt;/project&gt;&lt;/p&gt;
&lt;p&gt;this outputs MAVEN_REPO/com/jenkov/java-web-crawler/1.0.0/java-web-crawler-1.0.0.jar&lt;/p&gt;
&lt;h1&gt;Super POM&lt;/h1&gt;
&lt;p&gt;You can make a POM file explicitly inherit from another POM file. That way you can change the settings across all inheriting POM's via their common super POM. You specify the super POM at the top of a POM file like this: &lt;/p&gt;
&lt;p&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;lt;parent&amp;amp;gt;
    &amp;amp;lt;groupId&amp;amp;gt;org.codehaus.mojo&amp;amp;lt;/groupId&amp;amp;gt;
    &amp;amp;lt;artifactId&amp;amp;gt;my-parent&amp;amp;lt;/artifactId&amp;amp;gt;
    &amp;amp;lt;version&amp;amp;gt;2.0&amp;amp;lt;/version&amp;amp;gt;
    &amp;amp;lt;relativePath&amp;amp;gt;../my-parent&amp;amp;lt;/relativePath&amp;amp;gt;
&amp;amp;lt;/parent&amp;amp;gt;

&amp;amp;lt;artifactId&amp;amp;gt;my-project&amp;amp;lt;/artifactId&amp;amp;gt;
...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;/project&gt;&lt;/p&gt;
&lt;p&gt;mvn help:effective-pom shows the combined pom of parent and current&lt;/p&gt;
&lt;h1&gt;Running Maven&lt;/h1&gt;
&lt;p&gt;When executing the mvn command you pass the name of a build life cycle, phase or goal to it, which Maven then executes.&lt;/p&gt;
&lt;p&gt;syntax: mvn phase:goal&lt;/p&gt;
&lt;h1&gt;Directory Structure&lt;/h1&gt;
&lt;p&gt;You must follow the maven directory structure&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;- src
  - main
    - java
    - resources
    - webapp
  - test
    - java
    - resources
- target
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;more here: Introduction to the Maven Standard Directory Layout&lt;/p&gt;
&lt;h1&gt;Dependencies&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;project&lt;/span&gt; &lt;span class="na"&gt;xmlns=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://maven.apache.org/POM/4.0.0&amp;quot;&lt;/span&gt;
         &lt;span class="na"&gt;xmlns:xsi=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;&lt;/span&gt;
         &lt;span class="na"&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://maven.apache.org/POM/4.0.0&lt;/span&gt;
&lt;span class="s"&gt;   http://maven.apache.org/xsd/maven-4.0.0.xsd&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;modelVersion&amp;gt;&lt;/span&gt;4.0.0&lt;span class="nt"&gt;&amp;lt;/modelVersion&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.jenkov.crawler&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;java-web-crawler&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.0.0&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;

 &lt;span class="nt"&gt;&amp;lt;dependencies&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.jsoup&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;jsoup&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.7.1&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;

    &lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;junit&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;junit&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;4.8.1&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;scope&amp;gt;&lt;/span&gt;test&lt;span class="nt"&gt;&amp;lt;/scope&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/dependencies&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;build&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/build&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/project&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;external dependencies&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;mydependency&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;mydependency&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;scope&amp;gt;&lt;/span&gt;system&lt;span class="nt"&gt;&amp;lt;/scope&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.0&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;systemPath&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;basedir&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;\war\WEB-INF\lib\mydependency.jar&lt;span class="nt"&gt;&amp;lt;/systemPath&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;snapshot dependencies&lt;/h2&gt;
&lt;p&gt;Snapshot dependencies are dependencies (JAR files) which are under development. &lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;version&amp;gt;1.0-SNAPSHOT&amp;lt;/version&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;Repositories&lt;/h1&gt;
&lt;p&gt;maven tries to pull dependencies from local, central, and remote repo&lt;/p&gt;
&lt;h2&gt;Local Repositores&lt;/h2&gt;
&lt;p&gt;it's defined in ~/.m2/settings.xml&lt;/p&gt;
&lt;p&gt;&lt;settings&gt;
    &lt;localRepository&gt;
        d:\data\java\products\maven\repository
    &lt;/localRepository&gt;
&lt;/settings&gt;&lt;/p&gt;
&lt;h2&gt;Central Repositories&lt;/h2&gt;
&lt;p&gt;Maintained by the maven community&lt;/p&gt;
&lt;h2&gt;Remote Repositories&lt;/h2&gt;
&lt;p&gt;A remote repository is often used for hosting projects internal to your organization, which are shared by multiple projects.&lt;/p&gt;
&lt;p&gt;&lt;repositories&gt;
   &lt;repository&gt;
       &lt;id&gt;jenkov.code&lt;/id&gt;
       &lt;url&gt;http://maven.jenkov.com/maven2/lib&lt;/url&gt;
   &lt;/repository&gt;
&lt;/repositories&gt;&lt;/p&gt;
&lt;h1&gt;Maven Build Cycles&lt;/h1&gt;
&lt;p&gt;When Maven builds a software project it follows a build life cycle. The build life cycle is divided into build phases, and the build phases are divided into build goals.
Since you cannot execute the default life cycle directly, you need to execute a build phase or goal from the default life cycle. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;1. default 
validate    Validates that the project is correct and all necessary information is available. This also makes sure the dependencies are downloaded.
compile Compiles the source code of the project.
test    Runs the tests against the compiled source code using a suitable unit testing framework. These tests should not require the code be packaged or deployed.
package Packs the compiled code in its distributable format, such as a JAR.
install Install the package into the local repository, for use as a dependency in other projects locally.
deploy  Copies the final package to the remote repository for sharing with other developers and projects.
2. clean
3. site
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Profiles&lt;/h1&gt;
&lt;p&gt;Profiles let you use differvent build settings&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 05:57:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/maven-basics.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>ä½¿ç”¨ Gson è§£æ json æ–‡æ¡£</title><link>/posts/shi-yong-gson-jie-xi-json-wen-dang.html</link><description>&lt;p&gt;è§£æ json æœ‰ä¸¤ç§æµæ´¾ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;event-driven json parse: iterate the document, not loading all into memory&lt;/li&gt;
&lt;li&gt;document-based json parse: load the full document into memory once for all.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨ Python ä¸­å¯ä»¥å¾ˆå®¹æ˜“çš„è§£æjsonæ–‡ä»¶ï¼ŒPython ä¸­çš„ json.loads æ˜¯ document-basedã€‚è€Œåœ¨ java ä¸­å¯ä»¥ä½¿ç”¨ event-drivençš„ã€‚ä¸ªäººæ„Ÿè§‰è¿™ç§ event-driven çš„è§£ææ–¹å¼æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Œjsonæœ¬æ¥å®šä½å°±æ˜¯å°å‹çš„æ•°æ®ä¼ è¾“å’Œé…ç½®å­˜å‚¨ï¼Œå¦‚æœç”Ÿæˆäº†ä¸€ä¸ªå¾ˆå¤§çš„ jsonï¼Œåº”è¯¥è€ƒè™‘æ¢ç”¨xmläº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Java ä¸­éœ€è¦ç”Ÿæˆå’Œ JSON æ–‡æ¡£æ„ä¹‰å¯¹åº”çš„ JavaBean æ–‡ä»¶ï¼Œè¿™æ ·æ‰èƒ½è§£æåˆ° Java Classã€‚&lt;/p&gt;
&lt;p&gt;æŠŠä½ çš„ json æ–‡ä»¶çš„ä¾‹å­é¦–å…ˆç¼–å†™å¥½ï¼Œç„¶åå¯ä»¥é€šè¿‡è¿™ä¸ªç½‘ç«™ç”Ÿæˆ JavaBeanï¼šhttp://www.jsonschema2pojo.org/&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/0069RVTdly1fu2lsahbklj31880ni77y.jpg"&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ Android Studio build.gradle æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dependencies {
  compile &amp;#39;com.google.code.gson:gson:2.3.1&amp;#39;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è§£æ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;package&lt;/span&gt; &lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;example&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;com.google.gson.annotations.Expose&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;com.google.gson.annotations.SerializedName&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;public&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Example&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

&lt;span class="nd"&gt;@SerializedName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nd"&gt;@Expose&lt;/span&gt;
&lt;span class="n"&gt;private&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="n"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;getFoo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;public&lt;/span&gt; &lt;span class="n"&gt;void&lt;/span&gt; &lt;span class="n"&gt;setFoo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Gson gson = new Gson();

String json = &amp;quot;{\&amp;quot;foo\&amp;quot;: \&amp;quot;bar\&amp;quot;}&amp;quot;;
Example example = gson.fromJson(json, Example.class);
// è§£æï¼šJavaBeanå¯¹è±¡ = gson.fromJson(json, JavaBean.class);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;http://www.jianshu.com/p/b87fee2f7a23&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 05:56:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/shi-yong-gson-jie-xi-json-wen-dang.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>æ¯”ç‰¹å¸ç›¸å…³æŠ€æœ¯è°ƒç ”</title><link>/posts/bi-te-bi-xiang-guan-ji-zhu-diao-yan.html</link><description>&lt;h1&gt;æŒ–çŸ¿&lt;/h1&gt;
&lt;p&gt;æ¯”ç‰¹å¸çš„æŒ–çŸ¿ç®—æ³•æ˜¯CPUå¯†é›†å‹çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„ç¡¬ä»¶ï¼Œæ¯”å¦‚ FPGA æˆ–è€… ASIC æ¥åŠ é€Ÿã€‚åç»­çš„å¥½å¤šåŠ å¯†è´§å¸ï¼Œæ¯”å¦‚ETH ç­‰ï¼Œéƒ½ç‰¹æ„é€‰æ‹©äº†ä¸æ˜¯CPUå¯†é›†å‹çš„ç®—æ³•ï¼Œä»è€Œé¿å…è¿™ç§ä½¿ç”¨ç‰¹æ®Šç¡¬ä»¶æŒ–çŸ¿é€ æˆçš„ä¸å…¬å¹³ã€‚&lt;a href="http://cseweb.ucsd.edu/~mbtaylor/papers/Taylor_Bitcoin_IEEE_Computer_2017.pdf"&gt;æŒ–çŸ¿ç¡¬ä»¶çš„å‘å±•&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¯”ç‰¹å¸çš„æŒ–çŸ¿ç®—æ³•å°±æ ¸å¿ƒæ¥è¨€å°±æ˜¯ä¸‹é¢å‡ å¥ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;while (1)
 HDR[kNoncePos]++;
 IF (SHA256(SHA256(HDR)) &amp;lt; (65535 &amp;lt;&amp;lt; 208)/ DIFFICULTY) return;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;monero ä½¿ç”¨äº†é€‚åˆäºç°ä»£CPUçš„AESç®—æ³•ï¼Œå‚è§&lt;a href="https://monero.stackexchange.com/questions/1110/where-can-i-find-a-description-of-the-cryptonight-hash-algorithm"&gt;è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;è´§å¸&lt;/h1&gt;
&lt;p&gt;USDTï¼šé£é™©å°±åœ¨äºè¿™å®¶å…¬å¸éšæ—¶å¯èƒ½è·‘è·¯ã€‚ã€‚
Siacoin: ç”¨äºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„è´§å¸ï¼Œä½†æ˜¯å› ä¸ºåŠ å¯†ç®—æ³•è¢«æ¯”ç‰¹å¤§é™†åšå‡ºäº†çŸ¿æœºï¼Œæ‰€ä»¥ä»·æ ¼ä¸€è·¯ç‹‚æ³»ã€‚ã€‚(2018-02-04)
Filecoin: 
æ¯”ç‰¹è‚¡ï¼šhttps://www.zhihu.com/question/28812361
æ¯”ç‰¹è‚¡è¿˜è¡ç”Ÿå‡ºäº† bitcny å’Œ bitusd ç­‰è´§å¸ã€‚å›½å†…å¯ä»¥ä½¿ç”¨é¼“é¼“é’±åŒ…&lt;/p&gt;
&lt;p&gt;https://chainnews.com/articles/768752760963.htm&lt;/p&gt;
&lt;h1&gt;é—®é¢˜&lt;/h1&gt;
&lt;p&gt;æ¯”ç‰¹å¸å’Œä»¥å¤ªå¸çš„ç¡®è®¤é€Ÿåº¦éƒ½ç‰¹åˆ«æ…¢ï¼Œæ¯”ç‰¹å¸åœ¨ 7ç¬”æ¯ç§’ï¼Œä»¥å¤ªå¸åœ¨15ç¬”æ¯ç§’&lt;/p&gt;
&lt;p&gt;çŸ³å¢¨çƒ¯æŠ€æœ¯&lt;/p&gt;
&lt;p&gt;åŒºå—é“¾æŠ€æœ¯&lt;/p&gt;
&lt;p&gt;åœ¨åŒºå—é“¾ä¸­å­˜å‚¨æ•°æ®&lt;/p&gt;
&lt;p&gt;In 2013, a feature was introduced into the Bitcoin protocol that allows us to do just that: create a special kind of transaction (called anÂ OP_RETURNÂ transaction) inside which you can embed tiny amounts of data, 40 bytes, in transactions. Originally it was intended to be used for attaching contextual information to Bitcoin transactions, such as shipping information. A more creative way of using the feature is to create the smallest possible transaction (0.00000001 BTC, or a satoshi, plus the transaction fees) and embed whatever information you want that can fit inside it. æ¯”å¦‚ä½ å¯ä»¥æŠŠä¸€ä¸ªæ–‡ä»¶çš„hashå­˜åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¯æ˜åœ¨æŸä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å­˜åœ¨çš„&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 05:28:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/bi-te-bi-xiang-guan-ji-zhu-diao-yan.html</guid><category>bitcoin</category><category>è®¡ç®—æœº</category></item><item><title>[zz]å¦‚ä½•é«˜æ•ˆåœ°å­¦ä¹ ç¼–ç¨‹è¯­è¨€</title><link>/posts/zzru-he-gao-xiao-di-xue-xi-bian-cheng-yu-yan.html</link><description>&lt;p&gt;ä¸ªäººè§‚ç‚¹ï¼Œæˆ‘è§‰å¾—è®°ä½è¿™äº›æ˜¯æœ‰ç”¨çš„â€”â€”å½“å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€çš„æ—¶å€™ï¼Œä½ å®é™…ä¸Šæ­£åœ¨å­¦å››ä»¶äº‹æƒ…ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ€ä¹ˆå†™ä»£ç ï¼šè¯­æ³•ã€è¯­ä¹‰ä»¥åŠèµ„æºç®¡ç†&lt;/li&gt;
&lt;li&gt;è¯­è¨€çš„èŒƒå¼ï¼šé¢å‘å¯¹è±¡ï¼Œå‡½æ•°å¼ï¼Œé€»è¾‘ç­‰&lt;/li&gt;
&lt;li&gt;äº§å‡ºç‰©çš„ç”Ÿæ€åœˆï¼šå¦‚ä½•æ„å»ºã€è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ä»¥åŠå¦‚ä½•ä½¿ç”¨åº“&lt;/li&gt;
&lt;li&gt;å·¥å…·ï¼šç¼–è¾‘å™¨ï¼Œç¼–è¯‘å™¨ï¼Œè°ƒè¯•å™¨ï¼Œä»£ç è´¨é‡æ£€æµ‹å™¨ï¼ˆlinterï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™å››é¡¹å¾ˆå®¹æ˜“ææ··ï¼Œä¸å¹¸çš„ç»“æœæ˜¯ï¼Œå½“ä½ é‡åˆ°é—®é¢˜æœ€ç»ˆå®Œå…¨æ‰¾é”™äº†åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;http://lambeta.com/2017/04/18/Techniques-for-Efficiently-Learning-Programming-Languages/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 05:26:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/zzru-he-gao-xiao-di-xue-xi-bian-cheng-yu-yan.html</guid><category>æƒ³æ³•</category><category>è®¡ç®—æœº</category></item><item><title>sqlite3 å’Œåœ¨ Python ä¸­çš„ä½¿ç”¨æ•™ç¨‹</title><link>/posts/sqlite3-he-zai-python-zhong-de-shi-yong-jiao-cheng.html</link><description>&lt;p&gt;Yifei's notes:&lt;/p&gt;
&lt;p&gt;æ‰€è°“çš„äº‹åŠ¡ã€é”ã€å­˜å‚¨è¿‡ç¨‹ã€å¤–é”®ç­‰ç­‰ä¸é€‚åˆäº’è”ç½‘å…¬å¸çš„ä¸šåŠ¡åœºæ™¯ï¼Œè€Œæ›´é€‚åˆäºâ€œä¼ä¸šçº§â€â€œIOEâ€è¿™äº›åº”ç”¨ã€‚&lt;/p&gt;
&lt;h1&gt;sqlite3&lt;/h1&gt;
&lt;p&gt;% sqlite3 DATABASE&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;.databases&lt;/span&gt;  &lt;span class="no"&gt;show&lt;/span&gt; &lt;span class="no"&gt;databases&lt;/span&gt; &lt;span class="no"&gt;connected&lt;/span&gt; &lt;span class="no"&gt;to&lt;/span&gt;
&lt;span class="na"&gt;.dump&lt;/span&gt; &lt;span class="no"&gt;TABLE&lt;/span&gt; &lt;span class="no"&gt;dump&lt;/span&gt; &lt;span class="no"&gt;table&lt;/span&gt; &lt;span class="no"&gt;in&lt;/span&gt; &lt;span class="no"&gt;SQL&lt;/span&gt; &lt;span class="no"&gt;format&lt;/span&gt;
&lt;span class="na"&gt;.import&lt;/span&gt; &lt;span class="no"&gt;FILE&lt;/span&gt; &lt;span class="err"&gt;?&lt;/span&gt;&lt;span class="no"&gt;TABLE&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt;    &lt;span class="no"&gt;import&lt;/span&gt; &lt;span class="no"&gt;SQL&lt;/span&gt; &lt;span class="no"&gt;data&lt;/span&gt; &lt;span class="no"&gt;into&lt;/span&gt; &lt;span class="no"&gt;table&lt;/span&gt;
&lt;span class="na"&gt;.indices&lt;/span&gt; &lt;span class="err"&gt;?&lt;/span&gt;&lt;span class="no"&gt;TABLE&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt;    &lt;span class="no"&gt;show&lt;/span&gt; &lt;span class="no"&gt;indices&lt;/span&gt; &lt;span class="no"&gt;of&lt;/span&gt; &lt;span class="no"&gt;table&lt;/span&gt;
&lt;span class="na"&gt;.mode&lt;/span&gt; &lt;span class="no"&gt;MODE&lt;/span&gt;  &lt;span class="no"&gt;set&lt;/span&gt; &lt;span class="no"&gt;output&lt;/span&gt; &lt;span class="no"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;csv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="no"&gt;column&lt;/span&gt;
&lt;span class="na"&gt;.read&lt;/span&gt; &lt;span class="no"&gt;FILE&lt;/span&gt;  &lt;span class="no"&gt;excute&lt;/span&gt; &lt;span class="no"&gt;FILE&lt;/span&gt;
&lt;span class="na"&gt;.schema&lt;/span&gt; &lt;span class="err"&gt;?&lt;/span&gt;&lt;span class="no"&gt;TABLE&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt; &lt;span class="no"&gt;show&lt;/span&gt; &lt;span class="no"&gt;create&lt;/span&gt; &lt;span class="no"&gt;statement&lt;/span&gt;
&lt;span class="na"&gt;.restore&lt;/span&gt;  &lt;span class="err"&gt;?&lt;/span&gt;&lt;span class="no"&gt;DB&lt;/span&gt;&lt;span class="err"&gt;?&lt;/span&gt; &lt;span class="no"&gt;FILE&lt;/span&gt; &lt;span class="no"&gt;restore&lt;/span&gt; &lt;span class="no"&gt;db&lt;/span&gt; &lt;span class="no"&gt;from&lt;/span&gt; &lt;span class="no"&gt;file&lt;/span&gt;
&lt;span class="na"&gt;.headers&lt;/span&gt; &lt;span class="no"&gt;ON&lt;/span&gt;&lt;span class="err"&gt;|&lt;/span&gt;&lt;span class="no"&gt;OFF&lt;/span&gt; &lt;span class="no"&gt;show&lt;/span&gt; &lt;span class="no"&gt;headers&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ç¾åŒ–è¾“å‡º&lt;/h2&gt;
&lt;p&gt;è®© sqlite çš„è¾“å‡ºæ›´ç¾è§‚ï¼Œä½¿ç”¨ &lt;code&gt;.mode column&lt;/code&gt; å’Œ &lt;code&gt;.headers on&lt;/code&gt; ä¸¤ä¸ªå‘½ä»¤&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sqlite&amp;gt; select * from foo;
234|kshitiz|dba.se

sqlite&amp;gt; .mode column
sqlite&amp;gt; select * from foo;
234         kshitiz     dba.se

sqlite&amp;gt; .headers on
sqlite&amp;gt; select * from foo;
bar         baz         baf
----------  ----------  ----------
234         kshitiz     dba.se
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å¯¼å…¥å¯¼å‡º csv&lt;/h2&gt;
&lt;p&gt;å¯¼å‡º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sqlite&amp;gt; .mode csv   -- use &amp;#39;.separator SOME_STRING&amp;#39; for something other than a comma.
sqlite&amp;gt; .headers on 
sqlite&amp;gt; .out file.dmp 
sqlite&amp;gt; select * from MyTable;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯¼å…¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sqlite&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt; &lt;span class="n"&gt;csv&lt;/span&gt;
&lt;span class="n"&gt;sqlite&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;CSV_FILE&lt;/span&gt; &lt;span class="nn"&gt;TABLE_NAME&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å¤‡ä»½è¿˜åŸ&lt;/h2&gt;
&lt;p&gt;sqlite3 DATABASE .dump &amp;gt; backup.sql
sqlite3 DATABASE &amp;lt; backup.sql&lt;/p&gt;
&lt;p&gt;æˆ–è€…&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sqlite3&amp;gt; .read backup.sql
sqlite3&amp;gt; .dump backup.sql
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åœ¨ Python ä¸­ä½¿ç”¨ SQLite&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆè¿æ¥åˆ°æ•°æ®åº“ï¼Œè·å¾— connection å¯¹è±¡ï¼Œç„¶åå†è·å¾— cursorï¼Œä½¿ç”¨ cursor æ¥æ‰§è¡Œ sql è¯­å¥å¹¶è·å–ç»“æœã€‚&lt;/p&gt;
&lt;h2&gt;è¿æ¥&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sqlite3&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sqlite3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;database.db&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# connections&lt;/span&gt;
&lt;span class="n"&gt;cursor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c1"&gt;# get cursor&lt;/span&gt;
&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CREATE TABLE books (id int primary key, name text)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;INSERT INTO books (name) VALUES (&amp;#39;&lt;/span&gt; &lt;span class="n"&gt;sophie&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s choice&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;)&lt;/span&gt;
&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;INSERT INTO books (name) VALUES (&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;bible&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c1"&gt;# always remember to commit&lt;/span&gt;
&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SELECT * FROM books&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ–è€…ä½¿ç”¨ with è¯­å¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;with sqlite3.connect(&amp;#39;db&amp;#39;) as conn:
    cursor = conn.cursor()
    # cursor executes
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ„å»ºè¯­å¥&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# fabricating statement
cursor.execute(&amp;#39;select from books where name = ?&amp;#39;, (&amp;#39;the bible&amp;#39;,)) 
# NOTE the param must be a sequence

# You could also use named placeholders
cursor.execute(&amp;#39;insert into books (name) values (:name)&amp;#39;, {name: &amp;#39;the bible&amp;#39;})
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è·å–æ•°æ®&lt;/h2&gt;
&lt;p&gt;æœ‰ä¸¤ç§æ–¹å¼:&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ fetchone, fetchmany(n), fetchall&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;r = c.execute(&amp;#39;SELECT id FROM stocks WHERE name = &amp;#39;MSFT&amp;#39;&amp;#39;)
id = r.fetchone()[0]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç›´æ¥è¿­ä»£è¿”å›ç»“æœ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;for row in c.execute(&amp;#39;SELECT * FROM stocks ORDER BY price&amp;#39;):
    print row[0], row[1], row[&amp;#39;id&amp;#39;], row[&amp;#39;name&amp;#39;]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„ç»“æœæ¯è¡Œæ˜¯ä¸€ä¸ª tuple æˆ–è€…ä¸€ä¸ª dictï¼Œå³ä½¿ select äº†ä¸€ä¸ªå…ƒç´ ï¼Œç»“æœä¹Ÿæ˜¯ tupleã€‚&lt;/p&gt;
&lt;h2&gt;å…¶ä»–&lt;/h2&gt;
&lt;p&gt;lastrowid&lt;/p&gt;
&lt;p&gt;This read-only attribute provides the rowid of the last modified row. It is only set if you issued aÂ INSERTÂ statement using theÂ execute()method. For operations other thanÂ INSERTÂ or whenÂ executemany()Â is called,Â lastrowidÂ is set toÂ None.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 05:17:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/sqlite3-he-zai-python-zhong-de-shi-yong-jiao-cheng.html</guid><category>æ•°æ®åº“</category><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Linux ä¸­çš„ epoll å’Œ nginx ä¸­çš„åº”ç”¨</title><link>/posts/linux-zhong-de-epoll-he-nginx-zhong-de-ying-yong.html</link><description>&lt;h1&gt;epoll çš„ä¼˜åŠ¿&lt;/h1&gt;
&lt;p&gt;select å’Œ poll æ¯æ¬¡è·å–å¯è¯»å†™çš„æè¿°ç¬¦éƒ½éœ€è¦éå†æ‰€æœ‰çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒä»¬çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(n)ï¼Œè€Œ epoll æ˜¯åŸºäºå›è°ƒçš„ï¼Œæ¯ä¸ª socket ä¸Šæœ‰äº‹ä»¶å‘ç”Ÿéƒ½ä¼šè°ƒç”¨å›è°ƒå‡½æ•°æ”¾åˆ° epoll çš„å°±åºåˆ—è¡¨ä¸­ï¼Œå› æ­¤ epoll_wait åªéœ€è¦ç®€å•åœ°è¯»å–è¿™ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥epollçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1) çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ·»åŠ ç›‘æ§çš„socketåªéœ€è¦ä½¿ç”¨ epoll_ctl æ·»åŠ ä¸€æ¬¡ï¼Œè€Œè·å–æ¶ˆæ¯ epoll ä½¿ç”¨ mmap åŠ é€Ÿå†…æ ¸ä¸ç”¨æˆ·æ€çš„æ¶ˆæ¯ä¼ é€’ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½æŠŠ socket åœ¨å†…æ ¸æ€å’Œç”¨æˆ·æ€ä¹‹é—´è€ƒæ¥è€ƒå–ã€‚&lt;/p&gt;
&lt;h2&gt;epoll çš„å·¥ä½œæ¨¡å¼&lt;/h2&gt;
&lt;p&gt;epoll ä¸­æœ‰ä¸¤ä¸ªæ¨¡å¼ï¼Œæ°´å¹³è§¦å‘ï¼ˆLTï¼‰å’Œè¾¹ç¼˜è§¦å‘ï¼ˆETï¼‰ã€‚å…¶ä¸­æ°´å¹³è§¦å‘å¦‚æœä¸åšä»»ä½•æ“ä½œï¼Œå°±ä¼šä¸€ç›´è§¦å‘ï¼Œè€Œè¾¹ç¼˜è§¦å‘åªä¼šè§¦å‘ä¸€æ¬¡ã€‚å°±å¥½æ¯”ç”µå·¥ç”µå­é‡Œé¢çš„ä¸¤ç§è§¦å‘æ¨¡å¼ã€‚é»˜è®¤æ¨¡å¼æ˜¯ LT&lt;/p&gt;
&lt;p&gt;Level Triggered (LT) æ°´å¹³è§¦å‘&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;socketæ¥æ”¶ç¼“å†²åŒºä¸ä¸ºç©º æœ‰æ•°æ®å¯è¯» è¯»äº‹ä»¶ä¸€ç›´è§¦å‘&lt;/li&gt;
&lt;li&gt;socketå‘é€ç¼“å†²åŒºä¸æ»¡ å¯ä»¥ç»§ç»­å†™å…¥æ•°æ® å†™äº‹ä»¶ä¸€ç›´è§¦å‘&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¬¦åˆæ€ç»´ä¹ æƒ¯ï¼Œepoll_waitè¿”å›çš„äº‹ä»¶å°±æ˜¯socketçš„çŠ¶æ€&lt;/p&gt;
&lt;p&gt;Edge Triggered (ET) è¾¹æ²¿è§¦å‘&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;socketçš„æ¥æ”¶ç¼“å†²åŒºçŠ¶æ€å˜åŒ–æ—¶è§¦å‘è¯»äº‹ä»¶ï¼Œå³ç©ºçš„æ¥æ”¶ç¼“å†²åŒºåˆšæ¥æ”¶åˆ°æ•°æ®æ—¶è§¦å‘è¯»äº‹ä»¶&lt;/li&gt;
&lt;li&gt;socketçš„å‘é€ç¼“å†²åŒºçŠ¶æ€å˜åŒ–æ—¶è§¦å‘å†™äº‹ä»¶ï¼Œå³æ»¡çš„ç¼“å†²åŒºåˆšç©ºå‡ºç©ºé—´æ—¶è§¦å‘è¯»äº‹ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»…åœ¨çŠ¶æ€å˜åŒ–æ—¶è§¦å‘äº‹ä»¶&lt;/p&gt;
&lt;p&gt;ETæ¨¡å¼åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°‘äº†epolläº‹ä»¶è¢«é‡å¤è§¦å‘çš„æ¬¡æ•°ï¼Œå› æ­¤æ•ˆç‡è¦æ¯”LTæ¨¡å¼é«˜ã€‚epollå·¥ä½œåœ¨ETæ¨¡å¼çš„æ—¶å€™ï¼Œå¿…é¡»ä½¿ç”¨éé˜»å¡å¥—æ¥å£ï¼Œä»¥é¿å…ç”±äºä¸€ä¸ªæ–‡ä»¶å¥æŸ„çš„é˜»å¡è¯»/é˜»å¡å†™æ“ä½œæŠŠå¤„ç†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„ä»»åŠ¡é¥¿æ­»(åœ¨whileå¾ªç¯ä¸­è°ƒç”¨readã€writeã€acceptï¼Œè‹¥æ˜¯é˜»å¡å¥—æ¥å­—ï¼Œå½“èµ„æºä¸å¤Ÿæ—¶ï¼Œè¿›ç¨‹ä¼šè¢«é˜»å¡ï¼Œåˆ™å…¶ä»–å‡†å¤‡å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦å¾—ä¸åˆ°å¤„ç†ï¼Œå¦‚æœæ˜¯éé˜»å¡å¥—æ¥å­—ï¼Œå½“èµ„æºä¸å¤Ÿæ—¶ï¼Œä¸Šè¿°ç³»ç»Ÿè°ƒç”¨è¿”å›-1ï¼ŒåŒæ—¶å°†errnoè®¾ç½®ä¸ºEAGAIN)&lt;/p&gt;
&lt;p&gt;LTæ¨¡å¼ä¸‹å¼€å‘åŸºäºepollçš„åº”ç”¨è¦ç®€å•äº›ï¼Œä¸å¤ªå®¹æ˜“å‡ºé”™ã€‚è€Œåœ¨ETæ¨¡å¼ä¸‹äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¦‚æœæ²¡æœ‰å½»åº•åœ°å°†ç¼“å†²åŒºæ•°æ®å¤„ç†å®Œï¼Œåˆ™ä¼šå¯¼è‡´ç¼“å†²åŒºä¸­çš„ç”¨æˆ·è¯·æ±‚å¾—ä¸åˆ°å“åº”ã€‚&lt;/p&gt;
&lt;p&gt;ETå¤„ç†EPOLLOUTï¼ˆsocket å¯å†™äº‹ä»¶ï¼‰æ–¹ä¾¿é«˜æ•ˆäº›ï¼ŒLTä¸å®¹æ˜“é—æ¼äº‹ä»¶ã€ä¸æ˜“äº§ç”Ÿbugã€‚å¦‚æœserverçš„å“åº”é€šå¸¸è¾ƒå°ï¼Œä¸€æ¬¡æ€§å¯ä»¥å†™å®Œï¼Œä¸éœ€è¦ç›‘å¬EPOLLOUTï¼Œé‚£ä¹ˆé€‚åˆä½¿ç”¨LTï¼Œä¾‹å¦‚redisç­‰ã€æˆ–è€…å¤§å¤šæ•°çš„ç½‘ç»œåº“ã€‚è€Œnginxä½œä¸ºé«˜æ€§èƒ½çš„é€šç”¨æœåŠ¡å™¨ï¼Œç½‘ç»œæµé‡å¯ä»¥è·‘æ»¡è¾¾åˆ°1Gï¼Œè¿™ç§æƒ…å†µä¸‹å¾ˆå®¹æ˜“è§¦å‘EPOLLOUTï¼Œåˆ™ä½¿ç”¨ETã€‚å…³äºæŸäº›åœºæ™¯ä¸‹ETæ¨¡å¼æ¯”LTæ¨¡å¼æ•ˆç‡æ›´å¥½ï¼Œ&lt;/p&gt;
&lt;h2&gt;nginx ä¸­çš„ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;nginx ä½¿ç”¨çš„æ˜¯è¾¹ç¼˜è§¦å‘æ¨¡å¼&lt;/p&gt;
&lt;p&gt;epoll å¸¸ç”¨äºæ„å»ºäº‹ä»¶é©±åŠ¨çš„éé˜»å¡å¼‚æ­¥çš„äº‹ä»¶å¾ªç¯ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œæœ¬èº« epoll_wait è¿™ä¸ªæ“ä½œæ˜¯åŒæ­¥çš„ã€‚elect/poll/epollçš„æ„ä¹‰åœ¨äºåŒæ—¶ç­‰å¾…å¤šä¸ªsocketä¸Šçš„æ´»åŠ¨ã€‚select/poll/epollæ°¸è¿œéƒ½æ˜¯é˜»å¡çš„ï¼Œè·Ÿsocketæ˜¯å¦é˜»å¡æ— å…³ã€‚å½“ç„¶ä¸€èˆ¬æ¥è¯´ epoll ç®¡ç†çš„ socket è¦è®¾ç½®æˆéé˜»å¡çš„ã€‚&lt;/p&gt;
&lt;p&gt;nginxä¼šä¸€ç›´ï¼ˆé˜»å¡ï¼‰ç­‰å¾…epollè¿”å›äº‹ä»¶é€šçŸ¥æˆ–è€…epoll_waitè¶…æ—¶ï¼Œä¸€æ—¦æœ‰äº‹ä»¶è§¦å‘ï¼Œnginxå°±ä¼šè°ƒç”¨å…³è”çš„ï¼ˆread/writeï¼‰handlerå¤„ç†äº‹ä»¶ã€‚å¼€å‘è€…å¿…é¡»ä¿è¯æ¯ä¸€ä¸ªäº‹ä»¶handleréƒ½ä¸å¾—åŒ…å«ä»»ä½•é˜»å¡è°ƒç”¨ã€‚å¦åˆ™ï¼Œnginx workerçš„ä¸»çº¿ç¨‹å°†ä¼šå› ä¸ºä¸€ä¸ªäº‹ä»¶é˜»å¡ï¼Œå¯¼è‡´é˜Ÿåˆ—é‡Œé¢å¯èƒ½è¿˜æœ‰ä¸€å¤§å †äº‹ä»¶ä¸èƒ½åŠæ—¶å¤„ç†ï¼Œè¿™ä¼šä¸¥é‡å½±å“nginxçš„æ•ˆç‡ã€‚æ‰€ä»¥ nginx çš„ socketä¸èƒ½è®¾ç½®ä¸ºé˜»å¡çš„ï¼Œå¦‚æœsocketæ˜¯é˜»å¡çš„ï¼Œé‚£ä¹ˆä¸€ä¸ªsocketçš„IOäº‹ä»¶å°±ä¼šé˜»å¡åç»­æ‰€æœ‰çš„äº‹ä»¶å¤„ç†ï¼ŒCPUå°±ä¼šç©ºè½¬ï¼Œç­‰åœ¨é‚£é‡Œæ²¡äº‹å¹²äº†ã€‚è€Œåœ¨socketéé˜»å¡è°ƒç”¨æœŸé—´ï¼Œnginxå¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–çš„äº‹ä»¶ã€‚&lt;/p&gt;
&lt;h1&gt;epoll çš„ä½¿ç”¨&lt;/h1&gt;
&lt;p&gt;epoll æ€»å…±æœ‰ä¸‰ä¸ªç³»ç»Ÿè°ƒç”¨ï¼šepoll_create, epoll_ctl, epoll_waitã€‚å…¶ä¸­ epoll_create åœ¨å†…æ ¸ä¸­åˆ›å»ºä¸€ä¸ª eventpoll ç»“æ„ä½“ï¼Œepoll_ctl å¢åŠ æˆ–è€…åˆ é™¤ socket åˆ° epoll ä¸­ï¼Œepoll_wait ç­‰å¾…äº‹ä»¶å‘ç”Ÿã€‚&lt;/p&gt;
&lt;p&gt;åˆ›å»º epoll æ–‡ä»¶æè¿°ç¬¦&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;int epoll_create(int size);  // size å‚æ•°ä¼šè¢«å¿½ç•¥
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ·»åŠ  socket åˆ° epoll å¯¹è±¡ä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event);
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;epfd æ˜¯ epoll_create åˆ›å»ºçš„&lt;/li&gt;
&lt;li&gt;op æ˜¯è¿™ä¸‰ç§å¸¸é‡ï¼Œè¡¨ç¤ºæ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;EPOLL_CTL_ADDï¼šæ³¨å†Œæ–°çš„fdåˆ°epfdä¸­ï¼›&lt;/li&gt;
&lt;li&gt;EPOLL_CTL_MODï¼šä¿®æ”¹å·²ç»æ³¨å†Œçš„fdçš„ç›‘å¬äº‹ä»¶ï¼›&lt;/li&gt;
&lt;li&gt;EPOLL_CTL_DELï¼šä»epfdä¸­åˆ é™¤ä¸€ä¸ªfdï¼›&lt;/li&gt;
&lt;li&gt;fdï¼Œéœ€è¦æ›´æ”¹çš„ socket&lt;/li&gt;
&lt;li&gt;events æ˜¯ä¸€äº›å‚æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç›‘å¬äº‹ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;int epoll_wait(int epfd, struct epoll_event * events, int maxevents, int timeout);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸€èˆ¬å¦‚æœç½‘ç»œä¸»å¾ªç¯æ˜¯å•ç‹¬çš„çº¿ç¨‹çš„è¯ï¼Œå¯ä»¥ç”¨-1æ¥ç­‰(å³é˜»å¡è°ƒç”¨epoll_wait)ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸€äº›æ•ˆç‡ï¼Œå¦‚æœæ˜¯å’Œä¸»é€»è¾‘åœ¨åŒä¸€ä¸ªçº¿ç¨‹çš„è¯ï¼Œåˆ™å¯ä»¥ç”¨0ï¼ˆç«‹å³è¿”å›ï¼‰æ¥ä¿è¯ä¸»å¾ªç¯çš„æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://blog.csdn.net/dongfuye/article/details/50880251&lt;/li&gt;
&lt;li&gt;https://www.zhihu.com/question/63193746&lt;/li&gt;
&lt;li&gt;epoll è¯¦è§£ï¼šhttps://www.cnblogs.com/ljygoodgoodstudydaydayup/p/3916760.html&lt;/li&gt;
&lt;li&gt;https://www.zhihu.com/question/22576054&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 05:15:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/linux-zhong-de-epoll-he-nginx-zhong-de-ying-yong.html</guid><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>Linux ç£ç›˜ç®¡ç†å‘½ä»¤</title><link>/posts/linux-ci-pan-guan-li-ming-ling.html</link><description>&lt;h1&gt;æŒ‚è½½ç£ç›˜&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;mount&lt;/code&gt; å‘½ä»¤ï¼Œç”¨äºæŒ‚è½½ç£ç›˜ä»¥åŠæ˜¾ç¤ºç›¸å…³ä¿¡æ¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mount æ˜¾ç¤ºæŒ‚è½½ä¿¡æ¯
mount -t TYPE OPTIONS DEVICE DIRECTORY
æ¯”å¦‚ï¼š
     mount -t vfat /dev/sdb1 /mnt/media
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¸¸ç”¨çš„å‚æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-a æŒ‚è½½/etc/fstab ä¸­çš„æ‰€æœ‰æ–‡ä»¶
-f æ¨¡æ‹ŸæŒ‚è½½
-r åªè¯»æŒ‚è½½
-w è¯»å†™æŒ‚è½½ï¼ˆé»˜è®¤ï¼‰
-L æŒ‡å®š lebel
-u æŒ‡å®šuuid
-o é€‰é¡¹
    ro åªè¯»
    rw è¯»å†™
    user å…è®¸æ™®é€šç”¨æˆ·æŒ‚è½½
    check=none ä¸æ£€æŸ¥é”™è¯¯
    loop æŒ‚è½½æ–‡ä»¶ï¼Œæ¯”å¦‚iso
    nofail å¤±è´¥äº†ä¹Ÿä¸è¦æ±‡æŠ¥
    remount
--bind é€‰æ‹©æ–°çš„æŒ‚è½½ç‚¹ä½œä¸ºalias `mount --rbind olddir newdir`
--move ç§»åŠ¨åˆ°æ–°çš„æŒ‚è½½ç‚¹ `mount --move olddir newdir`
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ mount å‘½ä»¤çš„æœ€ä½³å®è·µæ˜¯åœ¨ &lt;code&gt;/etc/fstab&lt;/code&gt; ä¸­å…ˆè¾“å…¥éœ€è¦æŒ‚è½½çš„ç£ç›˜å¯¹åº”çš„é…ç½®ï¼Œç„¶åä½¿ç”¨ &lt;code&gt;mount -a&lt;/code&gt; æŒ‚è½½ã€‚è¿™æ ·é¿å…åœ¨ &lt;code&gt;/etc/fstab&lt;/code&gt; ä¸­æŒ‚è½½çš„å‘½ä»¤æ˜¯é”™çš„å¯¼è‡´æ— æ³•å¼€æœºã€‚&lt;/p&gt;
&lt;h2&gt;å¸è½½&lt;/h2&gt;
&lt;p&gt;umount DIRECTORY/DEVICE å¸è½½è®¾å¤‡&lt;/p&gt;
&lt;h1&gt;ç£ç›˜ä½¿ç”¨&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥çœ‹åˆ†åŒºçš„ uuidï¼šll /dev/disk/by-uuidã€‚åœ¨ &lt;code&gt;etc/fstab&lt;/code&gt; ä¸­æŒ‚è½½ç£ç›˜æœ€å¥½ä½¿ç”¨ uuid&lt;/li&gt;
&lt;li&gt;æŸ¥çœ‹åˆ†åŒºçš„ç±»å‹ï¼šparted -l&lt;/li&gt;
&lt;li&gt;df show free disk spaces&lt;/li&gt;
&lt;li&gt;du show disk usage infomationã€‚du -sh &lt;code&gt;ls&lt;/code&gt;  # great command&lt;/li&gt;
&lt;li&gt;dd disk dump&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;åˆ†åŒºä¸æ ¼å¼åŒ–&lt;/h1&gt;
&lt;p&gt;fdisk DEVICE&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;p   print partition table
n   new partition
w   write back to table
d   åˆ é™¤åˆ†åŒº
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkfs.ext4 PARTITION
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;fsck check a file system&lt;/p&gt;
&lt;h1&gt;é€»è¾‘å·&lt;/h1&gt;
&lt;p&gt;ç¡¬ç›˜ç§°ä½œç‰©ç†å·ï¼Œå¤šä¸ªç‰©ç†å·æ„æˆä¸€ä¸ªå·ç»„ï¼Œä¸€ä¸ªå·ç»„å¯ä»¥åˆ†æˆå¤šä¸ªé€»è¾‘å·&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 04:29:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/linux-ci-pan-guan-li-ming-ling.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>å…³äº CTO çš„ä¸€äº›æƒ³æ³•</title><link>/posts/guan-yu-cto-de-yi-xie-xiang-fa.html</link><description>&lt;p&gt;Hacker News ä¸Šçœ‹åˆ°ä¸€ç¯‡æ–‡ç« ä¸é”™ï¼Œæ‘˜å½•ä¸€äº›ç¬”è®°ï¼ŒåŸæ–‡é“¾æ¥åœ¨æœ€åé¢&lt;/p&gt;
&lt;h1&gt;æŠ€æœ¯ä¸Š&lt;/h1&gt;
&lt;p&gt;å­¦ä¹ æ–°ä¸œè¥¿çš„é€Ÿåº¦è¿œè¿œèµ¶ä¸ä¸Šé—®é¢˜äº§ç”Ÿçš„é€Ÿåº¦ã€‚
è™½ç„¶ startup å¯ä»¥å¾ˆçµæ´»çš„è½¬å‹ï¼Œä½†æ˜¯ä½ ç¬¬ä¸€æ¬¡é€‰æ‹©çš„æŠ€æœ¯æ¶æ„ä¸æ˜¯é‚£ä¹ˆå¥½æ”¹çš„
ç°åœ¨æŠ€æœ¯çš„ç”Ÿå‘½æœŸéƒ½å¾ˆçŸ­ï¼Œä¸€äº›å¾ˆæµè¡Œçš„æŠ€æœ¯å¾ˆå¯èƒ½ä¹Ÿä¼šå¾ˆå¿«è¿‡æœŸï¼Œæ‰€ä»¥é€‰æ‹©ä»»ä½•æŠ€æœ¯éƒ½è¦åšå¥½ç•™ä¸‹æŠ€æœ¯å€ºçš„å‡†å¤‡
ä½ å†™çš„æ¯ä¸€è¡Œä»£ç ä¹Ÿéƒ½å¯èƒ½å­˜åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œæ‰€ä»¥å°½é‡å†™å¥½å§ï¼Œå“ªæ€•æ…¢ä¸€ç‚¹
ä¸è¦è€æƒ³ç€åœä¸‹æ¥é‡æ„ï¼Œå°½é‡å¤šè°¢æµ‹è¯•&lt;/p&gt;
&lt;h1&gt;å…³äºæ‹›äºº&lt;/h1&gt;
&lt;p&gt;åªæœ‰å½“ä½ è¿«åˆ‡éœ€è¦è¿™ä¸ªäººçš„æ—¶å€™æ‰æ‰¾
æ‹›äººæ˜¯ä¸ºäº†è·Ÿçš„ä¸Šå¢é•¿ï¼Œè€Œä¸æ˜¯ä¸ºäº†äº§ç”Ÿå¢é•¿
çŸ¥é“éœ€è¦å¹²ä»€ä¹ˆäº‹æƒ…äº†å†æ‹›äºº&lt;/p&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œå¦‚æœä½ ä¸ç¡®å®šéœ€ä¸éœ€è¦æ‹›äººï¼Œé‚£ä¹ˆä¸€èˆ¬æ˜¯ä¸éœ€è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç®¡ç†äººä¸€ç›´éƒ½å¾ˆç®€å•ï¼Œä¿æŒå¦è¯šæ²Ÿé€šï¼Œå…¬å¼€åœ°æ‰“åˆ†ï¼Œæ²Ÿé€šå“ªäº›æ˜¯å¥½çš„ï¼Œå“ªäº›æ˜¯åçš„ã€‚è€Œä¸”è¿™æ ·ä¹Ÿå¯ä»¥è®©åšçš„ä¸å¥½çš„äººæœ‰æ‰€å‡†å¤‡ï¼Œå¦‚æœä¸åˆé€‚çš„äººï¼Œä»–ä»¬ä¹Ÿä¼šå¯¹è‡ªå·±çš„è¡¨ç°æœ‰æ‰€é¢„æœŸã€‚æœ€é‡è¦çš„æ˜¯ï¼Œç»™æ¯ä¸ªäººä¸€ä¸ªå¾ˆå¥½çš„ä¸ªäººå‘å±•è®¡åˆ’ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œåœ¨å…¬å¸å‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œçœ‹åˆ°æ–°äººæˆé•¿ç”šè‡³å˜ä¸º leader ä¹Ÿæ˜¯ä¸€ä»¶å¾ˆè®©äººæ¿€åŠ¨çš„äº‹æƒ…&lt;/p&gt;
&lt;p&gt;https://medium.com/sketchdeck-developer-blog/what-i-wish-i-knew-when-i-became-cto-fdc934b790e3?token=e-Jk1uh8fiXG6w_Z&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 04:27:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/guan-yu-cto-de-yi-xie-xiang-fa.html</guid><category>åˆ›ä¸š</category></item><item><title>Go è¯­è¨€æ•°æ®åº“æ•™ç¨‹</title><link>/posts/go-yu-yan-shu-ju-ku-jiao-cheng.html</link><description>&lt;p&gt;åœ¨å­¦ä¹  Go çš„è¿‡ç¨‹ä¸­é‡æ–°æ€è€ƒäº†æ•°æ®åº“ç›¸å…³çš„ä¸€äº›çŸ¥è¯†ï¼Œä¹‹å‰è®¤ä¸ºæ•°æ®åº“çš„é©±åŠ¨å°±æ˜¯åº”è¯¥æœ‰ä¸€ä¸ª conn å¯¹è±¡è¡¨ç¤ºè¿æ¥ï¼Œ ç„¶åå†æœ‰ä¸€ä¸ª cursor å¯¹è±¡æ¥å…·ä½“æ“ä½œã€‚ä½†æ˜¯ Go å®Œå…¨æ²¡æœ‰è¿™ä¹ˆæ¥ï¼Œè€Œæ˜¯ç›´æ¥ç”Ÿæˆä¸€ä¸ª db å¯¹è±¡æ¥æ“ä½œï¼Œå¼€å§‹è§‰å¾—ä¸é€‚åº”ï¼Œç„¶è€Œåæ¥æˆ‘ä¹Ÿå®åœ¨æƒ³ä¸èµ·æ¥ä¸ºä»€ä¹ˆéœ€è¦ç”¨ä¸¤ä¸ªå¯¹è±¡äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ ORM å‘¢ï¼Ÿä¹‹å‰ç”¨ Django çš„ORMæ¯”è¾ƒå¤šï¼Œå› ä¸ºç”Ÿæˆåå°éå¸¸æ–¹ä¾¿ï¼Œè€Œä¸”è‡ªå·±å¯¹ SQL ä¹Ÿä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå¯¹æ•°æ®åº“çš„æ“ä½œåŸºæœ¬ä¸Šéƒ½åœ¨ä½¿ç”¨è¿™ä¸ªORMã€‚ç„¶è€Œï¼Œç°åœ¨æ„Ÿè§‰åˆ°å¦‚æœæƒ³è¦è‡ªå·±çš„ä»£ç æ€§èƒ½æ¯”è¾ƒé«˜çš„è¯ï¼Œè‡ªå·±æ‰‹å·¥å†™ SQL å‡ ä¹æ˜¯ä¸å¯é¿å…çš„ï¼Œè€Œä¸” SQL å…¶å®ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå“äººã€‚&lt;/p&gt;
&lt;p&gt;Goè¯­è¨€ä¸­çš„ &lt;code&gt;database/sql&lt;/code&gt; åŒ…æä¾›äº†ä¸€ä¸ªæ•°æ®åº“çš„è®¿é—®æ¥å£ï¼Œä½†æ˜¯å¯¹äºä¸åŒçš„æ•°æ®åº“ï¼Œè¿˜éœ€è¦ä¸åŒçš„é©±åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€äº›å¸¸è§çš„æ•°æ®åº“çš„é©±åŠ¨å‚è§è¿™é‡Œï¼šhttp://golang.org/s/sqldriversã€‚&lt;/p&gt;
&lt;h1&gt;è¿æ¥æ•°æ®åº“&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;db, err := sql.Open(driver, dataSourceName)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œå€¼å¾—æ³¨æ„çš„æœ‰ä¸¤ç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Goè¯­è¨€ä¸­ä¸åƒå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œé™¤äº† connection å¯¹è±¡ä¹‹å¤–è¿˜æœ‰ cursor å¯¹è±¡ï¼Œgolang é‡Œé¢å¾ˆç®€å•ï¼Œç›´æ¥ç”¨dbå¯¹è±¡æ“ä½œå°±å¥½äº†ã€‚&lt;/li&gt;
&lt;li&gt;Open å‡½æ•°å¹¶ä¸ä¼šå»çœŸçš„é“¾æ¥æ•°æ®åº“ï¼Œç›´åˆ°ç¬¬ä¸€æ¡è¯­å¥æ‰ä¼šå»é“¾æ¥ï¼Œå¦‚æœæƒ³æ£€æµ‹æ˜¯å¦è¿æ¥æˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;if err := db.Ping(); err != nil {
  log.Fatal(err)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æ‰§è¡Œè¯­å¥&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;db.Exec&lt;/code&gt; æ–¹æ³•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;result, err := db.Exec(
    &amp;quot;INSERT INTO users (name, age) VALUES ($1, $2)&amp;quot;,
    &amp;quot;gopher&amp;quot;,
    27,
)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;result ç±»å‹å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;type Result Interface {
    LastInsertId()
    RowAffcted()
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æŸ¥è¯¢&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rows, err := db.Query(
    &amp;quot;SELECT NAME FROM  users WHERE age = $1&amp;quot;,
    age
)

if err != nil {
    log.Fatal(err)
}

for rows.Next() {
    var name string
    if err := rows.Scan(&amp;amp;name); err != nil {
        log.Fatal(err)
    }
    fmt.Printf(&amp;quot;%s is %d old\n&amp;quot;, name, age)
}

if err := rows.Err(); err != nil {
    log.Fata(err)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Row æœ‰ä¸€ä¸ªæ–¹æ³• Scanï¼Œè€Œ Rows ä¸­å¸¸ç”¨çš„ä¸¤ä¸ªæ–¹æ³•æ˜¯ Next å’Œ Err&lt;/p&gt;
&lt;p&gt;å¦‚æœæŸ¥è¯¢ç»“æœåªæœ‰ä¸€åˆ—çš„è¯ï¼Œä½¿ç”¨ QueryRow æ–¹æ³•ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;var age int64
row := db.QueryRow(&amp;quot;SELECT age FROM users WHERE name = $1&amp;quot;, name)
err := row.Scan(&amp;amp;age)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“ç„¶åƒå…¶ä»–æ‰€æœ‰çš„è¯­è¨€ä¸€æ ·ï¼Œå¯ä»¥é¢„ç¼–è¯‘è¯­å¥ç„¶åæ‰§è¡Œã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;age := 27
stme, err := db.Prepare(&amp;quot;SELECT name FROM users WHERE age = $1&amp;quot;)
if err != nil {
    log.Fatal(err)
}
rows, err := stmt.Query(age)
defer stmt.Close()
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;äº‹åŠ¡ï¼ˆTransactionï¼‰&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;tx, err := db.Begin()
if err != nil {
    log.Fatal(err)
}
...
tx.Commit() 
// or tx.Rollback()
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å¤„ç† null&lt;/h1&gt;
&lt;p&gt;å¦‚æœä¸€åˆ—å¯èƒ½ä¸º null çš„è¯ï¼Œé‚£ä¹ˆä¼ é€’ä¸ªScançš„å‚æ•°å°±ä¸åº”è¯¥æ˜¯å¯¹åº”çš„åŸºç¡€ç±»å‹ï¼Œè€Œåº”è¯¥æ˜¯å¯¹åº”çš„åŒ…å«nullçš„å¤åˆç±»å‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;var name NullString
err := db.QueryRow(&amp;quot;SELECT name FROM names WHERE id = $1&amp;quot;, &amp;amp;name)
if name.Valid {
   // ä½¿ç”¨ name.String è®¿é—®
} else {
  //
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é™¤æ­¤ä¹‹å¤–è¿˜åŒ…å«äº†å…¶ä»–å‡ ç§ Null å¤åˆå€¼ï¼ŒNullBoolã€NullFloat64ã€NullInt64ã€‚å¯ä»¥ä½¿ç”¨å¯¹åº”çš„å‚æ•°è®¿é—®&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨ sqlite3&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% go get github.com/mattn/go-sqlite3&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;database/sql&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;github.com/mattn/go-sqlite3&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;sqlite3&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;./foo.db&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;sqlx&lt;/h1&gt;
&lt;p&gt;å¾…ç»­&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 04:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/go-yu-yan-shu-ju-ku-jiao-cheng.html</guid><category>golang</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>ç»™äº§å“ç»ç†çš„ä»£ç è¯¾</title><link>/posts/gei-chan-pin-jing-li-de-dai-ma-ke.html</link><description>&lt;h1&gt;å¸¸è§è¯¯åŒº&lt;/h1&gt;
&lt;h2&gt;è¯¯åŒº1ï¼šè¿™ä¸ªåŠŸèƒ½ä¹‹å‰æˆ‘ä»¬å°±æœ‰å•Šï¼Œä¸ºä»€ä¹ˆç°åœ¨è¿˜éœ€è¦æ—¶é—´å¼€å‘ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æœ‰çš„åŠŸèƒ½åœ¨æ–°çš„æ¡ä»¶ä¸‹ä¸ä»£è¡¨èƒ½å¤Ÿç›´æ¥ä½¿ç”¨ï¼Œå¯èƒ½éœ€è¦å½»åº•éœ€è¦é‡æ–°å¼€å‘ï¼Œå¯èƒ½åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¹‹å‰çš„ç³»ç»Ÿèƒ½æ”¯æ’‘çš„å¹¶å‘é‡ã€è¿æ¥æ•°éƒ½å¤ªå°‘ï¼Œæ²¡æ³•æ»¡è¶³ç°åœ¨éœ€æ±‚&lt;/li&gt;
&lt;li&gt;ä¹‹å‰çš„å°±æ˜¯å‚¬ç€ä¸Šçº¿çš„ï¼Œä»£ç å¤ªtrickäº†ï¼Œåªèƒ½ä¸´æ—¶åº”ä»˜æµ‹è¯•ä¸€ä¸‹æ•ˆæœï¼Œæ²¡æ³•ç»´æŠ¤ï¼Œç°åœ¨å¦‚æœè¿™ä¸ªéœ€æ±‚æ˜ç¡®äº†ï¼Œé‚£éœ€è¦é‡æ–°è®¾è®¡ä¸€ä¸ªè‰¯å¥½çš„æ¶æ„&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;è¯¯åŒº2ï¼šæˆ‘ä¸è¦å…¨éƒ¨ç»“æœï¼Œèƒ½ä¸èƒ½å…ˆç»™æˆ‘è·‘ä¸€å°éƒ¨åˆ†æ•°æ®ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¥½å¤šæƒ…å†µä¸‹æ˜¯ä¸èƒ½çš„ã€‚æ¯”å¦‚è¯´ï¼Œä½ éœ€è¦1000ä¸‡è¡Œçš„æ•°æ®ï¼Œç¨‹åºå‘˜å¹¶ä¸æ˜¯ä¸€è¡Œä¸€è¡Œåœ°ä»æ•°æ®æºä¸­æ‹·è´å¤åˆ¶æ•°æ®å‡ºæ¥ï¼›è€Œæ˜¯å†™å¥½ä¸€ä¸ªè„šæœ¬ï¼Œè®©è®¡ç®—æœºå»ä¸€è¡Œä¸€è¡Œåœ°äº§ç”Ÿæ•°æ®ã€‚æ‰€ä»¥å¤šå¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œäº§ç”Ÿä¸€ä¸‡è¡Œæ•°æ®å’Œäº§ç”Ÿä¸€åƒä¸‡è¡Œæ•°æ®éœ€è¦çš„å·¥ä½œé‡å¾ˆå¯èƒ½æ˜¯ç›¸åŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸€äº›éœ€æ±‚åˆ†ææˆ–è€…å…¶ä»–é˜¶æ®µçš„ç®€å•çš„æ•°æ®æ•´åˆåˆ†æçš„å·¥ä½œï¼Œå¦‚æœäº§å“ç»ç†èƒ½å¤Ÿè‡ªå·±ä½¿ç”¨ SQL ä»æ•°æ®åº“æˆ–è€… Hive ç­‰å¤„æ¥æ‹‰å–æ•°æ®ï¼Œé‚£ä¹ˆå¾€å¾€æ¯”æ±‚ç¨‹åºå‘˜æ›´å¿«æ·ä¸€äº›ã€‚ç”šè‡³åˆ†æç«å“ç­‰ç­‰ä¸€äº›ç®€å•çš„æ•°æ®æŠ“å–å·¥ä½œï¼Œå¦‚æœèƒ½å¤Ÿåˆ©ç”¨å†…éƒ¨å¹³å°æ¥åšï¼Œå…¶å®ä¹Ÿéƒ½å¹¶ä¸éš¾ï¼Œå½“ç„¶è¿™éœ€è¦ç¨‹åºå‘˜å…ˆæä¾›ä¸€ä¸ªä¸é”™çš„å¹³å°ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œä¹Ÿæœ‰å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä¸€å°éƒ¨åˆ†æ•°æ®å’Œå…¨é‡æ•°æ®çš„ç¡®å·®å¼‚å¾ˆå¤§ã€‚è¿™ç§æƒ…å†µå¾€å¾€æ˜¯å› ä¸ºæ•°æ®çš„äº§ç”Ÿå—åˆ°çš„é™åˆ¶æ¯”è¾ƒå¤šï¼Œè·‘å¤§æ‰¹é‡çš„æ•°æ®éœ€è¦é‡æ–°æ¶‰åŠå¤æ‚çš„æ¶æ„ï¼Œè¿™æ—¶å€™å¾€å¾€ä¹Ÿéœ€è¦è€ƒè™‘ä¸‹æ˜¯ä¸æ˜¯éœ€è¦è¿™ä¹ˆå¤šçš„æ•°æ®ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;è¯¯åŒº3ï¼šè¿™ä¸ªæ˜¯çº¿ä¸Šé—®é¢˜ï¼ŒçœŸçš„éœ€è¦èµ¶ç´§æ”¹ä¸€ä¸‹&lt;/h2&gt;
&lt;p&gt;å¦‚æœè¿™ä¸ªé—®é¢˜ç°åœ¨å¯¹ç”¨æˆ·é€ æˆäº†ä¼¤å®³ï¼Œ&lt;/p&gt;
&lt;h1&gt;é¢˜å¤–è¯ï¼šæˆ‘é‡åˆ°çš„ä¸€äº›äº§å“ç»ç†&lt;/h1&gt;
&lt;h2&gt;æ˜¥é£åŒ–é›¨å‹&lt;/h2&gt;
&lt;p&gt;å¦‚æœæœ‰é—®é¢˜å¥¹ä¼šæ¥ç›´æ¥æ‰¾ä½ ï¼Œæ¯”è¾ƒå¤§æˆ–è€…éœ€è¦æå‰è§„åˆ’ä¼šæ‹‰ç›¸å…³äººå‘˜å¼€ä¸ªä¼šã€‚å¦‚æœæœ‰ç›¸åŒçš„é—®é¢˜ï¼ˆbugï¼‰ä¸¤æ¬¡æˆ–è€…ä»¥ä¸Šï¼Œå¥¹ä¼šé—®ä½ èƒ½ä¸èƒ½æ•™ä¸€ä¸‹å¥¹ï¼Œè®©å¥¹è‡ªå·±è§£å†³ï¼Œæˆ–è€…åˆæ­¥åˆ¤æ–­ä¸€ä¸‹ï¼Œæˆ–è€…æŠŠé—®é¢˜åˆ†ç±»æ¢³ç†æ¸…æ¥šï¼Œè€Œä¸æ˜¯ä¸¢ç»™ä½ ç®—äº†ã€‚å¦‚æœæœ‰æ—¶å€™å¥½å¤šæ¬¡äº†ï¼Œä½ æ²¡æœ‰åŠæ—¶å“åº”å¥¹ï¼Œå¥¹ä¼šæå‰å’Œä½ æ²Ÿé€šï¼Œé—®æ˜¯ä¸æ˜¯ç²¾åŠ›ä¸å¤Ÿï¼Œç„¶åè¯´å¦‚æœéœ€è¦ç”³è¯·æ›´å¤šèµ„æºå¥¹å¯ä»¥å¸®å¿™åè°ƒã€‚&lt;/p&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œäº§å“ç»ç†æ˜¯ä¸€ä¸ªè€ƒéªŒæƒ…å•†çš„å·¥ä½œï¼Œæ—¢è¦æœ‰åˆ›é€ æ€§çš„æ€ç»´ï¼Œåˆè¦åè°ƒå¥½å„æ–¹é¢èµ„æºã€‚ä½†æ˜¯ç°å®ä¸­çš„å¥½å¤šäº§å“ç»ç†å¤ªè®©äººå¤±æœ›äº†ï¼Œä»–ä»¬ä¸æ˜¯çœŸçš„çƒ­çˆ±åˆ›é€ äº§å“çš„è¿‡ç¨‹ï¼Œè€Œæ˜¯å› ä¸ºæ‡’å¾—å†™ä»£ç ã€æ‡’å¾—ææŠ€æœ¯ç„¶åé€‰æ‹©äº†äº§å“çš„é“è·¯ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 04 Apr 2018 03:49:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-04:/posts/gei-chan-pin-jing-li-de-dai-ma-ke.html</guid><category>åˆ›ä¸š</category><category>è¿è¥ä¸äº§å“</category></item><item><title>fzf - å‘½ä»¤è¡Œæ¨¡ç³ŠæŸ¥æ‰¾å™¨</title><link>/posts/fzf-ming-ling-xing-mo-hu-cha-zhao-qi.html</link><description>&lt;p&gt;fzf å¯ä»¥æ›¿ä»£ ag ç­‰ç­‰å·¥å…·&lt;/p&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;åœ¨ mac ä¸Šç›´æ¥ &lt;code&gt;brew install fzf&lt;/code&gt; å°±å¥½äº†&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨&lt;/h1&gt;
&lt;h2&gt;è°ƒç”¨ fzf å‘½ä»¤&lt;/h2&gt;
&lt;p&gt;ç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ fzf å¼€å§‹æ¨¡ç³ŠæŸ¥æ‰¾&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æŸ¥æ‰¾å‘½ä»¤&lt;/th&gt;
&lt;th&gt;åŒ¹é…ç±»å‹&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;sbtrkt&lt;/td&gt;
&lt;td&gt;æ¨¡ç³ŠåŒ¹é…&lt;/td&gt;
&lt;td&gt;åŒ¹é…sbtrkt&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;^music&lt;/td&gt;
&lt;td&gt;å‰ç¼€ç²¾ç¡®åŒ¹é…&lt;/td&gt;
&lt;td&gt;ä»¥musicå¼€å¤´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.mp3^&lt;/td&gt;
&lt;td&gt;åç¼€ç²¾ç¡®åŒ¹é…&lt;/td&gt;
&lt;td&gt;ä»¥.mp3ç»“å°¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;'wild&lt;/td&gt;
&lt;td&gt;ç²¾ç¡®åŒ¹é…(quoted)&lt;/td&gt;
&lt;td&gt;ç²¾ç¡®åŒ…å«wild&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;!fire&lt;/td&gt;
&lt;td&gt;inverse-exact-match&lt;/td&gt;
&lt;td&gt;ä¸åŒ…å«fire&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;!.mp3$&lt;/td&gt;
&lt;td&gt;inverse-suffix-exact-match&lt;/td&gt;
&lt;td&gt;ä¸ä»¥.mp3ç»“å°¾&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;|&lt;/code&gt;å¯ä»¥åšoråŒ¹é…ï¼Œ æ¯”å¦‚ &lt;code&gt;^core go$|rb$|py$&lt;/code&gt; è¡¨ç¤ºä»¥coreå¼€å¤´ï¼Œä»¥goæˆ–rbæˆ–pyç»“å°¾çš„&lt;/p&gt;
&lt;h2&gt;æŒ‰é”®&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ctrl-j/k æˆ–è€… ctrl-n/p æˆ–è€…ç®­å¤´æ¥ä¸Šä¸‹é€‰æ‹©
ctrl-c æˆ–è€… Esc é€€å‡º
Enter é€‰æ‹©
åœ¨å¤šè¡Œæ¨¡å¼ï¼Œtab å’Œ Shift-tab æ¥æ ‡è®°æ–‡ä»¶
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é™¤äº†è¿™äº›æŒ‰é”®ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ &lt;code&gt;--bind&lt;/code&gt; ç»‘å®šè‡ªå·±çš„æŒ‰é”®ï¼Œè§ä¸‹æ–‡&lt;/p&gt;
&lt;p&gt;é€‰ä¸­ä¹‹åï¼Œfzf çš„é»˜è®¤æ“ä½œæ˜¯æ‰“å°è¿™ä¸ªæ–‡ä»¶åï¼Œè¿™æ ·æˆ‘ä»¬è¿˜å¾—æ‰“å¼€ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ &lt;code&gt;vim $(fzf)&lt;/code&gt; ä¹Ÿå°±æ˜¯ä½¿ç”¨ vim æ‰“å¼€æˆ‘ä»¬é€‰ä¸­çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2&gt;ä½¿ç”¨å¿«æ·é”®&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Ctrl-T å¿«é€Ÿé€‰æ‹©å½“å‰ç›®å½•æ–‡ä»¶ï¼Œå¹¶æŠŠæ–‡ä»¶åæ‰“å°å‡ºæ¥
Ctrl-R ä½¿ç”¨fzfæ¥è¿‡æ»¤historyå‘½ä»¤
ALT-C cd è¿›å…¥é€‰ä¸­çš„ç›®å½•
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è‡ªåŠ¨è¡¥å…¨&lt;/h2&gt;
&lt;p&gt;fzf æ”¯æŒä¸å°‘å‘½ä»¤çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œé€šè¿‡ **&lt;tab&gt; æ¥è§¦å‘ã€‚å¦‚æœæ²¡æœ‰ç‰¹æ®Šæ”¯æŒæŸä¸ªå‘½ä»¤çš„è¯ï¼Œfzfä¼šç”¨æ–‡ä»¶æ¥è¡¥å…¨ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vim **&amp;lt;tab&amp;gt;
cd **&amp;lt;tab&amp;gt;
ssh **&amp;lt;tab&amp;gt;  ä» /etc/hosts ä¸­è¯»å–ä¸»æœºåˆ—è¡¨
unset **&amp;lt;tab&amp;gt;
export **&amp;lt;tab&amp;gt;
unalias **&amp;lt;tab&amp;gt;

kill -s TERM &amp;lt;tab&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™é‡Œæˆ‘æŠŠè§¦å‘æŒ‰é”®è®¾ç½®æˆäº† Ctrl-Y æ¯”åŸç”Ÿçš„è§¦å‘æ›´æ–¹ä¾¿ä¸€ç‚¹ï¼Œå¦‚ä½•é…ç½®è§ä¸‹æ–‡ã€‚&lt;/p&gt;
&lt;h1&gt;é€‰é¡¹&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;--height xx% é»˜è®¤æƒ…å†µä¸‹ fzf å æ®äº† 100% çš„å±å¹•
--reverse æç¤ºç¬¦åœ¨ä¸Šé¢
--bind ç»‘å®šå‘½ä»¤
--preview æŒ‡å®šé¢„è§ˆå‘½ä»¤
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨fzfä¸­é€‰ä¸­æ–‡ä»¶ä¹‹åçŸ¥è¯†æ‰“å°å‡ºè¿™ä¸ªæ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨bindæ¥æŒ‡å®šä¸€äº›å¿«æ·é”®ï¼Œæ¥å¯¹æ–‡ä»¶çš„ä¸€äº›æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Press F1 to open the file with less without leaving fzf
# Press CTRL-Y to copy the line to clipboard and aborts fzf (requires pbcopy)
fzf --bind &amp;#39;f1:execute(less -f {}),ctrl-y:execute-silent(echo {} | pbcopy)+abort&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œfzf ä¸ä¼šé¢„è§ˆæ–‡ä»¶çš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ --preview æŒ‡å®šï¼Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Use head instead of cat so that the command doesn&amp;#39;t take too long to finish
fzf --preview &amp;#39;head -100 {}&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¯­æ³•é«˜äº®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;fzf --preview &amp;#39;[[ $(file --mime {}) =~ binary ]] &amp;amp;&amp;amp;
                 echo {} is a binary file ||
                 (highlight -O ansi -l {} ||
                  coderay {} ||
                  rougify {} ||
                  cat {}) 2&amp;gt; /dev/null&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ç›¸å…³çš„ç¯å¢ƒå˜é‡&lt;/h2&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œfzf ä» &lt;code&gt;find * -type f&lt;/code&gt; ä¸­è¯»å–æ–‡ä»¶åˆ—è¡¨ï¼Œå¯ä»¥ä½¿ç”¨æ›´å¥½ç”¨çš„ fd æ¥æ›¿æ¢ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;export FZF_DEFAULT_OPTS=&amp;#39;--height 40% --reverse --border&amp;#39; è¿™ä¸ªå˜é‡æ¥æŒ‡å®šé»˜è®¤é€‰é¡¹ã€‚
export FZF_DEFAULT_COMMAND=&amp;#39;fd --type f&amp;#39; æ¥æŒ‡å®š
export FZF_CTRL_T_COMMAND=&amp;quot;$FZF_DEFAULT_COMMAND&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æˆ‘çš„æœ€ç»ˆé…ç½®&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[ -f ~/.fzf.zsh ] &amp;amp;&amp;amp; source ~/.fzf.zsh

export FZF_DEFAULT_COMMAND=&amp;#39;fd --type f&amp;#39;
export FZF_CTRL_T_COMMAND=&amp;#39;fd --type f&amp;#39;
export FZF_ALT_C_COMMAND=&amp;#39;fd --type d&amp;#39;
export FZF_COMPLETION_TRIGGER=&amp;#39;&amp;#39;
export FZF_DEFAULT_OPTS=&amp;quot;--height 40% --reverse --border --prompt &amp;#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39; \
    --bind &amp;#39;alt-j:preview-down,alt-k:preview-up,alt-v:execute(vi {})+abort,ctrl-y:execute-silent(cat {} | pbcopy)+abort,?:toggle-preview&amp;#39; \
    --header &amp;#39;A-j/k: preview down/up, A-v: open in vim, C-y: copy, ?: toggle preview&amp;#39; \
    --preview &amp;#39;(highlight -O ansi -l {} 2&amp;gt; /dev/null || cat {} || tree -C {}) 2&amp;gt; /dev/null&amp;#39;&amp;quot;
export FZF_CTRL_T_OPTS=$FZF_DEFAULT_OPTS
export FZF_CTRL_R_OPTS=&amp;quot;--preview &amp;#39;echo {}&amp;#39; --preview-window hidden:wrap --bind &amp;#39;?:toggle-preview&amp;#39;&amp;quot;
export FZF_ALT_C_OPTS=&amp;quot;--height 40% --reverse --border --prompt &amp;#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39; \
    --bind &amp;#39;alt-j:preview-down,alt-k:preview-up,?:toggle-preview&amp;#39; \
    --header &amp;#39;A-j/k: preview down/up, A-v: open in vim, C-y: copy, ?: toggle preview&amp;#39; \
    --preview &amp;#39;tree -C {}&amp;#39;&amp;quot;
bindkey &amp;#39;^Y&amp;#39; fzf-completion
bindkey &amp;#39;^I&amp;#39; $fzf_default_completion
[ -f ~/.dotfiles/lib/fzf-extras.sh ] &amp;amp;&amp;amp; source ~/.dotfiles/lib/fzf-extras.sh
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 01 Apr 2018 04:38:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-01:/posts/fzf-ming-ling-xing-mo-hu-cha-zhao-qi.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>fd - æ›´å¥½çš„ find å‘½ä»¤ï¼ˆfd - A nicer find commandï¼‰</title><link>/posts/fd-geng-hao-de-find-ming-ling-fd-a-nicer-find-command.html</link><description>&lt;p&gt;&lt;code&gt;fd&lt;/code&gt;ï¼ˆhttps://github.com/sharkdp/fdï¼‰ æ˜¯ &lt;code&gt;find&lt;/code&gt; å‘½ä»¤çš„ä¸€ä¸ªæ›´ç°ä»£çš„æ›¿æ¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fd&lt;/code&gt;ï¼ˆhttps://github.com/sharkdp/fdï¼‰is a modern and nicer replacement to the traditional &lt;code&gt;find&lt;/code&gt; command.&lt;/p&gt;
&lt;h1&gt;å¯¹æ¯”ä¸€ä¸‹ Some comparisons&lt;/h1&gt;
&lt;h2&gt;æŸ¥æ‰¾åå­—å«æœ‰æŸä¸ªå­—ç¬¦çš„æ–‡ä»¶ Find a filename with certain string&lt;/h2&gt;
&lt;p&gt;OLD&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % find . -name &amp;quot;*hello*&amp;quot;
./courses/hello_world.go
./courses/chapter_01/hello_world.go
./courses/chapter_01/hello_world
./examples/01_hello_world.go
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd hello
courses/chapter_01/hello_world
courses/chapter_01/hello_world.go
courses/hello_world.go
examples/01_hello_world.go
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾ Find files using regular expression&lt;/h2&gt;
&lt;p&gt;æ¯”å¦‚è¯´æŸ¥æ‰¾ç¬¦åˆ &lt;code&gt;\d{2}_ti&lt;/code&gt; æ¨¡å¼çš„æ–‡ä»¶ã€‚&lt;code&gt;find&lt;/code&gt; ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼éå¸¸å¤è€ï¼Œæ¯”å¦‚è¯´åœ¨è¿™é‡Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ &lt;code&gt;\d&lt;/code&gt;ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ &lt;code&gt;{x}&lt;/code&gt;  è¿™ç§è¯­æ³•ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹æˆ‘ä»¬çš„æ­£åˆ™è¡¨è¾¾å¼åšä¸€äº›æ”¹å†™ã€‚å…³äº&lt;code&gt;find&lt;/code&gt;æ”¯æŒçš„æ­£åˆ™è¡¨è¾¾å¼è¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fd&lt;/code&gt; é»˜è®¤å°±æ˜¯ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼ä½œä¸ºæ¨¡å¼ï¼Œå¹¶ä¸”é»˜è®¤åŒ¹é…çš„æ˜¯æ–‡ä»¶åï¼›è€Œ &lt;code&gt;find&lt;/code&gt; é»˜è®¤åŒ¹é…çš„æ˜¯å®Œæ•´è·¯å¾„ã€‚å¦å¤– &lt;/p&gt;
&lt;p&gt;For example, let's find a file whose name matches &lt;code&gt;\d{2}_ti&lt;/code&gt;. &lt;code&gt;find&lt;/code&gt; uses a very ancient form of regular expression. Neither can we use &lt;code&gt;\d&lt;/code&gt;, nor can we use &lt;code&gt;{x}&lt;/code&gt;. So we have to adjust our expression to these kind of limitations.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fd&lt;/code&gt;, by default, uses regular expression as patter, and matches filenames; on the other hand, &lt;code&gt;find&lt;/code&gt; uses the &lt;code&gt;-regex&lt;/code&gt; option to specify a regular expression, and it matches the whole path.&lt;/p&gt;
&lt;p&gt;OLD &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % find . -regex &amp;quot;.*[0-9][0-9]_ti.*&amp;quot;
./examples/33_tickers.go
./examples/48_time.go
./examples/28_timeouts.go
./examples/50_time_format.go
./examples/32_timers.go
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd &amp;#39;\d{2}_ti&amp;#39;
examples/28_timeouts.go
examples/32_timers.go
examples/33_tickers.go
examples/48_time.go
examples/50_time_format.go
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æŒ‡å®šç›®å½• Find in a specific directory&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;find&lt;/code&gt; çš„è¯­æ³•æ˜¯ &lt;code&gt;find DIRECTORY OPTIONS&lt;/code&gt;ï¼›è€Œ &lt;code&gt;fd&lt;/code&gt; çš„è¯­æ³•æ˜¯ &lt;code&gt;fd PATTERN [DIRECTORY]&lt;/code&gt;ã€‚æ³¨æ„å…¶ä¸­ç›®å½•æ˜¯å¯é€‰çš„ã€‚è¿™ç‚¹ä¸ªäººè®¤ä¸ºéå¸¸å¥½ï¼Œå› ä¸ºå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯åœ¨å½“å‰ç›®å½•æŸ¥æ‰¾ï¼Œæ¯æ¬¡éƒ½è¦å†™ &lt;code&gt;.&lt;/code&gt; éå¸¸çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find&lt;/code&gt; follows the syntax &lt;code&gt;find &amp;lt;directory&amp;gt; &amp;lt;options&amp;gt;&lt;/code&gt;; meanwhile, &lt;code&gt;fd&lt;/code&gt; uses &lt;code&gt;fd &amp;lt;pattern&amp;gt; [&amp;lt;directory&amp;gt;]&lt;/code&gt;. Note that the directory part is optional. AFAIK, this is very convenient. Most of the times, we are just trying to find something in the working directory, typing &lt;code&gt;.&lt;/code&gt; each time is very annoying.&lt;/p&gt;
&lt;p&gt;OLD&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % find examples -name &amp;quot;*hello*&amp;quot;
examples/01_hello_world.go
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd hello examples
examples/01_hello_world.go
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ç›´æ¥æ‰§è¡Œå‘½ä»¤ Execute the command without arguments&lt;/h2&gt;
&lt;p&gt;find ä¼šæ‰“å°å¸®åŠ©ä¿¡æ¯ï¼Œè€Œ fd åˆ™ä¼šæ˜¾ç¤ºå½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find&lt;/code&gt; will print help message, &lt;code&gt;fd&lt;/code&gt; will print all the files in current directory&lt;/p&gt;
&lt;p&gt;OLD&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % find
usage: find [-H | -L | -P] [-EXdsx] [-f path] path ... [expression]
       find [-H | -L | -P] [-EXdsx] -f path [path ...] [expression]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd
courses
courses/chapter_01
courses/chapter_01/chapter_1.md
courses/chapter_01/chapter_1.pdf
courses/chapter_01/hello_world
courses/chapter_01/hello_world.go
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æŒ‰åç¼€åæŸ¥æ‰¾æ–‡ä»¶ Find files by extension&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œ&lt;code&gt;find&lt;/code&gt; ä¸­éœ€è¦ä½¿ç”¨ &lt;code&gt;-name "*.xxx"&lt;/code&gt; æ¥è¿‡æ»¤ï¼Œè€Œ &lt;code&gt;fd&lt;/code&gt; ç›´æ¥æä¾›äº† &lt;code&gt;-e&lt;/code&gt; é€‰é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;It's a very common use case. With &lt;code&gt;find&lt;/code&gt;, you have to use &lt;code&gt;-name "*.xxx"&lt;/code&gt;, while &lt;code&gt;fd&lt;/code&gt; provides &lt;code&gt;-e&lt;/code&gt; option directly.&lt;/p&gt;
&lt;p&gt;OLD&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % find . -name &amp;quot;*.md&amp;quot;
./courses/chapter_01/chapter_1.md
./courses/chapter_1.md
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd -e md
courses/chapter_01/chapter_1.md
courses/chapter_1.md
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æŸ¥æ‰¾ä¸­è¿‡æ»¤æ‰ &lt;code&gt;.gitignore&lt;/code&gt; ä¸­çš„æ–‡ä»¶ Exclude files listed in &lt;code&gt;.gitignore&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;find&lt;/code&gt; å¹¶æ²¡æœ‰æä¾›å¯¹ &lt;code&gt;.gitingnore&lt;/code&gt; æ–‡ä»¶çš„åŸç”Ÿæ”¯æŒï¼Œæ›´å¥½çš„æ–¹æ³•å¯èƒ½æ˜¯ä½¿ç”¨ &lt;code&gt;git ls-files&lt;/code&gt;ã€‚è€Œä½œä¸ºä¸€ä¸ªç°ä»£å·¥å…·ï¼Œ&lt;code&gt;fd&lt;/code&gt; åˆ™é»˜è®¤æƒ…å†µä¸‹å°±ä¼šè¿‡æ»¤ &lt;code&gt;gitignore&lt;/code&gt; æ–‡ä»¶ï¼Œæ›´å¤šæƒ…å†µè¯·æŸ¥é˜…æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ &lt;code&gt;-I&lt;/code&gt; æ¥åŒ…å«è¿™äº›æ–‡ä»¶ï¼Œä½¿ç”¨ &lt;code&gt;-H&lt;/code&gt; æ·»åŠ éšè—æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find&lt;/code&gt; does not natively support &lt;code&gt;.gitignore&lt;/code&gt; files, a practical way would be using &lt;code&gt;git ls-files&lt;/code&gt;. As a modern tool, &lt;code&gt;fd&lt;/code&gt; ignores files listed in &lt;code&gt;.gitignore&lt;/code&gt; and hidden files by default.&lt;/p&gt;
&lt;p&gt;You could use &lt;code&gt;-I&lt;/code&gt; to include those files, &lt;code&gt;-H&lt;/code&gt; to also include hidden files.&lt;/p&gt;
&lt;p&gt;OLD&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % git ls-files | grep xxx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd xxx
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ’é™¤æŸä¸ªæ–‡ä»¶å¤¹ Exclude a directory&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;fd&lt;/code&gt; provides a &lt;code&gt;-E&lt;/code&gt; option to exclude directories. You could put the directories in &lt;code&gt;.fdignore&lt;/code&gt;, too.&lt;/p&gt;
&lt;p&gt;OLD&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % find . -path ./examples -prune -o -name &amp;#39;*.go&amp;#39;
./courses/hello_world.go
./courses/chapter_01/hello_world.go
./examples
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd -E examples &amp;#39;.go$&amp;#39;
courses/chapter_01/hello_world.go
courses/hello_world.go
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä½¿ç”¨ xargs Using xargs&lt;/h2&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä½¿ç”¨ç®¡é“è¿‡æ»¤çš„è¯ï¼Œéœ€è¦ä½¿ç”¨ '\0' æ¥ä½œä¸ºå­—ç¬¦ä¸²ç»“å°¾ï¼Œé¿å…ä¸€äº›æ½œåœ¨çš„ç©ºæ ¼å¼•èµ·çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;code&gt;find&lt;/code&gt; ä¸­éœ€è¦ä½¿ç”¨ &lt;code&gt;-print0&lt;/code&gt; æ¥è°ƒæ•´è¾“å‡º '\0' ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œåœ¨ &lt;code&gt;xargs&lt;/code&gt; ä¸­éœ€è¦ä½¿ç”¨ &lt;code&gt;-0&lt;/code&gt; è¡¨ç¤ºæ¥æ”¶è¿™ç§å­—ç¬¦ä¸²ã€‚è€Œåœ¨ &lt;code&gt;fd&lt;/code&gt; ä¸­ï¼Œå’Œ &lt;code&gt;xargs&lt;/code&gt; ä¿æŒäº†ä¸€ç›´ï¼Œä½¿ç”¨ &lt;code&gt;-0&lt;/code&gt; å‚æ•°å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;If you are using pipes to filter results, using &lt;code&gt;\0&lt;/code&gt; other than &lt;code&gt;\n&lt;/code&gt; would be a better option to avoid some potential problems.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;find&lt;/code&gt; with &lt;code&gt;-print0&lt;/code&gt; will output &lt;code&gt;\0&lt;/code&gt;-terminated strings, and &lt;code&gt;xargs&lt;/code&gt;'s option is &lt;code&gt;-0&lt;/code&gt; to process them. &lt;code&gt;fd&lt;/code&gt; chooses &lt;code&gt;-0&lt;/code&gt; as its option, which is consistent with &lt;code&gt;xargs&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;OLD&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % find . -name &amp;quot;*.go&amp;quot; -print0 | xargs -0 wc -l
       7 ./courses/hello_world.go
       7 ./courses/chapter_01/hello_world.go
      50 ./examples/07_switch.go
...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd -0 -e go | xargs -0 wc -l
       7 courses/chapter_01/hello_world.go
       7 courses/hello_world.go
       7 examples/01_hello_world.go
...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ€»ä¹‹ï¼Œfd å‘½ä»¤ç›¸å¯¹äº find æ¥è¯´ç›¸å½“ç®€å•æ˜“ç”¨äº†&lt;/p&gt;
&lt;p&gt;As you can see, using &lt;code&gt;fd&lt;/code&gt; can save you a lot of keystrokes.&lt;/p&gt;
&lt;h1&gt;PS&lt;/h1&gt;
&lt;h2&gt;ä½¿ç”¨ exec Using exec&lt;/h2&gt;
&lt;p&gt;OLD&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % find . -name &amp;quot;*.md&amp;quot; -exec wc -l {} \;
     114 ./courses/chapter_01/chapter_1.md
     114 ./courses/chapter_1.md
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NEW&lt;/p&gt;
&lt;p&gt;You could also omit the &lt;code&gt;{}&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % fd -e md --exec wc -l {}
     114 courses/chapter_1.md
     114 courses/chapter_01/chapter_1.md
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 01 Apr 2018 04:33:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-04-01:/posts/fd-geng-hao-de-find-ming-ling-fd-a-nicer-find-command.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>MyISAM vs InnoDB: mysql çš„ä¸¤ç§å­˜å‚¨å¼•æ“çš„åŒºåˆ«</title><link>/posts/myisam-vs-innodb-mysql-de-liang-chong-cun-chu-yin-qing-de-qu-bie.html</link><description>&lt;ul&gt;
&lt;li&gt;InnoDB æœ‰è¡Œçº§åˆ«çš„é”ï¼Œè€Œ MyISAM åªèƒ½é”å®šåˆ°è¡¨çº§åˆ«ã€‚&lt;/li&gt;
&lt;li&gt;InnoDB æœ‰æ›´å¥½çš„æ•…éšœæ¢å¤æœºåˆ¶.&lt;/li&gt;
&lt;li&gt;MyISAM æœ‰å…¨æ–‡ç´¢å¼•ï¼ŒInnoDB ç›´åˆ°5.6(Feb 2013)æ‰æ‹¥æœ‰ã€‚&lt;/li&gt;
&lt;li&gt;InnoDB å®ç°äº†äº‹ç‰©ã€å¤–é”®å’Œå…³ç³»é™åˆ¶, MyISAM æ²¡æœ‰.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ref: https://dba.stackexchange.com/questions/1/what-are-the-main-differences-between-innodb-and-myisam&lt;/p&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œå¼•ç”¨å®Œæ•´æ€§å’Œäº‹ç‰©æ‰æ˜¯æ•°æ®åº“çš„æœ¬è´¨ï¼Œæ‰€ä»¥è¯´ï¼šâ€œMyISAM is a file system that understands SQL. Thereâ€™s no comparison. If you want a database engine with MySQL, use InnoDB.â€&lt;/p&gt;
&lt;p&gt;ref: https://jeremystein.com/journal/innodb-versus-myisam-no-comparison/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 17 Mar 2018 22:11:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-03-17:/posts/myisam-vs-innodb-mysql-de-liang-chong-cun-chu-yin-qing-de-qu-bie.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>ã€Šç»“ç½‘ã€‹é˜…è¯»ç¬”è®°</title><link>/posts/jie-wang-yue-du-bi-ji.html</link><description>&lt;ol&gt;
&lt;li&gt;Alan Keyï¼šçƒ­çˆ±è½¯ä»¶çš„äººåº”è¯¥åˆ¶é€ è‡ªå·±çš„ç¡¬ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;ä¸è¦è‡ªä»¥ä¸ºæ˜¯ï¼Œè¦é€šè¿‡ A/B æµ‹æ¥è¿›è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯”å¦‚æœ‰ç”¨æˆ·åé¦ˆç³—ç™¾å®¡æ ¸ç•Œé¢å°†â€œé€šè¿‡â€æŒ‰é’®æ”¹æˆâ€œç¬‘äº†â€æŒ‰é’®å¾ˆä¸å¥½ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œæ„Ÿäººçš„æ¸©æƒ…å¸–ä¸å®¹æ˜“å°±é€šè¿‡äº†ã€‚
3. åœ¨ç¾å›¢ä¹‹å‰ï¼Œè¿‡æœŸä¸é€€æ˜¯å›¢è´­è¡Œä¸šçš„åˆ›æ”¶çš„å•†ä¸šæ¨¡å¼ä¹‹ä¸€ï¼Œè€Œç¾å›¢æä¾›äº†é€€æ¬¾æœåŠ¡ï¼Œåšåˆ°äº†ç†å¿µé¢†å…ˆï¼Œæ²¡æœ‰æ”¾å¼ƒä¸ºç”¨æˆ·åˆ›é€ ä»·å€¼çš„åˆè¡·ã€‚
4. å¤§å¤šæ•°æ—¶å€™ï¼Œä½ æƒ³åˆ°çš„åŸåˆ›æ¦‚å¿µå¯èƒ½æ—©å°±æœ‰å…¶ä»–äººæƒ³åˆ°äº†ï¼Œæ‰€ä»¥ä¸è¦æ‹˜æ³¥äºéè¦æœ‰ä¸€ä¸ªåŸåˆ›æ¦‚å¿µæ‰èƒ½ç¢¾å‹åˆ«äººã€‚å¦‚æœèƒ½æ‰¾åˆ°å·²ç»å­˜åœ¨çš„å®ç°ï¼Œé€šè¿‡ç ”ç©¶å®ƒå¯ä»¥èŠ‚çœå¾ˆå¤šæ¢ç´¢çš„æ—¶é—´ã€‚
5. æ—¢æœ‰æ¦‚å¿µçš„è½¬åŒ–ï¼šæ¯”å¦‚ä»åšå®¢ç®€åŒ–ä¸€ç‚¹å°±åˆ°äº†å¾®åšï¼Œå†ä»å¾®åšé™ä½é—¨æ§›å°±å¾—åˆ°äº†å¿«æ‰‹ã€‚
6. Web 2.0 å…¬å¸çš„ 7 ç§èƒ½åŠ›
  1. æœåŠ¡ï¼Œè€Œä¸æ˜¯æ‰“åŒ…çš„è½¯ä»¶
  2. æ§åˆ¶ç‹¬ç‰¹çš„éš¾ä»¥å†é€ çš„æ•°æ®æºï¼Œå¹¶ä¸”ç”¨æˆ·è¶Šå¤šå†…å®¹è¶Šä¸°å¯Œ
  3. æŠŠç”¨æˆ·å½“åšå…±åŒå¼€å‘è€…æ¥ä¿¡ä»»
  4. å€ŸåŠ›äºé›†ä½“æ™ºæ…§
  5. é€šè¿‡ç”¨æˆ·çš„è‡ªåŠ©æœåŠ¡æ¥å‘æŒ¥é•¿å°¾çš„åŠ›é‡
  6. è¶…è¶Šå•ä¸€è®¾å¤‡å±‚æ¬¡çš„è½¯ä»¶
  7. è½»é‡çº§çš„ç”¨æˆ·ç•Œé¢ã€å¼€å‘æ¨¡å¼å’Œå•†ä¸šæ¨¡å¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…¶å®æ€»ç»“èµ·æ¥å°±æ˜¯ä¸¤ä¸ªè¯ï¼šæœåŠ¡å’ŒUGCï¼Œè€Œä¸æ˜¯è½¯ä»¶å’ŒPGCã€‚
7. é€šè¿‡å·®å¼‚åŒ–å’Œä½æˆæœ¬æ¥å®ç°åˆ›æ–°ä»·å€¼ï¼Œä»è€Œåœ¨è“æµ·ä¸­æ—¶é—´æ®µå†…è¾¾åˆ°ç†æ€§çš„ç”¨æˆ·è§„æ¨¡æˆ–è€…è¶³å¤Ÿé«˜çš„ç«äº‰å£å’ã€‚
8. web 2.0 å°±æ˜¯æä¾›ä¸€ä¸ªç¤¾åŒºè®©ç”¨æˆ·æ¥ä¸»åŠ¨å‚ä¸åˆ›ä½œå†…å®¹ï¼Œè€Œä¸æ˜¯éœ€è¦ç½‘ç«™çš„è¿è¥è€…ç»„ç»‡ç¼–è¾‘å›¢é˜Ÿæ¥åˆ›ä½œã€‚ä¸‹é¢çš„å‡ ä¸ªä¾‹å­
  1. QDBï¼ˆbash.orgï¼‰æµ·å¤–ç‰ˆç³—äº‹ç™¾ç§‘ï¼Œåªæä¾›äº†ä¸€å¥—å†…å®¹ä½“ç³»æ¥è®©ç”¨æˆ·æäº¤å†…å®¹
  2. ä½œè€…è‡ªå·±çš„åšå®¢çš„å‹æƒ…é“¾æ¥ï¼šæœ¬æ¥åº”è¯¥æ˜¯ç”±ä½œè€…æ¥ç»´æŠ¤çš„ï¼Œä½†æ˜¯ä½œè€…é€‰æ‹©è®©è¯„è®ºæœ€å¤šçš„äº”ä¸ªäººè‡ªåŠ¨æˆä¸ºå‹æƒ…é“¾æ¥ã€‚
9. &lt;a href="https://assets.strategyzer.com/assets/resources/the-business-model-canvas.pdf"&gt;å•†ä¸šæ¨¡å¼ç”»å¸ƒ&lt;/a&gt;
  1. å“ªäº›ç”¨æˆ·å¯ä»¥é€šè¿‡äº§å“å—ç›Šï¼Œä»–ä»¬æ˜¯ç”·æ˜¯å¥³ï¼Œå¹´é¾„å¤šå¤§ï¼Œæœ‰å¤šå°‘äººï¼Ÿ
  2. è¿™ä¸ªäº§å“ä¸ºç›®æ ‡ç”¨æˆ·å¸¦æ¥ä»€ä¹ˆä»·å€¼ï¼Ÿ
  3. äº§å“æ‰€å®ç°çš„ä»·å€¼å¦‚ä½•ä¼ é€’ç»™ç”¨æˆ·ï¼Ÿ
  4. å¦‚ä½•å»ºç«‹å’Œç»´æŠ¤äº§å“å’Œç”¨æˆ·ä¹‹é—´çš„å…³ç³»ï¼Ÿ
  5. èƒ½è·å¾—æ”¶å…¥å—ï¼Ÿ
  6. æ ¸å¿ƒèµ„æºå“ªäº›å·²ç»å…·å¤‡äº†ï¼Œå“ªäº›è¿˜æ˜¯æ¬ ç¼ºçš„ï¼Ÿ
  7. éœ€è¦å®Œæˆä»€ä¹ˆå…³é”®ä¸šåŠ¡æ‰èƒ½è¾¾åˆ°é‡Œç¨‹ç¢‘ï¼Ÿ
  8. éœ€è¦å¤–éƒ¨åˆä½œä¼™ä¼´å—ï¼Ÿ
  9. ä¸Šè¿°é—®é¢˜çš„æˆæœ¬æ˜¯ï¼Ÿ
10. é¡¹ç›®æ˜¯å¦èƒ½å¤ŸçœŸæ­£è½åœ°ï¼Ÿ
  1. å¯ä»¥ä½¿ç”¨â€œæœ‹å‹æµ‹è¯•æ³•â€ã€‚æˆ‘èº«è¾¹çš„æŸä¸ªæœ‹å‹æ˜¯ä¸æ˜¯ä¼šæˆä¸ºç”¨æˆ·ï¼Ÿä»–ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™æ¬¾äº§å“ï¼Ÿæˆ‘çš„çˆ¶æ¯ä¼šä¸ä¼šä½¿ç”¨è¿™æ¬¾äº§å“ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿå¦‚æœæµ‹è¯•ä¸‹æ¥å‘ç°èº«è¾¹æ²¡æœ‰ä¸€ä¸ªâ€œçœŸäººâ€æƒ³è¦ä½¿ç”¨å®ƒï¼Œè¿™ä¸ªæ¦‚å¿µå°±æœ‰å¾ˆå¤§é—®é¢˜ã€‚
  2. å¯ä»¥ä½¿ç”¨â€œçœŸå®ä¸–ç•ŒæŠ•å°„æ³•â€ã€‚æŠŠäº’è”ç½‘ä¸­çš„æ¦‚å¿µæŠ•å°„åˆ°çœŸå®ä¸–ç•Œä¸­æ™®éå­˜åœ¨çš„äº‹ç‰©ä¸Šï¼Œé€šè¿‡å·²ç»è¢«éªŒè¯çš„çœŸå®ä¸–ç•Œæ¡ˆä¾‹æ¥æ¨æ–­äº’è”ç½‘äº§å“çš„å¯è¡Œæ€§ã€‚æ¯”å¦‚åœ¨ facebook çš„ news feed ä¹‹å‰ï¼Œè¦äº†è§£æŸä¸ªå¥½å‹çš„åŠ¨æ€éœ€è¦åˆ°ä»–çš„ä¸»é¡µå»çœ‹ï¼Œç°å®ä¸–ç•Œä¸­æˆ‘ä»¬æ˜¾ç„¶ä¸æƒ³è¦å»å¥½å‹å®¶é‡Œæ‰“å¬ä»–çš„æœ€æ–°çŠ¶å†µï¼Œè€Œæ˜¯ä¸ç»æ„é—´å°±ä¼šå¬è¯´ï¼Œè€Œnews feed æ˜¾ç„¶æ»¡è¶³äº†è¿™ä¸ªéœ€æ±‚ã€‚
11. äº§å“æ˜¯ä¸ºç”¨æˆ·æä¾›ä»·å€¼çš„ï¼Œå¦‚æœèƒ½æ›´å¥½åœ°ä¸ºç”¨æˆ·æä¾›ä»·å€¼ï¼Œé‚£å°±è¦åŠæ—©é©å‘½è‡ªå·±ã€‚æ¯”å¦‚æ–°æµªæ¨å‡ºäº†æ–°æµªå¾®åšï¼Œç›´æ¥å»çœ‹æ–°é—»çš„äººå°±å°‘äº†ï¼Œç®—æ˜¯é©æ‰è‡ªå·±çš„å‘½ã€‚ä½†æ˜¯æ–°æµªæ–°é—»è‡ªèº«å®é™…ä¸Šè¿˜æ˜¯æ²¡æœ‰æ„è¯†åˆ°å±æœºï¼Œæœ€ç»ˆè¢«ä»Šæ—¥å¤´æ¡å–è€Œä»£ä¹‹
12. æœªæ¥çš„è¡Œä¸šåˆ’åˆ†
  1. ä¸åº”è¯¥æ˜¯ å†œä¸š-å·¥ä¸š-æœåŠ¡ä¸šï¼Œè€Œå› è¯¥æ˜¯&lt;strong&gt;åˆ¶é€ ä¸š-æœåŠ¡ä¸š-ä½“éªŒé¡µ&lt;/strong&gt;ã€‚å¦‚æœä½ ä¸ºç‰©å“å’Œæœ‰å½¢çš„ä¸œè¥¿æ”¶è´¹ï¼Œé‚£ä¹ˆä½ æ‰€ä»äº‹çš„å°±æ˜¯å•†å“ä¸šï¼Œå¦‚æœä½ ä¸ºè‡ªå·±å¼€å±•çš„æ´»åŠ¨æ”¶è´¹ï¼Œé‚£ä¹ˆä½ ä»äº‹çš„å°±æ˜¯æœåŠ¡ä¸šï¼Œåªæœ‰å½“ä½ ä¸ºæ¶ˆè´¹è€…å’Œä½ ä¸€èµ·åº¦è¿‡çš„æ—¶é—´æ”¶è´¹çš„æ—¶å€™ï¼Œä½ æ‰ç®—è¿›å…¥äº†ä½“éªŒä¸šã€‚â€”â€”ã€Šä½“éªŒç»æµã€‹ã€‚æ¯”å¦‚ç½‘æ¸¸ã€QQä¼šå‘˜ç­‰ã€‚
13. äº’è”ç½‘å…¬å¸ä¸­çš„ä¸¤ç§é‡è¦äº§å“ï¼š
  1. ç°é‡‘ç‰›ï¼šåˆ©æ¶¦ç‡è¶…çº§é«˜ï¼Œå äº†å…¬å¸æ€»åˆ©æ¶¦çš„å¾ˆå¤§æ¯”ä¾‹ï¼Œæ¯”å¦‚ä¹åŸä»£ç†çš„é­”å…½ä¸–ç•Œ
  2. å¹³å°äº§å“ï¼šèƒ½é€šè¿‡è‡ªèº«çš„èµ„æºä¼˜åŠ¿æ‹‰åŠ¨å…¶ä»–äº§å“çš„äº§å“ï¼Œæ¯”å¦‚QQã€‚
  ä¸€æ¬¾äº§å“çš„ç”¨æˆ·è§„æ¨¡æ—¶å€™ä¼šå˜å¾—å¾ˆå¤§ï¼Œæœ€ç»ˆæˆé•¿ä¸ºå¹³å°å‹äº§å“ï¼Œè¦çœ‹è¿™æ¬¾äº§å“æœ‰æ²¡æœ‰æ»¡è¶³ç”¨æˆ·çš„å¼ºéœ€æ±‚å’Œé¢‘å‘éœ€æ±‚ã€‚
  å¾ˆå¤šç”¨æˆ·éƒ½æ˜¯åœ¨æ³¨å†Œè¿™ä¸ªæµç¨‹ä¸­æµå¤±çš„ï¼Œæ‰€ä»¥å¹³å°æä¾›è‡ªå·±çš„è´¦å·ä½“ç³»æ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œæ¯”å¦‚ Google çš„ Gmail è´¦å·ã€‚
14. è·å¾—æŠ•èµ„ï¼Œç‹æ½‡æ€»ç»“çš„ä¸‰å¤§é—®é¢˜ï¼š
  1. äº§å“æ¦‚å¿µæ˜¯å¦ å¤„äº è¶‹åŠ¿ ä¸Šï¼Œæ˜¯å¦ åœ¨ æ»¡è¶³ å¼º éœ€ æ±‚å’Œ é¢‘ å‘ éœ€æ±‚ï¼Ÿ 
  2. æ˜¯å¦ æ‰¾åˆ°äº† æœ‰æ•ˆ çš„ çªç ´å£ï¼Œ çªç ´ ä¹‹å å¦‚ä½• å»ºç«‹ å£å’ï¼Ÿ
  3. å›¢é˜Ÿ èƒ½åŠ› ä¸ äº§å“ æ¦‚å¿µ æ˜¯å¦ åŒ¹é…ï¼Ÿ
  çªç ´å£çš„ä½œç”¨åœ¨äºè®©ç”¨æˆ·è§‰å¾—äº§å“æœ‰ç”¨ï¼Œå£å’çš„ä½œç”¨åœ¨äºè®©è¿™ç§æœ‰ç”¨å˜å¾—éš¾ä»¥å¤åˆ¶ã€‚App Store é‡Œçš„å¤§é‡åº”ç”¨ï¼Œæ·˜å®å–å®¶æœåŠ¡å¸‚åœºé‡Œçš„å¤§é‡åº”ç”¨ï¼Œå¾®ä¿¡ä¸­æ²‰æ·€çš„å…³ç³»é“¾ï¼Œéƒ½æ˜¯éå¸¸é«˜çš„å£å’ï¼Œç«äº‰å¯¹æ‰‹ä»¬å¾ˆéš¾å¤åˆ¶ä¸€äº›åŠŸèƒ½æ¥è·å¾—è¿™äº›ç‰¹æ®Šçš„èµ„æºã€‚
15. ä½¿ç”¨ç„¦ç‚¹å°ç»„å¯¹ç”¨æˆ·è¿›è¡Œæ¦‚å¿µæµ‹è¯•
  1. ç„¦ç‚¹å°ç»„å°±æ˜¯é‚€è¯·6-9ä¸ªäººï¼Œå…·æœ‰ä»£è¡¨æ€§çš„ç”¨æˆ·å¯¹æŸä¸€ä¸»é¢˜æˆ–è§‚å¿µè¿›è¡Œæ·±å…¥è®¨è®ºçš„æ–¹æ³•ã€‚
  2. ç”¨æˆ·çš„å†å²è¡Œä¸ºæ¯”ä»–ä»¬çš„å½“å‰æ„æ„¿æ›´æœ‰ä»·å€¼ï¼Œå› ä¸ºç”¨æˆ·ä¸ä¸€å®šè¡¨è¾¾çš„æ˜¯çœŸå®è§‚ç‚¹ã€‚
  3. å…¶ä»–çš„æ–¹æ³•åŒ…æ‹¬ä½“éªŒè§‚å¯Ÿå®¤ï¼ˆæ„Ÿè§‰ä¸å¤ªç°å®ï¼‰ï¼Œæ›´é‡è¦çš„æ˜¯ A/Bè¯•éªŒã€‚
  æœ€é‡è¦çš„æ„è¯†æ˜¯ï¼Œç½‘ç«™åšå‡ºé‡è¦è§‰å¾—çš„æ—¶å€™ï¼Œè¦ä¾èµ–æ•°æ®ï¼Œè€Œä¸èƒ½æƒ³å½“ç„¶ï¼Œæ¯”å¦‚ picasa çš„ä¸‹è½½æŒ‰é’®è¯•éªŒã€‚&lt;/p&gt;
&lt;h2&gt;äº§å“ç»ç†çš„å…·ä½“å·¥ä½œ&lt;/h2&gt;
&lt;h3&gt;äº§å“è®¾è®¡æ–‡æ¡£&lt;/h3&gt;
&lt;p&gt;æŠŠæ¦‚å¿µå˜æˆå›¾çº¸ã€‚YNï¼šè¿™ç®—æ˜¯äº§å“ç»ç†çš„ä¸€é¡¹å…·ä½“å·¥ä½œäº†ï¼Œå½“ç„¶ç½‘é¡µè¿™ä¸ªæ¦‚å¿µåœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ä¹Ÿåº”è¯¥æ”¹æˆåº”ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦ä¸‰ä¸ªå›¾çº¸ï¼šç½‘é¡µ(App)ç»“æ„å›¾ã€ç½‘é¡µ(App)çº¿æ¡†å›¾ã€ç½‘é¡µ(App)æè¿°è¡¨&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç½‘é¡µ(App)ç»“æ„å›¾ã€‚æè¿°äº†æ•´ä¸ªç½‘ç«™æˆ–è€…åº”ç”¨çš„æ¶æ„ï¼Œç¡®å®šäº†æ¨¡å—åˆ’åˆ†å’Œç½‘é¡µï¼ˆåº”ç”¨ç•Œé¢ï¼‰çš„ä¸ªæ•°ã€‚ï¼ˆå¾ˆå¤šæ—¶å€™æ ¹ç»è¿™ä¸ªç¡®å®šurlè§„åˆ™å’Œtitleè§„åˆ™ï¼‰ã€‚æè¿°ç»“æ„å›¾åº”è¯¥ä½¿ç”¨MESEæ³•åˆ™ï¼Œç›¸äº’ç‹¬ç«‹ï¼Œå®Œå…¨ç©·å°½ã€‚&lt;strong&gt;å…¶ä¸­æ ‡æ³¨çš„ä¼˜å…ˆçº§å¯ä»¥å°†é¡¹ç›®è¿›ä¸€æ­¥ç»†åˆ†ä¸ºå‡ ä¸ªé˜¶æ®µï¼šphase1ã€phase2ã€phase3ï¼Œè¿™å¯¹ç½‘ç«™çš„å¼€å‘å¾ˆæœ‰å¸®åŠ©ï¼Œå¯ä»¥è®©é¡¹ç›®æˆå‘˜çŸ¥é“ï¼Œå®Œæˆäº†phase1åŸºæœ¬ä¸Šç½‘ç«™å°±å¯ç”¨äº†ã€‚&lt;/strong&gt; &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ–¹æ³•æ¥åšäº§å“è§„åˆ’ï¼Œåœ¨å®éªŒè¿‡ç¨‹ä¸­æ›´å®¹æ˜“è¾¾åˆ°ç”¨æˆ·äººç‰©çš„é—­ç¯ï¼Œæ¯”å¦‚å¯¹äºä¹¦çš„CRUDï¼ŒåŸºæœ¬æ»¡è¶³äº†å¯¹ç”¨æˆ·ä¹°ä¹¦çš„é—­ç¯ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æˆæœ¬çš„æ—¶å€™ï¼Œæƒ³ç€ç ”å‘æˆæœ¬åªå 20%ã€‚å‰©ä¸‹çš„é—®é¢˜æ˜¯ç¡®è®¤è¿™80%çš„éç ”å‘æˆæœ¬éƒ½åœ¨å“ªé‡Œï¼ŸYN: ä¸ºä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;PSï¼šæ¶ˆç­æ‹–å»¶çš„æœ€å¥½æ–¹æ³•ï¼Œå°±æ˜¯æŠŠä»»åŠ¡åˆ†è§£ä¸ºè¿ç»­çš„ï¼Œåœ¨èƒ½åŠ›èŒƒå›´å†…çš„å°ä»»åŠ¡ã€‚
&lt;img alt="[ç³—äº‹ç™¾ç§‘çš„åŠŸèƒ½]" src="https://ws3.sinaimg.cn/large/006tNc79ly1fpfxrkcmqbj30do0cgjv6.jpg" height=200px/&gt;
&lt;img alt="[ç³—äº‹ç™¾ç§‘ç”¨æˆ·è§’è‰²åˆ’åˆ†]" src="https://ws4.sinaimg.cn/large/006tNc79ly1fpfxrup5mdj30ou0dwq91.jpg" height=200px /&gt;
  2. ç½‘é¡µ(App)çº¿æ¡†å›¾ã€‚å›¾ç‰‡è¶ŠæŠ½è±¡ï¼Œè¯»è€…ç†è§£èµ·æ¥å°±æœ‰è¶Šå¤§çš„å‘æŒ¥ç©ºé—´ã€‚ä½¿ç”¨ balsamiq mockup ç»˜åˆ¶çº¿æ¡†å›¾ã€‚
  3. ç½‘é¡µæè¿°è¡¨æ˜¯åŒ…å«äº†ä¸€ä»½ç½‘é¡µæ‰€éœ€è¦æˆ˜å£«çš„å…ƒç´ å’Œä»–èƒŒåçš„é€»è¾‘ï¼Œè€Œä¸åŒ…å«è¿™äº›å…ƒç´ åœ¨é¡µé¢ä¸­çš„å¸ƒå±€ã€‚
    1. å°†äº§å“ç»ç†çš„å·¥ä½œå’Œäº¤äº’è®¾è®¡å¸ˆçš„å·¥ä½œåŒºåˆ†å¼€ï¼ŒèŒ¶å“ç»ç†å…³æ³¨çš„æ˜¯ä¼ é€’&lt;em&gt;ä»€ä¹ˆ&lt;/em&gt;ä¿¡æ¯ï¼Œäº¤äº’è®¾è®¡å¸ˆå…³æ³¨çš„æ˜¯&lt;em&gt;æ€æ ·&lt;/em&gt;ä¼ é€’ä¿¡æ¯ã€‚
    2. å‘ç ”å‘å›¢é˜Ÿè¯´æ˜ä¿¡æ¯èƒŒåçš„é€»è¾‘ï¼Œæ–¹ä¾¿ä»–ä»¬å®ç°ã€‚
    æè¿°è¡¨å’Œçº¿æ¡†å›¾ä¸€èµ·æ„æˆäº†ä¸€ä¸ªç½‘é¡µçš„å®Œæ•´æè¿°ï¼Œæœ‰äº†è¿™ä¸ªç ”å‘æ‰èƒ½è¯„ä¼°å¼€å‘é‡ã€‚
  é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€äº›éåŠŸèƒ½éœ€æ±‚ï¼Œæ¯”å¦‚ç½‘é¡µçš„åŠ è½½å»¶æ—¶ç­‰ç­‰ï¼Œéœ€è¦ä½œä¸ºæ•´ä½“éœ€æ±‚ä¸€å¹¶æäº¤ã€‚&lt;/p&gt;
&lt;p&gt;äº§å“è®¾è®¡æ–‡æ¡£æ˜¯ä¼´éšäº§å“æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„é“¾æ¥æ¦‚å¿µå’Œæ‰§è¡Œçš„é‡è¦å·¥å…·ï¼Œå®ƒå¸®åŠ©äº§å“å›¢é˜Ÿä¸ç ”å‘å›¢é˜Ÿå’Œé«˜å±‚ä¹‹é—´è¾¾æˆå…±è¯†ï¼Œè¿›è€Œæ˜ç¡®ç ”å‘è®¡åˆ’å¹¶æŒ‡å¯¼ç ”å‘è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è®¾è®¡æ–‡æ¡£éœ€è¦æœ‰ FAQï¼Œå½“é¡¹ç›®è¿›è¡Œäº†å¾ˆä¹…ä¹‹åï¼Œå¾ˆå¯èƒ½æ²¡æœ‰äººè®°å¾—å½“åˆæŸä¸ªéœ€æ±‚æ˜¯å¦‚ä½•ç¡®å®šçš„ï¼Œè¿™æ—¶å€™é™„åŠ ä¿¡æ¯å°±èƒ½å¸®åŠ©å›¢é˜Ÿæ‰¾å‡ºæœ€åˆçš„èƒŒæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;åº”è¯¥ä½¿ç”¨ wiki è€Œä¸æ˜¯ word æ–‡æ¡£æ¥è®°å½•äº§å“å¼€å‘æ–‡æ¡£ï¼Œå¥½å¤„å¤ªå¤šäº†ï¼Œä¸å†èµ˜è¿°ã€‚&lt;/li&gt;
&lt;li&gt;äº§å“ç»ç†ä¸åº”è¯¥å¯¹åˆ«äººï¼ˆå°¤å…¶æ˜¯ç ”å‘äººå‘˜ï¼‰æŒ‡æ‰‹ç”»è„šã€‚&lt;/li&gt;
&lt;li&gt;äº§å“å¼€å‘æ–‡æ¡£åº”è¯¥ä½¿ç”¨è‚¯å®šçš„è¯­è¨€ï¼Œä¸è¦ææ¨¡ç³Šçš„éœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;ä¸è¦è¿‡åˆ†å…³æ³¨æ–‡æ¡£è€Œå¿½è§†äº†æ²Ÿé€š&lt;/li&gt;
&lt;li&gt;æ–‡æ¡£çš„æ¨¡æ¿å¹¶ä¸é‡è¦ï¼Œå…³é”®æ˜¯å†…å®¹&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;ç”¨æˆ·ä½“éªŒ&lt;/h2&gt;
&lt;p&gt;ç½‘ç»œå¹¿å‘Šåœ¨äº§å“è®¤çŸ¥ä¸­åªèƒ½æ’åç¬¬äºŒï¼Œæ’åç¬¬ä¸€çš„æ˜¯æœ‹å‹ä¹Ÿåœ¨ç”¨ã€‚è€Œç”¨æˆ·ä½“éªŒå†³å®šå£ç¢‘ï¼Œå£ç¢‘å†³å®šäº§å“æˆè´¥ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·ä½“éªŒçš„ä¸‰è¦ç´ ï¼šåˆ«è®©æˆ‘ç­‰ã€åˆ«è®©æˆ‘æƒ³ã€åˆ«è®©æˆ‘çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·çš„è€å¿ƒæ˜¯éå¸¸æœ‰é™çš„ï¼Œä»–ä»¬å¯¹äºé€Ÿåº¦çš„è¿½æ±‚&lt;em&gt;è¶…è¿‡äº†å¯¹äºç”»é¢çš„è¿½æ±‚&lt;/em&gt;ã€‚å®é™…ä¸Šè¿™æ˜¯ä¸€ä¸ªå“åº”é—®é¢˜ï¼Œè€Œä¸æ˜¯æ€§èƒ½é—®é¢˜ï¼Œæ¯”å¦‚ç¨‹åºæ‰“å¼€æ—¶å€™çš„å›¾æ ‡æ”¾å¤§åŠ¨ç”»ã€‚è€Œä¸”å¦‚æœç‰ºç‰²å®Œæ•´æ€§åœ¨å¯ä»¥å®¹å¿çš„èŒƒå›´å†…ï¼Œå°±è¦ç‰ºç‰²å®Œæ•´æ€§ï¼Œè€Œè®©æ€§èƒ½æ›´å¥½ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸‡ä¸€å‡ºç°äº†é—®é¢˜ï¼Œè¦åŠ å¼ºä¿¡æ¯çš„æŠ«éœ²å’Œç”¨æˆ·çš„æ²Ÿé€šï¼Œäº‰å–ç”¨æˆ·çš„è°…è§£å’Œæ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;å¸ƒä»€å†…å°”ï¼šè°ä½ä¼°ç¾å›½äººçš„æ™ºå•†ï¼Œè°å°±ä¼šå‘è´¢ã€‚ç”¨æˆ·æ˜¯æ‡’å¾—æƒ³çš„ã€‚&lt;/p&gt;
&lt;p&gt;è®¾å¤‡å½“å‰ä½ç½®å’Œç›®æ ‡ä½ç½®çš„è·ç¦»ï¼Œè·ç¦»è¶ŠçŸ­ï¼Œæ‰€ç”¨æ—¶é—´è¶ŠçŸ­ã€‚é¢ç§¯è¶Šå¤§ï¼Œæ‰€ç”¨æ—¶é—´è¶ŠçŸ­ã€‚å°½é‡å‡å°‘ç”¨æˆ·çš„æ“ä½œæ—¶é—´ã€‚å¦å¤–é‡‡ç”¨æ¸©æŸ”çš„æç¤ºæ–¹æ³•ï¼Œä¸è¦å¼¹å‡ºè­¦å‘Šå¯¹è¯æ¡†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸€äº›ç”¨æˆ·ä¼šæ„Ÿåˆ°å¾ˆçƒ¦çš„æŒ‰é’®ï¼Œæ¯”å¦‚â€œæ³¨å†Œâ€ï¼Œå¯ä»¥æ›¿æ¢æˆâ€œç»§ç»­â€ï¼Œè®©ç”¨æˆ·é¡ºä¾¿åˆ›å»ºä¸€ä¸ªè´¦æˆ·ï¼Œè¿™æ ·æ›´å¥½ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·å–œæ¬¢æ¶ˆç­æ•°å­—ï¼Œæ¯”å¦‚â€œè±†é‚®(1)â€ï¼Œä»å¤´æ¡çš„å®è·µæ¥çœ‹ï¼Œè¿™ä¸ªå°çº¢ç‚¹è¿˜æ˜¯å¾ˆç®¡ç”¨çš„ã€‚ä½†æ˜¯ä¸è¦è®©æ•°å­—å¤ªå¤§ï¼Œè¿™æ ·ç”¨æˆ·ç›´æ¥æ”¾å¼ƒæ²»ç–—äº†ã€‚&lt;/p&gt;
&lt;h2&gt;é¡¹ç›®ç®¡ç†&lt;/h2&gt;
&lt;p&gt;é¡¹ç›®ç»ç†å¯¹é¡¹ç›®è´Ÿè´£ï¼Œäº§å“ç»ç†å¯¹äº§å“è´Ÿè´£ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œäº§å“ç»ç†æå‡ºäº§å“æ¦‚å¿µï¼Œæ¢³ç†å¥½ç”¨æˆ·çš„ä»»åŠ¡ã€‚è®¾è®¡å›¢é˜Ÿä¸­çš„äº¤äº’è®¾è®¡å¸ˆä¼šå’Œäº§å“ç»ç†ä¸€èµ·è®¾è®¡è¡¨ç°å±‚çš„ä¿¡æ¯å±•ç°å’Œäº¤äº’ã€‚æœ‰äº†çº¿æ¡†å›¾åï¼Œå›¾å½¢ç”¨æˆ·ç•Œé¢è®¾è®¡å¸ˆå¼€å§‹è®¾è®¡å½¢çŠ¶ã€è‰²å½©ã€è´¨æ„Ÿç­‰è§†è§‰å…ƒç´ ï¼Œç¡®å®šäº§å“åœ¨è¡¨ç°å±‚çš„æœ€ç»ˆå±•ç°ã€‚åŒæ—¶ï¼Œç ”å‘å›¢é˜Ÿä¸­çš„ç³»ç»Ÿæ¶æ„å¸ˆä¼šæ ¹æ®äº§å“ç»ç†çš„äº§å“è®¾è®¡æ–‡æ¡£ï¼Œè§„åˆ’å¥½ä¸šåŠ¡é€»è¾‘å±‚è¦åšçš„äº‹æƒ…å¹¶ç¡®è®¤è¦å­˜å‚¨å“ªäº›æ•°æ®ï¼Œä¹Ÿä¼šç¡®å®šè¡¨ç°å±‚ã€ä¸šåŠ¡é€»è¾‘å±‚ã€æ•°æ®æŒä¹…å±‚å’Œè¾…åŠ©ç³»ç»Ÿéƒ½è¦ç”¨åˆ°å“ªäº›æŠ€æœ¯ï¼Œå¹¶ä¸”ä¼°ç®—ä¸åŒç”¨æˆ·è§„æ¨¡ä¸‹éœ€è¦çš„æœåŠ¡å™¨æ•°é‡å’Œå¸¦å®½ï¼›ç ”å‘åŒäº‹ä¼šæŒ‰ç…§ç³»ç»Ÿæ¶æ„å¸ˆçš„è§„åˆ’é¢†å–è‡ªå·±çš„ç ”å‘ä»»åŠ¡ï¼Œè¿™äº›ç ”å‘ä»»åŠ¡å®Œæˆåä¼šè¢«ç»„åˆå¥½å®‰è£…åˆ°æœåŠ¡å™¨ä¸Šã€‚å›¾å½¢ç”¨æˆ·ç•Œé¢è®¾è®¡å¸ˆçš„å·¥ä½œå’Œç ”å‘å›¢é˜Ÿçš„å·¥ä½œä¼šåœ¨è¡¨ç°å±‚æ•´åˆåˆ°ä¸€èµ·ï¼Œå½¢æˆå…¼å…·è§†è§‰æ•ˆæœå’Œç‰¹æ€§çš„äº§å“è¡¨ç°å±‚ã€‚ç„¶åï¼Œæµ‹è¯•å›¢é˜Ÿé€šè¿‡æµ‹è¯•ç¡®è®¤äº§å“æ˜¯å¦ç¬¦åˆäº§å“è®¾è®¡æ–‡æ¡£ï¼Œæµ‹è¯•é€šè¿‡åé€šçŸ¥äº§å“ç»ç†è¿›è¡Œæœ€ç»ˆçš„æµ‹è¯•å’Œä½“éªŒã€‚è¿™ä¸€åˆ‡å®Œæˆä¹‹åï¼Œäº§å“å°±å¯ä»¥å‘å¸ƒå’Œç”¨æˆ·è§é¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸è§çš„æ–¹æ¡ˆï¼šä» app å¼€å§‹ï¼Œç„¶åå¹³ç§»åˆ° wap é¡µï¼Œç„¶ååœ¨æ‹“å±•åˆ° web å’Œ iPadã€‚åŸå› æ˜¯ä»ä¸€ä¸ªç²¾ç®€çš„åŸºç¡€åšåŠ æ³•å®¹æ˜“ï¼Œè€Œä»ä¸€ä¸ªå¤§è€Œå…¨çš„åŸºç¡€ä¸Šå‰²è‚‰å¾ˆéš¾ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å‘é¡¹ç›®å¾€å¾€æ˜¯ç”±è™šæ‹Ÿå›¢é˜Ÿè´Ÿè´£çš„ï¼Œé¡¹ç›®æˆå‘˜ä¸æ˜¯äº§å“ç»ç†æˆ–è€…é¡¹ç›®ç»ç†çš„ç›´æ¥ä¸‹å±ï¼Œæ‰€ä»¥äº§å“ç»ç†ä¹Ÿæ²¡æœ‰æå“ä»–ä»¬çš„å¤§æ£’ï¼Œä¹Ÿè§¦ç¢°ä¸åˆ°ä»–ä»¬çš„è¯„çº§å’Œå¥–é‡‘ã€‚&lt;/p&gt;
&lt;p&gt;ä¸–ç•Œè¯­æ˜¯æŒ‡é¡¹ç›®ç»„æ‰€æœ‰æˆå‘˜é€šç”¨çš„è¯­è¨€ï¼Œä¸–ç•Œè¯­çš„æ•™ç§‘ä¹¦å°±æ˜¯é¡¹ç›®å­—å…¸ã€‚é¡¹ç›®å­—å…¸å¹¶ä¸æ˜¯ä¸€ä»½æ–‡æ¡£ï¼Œå®ƒæ˜¯é¡¹ç›®ç»ç†åœ¨é¡¹ç›®å›¢é˜Ÿä¸­æ‰€æ¨å¹¿çš„ä¸€ä»½è™šæ‹Ÿæ–‡æ¡£ï¼Œå®ƒå­˜åœ¨äºäº§å“éœ€æ±‚æ–‡æ¡£å’Œæ—¥å¸¸çš„æ²Ÿé€šä¸­ã€‚é¦–å…ˆï¼Œé¡¹ç›®ç»ç†åœ¨æ—¥å¸¸çš„æ²Ÿé€šä¸­å‘ç°å¤§å®¶ç»å¸¸å‡ºç°è¯­è¨€ä¸é€šçš„åœ°æ–¹ï¼Œç„¶åå¯¹è¿™äº›åœ°æ–¹è¿›è¡Œæ›´ç²¾ç¡®çš„å‘½åä»¥æ¶ˆé™¤æ­§ä¹‰ï¼Œå¹¶ä¸”åœ¨æ—¥åçš„æ²Ÿé€šä¸­ä¸æ–­å¼ºåŒ–ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºé¡¹ç›®ä¸­çš„èµ„æºå’Œå®æ–½ç¯èŠ‚ï¼Œéœ€è¦é¢„å…ˆè¯„ä¼°é£é™©ï¼Œç„¶åè€ƒè™‘åˆ°å¦‚æœå‘ç”Ÿäº†è¿™æ ·çš„æƒ…å†µï¼Œæ˜¯å¦å¯ä»¥å¿å—ï¼Œæˆ–è€…æœ‰ä»€ä¹ˆè¡¥æ•‘çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¢¨è²å®šå¾‹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸€é¡¹å·¥ä½œå¦‚æœåªæœ‰ä¸€ä¸ªäººè´Ÿè´£ï¼Œè¿™ä¸ªäººè‚¯å®šä¼šä¼‘å‡æˆ–è€…ç¦»èŒ&lt;/li&gt;
&lt;li&gt;äººä¸ºæ²¡æœ‰æŠ€æœ¯éš¾ç‚¹çš„éƒ¨åˆ†ï¼Œéƒ½ä¼šæˆä¸ºæŠ€æœ¯éš¾ç‚¹æˆ–è€…æ˜¯æ€§èƒ½ç“¶é¢ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€‰ç”¨è½»é‡çº§ã€å¯¹å›¢é˜Ÿç°æœ‰å·¥ä½œä¹ æƒ¯å…¥ä¾µå°çš„å·¥å…·ï¼Œå¯ä»¥äº‹åŠåŠŸå€ï¼Œå¤ªé‡çš„å·¥å…·å¾€å¾€å› ä¸ºæ‡’å¾—å¯åŠ¨è€Œå˜æˆé¸¡è‚‹ï¼Œä¸å›¢é˜Ÿå·¥ä½œä¹ æƒ¯å·®å¼‚å¤ªå¤§åˆ™éš¾ä»¥æœ‰æ•ˆæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ã€Šå¤±æ§ã€‹ï¼šè¦æƒ³æ´æ‚‰ä¸€ä¸ªç³»ç»Ÿæ‰€è•´è—çš„æ¶Œç°ç»“æ„ï¼Œæœ€å¿«æ·ã€æœ€ç›´æ¥ä¹Ÿæ˜¯å”¯ä¸€å¯é çš„æ–¹æ³•å°±æ˜¯è¿è¡Œå®ƒã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 10 Mar 2018 21:15:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-03-10:/posts/jie-wang-yue-du-bi-ji.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>Linux å‘½ä»¤è¡ŒæŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</title><link>/posts/linux-ming-ling-xing-cha-kan-xi-tong-xin-xi.html</link><description>&lt;h1&gt;æŸ¥çœ‹æœºå™¨å&lt;/h1&gt;
&lt;p&gt;uname -a # view system name
arch # show arch&lt;/p&gt;
&lt;h1&gt;æŸ¥çœ‹ ubuntu ç‰ˆæœ¬&lt;/h1&gt;
&lt;p&gt;show ubuntu version&lt;/p&gt;
&lt;p&gt;cat /etc/*release&lt;/p&gt;
&lt;h1&gt;æŸ¥çœ‹å†…å­˜ä½¿ç”¨&lt;/h1&gt;
&lt;p&gt;free -mh&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(master)kongyifei@localhost ~ $ free -mh
             total       used       free     shared    buffers     cached
Mem:          251G       241G       9.8G       5.9G       4.3G        76G
-/+ buffers/cache:       161G        90G
Swap:           0B         0B         0B
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å«ä¹‰ï¼Œç¬¬ä¸€è¡Œè¡¨ç¤ºå®é™…çš„å†…å­˜å ç”¨æƒ…å†µï¼Œlinuxçš„æœºåˆ¶æ˜¯å°½å¯èƒ½å¤šçš„å ç”¨å†…å­˜ï¼Œæ‰€ä»¥freeå¾€å¾€å¾ˆå°ï¼›ä½†æ˜¯å ç”¨çš„å†…å­˜ä¸ä¸€å®šéƒ½åœ¨è¢«ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯æœ€åçš„bufferså’Œcachedå†…å­˜æ˜¯è¢«ç³»ç»Ÿé¢„å…ˆå ç”¨çš„ã€‚
åœ¨ç¬¬äºŒè¡ŒæŠŠè¿™ä¸¤é¡¹æŠ›å‡ºï¼Œå°±æ˜¯ä½ çš„å®é™…å†…å­˜å ç”¨161Gï¼Œå®é™…å¯ä½¿ç”¨å†…å­˜90G&lt;/p&gt;
&lt;h1&gt;iostat å’Œ vmstat&lt;/h1&gt;
&lt;p&gt;vmstat -awS M&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(master)kongyifei.rocks@n8-147-097 ~/repos/crawl_deploy/svc_ctl $ vmstat -a
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free  inact active   si   so    bi    bo   in   cs us sy id wa st
57  0      0 197155680 3614480 57558348    0    0     8    39    0    0  6  2 91  0  0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯freeå’Œsiã€soä¸‰åˆ—ï¼Œå…¶ä¸­freeè¡¨ç¤ºç©ºé—²å†…å­˜ï¼Œsiè¡¨ç¤ºswap inï¼Œsoè¡¨ç¤º swap out&lt;/p&gt;
&lt;p&gt;vmstat INTERVAL TIMES æ‰§è¡Œvmstatæ¯INTERVALç§’ï¼Œå¹¶ä¸”æ‰§è¡ŒTIMESæ¬¡&lt;/p&gt;
&lt;p&gt;http://www.orczhou.com/index.php/2010/03/iostat-detail/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 03 Mar 2018 05:23:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-03-03:/posts/linux-ming-ling-xing-cha-kan-xi-tong-xin-xi.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>å®‰å“è¯ä¹¦ä¸ä»£ç†è‡ªåŠ¨é…ç½®</title><link>/posts/an-zhuo-zheng-shu-yu-dai-li-zi-dong-pei-zhi.html</link><description>&lt;p&gt;Go toÂ SettingsÂ &amp;gt;Â SecurityÂ &amp;gt;Â Install from storage.&lt;/p&gt;
&lt;p&gt;install programatically can be achived by from command line, by moving certs to &lt;/p&gt;
&lt;p&gt;replacing bks file solely is useless, it has to be combined with the password&lt;/p&gt;
&lt;p&gt;https://github.com/danzeeeman/meerkat-decompiled/blob/master/io/fabric/sdk/android/services/network/PinningInfoProvider.java&lt;/p&gt;
&lt;p&gt;set proxy programatically&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;set mannully for one&lt;/li&gt;
&lt;li&gt;pull /data/misc/wifi/ipconfig.txt&lt;/li&gt;
&lt;li&gt;push to other devices&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚ä½•å®‰è£…è¯ä¹¦&lt;/p&gt;
&lt;p&gt;make certs like this tutorial,  http://forum.xda-developers.com/google-nexus-5/help/howto-install-custom-cert-network-t2533550
but push it to /data/misc/user/0/cacerts-added/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 24 Feb 2018 18:08:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-02-24:/posts/an-zhuo-zheng-shu-yu-dai-li-zi-dong-pei-zhi.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>å‘½ä»¤è¡Œçš„ä¸€äº›å°æŠ€å·§</title><link>/posts/ming-ling-xing-de-yi-xie-xiao-ji-qiao.html</link><description>&lt;p&gt;æœ€è¿‘å·¥ä½œä¸­ç»å¸¸ç”¨åˆ°çš„ä¸€äº›ç»„åˆå‘½ä»¤ï¼Œæœ¬æ¥æƒ³æäº¤åˆ° commandlinefu.com ä¸Šï¼Œä½†æ˜¯å¿˜è®°äº†å¯†ç ï¼Œæ€ä¹ˆä¹Ÿç™»å½•ä¸ä¸Šå»äº†ï¼Œè®°åˆ°è¿™é‡Œå§&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è„šæœ¬æ‰€åœ¨çš„ç›®å½•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dirname $0
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶å¤¹ä¸‹é¢æŒ‰ç…§å ç”¨ç©ºé—´å¤§å°æ’åº&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;du -sh `ls` | sort -rh
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;è¿”å›ä¸Šä¸€ä¸ªç›®å½•&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cd -
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;æ˜¾ç¤ºæ‰€æœ‰çš„æ—¥å¿—çš„æœ€åå‡ è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;tail *
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;set&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;set -x # æ˜¾ç¤ºæ¯ä¸ªæ‰§è¡Œçš„å‘½ä»¤
set -e # å½“æœ‰ç¨‹åºè¿”å›é0å€¼æ—¶ç›´æ¥é€€å‡ºï¼Œç›¸å½“äºæŠ›å‡ºå¼‚å¸¸
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;here doc&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat &amp;lt;&amp;lt; EOF &amp;gt; /tmp/yourfilehere
These contents will be written to the file.
        This line is indented.
EOF
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;åˆ é™¤åŒ…å«æŸä¸ªå…³é”®å­—çš„æ‰€æœ‰è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;fd -t f -0 | xargs -0 sed -i /KeyWord/d
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;åœ¨ shell ä¸­ï¼Œæ‰€æœ‰å­—ç¬¦ä¸²éƒ½è¦ç”¨å¼•å·åŒ…å›´&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Always quote strings in bash. If you string is empty and you are testing it with == or !=, then there will be a "== is not uniary operator" error&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ›¿æ¢ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;find ./ -type f -exec sed -i -e &amp;#39;s/apple/orange/g&amp;#39; {} \;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;from: https://stackoverflow.com/questions/6758963/find-and-replace-with-sed-in-directory-and-sub-directories&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 28 Jan 2018 19:51:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-01-28:/posts/ming-ling-xing-de-yi-xie-xiao-ji-qiao.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>æ­å»º git æœåŠ¡å™¨ï¼ˆä¸­å¿ƒä»“åº“ï¼‰</title><link>/posts/da-jian-git-fu-wu-qi-zhong-xin-cang-ku.html</link><description>&lt;h1&gt;gitlab&lt;/h1&gt;
&lt;p&gt;å»ºè®®ä½¿ç”¨ gitlab æ­å»ºï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤å°±å¯ä»¥äº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker run --detach \
    --hostname gitlab.example.com \
    --publish 443:443 --publish 80:80 --publish 22:22 \
    --name gitlab \
    --restart always \
    --volume /srv/gitlab/config:/etc/gitlab \
    --volume /srv/gitlab/logs:/var/log/gitlab \
    --volume /srv/gitlab/data:/var/opt/gitlab \
    gitlab/gitlab-ce:latest
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;source: https://docs.gitlab.com/omnibus/docker/README.html&lt;/p&gt;
&lt;h1&gt;æ‰‹å·¥æ­å»º git æœåŠ¡å™¨&lt;/h1&gt;
&lt;p&gt;å‡è®¾æœåŠ¡å™¨çš„åå­—æ˜¯ git.example.com.
é¦–å…ˆï¼Œæ·»åŠ ä¸€ä¸ªå«åšgitçš„ç”¨æˆ·&lt;code&gt;adduser git&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå¦‚æœä¸å­˜åœ¨çš„è¯, ä¸ºè¿™ä¸ªç”¨æˆ·æ–°å»ºä¸€ä¸ªä¸»ç›®å½•&lt;code&gt;mkdir /home/git&lt;/code&gt;ï¼Œç„¶åæŠŠè¿™ä¸ªç›®å½•è®¾ä¸ºgitæ‰€æœ‰&lt;code&gt;chown git ~git&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å†åœ¨æœ¬åœ°æŠŠä½ çš„sshå…¬é’¥æ‹·è´åˆ°æœåŠ¡å™¨ä¸Š 
    ssh-copy-id git@git.example.com&lt;/p&gt;
&lt;p&gt;æœåŠ¡å™¨å°±è¿™æ ·æå¥½äº†&lt;/p&gt;
&lt;h2&gt;ä½¿ç”¨&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨æœåŠ¡å™¨ä¸Šæ–°å»ºä»“åº“&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é¦–å…ˆï¼Œåœ¨æœåŠ¡å™¨æ–°å»ºä¸€ä¸ªé¡¹ç›®, å…¶ä¸­ new_project æ˜¯ä½ çš„é¡¹ç›®çš„åå­—.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ssh git@git.example.com &amp;quot;mkdir &amp;lt;new_project&amp;gt;.git &amp;amp;&amp;amp; cd &amp;lt;new_project&amp;gt;.git &amp;amp;&amp;amp; git init -bare&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“ç„¶è¿™ä¹ˆä¸€é•¿ä¸²å®åœ¨æ˜¯å¤ªçƒ¦äº†, æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå†™æˆä¸€è¡Œè„šæœ¬new_repo.sh&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
ssh git@git.example &lt;span class="s2"&gt;&amp;quot;mkdir &lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;\.git &amp;amp;&amp;amp; cd &lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;\.git &amp;amp;&amp;amp; git init --bare&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;New git repo git@git.example.com:&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;.git&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;ç„¶å chmod +x new_repo.sh
ä»¥åå°±å¯ä»¥è¿™æ ·è°ƒç”¨äº† ./new_repo.sh foobar å°±å¯ä»¥äº†&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å’Œæœ¬åœ°å»ºç«‹è¿æ¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœæ˜¯æ–°é¡¹ç›®&lt;/p&gt;
&lt;p&gt;ç„¶å clone åˆ°æœ¬åœ°å°±å¥½äº†ï¼š&lt;/p&gt;
&lt;p&gt;git clone git@git.example.com:new_project.git&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯è€é¡¹ç›®&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ å·²ç»åœ¨æœ¬åœ°æœ‰äº†é¡¹ç›®, å¹¶ä¸”åˆå§‹åŒ–äº† git ä»“åº“, ä¸æ˜¯é‡‡ç”¨cloneï¼Œè€Œæ˜¯ç›´æ¥è®¾ç½®ä¸Šæ¸¸æœåŠ¡å™¨ï¼Œé‚£å°±æ¨é€åˆ°æœåŠ¡å™¨ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git remote add origin git@git.example.com:new_project.git
git push -u origin master
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 20 Jan 2018 22:50:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-01-20:/posts/da-jian-git-fu-wu-qi-zhong-xin-cang-ku.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>ä¸€äº› vim å°æŠ€å·§</title><link>/posts/yi-xie-vim-xiao-ji-qiao.html</link><description>&lt;h3&gt;é‡æ–°å¯¹é½æ–‡æœ¬åˆ°å›ºå®šé•¿åº¦&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gq&amp;lt;motion&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;check if mapping is replaced&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;:verbose map &amp;lt;Key&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;using map may cause infinite recursion!&lt;/p&gt;
&lt;h3&gt;force set syntax&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;# vim: set filetype=javascript&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;exit&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ Ctrl-C è€Œä¸æ˜¯esc
ä½¿ç”¨ZZè€Œä¸æ˜¯:wq&lt;/p&gt;
&lt;h3&gt;window management&lt;/h3&gt;
&lt;p&gt;use ctrl-w r to swap pane&lt;/p&gt;
&lt;h3&gt;folding&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;{selection}zf&lt;/code&gt; or &lt;code&gt;zf{motion}&lt;/code&gt; for manual folding&lt;/p&gt;
&lt;h3&gt;history&lt;/h3&gt;
&lt;p&gt;Ctrl-O to go back to files
Ctrl-I to go to new files&lt;/p&gt;
&lt;p&gt;:%s/pattern//gn&lt;/p&gt;
&lt;h3&gt;delete blank lines&lt;/h3&gt;
&lt;p&gt;:g/^$/d&lt;/p&gt;
&lt;h3&gt;run python from vim&lt;/h3&gt;
&lt;p&gt;:w !python&lt;/p&gt;
&lt;h3&gt;nerdtreeçš„ä½¿ç”¨&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨iå’Œsåˆ†åˆ«åœ¨splitä¸­æ‰“å¼€æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;ä¸è¦ä½¿ç”¨chardetæ¥æ£€æµ‹è¿‡é•¿çš„ç½‘é¡µï¼Œå¯ä»¥æ£€æµ‹å‰ä¸€åƒä¸ªå­—ç¬¦ chardet.detect(text[:1000])&lt;/p&gt;
&lt;h3&gt;äº¤æ¢ä¸¤åˆ—&lt;/h3&gt;
&lt;p&gt;:%!awk '{print $2, $1}'&lt;/p&gt;
&lt;p&gt;:set fileencoding=utf8
:w myfilename&lt;/p&gt;
&lt;h3&gt;add utf-8 BOM&lt;/h3&gt;
&lt;p&gt;:set bomb  # add BOMB&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 18 Jan 2018 06:26:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-01-18:/posts/yi-xie-vim-xiao-ji-qiao.html</guid><category>vim</category><category>å°æŠ€å·§</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>django auth and user</title><link>/posts/django-auth-and-user.html</link><description>&lt;h1&gt;æ¿€æ´»&lt;/h1&gt;
&lt;p&gt;django è‡ªå¸¦çš„ auth æ¨¡å—éœ€è¦æ”¶å…ˆåˆ›å»ºæ•°æ®åº“æ‰èƒ½å¤Ÿä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py migrate auth
python manage.py migrate
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;request.user.is_anonymous æ£€æŸ¥ç”¨æˆ·æ˜¯å¦&lt;/p&gt;
&lt;p&gt;django comes with login/logout forms and views&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.auth&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;auth_views&lt;/span&gt;
&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^login/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;auth_views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;login&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^logout/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;auth_views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;logout&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;By default, theÂ django.contrib.auth.views.loginÂ view will try to render theÂ registration/login.html template.Â  and will redirct to the /accouts/profile page&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;extends&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;base.html&amp;#39;&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
 &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;block&lt;/span&gt; &lt;span class="nv"&gt;title&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;Login&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endblock&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt; 
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;block&lt;/span&gt; &lt;span class="nv"&gt;content&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
 &lt;span class="nt"&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;Login&lt;span class="nt"&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt; 
&lt;span class="nt"&gt;&amp;lt;form&lt;/span&gt; &lt;span class="na"&gt;method=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;post&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; 
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;csrf_token&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt; 
&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;form.as_p&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;
 &lt;span class="nt"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;submit&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Login&lt;span class="nt"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;
 &lt;span class="nt"&gt;&amp;lt;/form&amp;gt;&lt;/span&gt; 
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endblock&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can change what django renders&lt;/p&gt;
&lt;p&gt;&lt;code&gt;url(r'^login/$', auth_views.login, {'template_name': 'core/login.html'}, name='login'),&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You can change where django redirects&lt;/p&gt;
&lt;p&gt;&lt;code&gt;LOGIN_REDIRECT_URL = 'home' # in settings.py&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;logout&lt;/p&gt;
&lt;p&gt;by default, renders the registration/logged_out.html&lt;/p&gt;
&lt;p&gt;&lt;code&gt;url(r'^logout/$', auth_views.logout, {'template_name': 'logged_out.html'}, name='logout'),&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;url(r'^logout/$', auth_views.logout, {'next_page': '/'}, name='logout'),&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Note the difference, you don't have to do anything when visiting /logout, the system will just log you out and send you to another page or render a logged out page&lt;/p&gt;
&lt;p&gt;~~Side notes: why changing the redirect url is different with login? find it out later~~&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 17 Jan 2018 22:53:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-01-17:/posts/django-auth-and-user.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>tiller for docker</title><link>/posts/tiller-for-docker.html</link><description>&lt;h1&gt;Yifei's Notes&lt;/h1&gt;
&lt;p&gt;Tiller SUCKS&lt;/p&gt;
&lt;p&gt;The only good part of tiller is that it makes a docker image can read environment variables and generate config files based on predefined templates, this functionality should easily be achieved by python and jinja2&lt;/p&gt;
&lt;h1&gt;Tiller&lt;/h1&gt;
&lt;p&gt;tiller runs program such as nginx inside docker instead of bare-bone nginx. tiller dynamically generates config files for different environment such as dev and QA.&lt;/p&gt;
&lt;p&gt;tiller is only useful because &lt;strong&gt;your program reads config files only&lt;/strong&gt; instead of environment variables&lt;/p&gt;
&lt;p&gt;you define variables and pass the variables to tiller, tiller generate config files and the start corresponding program.&lt;/p&gt;
&lt;p&gt;Before: Docker -&amp;gt; nginx
After: Docker -&amp;gt; tiller -&amp;gt; nginx&lt;/p&gt;
&lt;p&gt;you copy the config file template when building image
and run the container with you env vars&lt;/p&gt;
&lt;h1&gt;Downsides&lt;/h1&gt;
&lt;p&gt;We have to pre-define several environments in the image, then we choose which to use when starting the container.
It's fine to use if we have limited envs, but what if we want to change the environment, we have to repack the image&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 17 Jan 2018 20:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-01-17:/posts/tiller-for-docker.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category><category>Docker</category></item><item><title>è¯»ã€Šæ•°å­¦ä¹‹ç¾ã€‹</title><link>/posts/du-shu-xue-zhi-mei.html</link><description>&lt;ol&gt;
&lt;li&gt;æ–‡å­—åªæ˜¯ä¿¡æ¯çš„è½½ä½“ï¼Œè€Œéä¿¡æ¯æœ¬èº«&lt;/li&gt;
&lt;li&gt;ç¿»è¯‘ä¹‹æ‰€ä»¥èƒ½å¤Ÿè¿›è¡Œï¼Œæ˜¯å› ä¸ºäººç±»çš„è¯­è¨€æœ¬è´¨ä¸Šéƒ½æ˜¯ç­‰ä»·çš„&lt;/li&gt;
&lt;li&gt;ä¿¡æ¯çš„å†—ä½™æ˜¯ä¿¡æ¯å®‰å…¨çš„ä¿éšœ&lt;/li&gt;
&lt;li&gt;è‡ªç„¶è¯­è¨€æ˜¯ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•ï¼Œè€Œäººå·¥è¯­è¨€å¾€å¾€æ˜¯ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•ã€‚&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 07 Jan 2018 03:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-01-07:/posts/du-shu-xue-zhi-mei.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>æŒ‰éƒ¨å°±ç­ä¸ä¸šä½™æ—¶é—´çš„æƒ³æ³•</title><link>/posts/an-bu-jiu-ban-yu-ye-yu-shi-jian-de-xiang-fa.html</link><description>&lt;p&gt;æ„Ÿè§‰å¾ˆéš¾åœ¨å·¥ä½œå’Œå­¦ä¹ ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚å€’ä¹Ÿä¸æ˜¯è¯´æ¯å¤©çš„å·¥ä½œæœ‰å¤šä¹ˆæ¯ç‡¥æ— å‘³ï¼Œä½†æ˜¯æ€»å½’æ¯å¤©æ¶‰åŠçš„é¢†åŸŸæ¯”è¾ƒå•ä¸€ï¼Œä¹Ÿç»å¸¸è¦åšä¸€äº›å¾ˆä¸ä¼˜é›…çš„æŠ˜ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¹ˆå¤šå¹´çš„æˆé•¿ç»å†å’Œä¹ æƒ¯æ˜¯ï¼Œæ€»è¦æäº›â€œå‰¯ä¸šâ€æ‰èƒ½å¿ƒé‡Œå®‰ç”Ÿï¼Œä¹Ÿçš„ç¡®æ²¡æœ‰åƒäºï¼Œå¦‚æœåªæ˜¯æŒ‰éƒ¨å°±ç­çš„è¯ï¼Œå¯èƒ½é«˜ä¸­æ¯•ä¸šæœ€ç»ˆä¼šä¸Šä¸€ä¸ªæ™®é€šäºŒæœ¬ã€æˆ–è€…ä»æ•°å­¦ç³»æ¯•ä¸šäº†å»åšä¸€ä¸ªé“¶è¡ŒæŸœå‘˜ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç„¶è€Œç°åœ¨å‘¢ï¼Œæ”¶è·çš„ç¡®æ˜¯æœ‰çš„ï¼Œæˆ‘ä¹Ÿä¸ç¡®å®šæ˜¯ä¸æ˜¯å…¶å®è¿™å·²ç»æ˜¯æœ€å¿«çš„é€Ÿåº¦äº†ï¼Œè‡ªå·±æ€»æ˜¯æ€ç»´è·³è·ƒæ˜¯ä¸æ˜¯åå€’åœ¨æµªè´¹å®è´µçš„å­¦ä¹ æœºä¼šï¼Œåªæ„Ÿè§‰æ—¶é—´è¿‡çš„ç‰¹åˆ«å¿«ï¼Œè€Œæ¥ä¸åŠæŠ“ä½ä»€ä¹ˆã€‚æ€»æœ‰äººå‚¬ï¼Œå¿ƒé‡Œä¹Ÿå¾ˆåŒçƒ¦ã€‚æœ‰æ—¶å€™è§‰å¾—åŒäº‹ä»¬æ˜¯ç”±ä¸€äº›å¾ˆå¥½çš„æ€è·¯ï¼Œå¦å¤–çš„æ—¶å€™ä¹Ÿè§‰å¾—å¥½å¤šäº‹æƒ…å…¶å®ç¨å¾®å¤šä¸€ç‚¹æ—¶é—´åœä¸‹æ¥è§£å†³ä¸€ä¸‹ä»¥åä¼šçœå¾ˆå¤šæ—¶é—´ï¼Œç„¶è€Œæ€»æ˜¯ä¸€ä¸ªæ¼æ´è¡¥å¦ä¸€ä¸ªæ¼æ´ã€‚æœ‰æ—¶å€™åˆåœ¨æƒ³æ˜¯ä¸æ˜¯è¾¹é™…æ•ˆç›Šå·²ç»å˜å¾—å¾ˆå°äº†ï¼Œè¯¥å»å¹²ä¸€äº›åˆ«çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰æœºä¼šå¼€ä¸€å®¶å…¬å¸çš„è¯ï¼Œä¸€å®šè¦å¤šç»™å·¥ç¨‹å¸ˆä¸€äº›æ—¶é—´å§ã€‚è¿˜æ˜¯è§‰å¾—å¾ˆå¤šäº‹æƒ…èƒ½æå‡å¾ˆå¤§çš„æ•ˆç‡ï¼Œä½†æ˜¯ç¡®æ€»åœ¨å¾ˆä½çš„æ•ˆç‡åšã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿè®¸åªæ˜¯èƒ½åŠ›ä¸å¤Ÿå§ï¼Œå¥½å¤šä¸œè¥¿å¯èƒ½è‡ªå·±é‡åˆ°äº†è¦èŠ±30åˆ†é’Ÿäº†è§£ä¸€ä¸‹ï¼Œè€Œåˆ«äººäº”åˆ†é’Ÿå°±å¤Ÿäº†ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰äº›ä¸œè¥¿çš„ç¡®ä¸æ‡‚ä¹Ÿå¯ä»¥å¹²å¥½æ¯å¤©çš„å·¥ä½œï¼Œæ¯”å¦‚ Linux ä¸Š C ç¼–ç¨‹ï¼Œæ¯”å¦‚ç¼–è¯‘åŸç†ï¼Œæ¯”å¦‚ https çš„åŸç†ï¼Œä½†æ˜¯ç¡®å®æœ‰äº›æ—¶å€™ä¼šæˆä¸ºç“¶é¢ˆï¼Œå¦å¤–é‡åˆ°äº†ä½†å´ä¸èƒ½å¼„ç—›æ€»æ„Ÿè§‰å¿ƒæœ‰ä¸ç”˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰åœ¨ä¸€å®¶å¤–ä¼å·¥ä½œï¼Œåº”è¯¥è¯´ work-life balance å¾ˆå¥½äº†ï¼Œä¸è¿‡è‡ªçŸ¥èƒ½åŠ›ä¸å¤Ÿï¼Œä¸šä½™æ—¶é—´è¿˜æ˜¯çœ‹çœ‹ä¹¦å¥½ã€‚ç°åœ¨ work-life balance æ²¡æœ‰äº†ï¼Œå€’ä¹Ÿæ²¡æœ‰ä»€ä¹ˆï¼Œé—®é¢˜æ˜¯ work-study balance ä¹Ÿå¾ˆéš¾ç»´æŒã€‚ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 02 Jan 2018 07:06:00 +0800</pubDate><guid isPermaLink="false">tag:None,2018-01-02:/posts/an-bu-jiu-ban-yu-ye-yu-shi-jian-de-xiang-fa.html</guid><category>åæ€ä¸æ€»ç»“</category></item><item><title>å­¦ä¹ å†™ä¸€ä¸ªç¼–è¯‘å™¨</title><link>/posts/xue-xi-xie-yi-ge-bian-yi-qi.html</link><description>&lt;h1&gt;ä¸ºä»€ä¹ˆï¼Ÿ&lt;/h1&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ¯”å–»ï¼šä¸æ‡‚ç¼–è¯‘å™¨å†™ç¨‹åºå°±å¥½æ¯”æ²¡æœ‰å­¦è¿‡äººä½“è§£å‰–å­¦å°±å»ç”»äººåƒä¸€æ ·ï¼Œèƒ½å½“è®©æ˜¯èƒ½ï¼Œä½†æ˜¯æ ¸å¿ƒä¸Šæ€»æœ‰äº›ä¸å¯¹çš„åœ°æ–¹&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªæˆåŠŸçš„é¡¹ç›®éƒ½æœ‰å¾ˆå¤šçš„è¯­è¨€æ„æˆï¼Œæ‹¿ä¸€ä¸ªç®€å•çš„ Python Web é¡¹ç›®æ¥è¯´ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ Pythonã€ymlã€jinjaã€ini ç­‰ç­‰å¤šç§è¯­è¨€ï¼ˆä¸ä¸€å®šæ˜¯å®Œå¤‡çš„å˜æˆè¯­è¨€ï¼‰ã€‚æ€»æœ‰ä¸€å¤©ä½ å¯¹å‘ç°ç°æœ‰çš„è¯­è¨€å¹¶ä¸èƒ½ç‰¹åˆ«å¥½å¾—æ»¡è¶³ä½ çš„ç‰¹å®šéœ€æ±‚çš„æ—¶å€™ï¼Œè€Œè¿™æ—¶å€™ä½ å°±éœ€è¦ä¸€ä¸ªç¼–è¯‘å™¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;è®¾è®¡ä¸€é—¨è¯­è¨€è¿˜æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è”ç³»&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://www.craftinginterpreters.com/image/a-map-of-the-territory/mountain.png"&gt;&lt;/p&gt;
&lt;h1&gt;ç¼–è¯‘çš„æ­¥éª¤&lt;/h1&gt;
&lt;p&gt;&lt;img alt="" src="http://www.craftinginterpreters.com/image/a-map-of-the-territory/string.png"&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Scanningï¼Œä¹Ÿå°±æ˜¯è¯æ³•åˆ†æï¼ˆLexical Analysisï¼‰&lt;/li&gt;
&lt;li&gt;Parsing&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 18 Dec 2017 07:14:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-12-18:/posts/xue-xi-xie-yi-ge-bian-yi-qi.html</guid><category>ç¼–è¯‘åŸç†</category><category>è®¡ç®—æœº</category></item><item><title>Python çš„å•å…ƒæµ‹è¯•</title><link>/posts/python-de-dan-yuan-ce-shi.html</link><description>&lt;h1&gt;ç¼–å†™æµ‹è¯•çš„åŸºæœ¬åŸåˆ™&lt;/h1&gt;
&lt;p&gt;æ¯ä¸€ä¸ªæµ‹è¯•å•å…ƒå¿…é¡»æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚æ¯ä¸€ä¸ªå¿…é¡»èƒ½å¤Ÿç‹¬ç«‹è¿è¡Œä»¥åŠåœ¨å…¶ä»–çš„æµ‹è¯•ç»„ä¸­è¿è¡Œï¼Œä¸ç®¡ä»–ä»¬çš„é¡ºåºå¦‚ä½•ã€‚åŠ è½½å’Œæ¸…ç©ºæ•°æ®åº”è¯¥ä½¿ç”¨ setUp() å’Œ tearDown() æ–¹æ³•ï¼ˆå¦‚æœä½¿ç”¨unittestï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;sans-io&lt;/strong&gt;ã€‚ä¹Ÿå°±æ˜¯æŠŠé€»è¾‘å’Œ IO åˆ†å¼€æ¥ï¼Œè¿™æ ·åœ¨æµ‹è¯•çš„æ—¶å€™æ–¹ä¾¿æŒ‡å®šè¾“å…¥ï¼Œä»¥åŠæ•è·è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;å°½é‡è®©æµ‹è¯•è·‘çš„å¿«ä¸€ç‚¹ã€‚å¦‚æœä¸€ä¸ªæµ‹è¯•åœ¨å‡ æ¯«ç§’ä¹‹å†…è·‘ä¸å®Œçš„è¯ï¼Œå¼€å‘å°±ä¼šæ…¢ä¸‹æ¥ï¼Œä»¥è‡³äºæ²¡æœ‰äººå†å»è·‘è¿™äº›æµ‹è¯•äº†ã€‚å¦‚æœå®åœ¨æœ‰å¾ˆèŠ±æ—¶é—´çš„æµ‹è¯•ï¼ŒæŠŠä»–ä»¬å•ç‹¬æ”¾åœ¨ä¸€èµ·å®šæœŸæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ­£åœ¨å¼€å‘æŸæ ·ä¸œè¥¿çš„è¿‡ç¨‹ä¸­è¢«æ‰“æ–­çš„è¯ï¼Œå¯ä»¥å†™ä¸€ä¸ªæµ‹è¯•ï¼Œè¿™æ ·å½“ä½ å›è¿‡å¤´æ¥çš„æ—¶å€™è¿˜èƒ½å¾ˆå¿«æƒ³èµ·æ¥éœ€è¦åšä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æœ‰æè¿°æ€§çš„é•¿åå­—ã€‚å®é™…ä»£ç ä¸­ä½ å¯èƒ½ä½¿ç”¨ &lt;code&gt;square()&lt;/code&gt; è¿™æ ·çš„åå­—ï¼Œä½†æ˜¯åœ¨æµ‹è¯•ç”¨ä½ è¦ç”¨ &lt;code&gt;test_square_of_number_2&lt;/code&gt; è¿™æ ·çš„åå­—ã€‚&lt;/p&gt;
&lt;p&gt;æµ‹è¯•ä»£ç çš„å¦ä¸€ä¸ªç”¨é€”æ˜¯ä½œä¸ºæ–°æ‰‹çš„ä»‹ç»ã€‚è®©åˆ«äººæ¥çœ‹ä½ çš„ä»£ç çš„æ—¶å€™ï¼Œçœ‹çœ‹æµ‹è¯•å°±çŸ¥é“ä»–æ˜¯å¹²ä»€ä¹ˆçš„äº†ã€‚&lt;/p&gt;
&lt;h1&gt;ç¼–å†™æµ‹è¯•çš„æ€è·¯&lt;/h1&gt;
&lt;p&gt;æŒ‰ç…§ä»£ç é€»è¾‘åˆ†æ”¯æµ‹è¯•ï¼ŒæŠŠä»£ç çš„æ¯ä¸€ä¸ªåˆ†æ”¯çš„&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…¥å£å‚æ•°æ˜¯ä»€ä¹ˆ&lt;/li&gt;
&lt;li&gt;å‡ºå£å‚æ•°æ˜¯ä»€ä¹ˆ&lt;/li&gt;
&lt;li&gt;å‰¯ä½œç”¨æ˜¯ä»€ä¹ˆ&lt;/li&gt;
&lt;li&gt;äº§ç”Ÿçš„å¼‚å¸¸æ˜¯ä»€ä¹ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;éƒ½æµ‹è¯•åˆ°ã€‚&lt;/p&gt;
&lt;h1&gt;å·¥å…·é€‰æ‹©&lt;/h1&gt;
&lt;p&gt;Python å¸¸ç”¨çš„æµ‹è¯•å·¥å…·æœ‰ä¸‰ç§ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ ‡å‡†åº“è‡ªå¸¦çš„ unittest&lt;/li&gt;
&lt;li&gt;nose[2]&lt;/li&gt;
&lt;li&gt;pytest&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…¶ä¸­ unittest å®Œå…¨æ˜¯ä» JUnit ç§»æ¤è¿‡æ¥çš„ï¼Œç”¨èµ·æ¥ç¨å¾®æœ‰äº›åˆ«æ‰­ã€‚nose å’Œ pytest ç›¸æ¯”çš„è¯ï¼Œç½‘å‹å¤§å¤šæ¨è pytestã€‚è¯¦ç»†çš„æ¯”è¾ƒå¯ä¸€ä»¶å‚è€ƒæ–‡æ¡£ã€‚&lt;/p&gt;
&lt;h1&gt;pytest&lt;/h1&gt;
&lt;p&gt;æµ‹è¯•å‡½æ•°ä½¿ç”¨test_å¼€å¤´, pytest é»˜è®¤ä¼šæŸ¥æ‰¾å½“å‰ç›®å½•ä¸­çš„ &lt;code&gt;test_&lt;/code&gt; å¼€å¤´æˆ–è€… &lt;code&gt;_test&lt;/code&gt; ç»“å°¾çš„æ–‡ä»¶ä¸­çš„æµ‹è¯•å¹¶è¿è¡Œã€‚ä½¿ç”¨assertæ¥éªŒè¯è¯­å¥ã€‚&lt;/p&gt;
&lt;h2&gt;æµ‹è¯•æŸä¸ªå¼‚å¸¸æŠ›å‡ºï¼š&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pytest&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
Â Â Â  &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;SystemExit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
Â 
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_mytest&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
Â Â Â  &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;pytest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;raises&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ne"&gt;SystemExit&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ‰§è¡Œé¡ºåº&lt;/h2&gt;
&lt;p&gt;å¦‚æœåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å®šä¹‰äº†å¤šä¸ªæµ‹è¯•å‡½æ•°ï¼Œé‚£ä¹ˆ pytest å°†æŒ‰ç…§å‡½æ•°å®šä¹‰çš„é¡ºåºæ‰§è¡Œã€‚&lt;/p&gt;
&lt;h2&gt;setup å’Œ teardown&lt;/h2&gt;
&lt;p&gt;setup å’Œ teardown ç”¨æ¥åœ¨æµ‹è¯•å¼€å§‹å‰åŠ è½½èµ„æºï¼Œå¹¶åœ¨æµ‹è¯•ç»“æŸåå¸è½½èµ„æºã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯ä»¥åœ¨æ–‡ä»¶ä¸­å®šä¹‰ setup_module å’Œ teardown_module ä¸­&lt;/li&gt;
&lt;li&gt;å¯ä»¥åœ¨ç±»ä¸­å®šä¹‰ setup_class å’Œ teardown_class ä¸­å®šä¹‰åŠ è½½å’Œå¸è½½æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;pytest å‘½ä»¤è¡Œé€‰é¡¹&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;pytest some_mod.py&lt;/code&gt; è¿è¡ŒæŸä¸ªæ–‡ä»¶ä¸­çš„ä¸­çš„æµ‹è¯•&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pytest tests/&lt;/code&gt; è¿è¡ŒæŸä¸ªç›®å½•ä¸­çš„æµ‹è¯•&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pytest -x&lt;/code&gt; åœ¨ç¬¬ä¸€ä¸ªé”™è¯¯çš„åœ°æ–¹ç»“æŸ&lt;/p&gt;
&lt;p&gt;pytest --pdbï¼Œå½“å‡ºç°å¼‚å¸¸çš„æ—¶å€™, æ‰“å¼€pdb&lt;/p&gt;
&lt;h2&gt;mock å’Œ patch&lt;/h2&gt;
&lt;h1&gt;unittest&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;unittest&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyTest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;setUp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;# bootstrapping&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tearDown&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;#clean up&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assertEqual&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Unittest ä¸­çš„ assert æ–¹æ³•ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ–¹æ³•&lt;/th&gt;
&lt;th&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;assertEqual(a, b)&lt;/td&gt;
&lt;td&gt;a == b&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertNotEqual(a, b)&lt;/td&gt;
&lt;td&gt;a != b&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertTrue(x)&lt;/td&gt;
&lt;td&gt;bool(x) is True&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertFalse(x)&lt;/td&gt;
&lt;td&gt;bool(x) is False&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertIs(a, b)&lt;/td&gt;
&lt;td&gt;a is b&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertIsNot(a, b)&lt;/td&gt;
&lt;td&gt;a is not b&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertIsNone(x)&lt;/td&gt;
&lt;td&gt;x is None&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertIsNotNone(x)&lt;/td&gt;
&lt;td&gt;x is not None&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertIn(a, b)&lt;/td&gt;
&lt;td&gt;a in b&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertNotIn(a, b)&lt;/td&gt;
&lt;td&gt;a not in b&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertIsInstance(a, b)&lt;/td&gt;
&lt;td&gt;isinstance(a, b)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;assertNotIsInstance(a, b)&lt;/td&gt;
&lt;td&gt;not isinstance(a, b)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;save it as fun_test.py and run it by:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python -m unittest fun_test
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;doctest&lt;/h1&gt;
&lt;p&gt;Note: only method starts with test is run by unittest module&lt;/p&gt;
&lt;p&gt;unittestè¿™ä¸ªåº“æ²¡æœ‰æŒ‰ç…§PEP8æ¥, çœ‹ç€å°±ä¸çˆ½&lt;/p&gt;
&lt;p&gt;æ³¨æ„docstring&lt;/p&gt;
&lt;p&gt;éœ€è¦ç”¨ unicode, éœ€è¦ç”¨u prefix&lt;/p&gt;
&lt;p&gt;éœ€è¦è½¬ä¹‰ \n&lt;/p&gt;
&lt;p&gt;éœ€è¦ä½¿ç”¨&lt;BLANKLINE&gt;æ¥ä»£è¡¨ç©ºè¡Œ&lt;/p&gt;
&lt;h1&gt;å‚è€ƒæ–‡æ¡£&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://www.reddit.com/r/Python/comments/50nqlp/is_nose_still_relevant_how_about_unittest/&lt;/li&gt;
&lt;li&gt;https://agopian.info/presentations/2015_06_djangocon_europe/?full#pythonic&lt;/li&gt;
&lt;li&gt;http://docs.python-guide.org/en/latest/writing/tests/&lt;/li&gt;
&lt;li&gt;https://realpython.com/python-testing/&lt;/li&gt;
&lt;li&gt;https://pytest-benchmark.readthedocs.io/en/latest/&lt;/li&gt;
&lt;li&gt;https://medium.com/@yeraydiazdiaz/what-the-mock-cheatsheet-mocking-in-python-6a71db997832&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Dec 2017 20:26:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-12-17:/posts/python-de-dan-yuan-ce-shi.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>[ZZ]å¦‚ä½•åšåˆ›ä¸šçš„å“ç±»é€‰æ‹©</title><link>/posts/zzru-he-zuo-chuang-ye-de-pin-lei-xuan-ze.html</link><description>&lt;p&gt;è½¬è‡ªï¼šhttp://mp.weixin.qq.com/s/WdK1umJkeeQdgpFS9wZh7Q&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆçœ‹å…±äº«å•è½¦ã€‚&lt;/p&gt;
&lt;p&gt;ç§»åŠ¨æ”¯ä»˜ã€ç§»åŠ¨å®šä½ã€åœ°å›¾ã€æ— æ¡©ã€ç”µå­é”ç­‰ç­‰ä¸œè¥¿éƒ½ä¸æ˜¯çªç„¶å‡ºç°çš„æŠ€æœ¯é©æ–°ï¼Œä½†å½“è¿™äº›ä¸œè¥¿çš„æ™®åŠã€è¦†ç›–ã€æŠ€æœ¯æˆç†Ÿåº¦ç­‰éƒ½è¾¾åˆ°äº†ä¸€ä¸ªä¸´ç•Œç‚¹ï¼Œofoã€æ‘©æ‹œå°±å‡ºç°äº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸‹ï¼ŒFriction æ˜¯è´­ä¹°æˆæœ¬ã€æ˜¯ä½¿ç”¨æˆæœ¬ã€æ˜¯ä»˜è´¹ä¾¿æ·åº¦ã€æ˜¯æŒæœ‰æˆæœ¬ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å†çœ‹å…±äº«å……ç”µå®ã€‚&lt;/p&gt;
&lt;p&gt;åŸºæœ¬æ‰€æœ‰çš„æŠ€æœ¯åŸºç¡€å’Œå…±äº«å•è½¦åŒºåˆ«ä¸å¤§ï¼Œä½†ä» Friction è§’åº¦æ¥çœ‹ï¼Œæœ‰å‡ ç‚¹ä¸åŒï¼Œè€Œæ­£æ˜¯è¿™å‡ ç‚¹ä¸åŒï¼Œå¸¦æ¥äº†æœ¬è´¨çš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå……ç”µå®å¾ˆä¾¿å®œï¼Œè´­ä¹°æˆæœ¬å¾ˆä½ï¼Œæ‰€ä»¥äººä»¬å¯ä»¥éšæ‰‹è´­ä¹°ï¼›å…¶æ¬¡ï¼Œå……ç”µå®ä½“ç§¯å¾ˆå°ï¼ŒæŒæœ‰æˆæœ¬å¾ˆä½ï¼Œæ‰€ä»¥äººä»¬å¯ä»¥éšèº«æºå¸¦ï¼›æœ€åï¼Œå……ç”µå®æ— æ³•åƒå•è½¦ä¸€æ ·éšå¤„åœæ”¾ï¼Œæ‰€ä»¥è¿˜å¤šå‡ºäº†ä¸€ä¸ªå½’è¿˜æˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œä» Friction çš„è§’åº¦æ¥çœ‹ï¼Œè´­ä¹°å……ç”µå®æœ¬èº«å·²ç» Friction å¾ˆä½ï¼Œè€Œå…±äº«å……ç”µå®çš„å½’è¿˜è¿˜åè¿‡æ¥å¢åŠ äº† Frictionã€‚æ‰€ä»¥å…±äº«å……ç”µå®ä¸å¦‚å…±äº«å•è½¦çš„å“ç±»å¥½ã€‚&lt;/p&gt;
&lt;p&gt;é‚£æ¯”è¾ƒè¿™ä¸¤ç§å…¶å®æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä½“ç§¯å¤§çš„ä¸œè¥¿æ‰æœ‰æŒæœ‰æˆæœ¬ï¼Œè€Œæœ‰æŒæœ‰æˆæœ¬æ‰æœ‰ Friction å¯ä»¥å‡å°‘ï¼Œä¹Ÿå°±æ˜¯æ‰æœ‰å¢å€¼ç‚¹ï¼Œè€Œäººä»¬æ— æ³•æºå¸¦ä½“ç§¯æ›´å¤§çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å°±éœ€è¦è¿™ç±»ä¸œè¥¿è‡ªå¸¦ç§»åŠ¨å±æ€§ï¼Œä¹Ÿå°±æ˜¯ç±»äº¤é€šå·¥å…·æ‰å¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä½“ç§¯å°çš„ä¸œè¥¿å¿…é¡»æ˜¯äººä»¬æ„¿æ„éšèº«æºå¸¦çš„ï¼Œè€Œä¸”è´­ä¹°æˆæœ¬æˆ–æŒæœ‰æˆæœ¬é«˜çš„ï¼Œæ‰èƒ½å¼¥è¡¥ï¼ˆè®¡ç®— Friction æ€»å’Œï¼‰ã€‚è¿™æ ·çš„å“ç±»è¿˜æœ‰ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™å°±åˆ°äº†ç¬¬ä¸‰ç§å…¬å¸ï¼Œè¡£äºŒä¸‰è¿™ç±»çš„æœè£…ç§Ÿèµã€‚&lt;/p&gt;
&lt;p&gt;è¡£æœè¿™ä¸ªå“ç±»éå¸¸æœ‰æ„æ€ã€‚è¡£æœä½œä¸ºä¸€ä¸ªç±»åˆ«ï¼Œæ˜¯äººä»¬æ¯å¤©éƒ½è¦ç©¿çš„ï¼ˆä¹Ÿå°±æ˜¯æ¯ä¸ªäººéƒ½éšèº«æºå¸¦çš„ï¼‰ï¼Œä½†å¯¹äºå•ä»¶è¡£æœæ¥è¯´ï¼Œå´æœ‰è´­ä¹°æˆæœ¬é«˜ï¼Œä½¿ç”¨é¢‘æ¬¡ä½ï¼ˆæ›´æ¢é¢‘æ¬¡é«˜ï¼‰çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¯´ï¼Œè¡£æœç§Ÿèµè¿™ä¸ªå“ç±»ä¹Ÿæ˜¯ä¸ªå¥½å“ç±»ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 17 Dec 2017 08:55:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-12-17:/posts/zzru-he-zuo-chuang-ye-de-pin-lei-xuan-ze.html</guid><category>åˆ›ä¸š</category></item><item><title>Google å…³äºMachine Leaning çš„ç¬”è®°</title><link>/posts/google-guan-yu-machine-leaning-de-bi-ji.html</link><description>&lt;p&gt;å‰å‡ å¤©çœ‹äº† Google çš„ä¸€ä¸ªå…³äº Machine Learning çš„&lt;a href="https://docs.google.com/presentation/d/1kSuQyW5DTnkVaZEjGYCkfOxvzCqGEFzWBy4e9Uedd9k/preview"&gt;slides&lt;/a&gt;ï¼Œæ„Ÿè§‰ä¸é”™ï¼Œæ•´ç†ä¸€ä¸‹å­¦ä¹ ç¬”è®°&lt;/p&gt;
&lt;h1&gt;ML çš„å®šä¹‰&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;An approach to achieve artificial intelligence through systems that can learn from experience to find patterns in that data&lt;/p&gt;
&lt;p&gt;ML teaches a computer to recognise patterns by examples, rather than programming it with specific rules.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tNc79gy1fmjv6ugbr4j31jw0mo4qp.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;feature&lt;/h1&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œå‡ ä¸ªå±æ€§å°±ä»£è¡¨äº†å‡ ä¸ªç»´åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws3.sinaimg.cn/large/006tNc79gy1fmjllksmxfj30ma0omwg0.jpg /&gt;&lt;/p&gt;
&lt;p&gt;æœ‰æ—¶å€™æ›´å¤šçš„ç»´åº¦ï¼Œæ›´å®¹æ˜“åšå‡ºåˆ†ç±»ï¼šå‚è€ƒ&lt;a href="http://www.visiondummy.com/2014/04/curse-dimensionality-affect-classification/"&gt;è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws2.sinaimg.cn/large/006tNc79gy1fmjnimu1pyj30qw0uaqe7.jpg /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws3.sinaimg.cn/large/006tNc79gy1fmjnptevb6j30mk0gkwhb.jpg /&gt;&lt;/p&gt;
&lt;h1&gt;æœºå™¨å­¦ä¹ çš„åˆ†ç±»&lt;/h1&gt;
&lt;h2&gt;ç›‘ç£å­¦ä¹ &lt;/h2&gt;
&lt;p&gt;æ•°æ®æ˜¯æ ‡æ³¨è¿‡çš„&lt;/p&gt;
&lt;h2&gt;æ— ç›‘ç£çš„å­¦ä¹ &lt;/h2&gt;
&lt;p&gt;ä»æ²¡æœ‰æ ‡æ³¨çš„æ•°æ®ä¸­å­¦ä¹ &lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws3.sinaimg.cn/large/006tNc79gy1fmjnt7mzroj30os0nowg1.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;å¼ºåŒ–å­¦ä¹ &lt;/h2&gt;
&lt;p&gt;é€šè¿‡å¸¦æœ‰æ¿€åŠ±çš„è¯•é”™æ¥å­¦ä¹ &lt;/p&gt;
&lt;h1&gt;ä¾‹å­&lt;/h1&gt;
&lt;h2&gt;çº¿æ€§å›å½’ï¼ˆLinear Regressionï¼‰&lt;/h2&gt;
&lt;p&gt;&lt;img width=300 src=https://ws1.sinaimg.cn/large/006tNc79gy1fmjo16iq86j30hy0b4gmc.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;èšç±»&lt;/h2&gt;
&lt;p&gt;&lt;img width=300 src=https://ws4.sinaimg.cn/large/006tNc79gy1fmjo292bd4j30nu0o475r.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;KNN&lt;/h2&gt;
&lt;p&gt;&lt;img width=300 src=https://ws4.sinaimg.cn/large/006tNc79gy1fmjo31w9wnj30nm0iuq3r.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;ç¥ç»ç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;&lt;img src=https://ws2.sinaimg.cn/large/006tNc79gy1fmjo8g08s2j31ie0h07b4.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;fully-connected ç¥ç»ç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;&lt;img src=https://ws3.sinaimg.cn/large/006tNc79gy1fmjo81ka29j31kw0l9wr1.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;æ·±åº¦ç¥ç»ç½‘ç»œï¼ˆDNNï¼‰&lt;/h2&gt;
&lt;p&gt;æ·±åº¦çš„æ„æ€å°±æ˜¯æœ‰å¾ˆå¤šçš„å±‚ã€‚æ¯”å¦‚è¯´ï¼Œå¯¹äºäººè„¸è¯†åˆ«ï¼Œå…¶ä¸­æŸäº›å±‚å¯èƒ½ä¼šè¯†åˆ«å‡ºçº¿æ¡ï¼Œç„¶åæœ‰çš„å±‚ä¼šè¯†åˆ«å‡ºçœ¼ç›ç­‰ç­‰&lt;/p&gt;
&lt;h2&gt;å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰&lt;/h2&gt;
&lt;p&gt;CNN å¯ä»¥ç”¨æ¥å¤„ç†å›¾ç‰‡æ•°æ®ï¼Œä»¥åŠå¯ä»¥è¡¨ç¤ºä¸ºå›¾ç‰‡çš„æ•°æ®ã€‚è¦ç¡®å®šä¸€ç»„æ•°æ®å¯ä¸å¯ä»¥è¡¨ç¤ºä¸ºå›¾ç‰‡ï¼Œå¯ä»¥å°è¯•äº¤æ¢ä»»æ„ä¸¤è¡Œï¼Œæˆ–è€…ä»»æ„ä¸¤åˆ—ï¼Œå¦‚æœäº¤æ¢åå¯¹æ•°æ®æ²¡æœ‰å½±å“ï¼Œé‚£ä¹ˆå°±ä¸å¯ä»¥è¢«è®¤ä¸ºæ˜¯å›¾ç‰‡æ•°æ®ã€‚æ›´å¤šç»†èŠ‚å‚çœ‹è¿™ä¸ª &lt;a href="https://youtu.be/FmpDIaiMIeA"&gt;Video&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;ç®—æ³•çš„åˆ†ç±»&lt;/h1&gt;
&lt;p&gt;è¯¦ç»†è®²è§£è¯·çœ‹&lt;a href="https://docs.google.com/presentation/d/1kSuQyW5DTnkVaZEjGYCkfOxvzCqGEFzWBy4e9Uedd9k/preview"&gt;è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Regression&lt;/h2&gt;
&lt;p&gt;å›å½’é¦–å…ˆè¦æœ‰ä¸€ä¸ªè¯„ä»·è¯¯å·®çš„æ–¹æ³•ï¼Œç„¶åè¿­ä»£çš„æ±‚å‡ºæ¨¡å‹ã€‚å›å½’æ˜¯ä¸€ç±»ä»ç»Ÿè®¡ä¸­å¾—å‡ºçš„æ–¹æ³•ï¼Œæ¯”å¦‚ä¸Šé¢è¯´åˆ°çš„ çº¿æ€§å›å½’ï¼ˆç”¨æœ€å°äºŒä¹˜æ³•ï¼‰ï¼Œè¿˜æœ‰é€»è¾‘å›å½’ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws3.sinaimg.cn/large/006tNc79gy1fmjq0fm7qsj30fa0euabi.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;Instance Based&lt;/h2&gt;
&lt;p&gt;Instance Based æ˜¯ä¸€ä¸ªå†³ç­–æ–¹æ³•ã€‚é€šè¿‡ç›¸ä¼¼åº¦è®¡ç®—æ‰¾å‡ºæœ€æ¥è¿‘çš„å®ä¾‹ã€‚æ¯”å¦‚KNN&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws2.sinaimg.cn/large/006tNc79gy1fmjpzyw85ej30f40h2dhc.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;Decision Tree&lt;/h2&gt;
&lt;p&gt;è‡ªå®šå‘ä¸‹ï¼Œåšå‡ºå†³ç­–&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws2.sinaimg.cn/large/006tNc79gy1fmjpzktongj30ho0guwg1.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;Bayesian&lt;/h2&gt;
&lt;p&gt;&lt;img width=300 src=https://ws2.sinaimg.cn/large/006tNc79gy1fmjq298126j30fs0fe404.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;clustering&lt;/h2&gt;
&lt;p&gt;&lt;img width=300 src=https://ws1.sinaimg.cn/large/006tNc79gy1fmjsnszjsnj30ea0fajsp.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;association rules&lt;/h2&gt;
&lt;p&gt;&lt;img width=300 src=https://ws3.sinaimg.cn/large/006tNc79gy1fmjsp79sk7j30eo0h4abg.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;Artificial Neural Network&lt;/h2&gt;
&lt;p&gt;æ¨¡æ‹Ÿäººçš„ç¥ç»ç³»ç»Ÿï¼Œæ¯”å¦‚æ„ŸçŸ¥æœº&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws4.sinaimg.cn/large/006tNc79gy1fmjsqfb0uij30ge0hejsj.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;æ·±åº¦å­¦ä¹ &lt;/h2&gt;
&lt;p&gt;å…¶å®å°±æ˜¯å¾ˆå¤šå±‚çš„ç¥ç»ç½‘ç»œï¼Œæ¯”å¦‚CNN&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws2.sinaimg.cn/large/006tNc79gy1fmju4bxxz6j30fs0goq5h.jpg /&gt;&lt;/p&gt;
&lt;h2&gt;é™ç»´ (Dimensionality Reduction)&lt;/h2&gt;
&lt;p&gt;æ‰¾åˆ°æ•°æ®çš„å†…åœ¨å±æ€§ï¼Œç„¶åç¼©å‡ç»´åº¦ï¼Œä»¥ä¾¿èƒ½å¤Ÿä½¿ç”¨ç›‘ç£å­¦ä¹ æ–¹æ³•&lt;/p&gt;
&lt;p&gt;&lt;img width=300 src=https://ws1.sinaimg.cn/large/006tNc79gy1fmju5kon3tj30fu0hc3zm.jpg /&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªensembleæ²¡çœ‹æ‡‚&lt;/p&gt;
&lt;h1&gt;æœºå™¨å­¦ä¹ çš„è¾“å‡º&lt;/h1&gt;
&lt;h2&gt;è¿ç»­è¾“å‡º&lt;/h2&gt;
&lt;p&gt;æ¯”å¦‚æ‹Ÿåˆå¥½çš„çº¿æ€§å›å½’è·Ÿå®šä¸€ä¸ªæ•°å€¼ï¼Œå¯ä»¥é¢„æµ‹å¦ä¸€ä¸ªæ•°å€¼&lt;/p&gt;
&lt;h2&gt;æ¦‚ç‡é¢„æµ‹&lt;/h2&gt;
&lt;h2&gt;åˆ†ç±»&lt;/h2&gt;
&lt;p&gt;æ¯”å¦‚åˆ†è¾¨å‡ºå°çŒ«å°ç‹—ï¼Œæˆ–è€…æ˜¯è¯†åˆ«æ•°å­—&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 16 Dec 2017 19:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-12-16:/posts/google-guan-yu-machine-leaning-de-bi-ji.html</guid><category>è®¡ç®—æœº</category><category>æœºå™¨å­¦ä¹ </category></item><item><title>çŸ¥è¯†ä»˜è´¹æ˜¯ä¸€ä¸ªä¼ªéœ€æ±‚</title><link>/posts/zhi-shi-fu-fei-shi-yi-ge-wei-xu-qiu.html</link><description>&lt;p&gt;ä»åˆ†ç­”å¼€å§‹ï¼Œäº’è”ç½‘ä¼¼ä¹æ€èµ·äº†ä¸€è‚¡çŸ¥è¯†ä»˜è´¹çš„çƒ­æ½®ã€‚ç„¶è€Œåœ¨æˆ‘çœ‹ç€è¿™è‚¡çƒ­æ½®å®åœ¨æ˜¯ä¸ªå¤§å¤§çš„æ³¡æ²«ï¼Œåªä¸è¿‡æ˜¯ä¹˜ç€æ”¯ä»˜å®å’Œå¾®ä¿¡æ”¯ä»˜æ™®åŠçš„ä¸œé£åˆ›é€ å‡ºæ¥çš„ä¸€ä¸ªä¼ªéœ€æ±‚ï¼Œçƒ­ä¹åŠ²ä¸€è¿‡ä¼°è®¡ä¹Ÿå°±åƒæ——æ¯é¼“äº†ã€‚&lt;/p&gt;
&lt;p&gt;äº’è”ç½‘çš„ç²¾ç¥æ˜¯å¼€æ”¾å…±äº«ï¼Œè€ŒçŸ¥è¯†ä»˜è´¹åˆ™æ˜¯å»ºç«‹äº†ä¸€ä¸ªä»˜è´¹çš„å›´å¢™ï¼Œæ˜¾ç„¶å’Œå¤§åŠ¿æ˜¯ç›¸æ‚–çš„ã€‚&lt;/p&gt;
&lt;h1&gt;å›ç­”æ¬²&lt;/h1&gt;
&lt;p&gt;å¯¹äºä»˜è´¹çš„é—®é¢˜å’Œæ”¶è´¹çš„é—®é¢˜ï¼Œäººä»¬çš„å›ç­”æ¬²æœ›æ˜¯æœ‰å¤©å£¤ä¹‹åˆ«çš„ã€‚æœ‰æ—¶å€™çœ‹ä¸ªé—®é¢˜ä¸é”™ï¼Œå°±æ˜¯æŒ‰è€ä¸ä½ä½“å†…çš„æ´ªè’ä¹‹åŠ›ï¼Œæƒ³å†™ä¸Šå‡ åƒå­—ã€‚ä½†æ˜¯çªç„¶æœ‰ä¸ªäººè¿‡æ¥è¯´ï¼Œæ¥å›ç­”è¿™ä¸ªé—®é¢˜ç»™ä½ 5å—é’±ï¼Œç¬é—´å°±ä¸æƒ³ç­”äº†ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ¥å›ç­”é—®é¢˜å®é™…ä¸Šæ˜¯è‡ªå·±çš„ä¸€ç§ç²¾ç¥äº«å—ï¼Œè€Œä¸€æ—¦åŠ ä¸Šé’±ä»¥åï¼Œäººä»¬æ½œæ„è¯†é‡Œå°±ä¼šè§‰å¾—è¿™æ˜¯å†ç»™åˆ«äººå¹²æ´»å„¿äº†ï¼Œæ‰€ä»¥å‡ å—é’±åå€’ä¼šåäº†äº‹ã€‚&lt;/p&gt;
&lt;p&gt;çœŸæ­£æœ‰ä»·å€¼çš„ä¸œè¥¿è¦ä¹ˆæ ¹æœ¬ä¸ä¼šå…¬å¼€ä¼ æ’­ï¼Œè¦ä¹ˆé‚£å°±æ˜¯è¦å‡ºä¹¦ç«‹ä¼ ï¼ŒæµèŠ³åƒå¤çš„ï¼Œä¼šå–ç€å±ˆå±ˆå‡ å—é’±ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´æˆ‘ï¼Œå»å¼€ä¸€åœºliveï¼Œ5å—ä¸€ä¸ªäººï¼Œæœ‰1000äººæ¥å¬ï¼Œé‚£æˆ‘ä¹Ÿå¾—å‡†å¤‡ä¸Šä¸ªä¸€ä¸¤å¤©å§ï¼Œä½†æ˜¯æˆ‘èƒ½æ•™å•¥å‘¢ï¼Œæˆ‘å¯ä»¥è¯´ä¸€äº›çˆ¬è™«çš„åŸºç¡€çŸ¥è¯†å•¥çš„ï¼Œä½†æ˜¯è¯´æ·±äº†ï¼Œæˆ‘ä¹Ÿä¸èƒ½æš´éœ²æˆ‘ä»¬çš„ä¸šåŠ¡æ•°æ®å§ï¼Ÿæ¯”æˆ‘çº§åˆ«é«˜ä¸€ç‚¹çš„ï¼Œæ‰‹é‡ŒæœŸæƒä¸€å¤§æŠŠï¼Œä¼šç¼ºè¿™ç‚¹é’±ï¼Ÿä¼šæœ‰æ—¶é—´æŒ£è¿™ç‚¹é’±ï¼Ÿå“ªæ€•æ˜¯ä¸ªæ„¿æ„åˆ†äº«çŸ¥è¯†ï¼Œå»ºç«‹è‡ªå·±å½±å“åŠ›çš„äººï¼Œé‚£è‚¯å®šä¼šå»å†™åšå®¢å•Šï¼Œè¿™æ ·æ‰èƒ½æ‰©å¤§å½±å“åŠ›å˜›&lt;/p&gt;
&lt;h1&gt;çœ¼ä¸‹çš„çº¢ç«&lt;/h1&gt;
&lt;p&gt;ä»˜è´¹é—®ç­”ç°åœ¨è¿˜æ˜¯ä¸€ä¸ªå™±å¤´ï¼Œæ‰€ä»¥è¿˜ä¼šæœ‰ä¸€äº›åäººï¼å¤§Væ¥åšé—®ç­”ï¼Œä½†æ˜¯è¿™æ›´å¤šæ„ä¹‰ä¸Šç®—æ˜¯ç²‰ä¸ç»æµï¼Œåäººè¦çš„æ˜¯æ›å…‰åº¦ï¼Œè€Œä¸æ˜¯åœ¨ä¹é‚£å±ˆå±ˆå‡ æ¬¾é’±ã€‚åäººçš„è¯æ›´å¤šçš„æ˜¯å¢åŠ äº†æ›å…‰ï¼Œè¿™ä¸ªæ½œåœ¨ä»·å€¼å¤ªå¤§ï¼Œä¸è¿‡è¯´äº†ã€‚ä½†æ˜¯ä¸»æµçš„å¼€liveçš„äººï¼Œå¦‚æœæ˜¯é‚€è¯·æ¥çš„äººæ°´å¹³å¤Ÿäº†ï¼Œé‚£äººå®¶æ ¹æœ¬ä¸ç¼ºè¿™ç‚¹é’±ï¼ŒèŠ±è¿™ä¹ˆé•¿æ—¶é—´å°±èƒ½åœ¨è¿™ä¹ˆä¸€ç‚¹äººä¹‹é—´æ‰©å¤§å½±å“åŠ›å¤ªä¸å€¼å•Šï¼Œä¹Ÿå°±å›¾ä¸ªæ–°é²œã€‚å¦‚æœé‚€è¯·æ¥çš„äººæ„¿æ„é•¿æœŸèµšliveè¿™ä¸ªé’±ï¼Œé‚£æ°´å¹³è‚¯å®šé«˜ä¸äº†å•Šï¼Œä¸ç„¶è°åƒè¿™ç‚¹è‹è‡è‚‰å•Šï¼Œæ‰€ä»¥å°±æ˜¯å¤§é‡çš„é›¶åŸºç¡€å…¥é—¨pythonäº†ã€‚è¿˜æœ‰å°±æ˜¯è¦æƒ³è®©å—ä¼—å¹¿ï¼Œå°±åªèƒ½å¼€è¿™ç§åŸºç¡€è¯¾&lt;/p&gt;
&lt;h1&gt;åœ¨çº¿æ•™è‚²&lt;/h1&gt;
&lt;p&gt;å¹¿ä¹‰çš„è¯´ï¼ŒçŸ¥è¯†ä»˜è´¹ä¹ŸåŒ…æ‹¬ K12 åœ¨å†…çš„åœ¨çº¿æ•™è‚²ï¼Œè¿™éƒ¨åˆ†æˆ‘å€’æ˜¯éå¸¸çœ‹å¥½ã€‚æ¯•ç«Ÿæœ‰çš„äººå°±æ˜¯å­¦ä¹ èƒ½åŠ›å·®ï¼Œæˆ–è€…è¯´æ„¿æ„å¬äººåš¼ç¢äº†å†è®²ç»™ä»–å¬ï¼Œè¿™ç§éœ€æ±‚åœ¨çº¿ä¸‹æ˜¯åˆšéœ€ï¼ŒæŠŠçº¿ä¸‹çš„åŸ¹è®­æ¬åˆ°çº¿ä¸Šï¼Œèƒ½å¤Ÿæ›´å¥½çš„ä¼ æ’­ï¼Œèƒ½å¤Ÿçªç ´çº¿ä¸‹æ•™è‚²çš„åœ°ç†é™åˆ¶ï¼Œç›¸ä¿¡ä¼šæœ‰å¾ˆå¥½çš„å‘å±•ã€‚&lt;/p&gt;
&lt;h1&gt;ä»˜è´¹é—®ç­”çš„æ°´å¹³æ‚–è®º&lt;/h1&gt;
&lt;p&gt;ç°åœ¨çš„è¿™äº›ä»˜è´¹é—®ç­”å°±æ˜¯å¬ä¼—æƒ³èŠ±5å—é’±å–ä»·å€¼ç™¾ä¸‡çš„å•†ä¸šé—®é¢˜ï¼Œå›ç­”çš„äººè¦ä¹ˆä¸æ‡‚ï¼Œè¦ä¹ˆä¹Ÿæ²¡æ³•è¯´ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ ·ï¼Œä½ æƒ³èŠçš„äººä¸ç¨€ç½•è¿™ç‚¹é’±ï¼Œç¨€ç½•è¿™ç‚¹é’±çš„äººä½ ä¸æƒ³å’Œä»–èŠ&lt;/p&gt;
&lt;p&gt;çœŸæ­£çš„çŸ¥è¯†ä»˜è´¹æ˜¯å‡ ç™¾ä¸‡çš„å•†ä¸šç­–åˆ’ï¼Œå‡ ç™¾ä¸‡çš„UIè®¾è®¡ã€‚å…¬å¼€çš„é—®é¢˜å¯èƒ½æ˜¯ â€œå‰ç«¯ç¨‹åºå‘˜æ€ä¹ˆè§„åˆ’å­¦ä¹ è·¯å¾„â€ï¼Œç„¶è€Œä»˜è´¹é—®ç­”åˆ™å¯èƒ½æ˜¯ç°åœ¨ä½ èŠ±äº”å—é’±å°±æƒ³é—®â€œæˆ‘ç°åœ¨ä¼šjsï¼Œä¼šä¸€ç‚¹cssï¼Œä¼šä¸€ç‚¹vueï¼Œblahï¼Œblahï¼Œâ€&lt;/p&gt;
&lt;h1&gt;çœŸæ­£çš„çŸ¥è¯†ä»˜è´¹&lt;/h1&gt;
&lt;p&gt;å…¶å®çŸ¥è¯†ä»˜è´¹æ—©å°±å­˜åœ¨ã€‚å°è¯´å°±æ˜¯æœ€å¥½çš„ä¾‹å­ï¼Œå¹¶ä¸æ˜¯ä»€ä¹ˆé«˜å¤§ä¸Šçš„æ–°ä¸œè¥¿&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 15 Dec 2017 18:37:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-12-15:/posts/zhi-shi-fu-fei-shi-yi-ge-wei-xu-qiu.html</guid><category>åˆ›ä¸š</category><category>è¿è¥ä¸äº§å“</category></item><item><title>lispy ç¬”è®°</title><link>/posts/lispy-bi-ji.html</link><description>&lt;p&gt;é˜…è¯» norvig æ–‡ç« &lt;a href="http://norvig.com/lispy.html"&gt;(How to Write a (Lisp) Interpreter (in Python))&lt;/a&gt;çš„ç¬”è®°ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä»æ•°å­¦ç³»è½¬è¿‡æ¥çš„å­¦ç”Ÿï¼Œä¹‹å‰å¹¶æ²¡æœ‰å­¦è¿‡ç¼–è¯‘åŸç†ï¼Œåªæ˜¯è‡ªå·±åœ¨ä¸€äº›æ–‡ç« ä¸­è¯»è¿‡å…³äºç¼–è¯‘å™¨çš„åªè¨€ç‰‡è¯­ï¼Œå€Ÿè¿™ç¯‡æ–‡ç« äº†è§£ä¸€äº›ç¼–è¾‘å™¨çš„åŸºæœ¬çŸ¥è¯†å§ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ç”¨ Python å®ç°äº†ä¸€ä¸ª lisp çš„è§£é‡Šå™¨ã€‚lisp è¯­è¨€çš„è¯­æ³•éå¸¸ç®€å•ï¼Œå¯ä»¥è¯´lispè¯­è¨€æœ¬èº«å°±æ˜¯ AST ã€‚ä¸€ä¸ªè§£é‡Šå™¨åŸºæœ¬æœ‰ä¸¤ä¸ªéƒ¨åˆ†ã€‚ä¸€éƒ¨åˆ†æ˜¯ parserï¼Œç”ŸæˆASTï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æ‰§è¡Œï¼Œè¿è¡ŒASTã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;code --&amp;gt; (parse)  --&amp;gt; AST --&amp;gt; (eval) --&amp;gt; result
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¹Ÿå°±æ˜¯æˆ‘ä»¬åªè¦å»å®ç° parse å’Œ eval ä¸¤ä¸ªå‡½æ•°å°±å¥½äº†ï½&lt;/p&gt;
&lt;h1&gt;ç±»å‹å®šä¹‰&lt;/h1&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨äº†å‡ ä¸ªç±»å‹ï¼Œéƒ½æ˜¯ç›´æ¥è¡ç”Ÿè‡ªPython çš„åŸç”Ÿç±»å‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Symbol = str  # å˜é‡
Number = (int, float)
Atom = (Symbol, Number)
List = list
Exp = (Atom, List)
Env = dict
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;parse&lt;/h1&gt;
&lt;p&gt;parse ä¼ ç»Ÿæ„ä¹‰ä¸Šåº”è¯¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯è¯æ³•åˆ†æ(Lexical Analysis)ï¼Œä¹Ÿå°±æ˜¯ tokenizeï¼ŒæŠŠä»£ç è½¬æ¢æˆä¸€ç³»åˆ—çš„ tokenã€‚å¦ä¸€éƒ¨åˆ†æ˜¯è¯­æ³•åˆ†æï¼Œä¹Ÿå°±æ˜¯åˆæˆ ASTã€‚å¸¸ç”¨çš„å·¥å…·æœ‰ lexï¼Œply ç­‰&lt;/p&gt;
&lt;p&gt;åœ¨ Lispy ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ Python çš„ str.split æ¥å®ç° tokenize&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def tokenize(chars: str) -&amp;gt; list:
    return chars.replace(&amp;#39;(&amp;#39;, &amp;#39; ( &amp;#39;).replace(&amp;#39;)&amp;#39;, &amp;#39; ) &amp;#39;).split()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åä½¿ç”¨ read_from_tokens æ„å»ºä¸€é¢—è¯­æ³•æ ‘ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def read_from_tokens(tokens: list) -&amp;gt; Exp:
    if len(tokens) == 0:
        raise SyntaxError(&amp;#39;unexpected EOF&amp;#39;)
    token = tokens.pop(0)  # ä»å·¦å‘å³ä¾æ¬¡å¤„ç†
    if token == &amp;#39;(&amp;#39;:
        L = []
        while token[0] != &amp;#39;)&amp;#39;:
            L.append(read_from_tokens(tokens))  # æ„å»ºå­æ ‘
        tokens.pop(0)  #  å¼¹å‡º &amp;#39;(&amp;#39;
        return L
    elif token == &amp;#39;)&amp;#39;:
        raise SyntaxError(&amp;#39;unexpected )&amp;#39;)
    else:
        return atom(token)

def atom(token: str) -&amp;gt; Atom:
    try:
        return int(token)
    except ValueError:
        try:
            return float(token)
        except ValueError:
            return Symbol(token)

def parse(program: str) -&amp;gt; Exp:
    return read_from_tokens(tokenize(program))
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;environment&lt;/h1&gt;
&lt;p&gt;ç¯å¢ƒå¤§æ¦‚å’Œscopeæ˜¯ç›¸å…³çš„ä¸€ä¸ªæ¦‚å¿µäº†ã€‚æ¯”å¦‚ &lt;code&gt;sqrt&lt;/code&gt; å’Œ &lt;code&gt;max&lt;/code&gt; éƒ½æ˜¯å…¨å±€ç¯å¢ƒä¸­çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Env&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;outer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;outer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;outer&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;outer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;




&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;math&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;operator&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;op&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;standard_env&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;env&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Env&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;vars&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;  &lt;span class="c1"&gt;# å¼•å…¥python math æ¨¡å—çš„æ–¹æ³•&lt;/span&gt;
    &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sub&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;*&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mul&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;truediv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;gt;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ge&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;le&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;abs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;append&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;apply&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;proc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;proc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;begin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;car&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;cdr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:],&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;cons&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;eq?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;expt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;pow&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;equal?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;length&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;list?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;map&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;max&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;min&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;not&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;op&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;not_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;null?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="p"&gt;[],&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;number?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Number&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;print&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;procedure?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;callable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;round&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;round&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;symbol?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Symbol&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;env&lt;/span&gt;

&lt;span class="n"&gt;global_env&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;standard_env&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;eval&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è¡¨è¾¾å¼&lt;/th&gt;
&lt;th&gt;è¯­æ³•&lt;/th&gt;
&lt;th&gt;è¯­ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;å˜é‡å¼•ç”¨&lt;/td&gt;
&lt;td&gt;symbol&lt;/td&gt;
&lt;td&gt;å†™å‡ºå˜é‡åå°±æ˜¯è¡¨ç¤ºå¼•ç”¨è¿™ä¸ªå˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¸¸é‡&lt;/td&gt;
&lt;td&gt;number&lt;/td&gt;
&lt;td&gt;&lt;code&gt;10&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¡ä»¶å¼&lt;/td&gt;
&lt;td&gt;(if test conseq alt)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;(if  (&amp;gt; 10 20) (+ 1 1) (+ 3 3)&lt;/code&gt; =&amp;gt; 6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å®šä¹‰å˜é‡&lt;/td&gt;
&lt;td&gt;(define symbol exp)&lt;/td&gt;
&lt;td&gt;å®šä¹‰ä¸€ä¸ªæ–°çš„å˜é‡ &lt;code&gt;(define r 10)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¿‡ç¨‹è°ƒç”¨&lt;/td&gt;
&lt;td&gt;(proc args...)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;(sqrt (* 2 8))&lt;/code&gt; =&amp;gt; 4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;quotation&lt;/td&gt;
&lt;td&gt;(quote exp)&lt;/td&gt;
&lt;td&gt;è¿”å›è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯æ‰§è¡Œå®ƒã€‚&lt;code&gt;(quote (+ 1 2))&lt;/code&gt; =&amp;gt; &lt;code&gt;(+ 1 2)&lt;/code&gt;è€Œä¸æ˜¯3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;èµ‹å€¼&lt;/td&gt;
&lt;td&gt;(set! symbol exp)&lt;/td&gt;
&lt;td&gt;æ³¨æ„å’Œå®šä¹‰å˜é‡çš„åŒºåˆ«&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¿‡ç¨‹&lt;/td&gt;
&lt;td&gt;(lambda (symbols...) exp)&lt;/td&gt;
&lt;td&gt;å®šä¹‰ä¸€ä¸ªæ–°çš„è¿‡ç¨‹ &lt;code&gt;(lambda (r) (* pi (* r r)))&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;Procedure&lt;/span&gt;:
    &lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;env&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;
    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__call__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;Env&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;: &lt;span class="kt"&gt;Exp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;global_env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;Exp&lt;/span&gt;:
    &lt;span class="kt"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;Symbol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;      &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å˜é‡å¼•ç”¨&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="nx"&gt;elif&lt;/span&gt; &lt;span class="nx"&gt;not&lt;/span&gt; &lt;span class="nx"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;List&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å¸¸é‡&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;
    &lt;span class="nx"&gt;op&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nx"&gt;op&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;quote&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="nx"&gt;elif&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;if&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;            &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;æ¡ä»¶è¡¨è¾¾å¼&lt;/span&gt;
       &lt;span class="nx"&gt;test&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;conseq&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;alt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;
       &lt;span class="nx"&gt;exp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;conseq&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;test&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="nx"&gt;alt&lt;/span&gt;
       &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;elif&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;define&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å®šä¹‰å˜é‡&lt;/span&gt;
       &lt;span class="nx"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;symbol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;exp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;
       &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;symbol&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;elif&lt;/span&gt; &lt;span class="nx"&gt;op&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;set!&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;         &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å˜é‡èµ‹å€¼&lt;/span&gt;
        &lt;span class="nx"&gt;symbol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;exp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;
        &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;symbol&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="nx"&gt;symbol&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;elif&lt;/span&gt; &lt;span class="nx"&gt;op&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;lambda&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;å®šä¹‰è¿‡ç¨‹&lt;/span&gt;
        &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;Procedure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;                        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="err"&gt;è¿‡ç¨‹è°ƒç”¨&lt;/span&gt; &lt;span class="nx"&gt;List&lt;/span&gt;
        &lt;span class="nx"&gt;proc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;arg&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nx"&gt;arg&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;proc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;repl&lt;/h1&gt;
&lt;p&gt;repl çš„æ„æ€æ˜¯ Read-Eval-Print-Loopï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„â€œè§£é‡Šå™¨â€ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def repl(prompt=&amp;#39;lis.py&amp;gt; &amp;#39;):
    while True:
        val = eval(parse(input(prompt)))
        if val is not None:
            print(schemestr(val))

def schemestr(exp):
    if isinstance(exp, List):
        return f&amp;#39;({&amp;quot; &amp;quot;.join(map(schemestr, exp))})&amp;#39;)
    else:
        return str(exp)
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 10 Dec 2017 05:44:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-12-10:/posts/lispy-bi-ji.html</guid><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>bug é”™é¢˜æœ¬</title><link>/posts/bug-cuo-ti-ben.html</link><description>&lt;p&gt;å‘ç°æœ‰ä¸€äº›é”™è¯¯æ˜¯è‡ªå·±ç»å¸¸çŠ¯çš„ï¼Œä¸è®°å½•ä¸‹æ¥å›é¡¾ä¸€ä¸‹ï¼Œæ€»æ˜¯ä¼šä¸€ç›´çŠ¯ã€‚é«˜ä¸­çš„æ—¶å€™è¿˜æœ‰ä¹ æƒ¯æ¥è®°å½•é”™é¢˜ï¼Œç„¶è€Œè¿™ä¹ˆå¥½çš„ä¹ æƒ¯ï¼Œåˆ°äº†å¤§å­¦é‡Œå´è«åå…¶å¦™çš„æ²¡æœ‰äº†ï¼ŒçŸ¥é“æ¯•ä¸šä¸¤å¹´åçš„ä»Šå¤©æ‰çªç„¶æƒ³èµ·ã€‚æ‰€ä»¥ç¬¬ä¸€ä¸ªåœºè´©çš„é”™è¯¯å°±æ˜¯æ€æƒ³ä¸Šçš„â€”â€”å­¦ä¹ æ˜¯ä¸€ä»¶ç»ˆèº«çš„äº‹ï¼Œè¦å»¶ç»­å¥½ä¹ æƒ¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå„ç§æŒæœ‰èµ„æºçš„è¿æ¥æ± å¯¹è±¡ç­‰ï¼Œè¦æ—¶åˆ»æ³¨æ„å®ƒä»¬æ˜¯å¦æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;h1&gt;Python&lt;/h1&gt;
&lt;h2&gt;æ›´æ–°å˜é‡çš„valueçš„æ—¶å€™ï¼Œå˜é‡åå†™é”™äº†ï¼Œå¯¼è‡´åˆ›å»ºäº†ä¸€ä¸ªæ²¡æœ‰ç”¨çš„æ–°å˜é‡ï¼Œè€å˜é‡çš„valueå´æ²¡æœ‰æ›´æ–°&lt;/h2&gt;
&lt;p&gt;è§£å†³ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨pylint æ£€æŸ¥ä»£ç ï¼Œä¼šæç¤º unused variableï¼›&lt;/li&gt;
&lt;li&gt;åœ¨å†™ä»£ç çš„æ—¶å€™å¤šç”¨è‡ªåŠ¨è¡¥å…¨ï¼Œè€Œä¸è¦æ‰‹åŠ¨æ‰“å‡ºæ¯ä¸€ä¸ªå˜é‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Python çš„å˜é‡å£°æ˜å’Œèµ‹å€¼æ²¡æœ‰åˆ†å¼€ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªå‘ï¼Œåªèƒ½é€šè¿‡å¤šç”¨å·¥å…·æ£€æŸ¥æ¥å®ç°&lt;/p&gt;
&lt;h1&gt;æ•…éšœæ’æŸ¥&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æœ‰æ—¶å€™åˆ æ–‡ä»¶åˆ ä¸æ‰ä½†æ˜¯ç©ºé—´è¿˜åœ¨å ç”¨æ˜¯å› ä¸ºè¿˜æœ‰ç¨‹åºåœ¨ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CPU wait æ¯”è¾ƒé«˜è¯´æ˜åœ¨åšio&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿç›¸å…³é—®é¢˜ï¼ˆOOMï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;dmesg -T&lt;/code&gt; æˆ– &lt;code&gt;tail -200Â /var/log/kern.log&lt;/code&gt; æŸ¥çœ‹ç³»ç»Ÿkillè¿›ç¨‹çš„æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°è¢«killæ‰æ—¶å€™çš„å†…å­˜å ç”¨ï¼Œå†ç”¨free -m æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦è¶…å‡ºäº†å†…å­˜&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 30 Nov 2017 22:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-30:/posts/bug-cuo-ti-ben.html</guid><category>æƒ³æ³•</category><category>è®¡ç®—æœº</category></item><item><title>pdb</title><link>/posts/pdb.html</link><description>&lt;p&gt;å¸¸ç”¨å‘½ä»¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;[n]ext ä¸‹ä¸€æ­¥&lt;/li&gt;
&lt;li&gt;[s]tep into è¿›å…¥å‡½æ•°&lt;/li&gt;
&lt;li&gt;[r]eturn è·³å‡ºå‡½æ•°&lt;/li&gt;
&lt;li&gt;[b]reakpoint æ‰“æ–­ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;pdb&lt;/p&gt;
&lt;p&gt;pdb is fine, just donâ€™t have so many features&lt;/p&gt;
&lt;p&gt;Usage: import pdb; pdb.set_trace()&lt;/p&gt;
&lt;p&gt;Ipdb is better&lt;/p&gt;
&lt;p&gt;Usage: import ipdb; ipdb.set_trace()
n   next
p   print
pp  pprint
s   setp into
c   continue to next breakpoint
b   breakpoint
a   args&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 27 Nov 2017 23:47:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-27:/posts/pdb.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>æš‚æ—¶æ²¡ç”¨åˆ°çš„è½¯ä»¶æ¸…å•</title><link>/posts/zan-shi-mei-yong-dao-de-ruan-jian-qing-dan.html</link><description>&lt;p&gt;DNS&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://mp.weixin.qq.com/s?__biz=MzIwMzg1ODcwMw==&amp;amp;mid=2247487141&amp;amp;idx=1&amp;amp;sn=d8e3d8bb867e65d0f09ed38f58949956&amp;amp;chksm=96c9b8c5a1be31d3368334a5c0b7ade1cad89185f4a643d1be2778fe0198f6a48dc593792ae1#rd"&gt;PowerDNS æ‹¥æœ‰webç®¡ç†ç•Œé¢çš„DNS&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://xiaqunfeng.cc/2017/02/03/Dm-cache-vs-Bcache/"&gt;bcache&lt;/a&gt; &lt;a href="https://blog.lilydjwg.me/2015/5/11/self-made-sshd-with-bcache.92025.html"&gt;å¦ä¸€ç¯‡&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="http://man7.org/linux/man-pages/man7/vdso.7.html"&gt;vdso&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://zhuanlan.zhihu.com/clickhouse"&gt;clickhouse&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://github.com/major/MySQLTuner-perl"&gt;Mysql Tunner&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://www.maptiler.com/"&gt;åˆ‡å‰²åœ°å›¾ maptiler&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 25 Nov 2017 18:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-25:/posts/zan-shi-mei-yong-dao-de-ruan-jian-qing-dan.html</guid><category>è®¡ç®—æœº</category></item><item><title>sklearn å…¥é—¨ç¬”è®°</title><link>/posts/sklearn-ru-men-bi-ji.html</link><description>&lt;p&gt;å‰ä¸€é˜µçœ‹äº†ä¸€ä¸ªå«åš &lt;a href="https://morvanzhou.github.io/tutorials/machine-learning/sklearn/1-1-why/"&gt;è«çƒ¦Python&lt;/a&gt; çš„æ•™ç¨‹ï¼Œè¿˜æœ‰ &lt;a href="http://scikit-learn.org/stable/tutorial/basic/tutorial.html"&gt;sklearnçš„å®˜æ–¹æ•™ç¨‹&lt;/a&gt; åˆæ­¥äº†è§£äº†ä¸€ä¸‹ sklearn çš„åŸºæœ¬æ¦‚å¿µï¼Œä¸è¿‡æ•™ç¨‹æ¯•ç«Ÿæœ‰äº›å•°å—¦ï¼Œè¿˜æ˜¯è‡ªå·±è®°å½•ä¸€ä¸‹å…³é”®è¦ç‚¹å¤‡å¿˜ã€‚&lt;/p&gt;
&lt;h1&gt;æœºå™¨å­¦ä¹ è¦è§£å†³çš„é—®é¢˜&lt;/h1&gt;
&lt;h2&gt;ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;sklearn ç»™äº†ä¸€ä¸ªå®šä¹‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In general, a learning problem considers a set of n samples of data and then tries to predict properties of unknown data. If each sample is more than a single number and, for instance, a multi-dimensional entry (aka multivariate data), it is said to have several attributes or features.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¿»è¯‘è¿‡æ¥ï¼š&lt;/p&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œâ€œå­¦ä¹ é—®é¢˜â€é€šè¿‡ç ”ç©¶ä¸€ç»„ n ä¸ªæ ·æœ¬çš„æ•°æ®æ¥é¢„æµ‹æœªçŸ¥æ•°æ®çš„å±æ€§ã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœæ¯ä¸ªæ ·æœ¬éƒ½ä¸æ­¢åŒ…å«ä¸€ä¸ªæ•°å­—ï¼Œè€Œæ˜¯å¤šç»´çš„å‘é‡ï¼Œé‚£ä¹ˆå°±ç§°å®ƒä¸ºæœ‰å¤šä¸ªfeatureå±æ€§ã€‚&lt;/p&gt;
&lt;h2&gt;é—®é¢˜&lt;/h2&gt;
&lt;p&gt;æœºå™¨å­¦ä¹ çš„æ–¹æ³•ä¸å¤–ä¹è¿™å‡ ç±»ï¼Œç°åœ¨è‡ªå·±ç”¨åˆ°çš„åº”è¯¥æ˜¯åˆ†ç±»æ¯”è¾ƒå¤šã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Classification åˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯ç¦»æ•£çš„&lt;/li&gt;
&lt;li&gt;Regression å›å½’ï¼Œä¹Ÿå°±æ˜¯è¿ç»­çš„&lt;/li&gt;
&lt;li&gt;Clustering èšç±»&lt;/li&gt;
&lt;li&gt;Dimensionality reduction æ•°æ®é™ç»´&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¦å®ç°ä¸Šé¢å‡ ä¸ªç›®æ ‡ï¼Œå¯èƒ½éœ€è¦ä¸‹é¢çš„æ­¥éª¤&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Model Selection æ¨¡å‹é€‰æ‹©&lt;/li&gt;
&lt;li&gt;Preprocessing æ•°æ®é¢„å¤„ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¦å»åˆ¤å®šè‡ªå·±çš„ä»»åŠ¡éœ€è¦ç”¨å“ªç§æ–¹æ³•ï¼Œä¼˜å…ˆå‚è€ƒ sklearn å®˜æ–¹æ¨å‡ºçš„ &lt;a href="http://scikit-learn.org/stable/tutorial/machine_learning_map/index.html"&gt;cheatsheet&lt;/a&gt;ï¼ˆå°æŠ„ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img alt="sklearn-leanr cheatsheet" src="http://scikit-learn.org/stable/_static/ml_map.png"&gt;&lt;/p&gt;
&lt;h1&gt;sklearn çš„æ•°æ®åº“&lt;/h1&gt;
&lt;p&gt;sklearn ä¸ºäº†æ–¹ä¾¿å­¦ä¹ è‡ªå¸¦äº†ä¸€äº›æ•°æ®åº“ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸æ–¹ä¾¿äº†ã€‚åŒ…æ‹¬äº† iris èŠ±ç“£æ•°æ®åº“ï¼Œæ‰‹å†™æ•°å­—æ•°æ®åº“ç­‰ã€‚è¿™äº›ä¾‹å­å¯ä»¥è¯´ç›¸å½“äºç¼–ç¨‹è¯­è¨€çš„ hello world æˆ–è€…æ˜¯å›¾å½¢å­¦å±Šçš„ utah teapot äº†ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†çœŸå®çš„æ•°æ®é›†ï¼Œè¿˜å¯ä»¥ä½¿ç”¨&lt;code&gt;datasets.make_*&lt;/code&gt;ç³»åˆ—å‡½æ•°æ¥ç›´æ¥ç”Ÿæˆä¸€äº›æ•°æ®é›†ç”¨æ¥æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;datasets&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;iris&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datasets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_iris&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;          &lt;span class="c1"&gt;# iris èŠ±ç“£æ•°æ®åº“&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datasets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_digits&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;      &lt;span class="c1"&gt;# æ‰‹å†™æ•°å­—æ•°æ®åº“&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;                   &lt;span class="c1"&gt;# æ•°æ®åº“çš„è¾“å…¥&lt;/span&gt;
&lt;span class="p"&gt;[[&lt;/span&gt;  &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;5.&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;  &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;10.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;  &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;16.&lt;/span&gt;   &lt;span class="mf"&gt;9.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
 &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;  &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;1.&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mf"&gt;6.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;  &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;2.&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;12.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
 &lt;span class="p"&gt;[&lt;/span&gt;  &lt;span class="mf"&gt;0.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;  &lt;span class="mf"&gt;10.&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="mf"&gt;12.&lt;/span&gt;   &lt;span class="mf"&gt;1.&lt;/span&gt;   &lt;span class="mf"&gt;0.&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;                        &lt;span class="c1"&gt;# æ•°æ®åº“çš„è¾“å‡º&lt;/span&gt;
&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­dataå±æ€§æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ ¼å¼æ˜¯&lt;code&gt;(n_samples, n_features)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;å…³äºå¦‚ä½•è½½å…¥å¤–éƒ¨æ•°æ®åº“ï¼Œå¯ä»¥çœ‹è¿™é‡Œï¼Œå®é™…ä¸Šæˆ‘ä¹Ÿè¿˜æ²¡çœ‹ï¼Œç§‘ç§‘&lt;/p&gt;
&lt;h1&gt;å­¦ä¹ ä¸é¢„æµ‹&lt;/h1&gt;
&lt;p&gt;ä»¥è¯†åˆ«æ‰‹å†™æ•°å­—ä¸ºä¾‹ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯æ ¹æ®å›¾åƒè¯†åˆ«å‡ºæ•°å­—æ˜¯ä»€ä¹ˆæ¥ã€‚æˆ‘ä»¬éœ€è¦ &lt;em&gt;fit&lt;/em&gt; ï¼ˆè®­ç»ƒï¼‰å‡ºæ¥ä¸€ä¸ª estimatorï¼Œç„¶åç”¨æ¥ &lt;em&gt;predict&lt;/em&gt; ï¼ˆé¢„æµ‹ï¼‰æœªçŸ¥æ•°æ®çš„ç±»å‹ã€‚åœ¨ sklearn ä¸­ï¼Œä¸€ä¸ª &lt;code&gt;estimator&lt;/code&gt; å°±æ˜¯ä¸€ä¸ªå®ç°äº† &lt;code&gt;fit&lt;/code&gt; å’Œ &lt;code&gt;predict&lt;/code&gt; æ–¹æ³•çš„ objectã€‚estimator å¸¸ç”¨çš„å±æ€§è¿˜æœ‰ &lt;code&gt;get_params&lt;/code&gt;, &lt;code&gt;score&lt;/code&gt; ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨æ”¯æŒå‘é‡æœºæ¨¡å‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="s s-Atom"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s s-Atom"&gt;from&lt;/span&gt; &lt;span class="s s-Atom"&gt;sklearn&lt;/span&gt; &lt;span class="s s-Atom"&gt;import&lt;/span&gt; &lt;span class="s s-Atom"&gt;svm&lt;/span&gt;
&lt;span class="s s-Atom"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s s-Atom"&gt;classifier&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s s-Atom"&gt;svm&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nv"&gt;SVC&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s s-Atom"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;C&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;100.&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="s s-Atom"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s s-Atom"&gt;classifier&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nf"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s s-Atom"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="s s-Atom"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s s-Atom"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="s s-Atom"&gt;target&lt;/span&gt;&lt;span class="p"&gt;[:-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;  &lt;span class="s s-Atom"&gt;#&lt;/span&gt; &lt;span class="s s-Atom"&gt;æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç»“æœ&lt;/span&gt;
&lt;span class="nv"&gt;SVC&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;C&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;100.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;cache_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;class_weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;coef0&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="s s-Atom"&gt;decision_function_shape=&amp;#39;ovr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;degree&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;gamma&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;kernel=&amp;#39;rbf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="s s-Atom"&gt;max_iter=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;probability&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;random_state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;shrinking&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="s s-Atom"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;verbose&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# ç°åœ¨æˆ‘ä»¬å¼€å§‹é¢„æµ‹æœ€åä¸€ä¸ªæ•°æ®&lt;/span&gt;
&lt;span class="s s-Atom"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s s-Atom"&gt;classifier&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nf"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s s-Atom"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="s s-Atom"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="s s-Atom"&gt;:&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="nf"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;  &lt;span class="s s-Atom"&gt;#&lt;/span&gt; &lt;span class="s s-Atom"&gt;å¾—å‡ºçš„ç»“æœæ˜¯&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®é™…ä¸Šçš„å›¾åƒæ˜¯&lt;/p&gt;
&lt;p&gt;&lt;img alt="last digit" src="http://scikit-learn.org/stable/_images/sphx_glr_plot_digits_last_image_001.png"&gt;&lt;/p&gt;
&lt;p&gt;åˆšåˆšçš„ä¾‹å­æ˜¯ä½¿ç”¨å‰é¢çš„æ•°æ®åšè®­ç»ƒï¼Œç„¶åè¯†åˆ«äº†æœ€åä¸€ä¸ªæ•°å­—ï¼Œå…¶å®æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ sklearn è‡ªå¸¦çš„ &lt;code&gt;train_test_split&lt;/code&gt; å‡½æ•°æ¥åˆ†å‰²æ•°æ®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.model_selection&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;

&lt;span class="n"&gt;X_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X_test&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_test&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;iris_X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iris_y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;test_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ³¨æ„å…¶ä¸­è®­ç»ƒæ•°æ®è¢«sklearnæ‰“ä¹±äº†. åœ¨æœºå™¨å­¦ä¹ ä¸­, æ•°æ®æ¯”è¾ƒä¹±æ˜¯æ¯”è¾ƒå¥½çš„, ç®—æ³•å…¶å®ä¹Ÿä¸€æ ·, æ•°ç»„æ˜¯ä¹±çš„æœ€å¥½.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å®Œæ•´çš„ä¾‹å­åœ¨è¿™é‡Œï¼šhttp://scikit-learn.org/stable/auto_examples/classification/plot_digits_classification.html&lt;/p&gt;
&lt;h2&gt;ä¿å­˜æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;è®­ç»ƒæ¨¡å‹è¿˜æ˜¯å¾ˆèŠ±è´¹æ—¶é—´çš„ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æ¯æ¬¡éƒ½å»è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯ç¦»çº¿è®­ç»ƒå¥½äº†ä¹‹åï¼Œä¿å­˜ä¸‹æ¨¡å‹æ¥ï¼Œç„¶ååœ¨çº¿è°ƒç”¨ã€‚ä¿å­˜æ¨¡å‹å¯æ˜¯ç›´æ¥ä½¿ç”¨ Python å†…ç½®çš„ pickle æ¨¡å—ï¼Œä½†æ˜¯ä¸€èˆ¬æ¨¡å‹æ•°æ®éƒ½æ¯”è¾ƒå¤§ï¼Œpickle å¯¹å¤§æ–‡ä»¶æ”¯æŒä¸å¥½ï¼Œæœ€å¥½é‡‡ç”¨ sklearn è‡ªå¸¦çš„ joblib.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.externals&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;joblib&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;joblib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;classifier&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;filename.pkl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 

&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;clf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;joblib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;filename.pkl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¾ˆç®€å•å§&lt;/p&gt;
&lt;h1&gt;å…¶ä»–çš„ä¸€äº›æŠ€å·§&lt;/h1&gt;
&lt;h2&gt;ä¸€äº›çº¦å®š&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢è¯´åˆ° sklearn çº¦å®šäº† fit å’Œ predict æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„çº¦å®š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰€æœ‰çš„è¾“å…¥éƒ½ä¼šè¢«è½¬åŒ–ä¸º float64 ç±»å‹&lt;/li&gt;
&lt;li&gt;ä¸€åŠä¹ æƒ¯ç”¨ &lt;code&gt;X&lt;/code&gt; è¡¨ç¤ºæ ·æœ¬æ•°æ®, &lt;code&gt;y&lt;/code&gt; è¡¨ç¤ºé¢„æµ‹ç»“æœ&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;å¯è§†åŒ–&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; X, y = datasets.make_regression(n_samples=100, n_features=1, n_targets=1, noise=10)
&amp;gt;&amp;gt;&amp;gt; plt.scatter(X, y)
&amp;gt;&amp;gt;&amp;gt; plt.show()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¼šæœ‰ä¸‹é¢çš„å›¾&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://morvanzhou.github.io/static/results/sklearn/2_3_3.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 24 Nov 2017 19:35:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-24:/posts/sklearn-ru-men-bi-ji.html</guid><category>è®¡ç®—æœº</category><category>æœºå™¨å­¦ä¹ </category></item><item><title>ç½‘é¡µä¸APIçš„å¸¸è§é¢‘æ¬¡é™åˆ¶ä¸ç ´è§£</title><link>/posts/wang-ye-yu-apide-chang-jian-pin-ci-xian-zhi-yu-po-jie.html</link><description>&lt;p&gt;ä¸Šçº¿ä¸€ä¸ªæ–°çš„é¡µé¢æˆ–è€…æ¥å£çš„æ—¶å€™éƒ½éœ€è¦è€ƒè™‘è¢«çˆ¬å–ï¼Œæ»¥ç”¨çš„æƒ…å†µã€‚è¿™ç¯‡æ–‡ç« æ€»ç»“ä¸€ä¸‹å¸¸è§çš„é™åˆ¶ä¸ååˆ¶æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä»æ¥å£çš„è§’åº¦æ¥è¯´ï¼ŒåŒ¿åçš„æ¥å£ä¸€å®šæ˜¯å¯ä»¥æ»¥ç”¨çš„ï¼Œåªæ˜¯ç ´è§£æˆæœ¬çš„é—®é¢˜ï¼›è€Œæœ‰ç™»å½•çŠ¶æ€çš„æ¥å£ä¸€èˆ¬ä¸å®¹æ˜“è¢«æ»¥ç”¨ã€‚&lt;/p&gt;
&lt;h1&gt;ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œè‡ªå¢IDè¢«æ»¥ç”¨&lt;/h1&gt;
&lt;p&gt;ä»€ä¹ˆå€¼å¾—ä¹°çš„è¯„æµ‹é¡µé¢ï¼Œhttps://test.smzdm.com/pingce/p/40205/ï¼Œè¿™ä¸ªé“¾æ¥çš„æœ€åä¸€ä¸ªæ•°å­—å°±æ˜¯è¯„æµ‹çš„é—®é¢˜IDï¼Œå¤§å°æ‰ä¸è¿‡å‡ ä¸‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘åªè¦éå†ä¸€ä¸‹è¿™ä¸ªæ•°å­—ï¼Œå°±å¯ä»¥æŠŠâ€œä»€ä¹ˆå€¼å¾—ä¹°â€è¿™ä¸ªç½‘ç«™çš„æ‰€æœ‰è¯„æµ‹éƒ½çˆ¬å–ä¸€éï¼Œè¿™ä¸ªæ˜¯åœ¨å¤ªå®¹æ˜“è¢«åˆ©ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä¸è¦ç›´æ¥ä½¿ç”¨æ•°æ®åº“çš„ä¸»é”®ä½œä¸ºé¡µé¢çš„IDï¼Œè€Œæ˜¯å°½é‡ä½¿ç”¨æ²¡æœ‰è§„å¾‹çš„æ•°å­—ï¼ˆæ¯”å¦‚UUIDï¼‰æˆ–è€…è‡³å°‘å¤§ä¸€ç‚¹çš„æ•°å­—ä½œä¸ºIDï¼Œé¿å…è¢«ç©·ä¸¾éå†ã€‚&lt;/p&gt;
&lt;h1&gt;ç¬¬äºŒä¸ªä¾‹å­ï¼Œåˆ—è¡¨é¡µé¢è¢«æ»¥ç”¨&lt;/h1&gt;
&lt;p&gt;é“¾å®¶çš„äºŒæ‰‹æˆ¿é¡µé¢ï¼Œhttps://bj.lianjia.com/ershoufang/101102279987.htmlï¼Œè¿™ä¸ªé¡µé¢çš„IDå°±æ¯”è¾ƒå¤§äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡åŠæ³•å»éå†è¿™æ ·ä¸€ä¸ªæ•°å­—ã€‚è¿™æ—¶å€™å¯ä»¥ä»åˆ—è¡¨é¡µå…¥æ‰‹ï¼Œhttps://bj.lianjia.com/ershoufang/rs/ï¼Œåªè¦ä»é¡µé¢ä¸Šæ‰¾åˆ°æ‰€æœ‰äºŒæ‰‹æˆ¿çš„é¡µé¢åœ°å€å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ç§æ»¥ç”¨çš„æƒ…å½¢ï¼Œ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åªèƒ½é™åˆ¶æ¯ä¸ªç”¨æˆ·çš„è®¿é—®é¢‘æ¬¡äº†ã€‚&lt;/li&gt;
&lt;li&gt;æˆ–è€…ç›´æ¥å±è”½æ‰ä¸€äº›éæ³•çš„è¯·æ±‚ã€‚æ¯”å¦‚è¯´User-Agentæ˜¯curlçš„å…ˆå±è”½æ‰ã€‚ä½†æ˜¯è¿™äº›æ€»æ˜¯å¯ä»¥ä¼ªé€ çš„ï¼Œç”šè‡³å¯ä»¥ç›´æ¥ç”¨ä¸€ä¸ªheadless chromeæ¥è®¿é—®é¡µé¢ï¼Œé“¾å®¶ç½‘æ€»ä¸èƒ½æŠŠchromeå±è”½æ‰å§ã€‚ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ï¼Œè¿˜æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼Œç”¨æˆ·éƒ½æ˜¯æ²¡æœ‰ç™»å½•çŠ¶æ€çš„ï¼Œéƒ½æ˜¯åŒ¿åçš„ã€‚æ¯”å¦‚è¯´é“¾å®¶ç½‘ï¼Œæ€»ä¸èƒ½è®©æ¯ä¸ªäººç™»å½•äº†æ‰èƒ½çœ‹æˆ¿å­å§ï¼Œé‚£ä¼°è®¡å®¢æˆ·æµå¤±ä¼šå¾ˆä¸¥é‡ã€‚è¿™æ—¶å€™è¯†åˆ«æ¯ä¸ªç”¨æˆ·å¸¸ç”¨çš„ä¸€äº›æ–¹æ³•ä¸»è¦æ˜¯é€šè¿‡cookieså’ŒIPã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡IPè¯†åˆ«ç”¨æˆ·&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™ç§æ–¹æ³•ç®€å•ç²—æš´ï¼Œç›´æ¥æ ¹æ®æ¥æºIPæ¥åˆ¤å®šæ˜¯å¦æ˜¯åŒä¸€ä¸ªç”¨æˆ·ï¼Œå¦‚æœè®¿é—®è¿‡å¿«ï¼Œå±è”½è¯·æ±‚æˆ–è€…éœ€è¦è¾“å…¥éªŒè¯ç ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¥½å¤šå­¦æ ¡æˆ–è€…å…¬å¸éƒ½æ˜¯ä½¿ç”¨ä¸ºæ•°ä¸å¤šçš„å‡ ä¸ªIPåœ°å€æ¥ä½œä¸ºå‡ºå£IPï¼Œæ–¹ä¾¿ç®¡ç†ï¼Œå¦‚æœè¿™ç§åœ°æ–¹æœ‰ä¸€ä¸¤ä¸ªäººåœ¨æ¶æ„è¯·æ±‚ï¼Œé‚£ä¹ˆå¯èƒ½å±è”½ä¼šé€ æˆå¾ˆå¤šäººè®¿é—®å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ç§é™åˆ¶æ¥è¯´ï¼Œå¯ä»¥æ”¾æ…¢è¯·æ±‚é€Ÿåº¦ï¼Œæˆ–è€…ä½¿ç”¨å¤šä¸ªä»£ç†IPæ¥ä¼ªè£…è‡ªå·±ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡Cookiesæ¥è¯†åˆ«ç”¨æˆ·&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸Šé¢è¯´è¿‡ç›´æ¥é€šè¿‡ IP æ¥è¯†åˆ«ç”¨æˆ·çš„è¯æ¯”è¾ƒæš´åŠ›ï¼Œå¯èƒ½è¯¯ä¼¤ï¼Œå¦ä¸€ç§æ–¹æ³•å°±æ˜¯é€šè¿‡ Cookie æ¥æ ‡ç¤ºç”¨æˆ·ï¼Œå¦‚æœæœ‰ä¸€ä¸ªç”¨æˆ·è®¿é—®è¿‡å¤šçš„è¯ï¼Œå°±å¯¹è¿™ä¸ªCookieåšé™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ç§é™åˆ¶æ¥è¯´ï¼Œå¯ä»¥ç›´æ¥æ¯æ¬¡è¯·æ±‚ä¸å¸¦ Cookieï¼Œæˆ–è€…é¢„å…ˆå¤šç”³è¯·ä¸€äº› Cookieï¼Œç„¶åè´Ÿè½½å‡è¡¡ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¼ ç»Ÿçš„é™æ€é¡µé¢çš„é™åˆ¶å’Œç ´è§£åŸºæœ¬ä¸Šå°±æ˜¯è¿™äº›æ–¹æ³•ã€‚ä¸è¿‡ç°åœ¨å¾ˆå¤šé¡µé¢éƒ½æ˜¯æ“ä½œä¸°å¯Œçš„åŠ¨æ€é¡µé¢ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ¶ˆæ¯å¯èƒ½æ˜¯é€šè¿‡ajaxåŠ è½½çš„ï¼Œæˆ‘ä»¬åªéœ€è¦è®¿é—®è¿™ä¸ªapiå°±å¯ä»¥äº†ã€‚å¦å¤–ç°åœ¨ä¸å°‘çš„äº§å“éƒ½æ˜¯ç›´æ¥æä¾›åº”ç”¨ï¼Œæ ¹æœ¬æ²¡æœ‰ç½‘é¡µç‰ˆäº†ã€‚æ‰€ä»¥æ¥ä¸‹æ¥ç®€å•è°ˆä¸‹APIçš„æ”»é˜²ã€‚&lt;/p&gt;
&lt;h1&gt;API çš„æ”»é˜²&lt;/h1&gt;
&lt;p&gt;æœ‰ä¸€äº› API æ²¡æœ‰ä»»ä½•é˜²æŠ¤ï¼Œå¯¹äºè¿™ç§ API ç›´æ¥åˆ·å°±å¥½äº†ï¼Œä¸è¿‡å¯èƒ½æœ‰çš„ API ä¼šæœ‰æ ¹æ® IP çš„é¢‘æ¬¡é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€äº› API è®¿é—®å¿…é¡»é€šè¿‡Tokenï¼Œå¦‚æœå«æœ‰è¿™ä¸ª token å¹¶ä¸”åˆæ³•ï¼Œå°±è®¤ä¸ºè®¿é—®æ˜¯åˆæ³•çš„ã€‚ä¸€èˆ¬æ¥è¯´åœ¨ä½¿ç”¨äº† token éªŒè¯è®¿é—®åˆæ³•æ€§çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å°±ä¸ä¼šå†å¯¹ IP ç­‰åšé™åˆ¶äº†ã€‚&lt;/p&gt;
&lt;p&gt;Token çš„è®¡ç®—è¿‡ç¨‹å¾€å¾€æœ‰ä¸‰ä¸ªå› ç´ éœ€è¦å‚ä¸ï¼Œåˆ†åˆ«æ˜¯ keyã€secret å’Œç­¾åç®—æ³•ã€‚æ¯”å¦‚è¯´ä¸‹é¢çš„ API:&lt;/p&gt;
&lt;p&gt;GET api.example.com/v1/search?q=XXX&amp;amp;type=XXX&amp;amp;limit=5&amp;amp;timestamp=1501230129&amp;amp;app_key=424242token=XXX&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ app_key ç­‰äº 424242ï¼Œè¡¨ç¤ºè¯·æ±‚æ–¹çš„å”¯ä¸€IDï¼Œsecretæ˜¯æœåŠ¡å™¨æˆäºˆè¯·æ±‚æ–¹çš„å¯†ç ï¼Œæ¯”å¦‚123456ã€‚è€Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;secret = md5(sorted([&amp;quot;k=v&amp;quot; for k, v in params] + [&amp;quot;secret=123456&amp;quot;]).join(&amp;quot;&amp;quot;) + )
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¹Ÿå°±æ˜¯æŠŠæ‰€æœ‰å‚æ•°éƒ½æ’åºä¹‹åï¼Œæ‹¼æ¥æˆå­—ç¬¦ä¸²ç„¶åå†è®¡ç®—æŸä¸ªhashå€¼ï¼Œä½œä¸ºtokené™„åœ¨å‚æ•°åé¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´å¸¸ç”¨çš„ç­¾åç®—æ³•éƒ½æ˜¯è¿™æ ·å®ç°çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‚æ•°ä¸­åŠ ä¸Šæ—¶é—´æˆ³ï¼ŒåŒæ—¶é™„åœ¨è¯·æ±‚ä¸Šï¼Œè¿™æ ·æœåŠ¡å™¨å¯ä»¥åªæ¥å—å½“å‰æ—¶é—´é™„è¿‘çš„çœŸå®è¯·æ±‚ï¼Œä»è€Œé¿å…æŸä¸ªè¯·æ±‚è¢«ä¿å­˜ä¸‹æ¥ï¼Œç”¨ä½œé‡æ”¾æ”»å‡»ã€‚&lt;/li&gt;
&lt;li&gt;æ·»åŠ å‚æ•°secretï¼123456åˆ°éœ€è¦è®¡ç®—çš„å‚æ•°ä¸­ï¼Œä½†æ˜¯secretå¹¶ä¸ä¼šå‡ºç°åœ¨è¯·æ±‚ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;æŠŠæ‰€æœ‰éœ€è¦åŠ å¯†çš„å‚æ•°éƒ½æŒ‰ç…§å­—å…¸æ’åºï¼Œç„¶åæ‹¼æ¥æˆå­—ç¬¦ä¸²ï¼Œè¿™æ ·æ˜¯ä¸ºäº†è®¡ç®—å‡ºæ¥çš„å€¼å”¯ä¸€ã€‚&lt;/li&gt;
&lt;li&gt;è®¡ç®—å‡ºçš„tokenä¹Ÿé™„åœ¨è¯·æ±‚ä¸Šï¼Œä¸€èµ·å‘ç»™æœåŠ¡å™¨ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨æ ¹æ®app_keyï¼Œå–å‡ºå¯¹åº”çš„app_secretï¼Œç”¨åŒæ ·çš„æ–¹æ³•è®¡ç®—tokenï¼ŒéªŒè¯åˆæ³•æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;app_key çš„åˆ†é…å’Œå«ä¹‰&lt;/h2&gt;
&lt;p&gt;ä¸€èˆ¬æœ‰ä¸¤ç§ç†è§£ï¼Œä¸€ç§æ˜¯æŠŠ app_key ä½œä¸ºæŸç§ç±»å‹å®¢æˆ·ç«¯çš„æ ‡ç¤ºï¼Œæ¯”å¦‚å®‰å“å®¢æˆ·ç«¯ä½¿ç”¨ä¸€ä¸ªappkeyï¼ŒiOSå®¢æˆ·ç«¯ä½¿ç”¨ä¸€ä¸ªappkeyã€‚å¦ä¸€ç§æ˜¯æ¯ä¸ªç”¨æˆ·ä½¿ç”¨ä¸€ä¸ªappkeyï¼ŒæŠŠappkeyä½œä¸ºç”¨æˆ·çš„æ ‡ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºç½‘é¡µä¸­é€šè¿‡ ajax è¯·æ±‚ API æ¥è¯´ï¼Œå› ä¸º js å®é™…ä¸Šç›¸å½“äºæ˜¯æºç å…¬å¼€çš„ï¼Œæ‰€ä»¥éšè—secretå’Œç®—æ³•å®é™…ä¸Šæ˜¯ä¸ç°å®çš„ã€‚è¿™æ—¶å€™å¯ä»¥æœ‰ä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯æŠŠsecretå’ŒåŠ å¯†ç®—æ³•ç­‰æ”¾åˆ°Flashé‡Œé¢å»ï¼Œflashæ˜¯å¯ä»¥ç¼–è¯‘æˆäºŒè¿›åˆ¶çš„ï¼Œæ‰€ä»¥ç›¸å¯¹æ¥è¯´æ›´å®‰å…¨ä¸€äº›ï¼Œä¸è¿‡éšç€flashçš„æ­»äº¡ï¼Œè¿™ç§åšæ³•åº”è¯¥æ˜¯é€æ¸æ·˜æ±°äº†ã€‚å¦ä¸€ç§åšæ³•æ˜¯secretåŠ¨æ€è·å–ï¼Œæ§åˆ¶secretçš„æ¥æé«˜ç ´è§£éš¾åº¦ï¼ŒåŒæ—¶æŠŠåŠ å¯†ç®—æ³•åšä¸€äº›æ··æ·†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºåº”ç”¨ä¸­æ¥è¯´ï¼Œç®€å•ä¸€ç‚¹çš„åšæ³•å¯ç›´æ¥æŠŠsecretå’Œç®—æ³•éƒ½ç›´æ¥æ”¾åˆ°ä»£ç é‡Œé¢ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´å› ä¸ºé€šç”¨çš„åŠ å¯†æ–¹æ³•å¤§å®¶å¥—è·¯åŸºæœ¬ä¹Ÿéƒ½é‚£ä¹ˆå‡ æ ·ï¼Œé€šè¿‡åç¼–è¯‘ä¹‹ååŠ ä¸Šä¸€äº›åŸºäºç»éªŒçš„çŒœæµ‹å¾ˆå®¹æ˜“æ‰å‡ºæ¥ã€‚æ‰€ä»¥è¿›ä¸€æ­¥å¯ä»¥æŠŠåŠ å¯†ç®—æ³•å†™åˆ°nativeå±‚ï¼Œç¼–è¯‘æˆsoæ–‡ä»¶ï¼Œè¿™æ ·å°±å¤§å¤§æé«˜äº†åç¼–è¯‘çš„éš¾åº¦ï¼ŒåŸºæœ¬å¯ä»¥è®¤ä¸ºæ˜¯å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ›´ä¸¥å‰ä¸€ç‚¹çš„è¯ï¼Œå¯ä»¥é™åˆ¶åªæœ‰ç™»å½•ç”¨æˆ·å¯ä»¥è®¿é—®æŸäº›æ•æ„Ÿæ¥å£ï¼Œè¿™æ ·å°±å®Œå…¨ç”±æœåŠ¡ç«¯æ¥æ§åˆ¶æ¥å£çš„è®¿é—®é‡äº†ï¼Œåªéœ€è¦æ³¨æ„ç”¨æˆ·æ³¨å†Œçš„æ¥å£ä¸è¦è¢«æ»¥ç”¨å³å¯ã€‚&lt;/p&gt;
&lt;h1&gt;ä¸€ä¸ªä¾‹å­&lt;/h1&gt;
&lt;p&gt;æ¯”å¦‚æ·˜å®H5ç«™çš„æ¥å£&lt;/p&gt;
&lt;p&gt;å½“è¯·æ±‚ä¸å¸¦ä»»ä½•cookieæ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ª_m_h5_tk å’Œ _m_h5_tk_encï¼Œé€šè¿‡ä¸‹é¢çš„ç®—æ³•ç®—å‡ºsignå€¼å†æ¬¡è¯·æ±‚&lt;/p&gt;
&lt;p&gt;signç®—æ³•ï¼š&lt;em&gt;m_h5_tkå€¼çš„'&lt;/em&gt;'å‰éƒ¨åˆ†+æ—¶é—´æˆ³+appkey+dataÂ  ä¸­é—´ç”¨&amp;amp;åˆ†éš”ï¼Œå¦‚ä¸‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;echo -n &amp;#39;ddc882e0e69bb8babbfdecc479439252&amp;amp;1450260485494&amp;amp;12574478&amp;amp;{&amp;quot;platform&amp;quot;:&amp;quot;8&amp;quot;,&amp;quot;asac&amp;quot;:&amp;quot;D679AU6J95PHQT67G0B5&amp;quot;,&amp;quot;days&amp;quot;:50,&amp;quot;cinemaid&amp;quot;:&amp;quot;24053&amp;quot;,&amp;quot;showid&amp;quot;:141207}&amp;#39;|md5sum|cut -d &amp;#39; &amp;#39; -f1
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 17 Nov 2017 20:28:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-17:/posts/wang-ye-yu-apide-chang-jian-pin-ci-xian-zhi-yu-po-jie.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>å¦‚ä½•è¯„ä»·çº¢é»„è“äº‹ä»¶ï¼Ÿ</title><link>/posts/ru-he-ping-jie-hong-huang-lan-shi-jian.html</link><description>&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ä½œè€…ï¼šå¤æœ¨
é“¾æ¥ï¼šhttps://www.zhihu.com/question/68546899/answer/264622524
æ¥æºï¼šçŸ¥ä¹
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;çº¢é»„è“ç²‰ç¢äº†æˆ‘é˜¶å±‚è·ƒè¿çš„æ¢¦ï¼Œå³ä¾¿å¹´è–ªç™¾ä¸‡ï¼Œä¹Ÿä¿æŠ¤ä¸äº†åœ¨æ„çš„äººã€‚
ä¸ä¹…ä¹‹å‰ï¼Œä¸Šæµ·çš„æºç¨‹å¹¼å„¿å›­çˆ†å‡ºè™ç«¥ä¸‘é—»ï¼Œå› ä¸ºå­©å­ä¸å¥½ç®¡ï¼Œå°±å–‚å­©å­åƒèŠ¥æœ«ã€å®‰çœ è¯ï¼Œå¯¹å­©å­æ‹³æ‰“è„šè¸¢ï¼Œæˆ‘å¾ˆæ„¤æ€’ï¼Œä½†æˆ‘å¹¶ä¸ç»æœ›ã€‚
å› ä¸ºæˆ‘æƒ³ï¼Œæˆ‘æ‰äºŒåå¤šå²ï¼Œåªè¦æˆ‘å¤ŸåŠªåŠ›ï¼Œæˆ‘å°±èƒ½è®©æˆ‘çš„å­©å­ä¸Šä¸€ä¸ªå¥½ç‚¹çš„ç§ç«‹å¹¼å„¿å›­ï¼Œé‚£ä¸ªå¹¼å„¿å›­ä¼šè¯·ç‰¹åˆ«å¥½çš„è€å¸ˆï¼Œå¸¦ç€æˆ‘çš„å­©å­åšæ¸¸æˆï¼Œç»™ä»–è®²é“ç†ã€‚
å¯æ˜¯è¿™æ¬¡çº¢é»„è“å¹¼å„¿å›­çœŸçš„å½»å½»åº•åº•ç²‰ç¢äº†æˆ‘çš„ç™½æ—¥æ¢¦ã€‚
ä¸æ˜¯è¯´æˆ‘ä¸èƒ½å®Œæˆé˜¶å±‚è·ƒè¿ï¼Œä¸èƒ½ä»ä¸€ä¸ªå†œæ‘çš„ç©·å°å­å˜æˆä¸€ä¸ªä¸­äº§ï¼Œä¸æ˜¯è¯´æˆ‘ä¾›ä¸èµ·å­©å­ä¸Šæ¯ä¸ªæœˆ5000çš„å¹¼å„¿å›­ï¼Œè€Œæ˜¯å°±ç®—æˆ‘æœ‰é’±äº†ï¼Œé‚£æˆ‘ä¹Ÿä¿æŠ¤ä¸äº†æˆ‘çˆ±çš„äººã€‚
è€Œä¸”ä»–ä»¬ä¸ä»…ä¼šå¯¹æˆ‘çš„å­©å­æ‹³æ‰“è„šè¸¢ï¼Œè¿˜ä¼šæŠŠä»–ä»¬é€åˆ°ä¸€ç¾¤ç‹¼çš„å˜´é‡Œã€‚
æ³¨å°„è¯å‰‚ã€å–‚ä¸æ˜ç™½è‰²è¯ä¸¸ã€é’ˆæ‰ã€è£¸ä½“ç½šç«™ã€æ‹³æ‰“è„šè¸¢â€¦â€¦
å¯¹ä¸èµ·ï¼Œæˆ‘çœŸçš„å®³æ€•äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªç”·ç”Ÿï¼Œæˆ‘ä¸ç”¨ç»å†æ€€èƒåæœˆï¼Œä¹Ÿä¸ç”¨ä½“éªŒåˆ†å¨©çš„å‰§ç—›ã€‚
æˆ‘åªéœ€è¦å¤šå¤šèµšé’±ï¼Œç»™å­©å­ä¹°æœ€å¥½çš„å¥¶ç²‰ï¼Œè¿™æ ·ï¼Œä»–å°±ä¸ä¼šè¢«æ¯’å¥¶ç²‰å¼„æˆå¤§å¤´å¨ƒå¨ƒï¼›
æˆ‘ä¹°æœ€å¥½çš„å®¶å…·ï¼Œç»™ä»–å¼„ä¸€ä¸ªæ²¡æœ‰æ±¡æŸ“çš„æˆ¿é—´ï¼Œä¸è®©ä»–æ¥è§¦ç”²é†›ï¼›
æˆ‘æŠŠä»–èƒ½è§¦ç¢°åˆ°çš„åœ°æ–¹å…¨éƒ½é“ºä¸Šè½¯å«ï¼Œä¸è®©ä»–ç£•ç¢°æ’åˆ°ï¼›
æˆ‘ç»™ä»–è¯·æœ€å¥½çš„æœ€æœ‰è‰¯å¿ƒçš„ä¿å§†ï¼Œæ¯å¤©ç…§é¡¾å¥½å¥¹çš„å¿ƒæƒ…ï¼Œä¸è®©å­©å­è¢«çºµç«çƒ§æ­»ï¼›
æˆ‘æŠŠä»–é€è¿›æœ€å¥½çš„å¹¼å„¿å›­ï¼Œä¸ºäº†è®©è€å¸ˆå¥½å¥½å¯¹ä»–ï¼Œæˆ‘ä¸ä»…æ¯ä¸ªæœˆäº¤5000å—ï¼Œè¿˜â€œæ— å¿æèµ â€ç»™å¹¼å„¿å›­å‡ åä¸‡ï¼›
æ¯æ¬¡æ”¾å­¦çš„æ—¶å€™ï¼Œæˆ‘éƒ½æå‰åŠå°æ—¶ï¼Œè‡ªå·±å»æ¥å­©å­ï¼Œè¿™æ ·ä»–å°±ä¸ä¼šè¢«äººè´©å­æ‹èµ°äº†ï¼›
è·¯ä¸Šæˆ‘éƒ½å¼€è½¦ï¼Œéµå®ˆäº¤é€šè§„åˆ™ï¼Œå®‰ä¸¤ä¸ªè¡Œè½¦è®°å½•ä»ªï¼Œè¿™æ ·å³ä¾¿è¢«ç¢°ç“·ï¼Œä¹Ÿèƒ½å°½å¿«è§£å†³ï¼Œä¸ç»™å­©å­ç•™ä¸‹åçš„å°è±¡ï¼›
æˆ‘è¯·å¥èº«æ•™ç»ƒã€æ­¦æœ¯æ•™ç»ƒã€è·†æ‹³é“æ•™ç»ƒï¼Œæ•™å­©å­å¥èº«ã€æ­¦æœ¯ã€è·†æ‹³é“ï¼Œè¿™æ ·å­¦æ ¡é‡Œæœ‰äººæ¬ºè´Ÿä»–çš„æ—¶å€™ï¼Œä»–å°±èƒ½å¤Ÿåå‡»äº†â€¦â€¦
ä½ çœ‹ï¼Œè¿™ä¸€è·¯ä¸Šï¼Œæˆ‘é¿å¼€äº†æ¯’å¥¶ç²‰ã€æ±¡æŸ“ã€ç¢°æ’ï¼Œèº²å¼€äº†çºµç«çš„ä¿å§†ã€é»‘å¿ƒçš„å¹¼æ•™ã€äººè´©å­ï¼Œèµ¶èµ°äº†ç¢°ç“·çš„è€äººã€æ ¡å›­çš„éœ¸å‡Œï¼Œæˆ‘å°±åƒç©ä¸€ä¸ªå¤§å‹çš„æ¸¸æˆä¸€æ ·ï¼Œå°å¿ƒç¿¼ç¿¼ï¼Œæ­¥æ­¥ä¸ºè¥ï¼Œå“ªæ€•ä¸€æ­¥èµ°é”™ï¼Œå°±å…¨ç›˜çš†è¾“ã€‚
æˆ‘å®³æ€•äº†ï¼Œæˆ‘çœŸçš„å®³æ€•äº†ï¼Œæˆ‘æ€•æˆ‘èµ°ä¸å¯¹ï¼Œæˆ‘æ€•é‚£äº›æˆ‘ä¿¡ä»»çš„å¥¶ç²‰ã€ä¿å§†ã€è€å¸ˆä¼šåƒé¥¿ç‹¼ä¸€æ ·ï¼Œæˆ‘ç¨ä¸æ³¨æ„ï¼Œä»–ä»¬å°±å¯¹æˆ‘çš„å­©å­éœ²å‡ºç ç‰™ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¥ä¸ºï¼Œåªè¦æˆ‘èƒ½å¤Ÿä»ä¸€ä¸ªç©·å°å­å˜æˆä¸­äº§ï¼Œæˆ‘å°±èƒ½ä¿æŠ¤å¥½æˆ‘çš„çˆ±äººï¼Œä¿æŠ¤å¥½æˆ‘å¯èƒ½ä¼šæœ‰çš„å­©å­ã€‚
å¯æ˜¯è¿™æ¬¡çº¢é»„è“å¹¼å„¿å›­çš„å®¶é•¿ï¼Œæ­£æ˜¯æˆ‘æœæ€æš®æƒ³å¿ƒå¿ƒå¿µå¿µæƒ³è¦æˆä¸ºçš„ä¸­äº§ã€‚
å¤šä¹ˆè®½åˆºå•Šã€‚
æ¯«æ— ç–‘é—®ï¼Œæˆ‘æ˜¯çˆ±å›½çš„ï¼Œæ¯«æ— ç–‘é—®ï¼Œæˆ‘ä¹Ÿæ˜¯èƒ½å¤Ÿçœ‹åˆ°å›½å®¶ä¸è¶³å¹¶ä¸”æƒ³è¦åŠªåŠ›æ”¹å˜é‚£äº›çš„ã€‚ä½†æ˜¯æ¯å¤©éƒ½ä¼šçœ‹åˆ°ä¸€äº›è´Ÿé¢æ–°é—»ï¼Œæˆ‘è§‰å¾—æˆ‘æ´»åœ¨ä¸€ä¸ªå¾ˆçŸ›ç›¾çš„ä¸–ç•Œä¸Šã€‚
æˆ‘çŸ¥é“å“ªé‡Œéƒ½æœ‰å¥½äººå’Œåäººï¼Œå¯æ˜¯å½“ä»–ä»¬å‡ºç°çš„æ—¶å€™ï¼Œæˆ‘è¦æ€ä¹ˆä¿æŠ¤è‡ªå·±ï¼Œä¿æŠ¤è‡ªå·±åœ¨ä¹çš„äººå‘¢ï¼Ÿ
ç¾å›½æœ‰æªï¼Œæœ‰æ¯’å“ï¼Œæˆ‘å®³æ€•ï¼Œæˆ‘ä¸æƒ³å»ã€‚
æ¬§æ´²æœ‰éš¾æ°‘ï¼Œæœ‰ç»¿è‰²ï¼Œæˆ‘å®³æ€•ï¼Œæˆ‘ä¸æƒ³å»ã€‚
å¯æ˜¯åœ¨å›½å†…ï¼Œæˆ‘å°±èƒ½å®‰å…¨åœ°æ´»ä¸‹æ¥å—ï¼Ÿæˆ‘ä¼šä¸ä¼šåœ¨ç«ç¾ä¸­è¢«è¿«è®©é¢†å¯¼å…ˆèµ°ï¼Ÿæˆ‘ä¼šä¸ä¼šåœ¨åŒ»é™¢è¢«åŒ»é—¹æ‰“å¾—å¤´ç ´è¡€æµï¼Ÿæˆ‘ä¼šä¸ä¼šè¢«ç¢°ç“·çš„ç¢°åˆ°å€¾å®¶è¡äº§ï¼Ÿ
æˆ‘ä¸€ç›´åœ¨å‘Šè¯‰è‡ªå·±ï¼Œä¼šå¥½çš„ä¼šå¥½çš„ï¼Œäººæ¸£åˆ°å¤„éƒ½æœ‰ï¼Œåªè¦è¿‡å‡ å¹´å°±ä¼šå¥½ã€‚
å¯æ˜¯ä¸€ä¸ªç§ç«‹å¹¼å„¿å›­å•Šï¼Œä¸­å›½ä¸­ä¸Šé˜¶å±‚æ‰èƒ½ä¾›å¾—èµ·ï¼Œæˆ‘è¿™ä¸€è¾ˆå­å¯èƒ½ä¹Ÿå°±åªèƒ½å®Œæˆä»ä¸€ç©·äºŒç™½åˆ°ä¸­å±‚çš„è·¨è¶Šï¼Œå¯æ˜¯æˆ‘è¿™æ ·çš„è·¨è¶Šåˆæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæœ€ç¨šå«©æœ€è¯¥ä¿æŠ¤çš„äººè¢«æœ€æ®‹å¿æœ€è‚†æ— å¿Œæƒ®åœ°å¯¹å¾…ï¼Œæˆ‘åˆè¯¥æ€ä¹ˆä¿æŠ¤åœ¨æ„çš„äººä¸å—é‚£æ ·çš„è™å¾…å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘å¯ä»¥æƒ³è±¡åˆ°åå¹´ä¹‹åçš„æˆ‘çš„æ ·å­ã€‚
ä¸ºäº†é’±ï¼Œä¸ºäº†å°Šä¸¥ï¼Œæˆ‘å¿ƒç”˜æƒ…æ„¿åœ°è¿‡ä¸Šäº†996çš„ç”Ÿæ´»ã€‚æˆ‘æŠŠè‡ªå·±çš„å¼€é”€å‹åˆ°æœ€ä½ï¼Œè´·æ¬¾ä¹°ä¸€å¥—å­¦åŒºæˆ¿ï¼Œè·Ÿçˆ±äººçœåƒä¿­ç”¨æŠŠå­©å­é€å»äº†ä¸€å®¶è¿é”çš„ä¸Šå¸‚çš„å¹¼å„¿å›­ã€‚
æˆ‘ä»¥ä¸ºï¼Œè¿™æ ·çš„æˆ‘ï¼Œæ˜¯æœ‰å°Šä¸¥çš„ã€‚
å¯æ˜¯æˆ‘æ²¡æƒ³åˆ°ï¼Œæˆ‘æœ‰çš„ï¼Œåªæ˜¯è‡ªå·±çš„ç™½æ—¥æ¢¦ã€‚
äº‹æƒ…å‡ºç°äº†ï¼Œåª’ä½“ä»¬éƒ½åœ¨é¿é‡å°±è½»ï¼Œè¯´ä»€ä¹ˆå¹¼æ•™è™ç«¥ï¼Œå¯äº‹å®ä¸Šæ›´ä¸¥é‡çš„ï¼Œæ˜¯å¯¹å¹¼å„¿çš„é›†ä½“çŒ¥äºµï¼Œé›†ä½“å¼ºå¥¸ã€‚
æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆäº‹æƒ…è¢«çˆ†å‡ºæ¥äº†ä¹‹åï¼ŒçŸ¥ä¹ç¦æ­¢æé—®ï¼Œå¾®åšåˆ é™¤çƒ­æœï¼Œäººæ°‘æ—¥æŠ¥çš„è¯„è®ºä¹Ÿä¸€åº¦æ¶ˆå¤±ä¸è§ã€‚
æˆ‘æ›´ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¥½å¤šæ¬¡é‡‡è®¿é‡Œï¼Œæ–½è™è€…çš„è„¸ä¸Šéƒ½æ˜¯é©¬èµ›å…‹ï¼Œè€Œè¢«å®³äººå°±æ˜¯ä¸€å¼ å…¨è„¸ï¼Œæˆ‘ä»¬ä¿æŠ¤çš„ç©¶ç«Ÿæ˜¯è°å‘¢ï¼Ÿæ˜¯è¢«å®³äººçš„éšç§æ›´é‡è¦ï¼Œè¿˜æ˜¯æ–½è™è€…çš„éšç§æ›´é‡è¦ï¼Ÿ
å›½å®¶å¼ºå¤§äº†ï¼Œæˆ‘çŸ¥é“ã€‚è¿™äºŒåå‡ å¹´æˆ‘æ·±åˆ‡ä½“ä¼šåˆ°äº†å›½å®¶çš„å¼ºå¤§å’Œå¯Œè£•ï¼Œä»åœŸå¯æˆ¿ä½åˆ°ç –ç“¦æˆ¿å†ä½åˆ°æ¥¼æˆ¿ï¼Œæˆ‘æ˜¯ä¸­å›½å‘å±•çš„çº¢åˆ©çš„äº«å—è€…ã€‚å¯æ˜¯è¿™ç§æ—¶å€™ï¼Œæˆ‘å°±å¯ä»¥ä¸è¦å°Šä¸¥ã€ä¸è¦æœªæ¥äº†å—ï¼Ÿ
çœ‹ç€é‚£äº›è¢«è¿«ç¦»å¼€åŒ—äº¬çš„äººï¼Œçœ‹ç€é‚£äº›å¾˜å¾Šåœ¨å¹¼å„¿å›­é—¨å£çš„å®¶é•¿ï¼Œæˆ‘å¥½åƒçœ‹åˆ°äº†æœªæ¥ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 17 Nov 2017 04:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-17:/posts/ru-he-ping-jie-hong-huang-lan-shi-jian.html</guid><category>æœªåˆ†ç±»</category></item><item><title>å®‰å“å¼€å‘ä¸­çš„Context</title><link>/posts/an-zhuo-kai-fa-zhong-de-context.html</link><description>&lt;p&gt;åœ¨å®‰å“å½“ä¸­ï¼ŒContextå‡ ä¹æ˜¯æ— å¤„ä¸åœ¨çš„ï¼Œæ¯ä¸€ä¸ªActivityæ˜¯ä¸€ä¸ªContextï¼Œæ¯ä¸€ä¸ªServiceä¹Ÿæ˜¯ä¸€ä¸ªContextã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚æœä½ æ–°èµ·äº†ä¸€ä¸ªçº¿ç¨‹çš„è¯ï¼Œä½ éœ€è¦æ˜¾å¼åœ°æŠŠContextä¼ é€’è¿›å»ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;public class DumpLocationLog extends Thread {
    LocationManager lm;
    LocationHelper loc;
    public DumpLocationLog(Context context) {
        loc = new LocationHelper();
        lm = (LocationManager) context.getSystemService(Context.LOCATION_SERVICE);
    }
    public void run() {
        lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000L, 500.0f, loc);
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åä½¿ç”¨è¿™ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼ŒæŠŠthisï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªcontextçš„å®ä¾‹ä¼ é€’è¿›å»&lt;/p&gt;
&lt;p&gt;&lt;code&gt;new DumpLocationLog(this);&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;if you are in a fragment, use getAcitvity()&lt;/p&gt;
&lt;p&gt;if you are in an anoynmous onclicklistener, &lt;code&gt;this&lt;/code&gt; is MainActivity.this&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 15 Nov 2017 05:29:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-15:/posts/an-zhuo-kai-fa-zhong-de-context.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>ä¸ºå®‰å“ç¼–è¯‘64ä½çš„dropbear</title><link>/posts/wei-an-zhuo-bian-yi-64wei-de-dropbear.html</link><description>&lt;h2&gt;å¦‚ä½•ä½¿ç”¨dropbear&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œä¸»è¦æ˜¯éœ€è¦åœ¨å®‰å“ä¸Šç”Ÿæˆ host keyï¼Œä»¥åŠæŠŠè‡ªå·±çš„å…¬é’¥ä¼ åˆ°å®‰å“ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dropbearkey -t rsa -f /data/local/dropbear_host_key # åœ¨å®‰å“ä¸Šç”Ÿæˆkey
adb push ~/.ssh/id_rsa.pub /data/local/authorized_keys # åœ¨å®¿ä¸»æœºæŠŠè‡ªå·±çš„å¯†é’¥ä¼ è¿‡å»
dropbear -F -E -r /data/local/dropbear_host_key -A -N root -C jk -R /data/local/authorized_keys # æŒ‰ç…§ç»™å®šçš„keyå¯åŠ¨dropbear
dropbear -P /data/local/dropbear.pid -r /data/local/dropbear_host_key -A -N root -C jk -R /data/local/authorized_keys # ä»¥daemonå½¢å¼å¯åŠ¨dropbear
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å¦‚ä½•ä¸º64ä½çš„å®‰å“æœºå™¨ç¼–è¯‘ dropbear&lt;/h2&gt;
&lt;p&gt;éœ€è¦æ›´æ”¹å¦‚ä¸‹ä»£ç ï¼ˆsvr-chansession.cï¼‰:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;addnewvar(&amp;quot;LD_LIBRARY_PATH&amp;quot;, &amp;quot;/system/lib&amp;quot;);

to:

addnewvar(&amp;quot;LD_LIBRARY_PATH&amp;quot;, &amp;quot;/system/lib64&amp;quot;);
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä½¿ç”¨AILæŠŠdropbearæ·»åŠ ä¸ºæœåŠ¡&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;service sshd /system/xbin/dropbear -s
   user  root
   group root
   oneshot
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¯•è¿‡äº†ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸ&lt;/p&gt;
&lt;h2&gt;å¦‚ä½•é‡å¯adb(wifi)&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;setprop service.adb.tcp.port 5555
stop adbd
start adbd
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å…³é—­ ssh key éªŒè¯&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Host *
    StrictHostKeyChecking no
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;mount -o remount,rw /system&lt;/p&gt;
&lt;p&gt;å‚è€ƒ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;http://forum.xda-developers.com/nexus-7-2013/general/guide-compiling-dropbear-2016-73-t3351671&lt;/li&gt;
&lt;li&gt;http://forum.xda-developers.com/nexus-7-2013/general/guide-compiling-dropbear-2015-67-t3142412/page3&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 15 Nov 2017 05:13:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-15:/posts/wei-an-zhuo-bian-yi-64wei-de-dropbear.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>å®‰å“åç¼–è¯‘çš„ä¸€äº›ç¬”è®°</title><link>/posts/an-zhuo-fan-bian-yi-de-yi-xie-bi-ji.html</link><description>&lt;h1&gt;å·¥å…·&lt;/h1&gt;
&lt;p&gt;apk studio&lt;/p&gt;
&lt;p&gt;å¦‚ä½• signï¼šhttps://www.nevermoe.com/?p=373&lt;/p&gt;
&lt;p&gt;smali code tutorialï¼š https://forum.xda-developers.com/showthread.php?t=2193735&lt;/p&gt;
&lt;p&gt;ä¸€ç¯‡å¾ˆå¥½çš„pdfçš„æ–‡æ¡£ï¼Œåˆ©ç”¨smali codeï¼šhttp://www.security-assessment.com/files/documents/whitepapers/Bypassing%20SSL%20Pinning%20on%20Android%20via%20Reverse%20Engineering.pdf&lt;/p&gt;
&lt;h1&gt;å®‰å“ä¸­ pinning çš„åŸç†&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨è‡ªå·±çš„keystoreå®ä¾‹åŒ– TrustManagerFactory&lt;/p&gt;
&lt;p&gt;å…³é”®è¯­å¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;InputStream in = resources.openRawResource(certificateRawResource);//file name of res/raw keyStore = KeyStore.getInstance(&amp;quot;BKS&amp;quot;); keyStore.load(resourceStream, password);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;http://fdwills.github.io/diary/2014/06/13/ssl-pinning.html&lt;/p&gt;
&lt;p&gt;ä¸€äº›ç°æˆçš„å·¥å…·&lt;/p&gt;
&lt;p&gt;https://github.com/ac-pm/SSLUnpinning_Xposed  xposed æ’ä»¶ï¼Œå·²æµ‹è¯•ä¸å¥½ç”¨
https://github.com/iSECPartners/Android-SSL-TrustKiller éœ€è¦cydia&lt;/p&gt;
&lt;p&gt;è±Œè±†èšå•†åº—ä¸­æœ‰ä¸€ä¸ª xposed installer miuiä¸“ç‰ˆï¼Œä½¿ç”¨è¿™ä¸ªå¯ä»¥å¾ˆå¥½åœ°å®‰è£… xposed&lt;/p&gt;
&lt;p&gt;ä¹‹åå®‰è£…&lt;/p&gt;
&lt;p&gt;å¦ä¸€ç§æ€è·¯ï¼Œæ‰¾åˆ°bksæ–‡ä»¶ï¼Œæ›¿æ¢æ‰ï¼Œé‡æ–°æ‰“åŒ…ï¼Œç­¾å&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/30708548/how-to-modify-the-data-in-the-assets-folder-in-existing-apk-programmatically&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€äº›å·¥å…·&lt;/p&gt;
&lt;p&gt;https://github.com/ac-pm/Inspeckage&lt;/p&gt;
&lt;p&gt;https://github.com/iSECPartners/Android-SSL-TrustKiller  éœ€è¦cydia&lt;/p&gt;
&lt;p&gt;https://github.com/iSECPartners/android-ssl-bypass ä¸€ä¸ªåŸºç¡€å·¥å…·ï¼Œé€šè¿‡æ›¿æ¢trust managerå®ç°&lt;/p&gt;
&lt;h1&gt;arm æ±‡ç¼–æ•™ç¨‹&lt;/h1&gt;
&lt;p&gt;https://mp.weixin.qq.com/s/DKeXqzE6bj5t0eWTkLLCBQ&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 15 Nov 2017 05:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-15:/posts/an-zhuo-fan-bian-yi-de-yi-xie-bi-ji.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>å®‰å“çš„ AsyncTask</title><link>/posts/an-zhuo-de-asynctask.html</link><description>&lt;p&gt;asynchronusally run task without explicitly creating thread.&lt;/p&gt;
&lt;h1&gt;Usage&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;doInBackground(Params...)
onProgressUpdate(Progress...)
onPostExecute(Result)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here is an example of subclassing:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Â private class DownloadFilesTask extends AsyncTask&amp;lt;URL, Integer, Long&amp;gt; {
Â  Â  Â protected Long doInBackground(URL... urls) {
Â  Â  Â  Â  Â int count = urls.length;
Â  Â  Â  Â  Â long totalSize = 0;
Â  Â  Â  Â  Â for (int i = 0; i &amp;lt; count; i++) {
Â  Â  Â  Â  Â  Â  Â totalSize += Downloader.downloadFile(urls[i]);
Â  Â  Â  Â  Â  Â  Â publishProgress((int) ((i / (float) count) * 100));
Â  Â  Â  Â  Â  Â  Â // Escape early if cancel() is called
Â  Â  Â  Â  Â  Â  Â if (isCancelled()) break;
Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â return totalSize;
Â  Â  Â }

Â  Â  Â protected void onProgressUpdate(Integer... progress) {
Â  Â  Â  Â  Â setProgressPercent(progress[0]);
Â  Â  Â }

Â  Â  Â protected void onPostExecute(Long result) {
Â  Â  Â  Â  Â showDialog(&amp;quot;Downloaded &amp;quot; + result + &amp;quot; bytes&amp;quot;);
Â  Â  Â }
Â }
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Once created, a task is executed very simply: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;new DownloadFilesTask().execute(url1, url2, url3);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;template parameters can be &lt;code&gt;Void, Void, Void&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;see https://developer.android.com/reference/android/os/AsyncTask.html&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 15 Nov 2017 05:05:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-15:/posts/an-zhuo-de-asynctask.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>Linux å†…å­˜ä¸è¿›ç¨‹ç®¡ç†ï¼ˆps/top/kill...ï¼‰</title><link>/posts/linux-nei-cun-yu-jin-cheng-guan-li-pstopkill.html</link><description>&lt;h1&gt;ps å‘½ä»¤&lt;/h1&gt;
&lt;p&gt;æ¯”è¾ƒæœ‰ç”¨çš„é€‰é¡¹æœ‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-e æ˜¾ç¤ºæ‰€æœ‰çš„è¿›ç¨‹
-f æ˜¾ç¤º uid, pid, ppid, cpu, starttime, tty, cpu usage, command
-j æ˜¾ç¤º user, pid, ppid, pgid, sess, jobc, state, tt, time, commandã€‚ä¸ªäººæ›´å–œæ¬¢ -j ä¸€ç‚¹
-l æ˜¾ç¤º uid, pid, ppid, flags, cpu, pri, nice, vsz=SZ, rss, wchan, state=S, paddr=ADDR, tty, time, and command=CMD.
-v æ˜¾ç¤º pid, state, time, sl, re, pagein, vsz, rss, lim, tsiz, %cpu, %mem, and command

-L æ˜¾ç¤ºèƒ½å¤Ÿæ’åºçš„å…³é”®å­—ï¼ˆmacï¼‰
L æ˜¾ç¤ºèƒ½æ’åºçš„å…³é”®å­—ï¼ˆLinuxï¼‰
-o/-O æŒ‡å®šæ˜¾ç¤ºçš„åˆ—ï¼Œ-o åªæ˜¾ç¤ºæŒ‡å®šçš„åˆ—ï¼Œ-Oæœ‰é»˜è®¤çš„å‡ åˆ—ï¼Œç­‰ä»·äºï¼š-o pid,format,state,tname,time,command

-S æŠŠæ‰€æœ‰å·²ç»é€€å‡ºçš„è¿›ç¨‹çš„æ—¶é—´è®¡ç®—åˆ°çˆ¶è¿›ç¨‹ä¸Šï¼ˆmacï¼‰
S æŠŠæ‰€æœ‰å·²ç»é€€å‡ºçš„è¿›ç¨‹çš„æ—¶é—´è®¡ç®—åˆ°çˆ¶è¿›ç¨‹ä¸Šï¼ˆLinuxï¼‰
-u æŒ‰ç…§ uid/username è¿‡æ»¤
-p/--pid é™åˆ¶ pid
-g/--gid é™åˆ¶ gid
-C æŒ‰ç…§å‘½ä»¤è¿‡æ»¤
--ppid æŒ‰ç…§ ppid è¿‡æ»¤
--ssid æŒ‰ç…§ ssid è¿‡æ»¤
--tid æŒ‰ç…§ tty è¿‡æ»¤

-E æ˜¾ç¤ºç¯å¢ƒå˜é‡
-H/--forest æŒ‰ç…§è¿›ç¨‹æ ‘æ˜¾ç¤º

--sort æŒ‰ç…§æŸä¸€åˆ—æ’åº

-ww ä¸è¦é™åˆ¶æ˜¾ç¤ºçš„è¾“å‡ºå®½åº¦
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä¾‹å­&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨psæ˜¾ç¤ºå ç”¨å†…å­˜æœ€å¤šçš„è¿›ç¨‹&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%mem | head&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹æ ‘&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% ps -ejH&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å…¶ä»–ç›¸å…³å‘½ä»¤&lt;/h2&gt;
&lt;p&gt;pstree æŸ¥çœ‹è¿›ç¨‹æ ‘&lt;/p&gt;
&lt;p&gt;pgrep process_name æŒ‰ç…§åå­—æŸ¥æ‰¾è¿›ç¨‹ pid&lt;/p&gt;
&lt;h1&gt;top å‘½ä»¤&lt;/h1&gt;
&lt;p&gt;å®šæ—¶åˆ·æ–°ç³»ç»Ÿçš„è¿›ç¨‹çŠ¶æ€çš„ç›‘æ§ç¨‹åºã€‚mac ä¸Šçš„é»˜è®¤æ’åºæ˜¯pidï¼ŒLinux ä¸Šæ˜¯ %CPUã€‚mac ä¸Šçš„ top ç¨‹åºå’Œ Linux ä¸Šéå¸¸ä¸ä¸€æ ·ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;top æ•™ç¨‹ï¼šhttps://linoxide.com/linux-command/linux-top-command-examples-screenshots/&lt;/li&gt;
&lt;li&gt;htop æ•™ç¨‹ï¼šhttp://www.cnblogs.com/lizhenghn/p/3728610.html&lt;/li&gt;
&lt;li&gt;atop æ•™ç¨‹ï¼šhttp://www.cnblogs.com/bangerlee/archive/2011/12/23/2294090.html&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;atop&lt;/h2&gt;
&lt;p&gt;atop ç”¨æ¥åˆ†ææœºå™¨åœ¨å†å²ä¸Šçš„è´Ÿè½½æƒ…å†µã€‚é€šè¿‡ crontab å›ºå®šæ—¶é—´é‡‡æ ·ï¼Œç»„åˆèµ·æ¥å½¢æˆä¸€ä¸ª atop æ—¥å¿—æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ atop -r XXX å¯¹æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;atop æ¯å¤©ä»¥ä¸€ä¸ª &lt;code&gt;/var/log/atop/atop_YYYYMMDD&lt;/code&gt; çš„å½¢å¼ç”Ÿæˆä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸ç”¨å‘½ä»¤&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;b mm:ss åˆ°æŒ‡å®šæ—¶é—´&lt;/li&gt;
&lt;li&gt;t æŸ¥çœ‹ååç§’&lt;/li&gt;
&lt;li&gt;T æŸ¥çœ‹å‰åç§’&lt;/li&gt;
&lt;li&gt;m æŒ‰ç…§å†…å­˜æ’åº&lt;/li&gt;
&lt;li&gt;C æŒ‰ç…§CPUæ’åº&lt;/li&gt;
&lt;li&gt;c æŸ¥çœ‹è¯¦ç»†å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;kill å‘½ä»¤ç³»åˆ—&lt;/h1&gt;
&lt;p&gt;kill -s SIGNAL pid&lt;/p&gt;
&lt;p&gt;æˆ–è€… pkill xxxï¼Œä¸è¦ä½¿ç”¨ killall ï¼Œ&lt;a href="https://unix.stackexchange.com/questions/91527/whats-the-difference-between-pkill-and-killall"&gt;use pkill over killall&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;è°ƒæ•´ nice å€¼&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ nice å’Œ reniceã€‚nice çš„èŒƒå›´æ˜¯ -20 ~ 19ï¼Œniceå€¼è¶Šä½ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚&lt;/p&gt;
&lt;p&gt;nice -n 10 COMMAND  # ä»¥ 10 ä¸ºåˆå§‹niceå€¼å¯åŠ¨å‘½ä»¤
renice 10 -p pid&lt;/p&gt;
&lt;h1&gt;jobs å‘½ä»¤ç›¸å…³&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;jobs&lt;/code&gt; list all jobs&lt;/p&gt;
&lt;p&gt;&lt;code&gt;command &amp;amp;&lt;/code&gt;  put job in the background&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fg N&lt;/code&gt; to put it in the foreground&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bg N&lt;/code&gt; to put it in the background&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ctrl-z&lt;/code&gt; to put a job to sleep&lt;/p&gt;
&lt;p&gt;&lt;code&gt;kill %n&lt;/code&gt; to kill job number n&lt;/p&gt;
&lt;h1&gt;lsof&lt;/h1&gt;
&lt;p&gt;lsof -i:port  åˆ—å‡ºæŒ‡å®šç«¯å£å¯¹åº”çš„è¿›ç¨‹&lt;/p&gt;
&lt;p&gt;lsof -u username æŒ‡å®šç”¨æˆ·&lt;/p&gt;
&lt;p&gt;lsof -c process_name æŒ‡å®šè¿›ç¨‹å&lt;/p&gt;
&lt;p&gt;lsof -p pid æŒ‡å®špid&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨dmesg æŸ¥çœ‹å½“å‰çš„å†…æ ¸æ—¥å¿—ï¼Œdebianä¸Šå¯ä»¥æŸ¥çœ‹ /var/log/kern.log /var/log/dmesg.0&lt;/p&gt;
&lt;p&gt;RSS is Resident Set Size (physically resident memory - this is currently occupying space in the machine's physical memory), and VSZ is Virtual Memory Size (address space allocated - this has addresses allocated in the process's memory map, but there isn't necessarily any actual memory behind it all right now).[1]&lt;/p&gt;
&lt;p&gt;[1] https://stackoverflow.com/questions/7880784/what-is-rss-and-vsz-in-linux-memory-management&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 15 Nov 2017 04:55:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-15:/posts/linux-nei-cun-yu-jin-cheng-guan-li-pstopkill.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„é”</title><link>/posts/fen-bu-shi-xi-tong-zhong-de-suo.html</link><description>&lt;p&gt;åˆ†å¸ƒå¼ç³»ç»Ÿéœ€è¦ä½¿ç”¨åˆ†å¸ƒé”ã€‚é¦–å…ˆæˆ‘ä»¬æ¥å›å¿†ä¸€ä¸‹åœ¨å•æœºæƒ…å†µä¸‹çš„é”ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬çš„ç¨‹åºåœ¨éœ€è¦è®¿é—®ä¸´ç•ŒåŒºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸€ä¸ªé”ï¼Œå¦‚æœæ˜¯å¤šçº¿ç¨‹ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨çº¿ç¨‹é”ï¼Œå¦‚æœæ˜¯å¤šè¿›ç¨‹ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨è¿›ç¨‹çº§åˆ«çš„é”ã€‚ä½†æ˜¯åœ¨åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸­ï¼Œå¦‚æœåœ¨ä¸åŒä¸»æœºä¸Šéƒ¨ç½²çš„ç¨‹åºè¦è®¿é—®åŒä¸€ä¸ªä¸´ç•ŒåŒºæ˜¯è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦åˆ†å¸ƒå¼çš„é”ã€‚&lt;/p&gt;
&lt;p&gt;å½“éƒ¨ç½²çš„æœåŠ¡æˆ–è€…è„šæœ¬ä¸åœ¨åŒä¸€å°æœºå™¨ä¸Šæ—¶,ä½¿ç”¨åˆ†å¸ƒå¼çš„é”ï¼Œå¯ä»¥ä½¿ç”¨zookeeperæˆ–è€…rediså®ç°ä¸€ä¸ªåˆ†å¸ƒå¼é”ã€‚è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹åŸºäºredisçš„åˆ†å¸ƒå¼é”ã€‚&lt;/p&gt;
&lt;p&gt;redis å®˜æ–¹ç»™å‡ºçš„å•æœºredisåˆ†å¸ƒå¼é”:&lt;/p&gt;
&lt;p&gt;åŠ é”&lt;/p&gt;
&lt;p&gt;NX å‘½ä»¤æŒ‡å®šäº†åªæœ‰åœ¨ä¸å­˜åœ¨çš„æ—¶å€™æ‰ä¼šåˆ›å»ºï¼Œå¦‚æœå·²ç»å­˜åœ¨ï¼Œåˆ™ä¼šè¿”å›å¤±è´¥ã€‚EXæŒ‡å®šäº†è¿‡æœŸæ—¶é—´ï¼Œé¿å…è¿›ç¨‹æŒ‚æ‰åæ­»é”ã€‚å€¼è®¾å®šä¸ºäº†ä¸€ä¸ªéšæœºæ•°ï¼Œè¿™æ ·åªæœ‰åŠ é”çš„è¿›ç¨‹æ‰çŸ¥é“é”çš„å€¼æ˜¯å¤šå°‘&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SET resource-name my_random_string NX EX max-lock-time
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è§£é”&lt;/p&gt;
&lt;p&gt;å› ä¸ºè§£é”æ—¶ä¼šæ£€æŸ¥æ˜¯å¦æä¾›äº†éšæœºæ•°çš„å€¼ï¼Œæ‰€ä»¥åªæœ‰åˆ›å»ºé”çš„è¿›ç¨‹æ‰èƒ½å¤Ÿè§£é”ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;if redis.call(&amp;quot;get&amp;quot;,KEYS[1]) == ARGV[1] then
    return redis.call(&amp;quot;del&amp;quot;,KEYS[1])
else
    return 0
end
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;EVAL &amp;#39;script...&amp;#39; 1 resource-name my_random_string
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒ:&lt;/p&gt;
&lt;p&gt;[1] https://redis.io/topics/distlock&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 15 Nov 2017 04:42:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-15:/posts/fen-bu-shi-xi-tong-zhong-de-suo.html</guid><category>æ¶æ„</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>html çš„ä¸€äº›å°çŸ¥è¯†å’Œé™·é˜±</title><link>/posts/html-de-yi-xie-xiao-zhi-shi-he-xian-jing.html</link><description>&lt;h1&gt;å¦‚ä½•è‡ªå®šä¹‰favicon&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;link rel="shortcut icon" type="image/png" href="/favicon.png"/&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;htmlä¸­çš„ç©ºæ ¼&lt;/h1&gt;
&lt;p&gt;multiple spaces in html is displayed as one, to show multiple space&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;use &lt;code&gt;&amp;lt;pre&amp;gt;&lt;/code&gt; around the word&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;&amp;amp;nbsp;&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 14 Nov 2017 05:53:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-14:/posts/html-de-yi-xie-xiao-zhi-shi-he-xian-jing.html</guid><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>è§£å†³å°å†…å­˜æœºå™¨ MySQL æ€»æ˜¯ OOM çš„é—®é¢˜</title><link>/posts/jie-jue-xiao-nei-cun-ji-qi-mysql-zong-shi-oom-de-wen-ti.html</link><description>&lt;p&gt;æœ‰ä¸€å°512Må†…å­˜çš„å°æœºå™¨æ€»æ˜¯æŠ¥æ•°æ®åº“é”™è¯¯, æŸ¥çœ‹äº†ä¸‹æ—¥å¿—æ˜¯OOMäº†&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ¡ˆ:&lt;/p&gt;
&lt;p&gt;ä¸€ Add swap file to cloud instance&lt;/p&gt;
&lt;p&gt;http://www.prowebdev.us/2012/05/amazon-ec2-linux-micro-swap-space.html&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;RunÂ dd if=/dev/zero of=/swapfile bs=1M count=1024&lt;/li&gt;
&lt;li&gt;RunÂ mkswap /swapfile&lt;/li&gt;
&lt;li&gt;RunÂ swapon /swapfile&lt;/li&gt;
&lt;li&gt;Add this lineÂ /swapfile swap swap defaults 0 0Â toÂ /etc/fstabÂ Â &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Some useful command related to SWAP space:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ swapon -s   
$ free -k
$Â swapoff -a
$ swapon  -a
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;äºŒ limit mysql buffersize&lt;/p&gt;
&lt;p&gt;innodb_buffer_pool_size = 8M&lt;/p&gt;
&lt;p&gt;ä¸‰ limit apache memory cosumptionï¼ŒeditingÂ /etc/apache2/mods-enabled/mpm_prefork.conf&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;IfModule&lt;/span&gt; &lt;span class="err"&gt;mpm_prefork_module&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    StartServers        3
    MinSpareServers     3
    MaxSpareServers     5
    MaxRequestWorkers   25
    MaxConnectionsPerChild  0
&lt;span class="nt"&gt;&amp;lt;/IfModule&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 13 Nov 2017 21:54:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-13:/posts/jie-jue-xiao-nei-cun-ji-qi-mysql-zong-shi-oom-de-wen-ti.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>mysql åŸºç¡€çŸ¥è¯†(4) - ç”¨æˆ·å’Œæƒé™</title><link>/posts/mysql-ji-chu-zhi-shi-4-yong-hu-he-quan-xian.html</link><description>&lt;h2&gt;åˆ›å»ºç”¨æˆ·&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;CREATE USER &amp;#39;newuser&amp;#39;@&amp;#39;%&amp;#39; IDENTIFIED BY &amp;#39;password&amp;#39;;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æˆæƒ&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;GRANT ALL PRIVILEGES ON *.* TO &amp;#39;newuser&amp;#39;@&amp;#39;%&amp;#39;;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­çš„ &lt;code&gt;%&lt;/code&gt; ä»£è¡¨è¿™ä¸ªç”¨æˆ·å¯ä»¥åœ¨ä»»æ„ä¸»æœºç™»å½•.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;SHOW GRANTS FOR newuser
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç”¨æ¥æ˜¾ç¤ºä¸€ä¸ªç”¨æˆ·çš„å½“å‰æˆæƒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;set password for USERNAME = password(&amp;#39;xxx&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ›´æ”¹ç”¨æˆ·å¯†ç &lt;/p&gt;
&lt;h2&gt;é‡ç½®å¯†ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mysqld_safe --skip-grant-tables --skip-networking &amp;amp;
Â 
use mysql;
update user set authentication_string=PASSWORD(&amp;quot;&amp;quot;) where User=&amp;#39;root&amp;#39;;
update user set plugin=&amp;quot;mysql_native_password&amp;quot;; # THIS LINE
flush privileges;
quit;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å…¶ä»–é—®é¢˜&lt;/h2&gt;
&lt;p&gt;EXPLAIN, slow-log&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 13 Nov 2017 14:32:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-13:/posts/mysql-ji-chu-zhi-shi-4-yong-hu-he-quan-xian.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>django templates</title><link>/posts/django-templates.html</link><description>&lt;h1&gt;marco&lt;/h1&gt;
&lt;p&gt;there is no marco in django template, you just have to use include with parameters&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;{% include &amp;quot;marco.html&amp;quot; with arg=parameter %}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;variable&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;my_dict.key&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;my_object.attribute&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;my_list.0&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If a variable resolves to a callable, the template system will call it with no arguments and use its result instead of the callable.&lt;/p&gt;
&lt;h1&gt;tags&lt;/h1&gt;
&lt;h1&gt;filters&lt;/h1&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 13 Nov 2017 11:34:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-13:/posts/django-templates.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>mysql åŸºç¡€çŸ¥è¯†(2) - æ’å…¥åˆ é™¤ä¿®æ”¹</title><link>/posts/mysql-ji-chu-zhi-shi-2-cha-ru-shan-chu-xiu-gai.html</link><description>&lt;p&gt;æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ä¸Šç¯‡æ–‡ç« å®šä¹‰çš„ä¾‹å­æ¥è¯´æ˜é—®é¢˜&lt;/p&gt;
&lt;h1&gt;æ’å…¥æ•°æ®&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;INSERT&lt;/code&gt; è¯­å¥.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;insert into students(**field_names) values(**VALUES), values(**VALUES);
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ‰¹é‡æ’å…¥&lt;/h2&gt;
&lt;p&gt;å¦‚æœä¸€æ¬¡è¦æ’å…¥æ‰€æœ‰æ•°æ®çš„è¯, å¯ä»¥ç›´æ¥çœç•¥å‰é¢çš„å­—æ®µå. MySQL å¯ä»¥ä¸€æ¬¡æ’å…¥å¤šè¡Œæ•°æ®æˆ–è€…ä¸€è¡Œæ•°æ®, ä½†æ˜¯è¿™å¹¶ä¸æ˜¯SQLæ ‡å‡†è§„å®šçš„. ä½¿ç”¨æ‰¹é‡æ’å…¥å¯ä»¥å¤§å¹…åº¦æé«˜æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ‰¹é‡æ’å…¥çš„è¯­å¥ä¸­ï¼Œå¦‚æœæœ‰ä¸€è¡Œæ˜¯é”™çš„ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æ•´ä¸ªæ’å…¥å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨ insert ignore è¯­å¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦åœ¨æ‰¹é‡æ’å…¥ä¸åŒçš„è¡¨ï¼Œå¯ä»¥ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªè¯­å¥ï¼Œè€Œä¸æ˜¯åªæ‰§è¡Œä¸€ä¸ªã€‚&lt;/p&gt;
&lt;h1&gt;insert or update&lt;/h1&gt;
&lt;p&gt;å¦‚æœè¦å®ç° insert or update çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ insert on duplicate update è¯­å¥ã€‚&lt;/p&gt;
&lt;h1&gt;æ›´æ–°æ•°æ®&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;UPDATE&lt;/code&gt; è¯­å¥.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;update students set math_score = 100 where first_name = &amp;#39;luke&amp;#39;;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åˆ é™¤æ•°æ®&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;DELETE&lt;/code&gt; è¯­å¥.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;delete from students where name = &amp;#39;luke&amp;#39;;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;http://www.mysqltutorial.org/mysql-insert-ignore/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 12 Nov 2017 15:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-12:/posts/mysql-ji-chu-zhi-shi-2-cha-ru-shan-chu-xiu-gai.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>C++ å­—é¢é‡</title><link>/posts/c-zi-mian-liang.html</link><description>&lt;h1&gt;C++ä¸­çš„å­—å…¸å­—é¢é‡&lt;/h1&gt;
&lt;p&gt;You can actually do this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;std::map&amp;lt;std::string, int&amp;gt; mymap = &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;one&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;},&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;two&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;},&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;three&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;What is actually happening here is that std::map stores an std::pair of the key value types, in this case std::pair&lt;const std::string,int&gt;. This is only possible because of c++11's new uniform initialization syntax which in this case calls a constructor overload of std::pair&lt;const std::string,int&gt;. In this case std::map has a constructor with an std::intializer_list which is responsible for the outside braces.&lt;/p&gt;
&lt;p&gt;So unlike python's any class you create can use this syntax to initialize itself as long as you create a constructor that takes an initializer list (or uniform initialization syntax is applicable)&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/a/20230177/1061155&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 12 Nov 2017 02:20:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-12:/posts/c-zi-mian-liang.html</guid><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­ä¸çˆ½çš„åœ°æ–¹</title><link>/posts/python-zhong-bu-shuang-de-di-fang.html</link><description>&lt;h1&gt;GIL&lt;/h1&gt;
&lt;p&gt;ä¹‹å‰ç”¨å¤šçº¿ç¨‹éƒ½æ˜¯åšä¸€äº›IOå¯†é›†çš„å†…å®¹, æ¯”å¦‚çˆ¬ç½‘é¡µçš„æ—¶å€™å¼€ä¸€ä¸ªThreadPool, å¤„ç†é€Ÿåº¦ç«‹é©¬å°±ç¿»äº†å‡ å€. æ‰€ä»¥ä¸€ç›´æ²¡æŠŠGILæ”¾åœ¨å¿ƒä¸Š, å‰å‡ å¤©è¦è·‘ä¸€äº›å¤„ç†æ•æ„Ÿè¯çš„æ•°æ®, å¤§æ¦‚è¦å¯¹å‡ ç™¾ä¸‡ç¯‡æ–‡ç« åšæ­£åˆ™åŒ¹é…. æƒ³éƒ½æ²¡æƒ³å°±ç”¨äº†å¤šçº¿ç¨‹, åƒé¥­å›æ¥å‘ç°å¹¶æ²¡æœ‰è·‘å®Œ, è¿™æ‰æƒ³èµ·æ¥æ­£åˆ™åŒ¹é…è¿™ç§ä¸œè¥¿æ˜¯CPUå¯†é›†çš„, ç”¨Pythonçš„çº¿ç¨‹å¹¶æ²¡æœ‰ä»»ä½•åµç”¨. è¿™æ—¶å€™æ¢æˆmultiprocessing.Poolé€Ÿåº¦åˆé£šèµ·æ¥äº†, ç„¶è€Œä½¿ç”¨è¿›ç¨‹æ± ç»ˆç©¶è¿˜æ˜¯ä¸å¦‚çº¿ç¨‹æ± æ–¹ä¾¿, æ‰€æœ‰ä¼ å…¥çš„å‡½æ•°å¿…é¡»æ˜¯marshallable, æœ‰æ—¶å€™è¿˜æ˜¯ä¸èƒ½ç›´æ¥æ›¿æ¢çš„.&lt;/p&gt;
&lt;h1&gt;å‡½æ•°å¼ç¼–ç¨‹&lt;/h1&gt;
&lt;p&gt;æ²¡æœ‰çœŸæ­£çš„é—­åŒ…, å¿…é¡»ä½¿ç”¨nonlocalå…³é”®è¯æ‰èƒ½å®ç°ä¸€äº›é—­åŒ…çš„åŠŸèƒ½&lt;/p&gt;
&lt;p&gt;ä¹Ÿæ²¡æœ‰çœŸæ­£çš„lambdaè¡¨è¾¾å¼, è‡ªå¸¦çš„lambdaè¡¨è¾¾å¼å±€é™éå¸¸å¤§&lt;/p&gt;
&lt;h1&gt;å…¶ä»–&lt;/h1&gt;
&lt;p&gt;bytesçš„æ ¼å¼åŒ–è¾“å‡ºç«Ÿç„¶æ˜¯ b'xxx'&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 11 Nov 2017 11:16:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-11:/posts/python-zhong-bu-shuang-de-di-fang.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>RocksDB åŸºç¡€æ“ä½œæ•™ç¨‹</title><link>/posts/rocksdb-ji-chu-cao-zuo-jiao-cheng.html</link><description>&lt;h2&gt;æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;cassert&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
  &lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;quot;rocksdb/db.h&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;

  &lt;span class="n"&gt;rocksdb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;DB&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;rocksdb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Options&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create_if_missing&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_if_exists&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;rocksdb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Status&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rocksdb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;DB&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;/tmp/testdb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;assert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ok&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
  &lt;span class="p"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é€šè¿‡optionsåˆ¶å®šä¸€äº›å±æ€§, ç„¶åç”¨ &lt;code&gt;rocksdb::DB::Open&lt;/code&gt;æ‰“å¼€. RocksDB ä¼šæŠŠä½¿ç”¨çš„é…ç½®ä¿å­˜åœ¨ &lt;code&gt;OPTIONS-xxxx&lt;/code&gt; æ–‡ä»¶ä¸­.&lt;/p&gt;
&lt;p&gt;æ³¨æ„ä¸Šé¢è¿”å›çš„é‚£ä¸ªstatuså˜é‡, åœ¨RocksDBä¸­æ‰€æœ‰ä¼šé‡åˆ°é”™è¯¯çš„å‡½æ•°éƒ½ä¼šè¿”å›è¿™ä¸ªå˜é‡, å¯ä»¥ç”¨æ¥æ£€æŸ¥æœ‰æ²¡æœ‰å‡ºé”™.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;   &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;Status&lt;/span&gt; &lt;span class="nt"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;...;&lt;/span&gt;
   &lt;span class="nt"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(!&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ok&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="nt"&gt;cerr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ToString&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="nt"&gt;endl&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…³é—­æ•°æ®åº“, åªéœ€è¦ç®€å•å¾—æŠŠæŒ‡é’ˆé‡Šæ”¾å°±å¯ä»¥äº†: &lt;code&gt;delete db&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;è¯»å†™æ•°æ®åº“&lt;/h2&gt;
&lt;p&gt;åŸºæœ¬çš„Put, Get, Delete:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="nt"&gt;std&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;string&lt;/span&gt; &lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;Status&lt;/span&gt; &lt;span class="nt"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;Get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;ReadOptions&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="nt"&gt;key1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="nt"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ok&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="nt"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;WriteOptions&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="nt"&gt;key2&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;value&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="nt"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ok&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="nt"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;Delete&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;WriteOptions&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="nt"&gt;key1&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„å…¶ä¸­æ¯æ¬¡éƒ½æ£€æŸ¥äº†æ“ä½œæ˜¯å¦æˆåŠŸ.&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡ Get æ“ä½œéƒ½ä¼šå¯¼è‡´è‡³å°‘ä¸€æ¬¡çš„memcpy, å¦‚æœä¸æƒ³è¦è¿™ç§æµªè´¹çš„è¯, å¯ä»¥ä½¿ç”¨ PinnableSlice æ“ä½œ.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="nt"&gt;PinnableSlice&lt;/span&gt; &lt;span class="nt"&gt;pinnable_val&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;Status&lt;/span&gt; &lt;span class="nt"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;Get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;ReadOptions&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="nt"&gt;key1&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nt"&gt;pinnable_val&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åŸå­æ“ä½œ&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;WriteBatch&lt;/code&gt;æ¥æ„æˆä¸€ä¸ªåŸå­æ€§çš„æ“ä½œ. ä»€ä¹ˆæ˜¯åŸå­æ€§æ“ä½œæ€»ä¸ç”¨å¤šè¯´å§...åŸå­æ“ä½œä¸ä»…ä¿è¯äº†åŸå­æ€§, è€Œä¸”ä¸€èˆ¬æ¥è¯´å¯¹æ€§èƒ½ä¹Ÿæœ‰å¸®åŠ©&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;quot;rocksdb/write_batch.h&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
  &lt;span class="p"&gt;...&lt;/span&gt;
  &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;rocksdb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Status&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rocksdb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ReadOptions&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;key1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ok&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;rocksdb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;WriteBatch&lt;/span&gt; &lt;span class="n"&gt;batch&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;batch&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;batch&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rocksdb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;WriteOptions&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;batch&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åŒæ­¥ä¸å¼‚æ­¥è¯»å†™&lt;/h2&gt;
&lt;p&gt;è¿™å—æ²¡çœ‹æ˜ç™½...&lt;/p&gt;
&lt;p&gt;é»˜è®¤çš„æ˜¯å¼‚æ­¥è¯»å†™, å¦‚æœä½¿ç”¨äº†&lt;code&gt;sync&lt;/code&gt;è¿™ä¸ªæ ‡å¿—, é‚£ä¹ˆå°±æ˜¯åŒæ­¥è¯»å†™äº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;WriteOptions&lt;/span&gt; &lt;span class="nt"&gt;write_options&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;write_options&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sync&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;true&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;Put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;write_options&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;...);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¼‚æ­¥è¯»å†™ç»å¸¸ä¼šæ¯”åŒæ­¥è¯»å†™å¿«ä¸Š1000å€, ä½†æ˜¯å½“æœºå™¨downæ‰çš„æ—¶å€™, ä¼šä¸¢å¤±æœ€åçš„å‡ ä¸ªå†™å…¥. ä¸è¿‡é€šå¸¸æ¥è¯´, å¯ä»¥è®¤ä¸ºå¼‚æ­¥è¯»å†™å®‰å…¨æ€§ä¹Ÿæ˜¯å¤Ÿçš„.&lt;/p&gt;
&lt;p&gt;é™¤äº†å¯ä»¥ä½¿ç”¨å¼‚æ­¥è¯»å†™ä»¥å¤–, è¿˜å¯ä»¥ä½¿ç”¨ &lt;code&gt;WriteBatch&lt;/code&gt; æ¥æ‰¹é‡è¯»å†™.&lt;/p&gt;
&lt;h2&gt;å¹¶å‘&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªæ•°æ®åº“åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹è¯»å†™. ä½†æ˜¯ä¸€ä¸ªdbå®ä¾‹çš„&lt;code&gt;Get&lt;/code&gt;æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„, è€Œ&lt;code&gt;WriteBatch&lt;/code&gt;ç­‰æ“ä½œå¯èƒ½éœ€è¦å…¶ä»–ä¸€äº›åŒæ­¥æœºåˆ¶&lt;/p&gt;
&lt;h2&gt;Merge æ“ä½œç¬¦&lt;/h2&gt;
&lt;p&gt;å¾…ç»­&lt;/p&gt;
&lt;h2&gt;Iterators&lt;/h2&gt;
&lt;p&gt;éå†æ‰€æœ‰çš„key&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;Iterator&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nt"&gt;it&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;NewIterator&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;ReadOptions&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt;
  &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;it-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;SeekToFirst&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="nt"&gt;it-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;Valid&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="nt"&gt;it-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;Next&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;cout&lt;/span&gt; &lt;span class="err"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="err"&gt;it-&amp;gt;key().ToString()&lt;/span&gt; &lt;span class="err"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;:&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="err"&gt;it-&amp;gt;value().ToString()&lt;/span&gt; &lt;span class="err"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="err"&gt;endl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="nt"&gt;assert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;it-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;status&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ok&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt; &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="nt"&gt;Check&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;any&lt;/span&gt; &lt;span class="nt"&gt;errors&lt;/span&gt; &lt;span class="nt"&gt;found&lt;/span&gt; &lt;span class="nt"&gt;during&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;scan&lt;/span&gt;
  &lt;span class="nt"&gt;delete&lt;/span&gt; &lt;span class="nt"&gt;it&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;éå†[start, limit)ä¹‹é—´çš„å€¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  for (it-&amp;gt;Seek(start);
       it-&amp;gt;Valid() &amp;amp;&amp;amp; it-&amp;gt;key().ToString() &amp;lt; limit;
       it-&amp;gt;Next()) {
    ...
  }
  assert(it-&amp;gt;status().ok()); // Check for any errors found during the scan
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åå‘éå†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  for (it-&amp;gt;SeekToLast(); it-&amp;gt;Valid(); it-&amp;gt;Prev()) {
    ...
  }
  assert(it-&amp;gt;status().ok()); // Check for any errors found during the scan
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Snapshot(å¿«ç…§)&lt;/h2&gt;
&lt;p&gt;Snapshot æä¾›äº†å½“å‰ç³»ç»Ÿåœ¨æŸä¸€ç‚¹çš„ä¸€ä¸ªåªè¯»çš„çŠ¶æ€è¡¨ç¤º.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;ReadOptions&lt;/span&gt; &lt;span class="nt"&gt;options&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;options&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;snapshot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;GetSnapshot&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
  &lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="nt"&gt;apply&lt;/span&gt; &lt;span class="nt"&gt;some&lt;/span&gt; &lt;span class="nt"&gt;updates&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;db&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;
  &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;Iterator&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nt"&gt;iter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;NewIterator&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;options&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="nt"&gt;read&lt;/span&gt; &lt;span class="nt"&gt;using&lt;/span&gt; &lt;span class="nt"&gt;iter&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;view&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;state&lt;/span&gt; &lt;span class="nt"&gt;when&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;snapshot&lt;/span&gt; &lt;span class="nt"&gt;was&lt;/span&gt; &lt;span class="nt"&gt;created&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;
  &lt;span class="nt"&gt;delete&lt;/span&gt; &lt;span class="nt"&gt;iter&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;db-&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;ReleaseSnapshot&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;options&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;snapshot&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„è¿™é‡Œé€šè¿‡snapshotè¯»åˆ°çš„éƒ½æ˜¯åœ¨åšsnapshoté‚£ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®åº“çš„å€¼.&lt;/p&gt;
&lt;h2&gt;Slice&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢æåˆ°çš„ &lt;code&gt;iter-&amp;gt;key()&lt;/code&gt; å’Œ &lt;code&gt;iter-value()&lt;/code&gt; çš„è¿”å›å€¼éƒ½æ˜¯ &lt;code&gt;rocksdb::Slice&lt;/code&gt; ç±»å‹çš„. Slice ä»…ä»…æ˜¯ä¸€ä¸ªåŒ…å«äº†é•¿åº¦å’ŒæŒ‡é’ˆçš„bytearray. å®ƒæœ¬èº«å¹¶ä¸å‚¨å­˜å€¼, è¿™æ ·ä¹Ÿå°±é¿å…äº†æ‹·è´.&lt;/p&gt;
&lt;p&gt;Sliceå’Œstringçš„äº’ç›¸è½¬æ¢:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;   &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;Slice&lt;/span&gt; &lt;span class="nt"&gt;s1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

   &lt;span class="nt"&gt;std&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;string&lt;/span&gt; &lt;span class="nt"&gt;str&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;world&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
   &lt;span class="nt"&gt;rocksdb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;Slice&lt;/span&gt; &lt;span class="nt"&gt;s2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;str&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

   &lt;span class="nt"&gt;std&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;string&lt;/span&gt; &lt;span class="nt"&gt;str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nt"&gt;s1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ToString&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;
   &lt;span class="nt"&gt;assert&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;str&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nt"&gt;std&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nd"&gt;string&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æœªå®Œå¾…ç»­...&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 11 Nov 2017 03:59:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-11:/posts/rocksdb-ji-chu-cao-zuo-jiao-cheng.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>RocksDB å¸¸è§é—®é¢˜</title><link>/posts/rocksdb-chang-jian-wen-ti.html</link><description>&lt;h2&gt;RocksDB ä¼šæŠ›å‡ºå¼‚å¸¸å—?&lt;/h2&gt;
&lt;p&gt;ä¸ä¼š, RocksDBä¼šè¿”å›ä¸€ä¸ªStatusè¡¨ç¤ºæˆåŠŸæˆ–è€…å¤±è´¥, ä½†æ˜¯RocksDBå¹¶æ²¡æœ‰æ•è·STLä¸­çš„å¼‚å¸¸, æ¯”å¦‚bad_allocè¿™ç§&lt;/p&gt;
&lt;h2&gt;åŸºç¡€æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„å—?&lt;/h2&gt;
&lt;p&gt;æ˜¯çš„&lt;/p&gt;
&lt;h2&gt;å¯ä»¥ä½¿ç”¨å¤šä¸ªè¿›ç¨‹(process)åŒæ—¶è¯»å†™ RocksDB å—?&lt;/h2&gt;
&lt;p&gt;ä¸å¯ä»¥, å½“ç„¶åªè¯»æ¨¡å¼éšæ„&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 11 Nov 2017 03:34:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-11:/posts/rocksdb-chang-jian-wen-ti.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>RocksDB åŸºç¡€æ¦‚å¿µæ•™ç¨‹</title><link>/posts/rocksdb-ji-chu-gai-nian-jiao-cheng.html</link><description>&lt;p&gt;RocksDBèµ·æºäºLevelDB, å¹¶ä¸”ä»HBaseä¸­å¸å–äº†ä¸å°‘ä»£ç [1]. RocksDB è®¾è®¡çš„åˆè¡·æ˜¯èƒ½å¤Ÿåˆ©ç”¨å¥½SSDå’Œå†…å­˜çš„é«˜æ€§èƒ½, è€Œä¸”å¯ä»¥é€šè¿‡é…ç½®æ¥æ‰¿è½½é«˜å¼ºåº¦çš„è¯»æˆ–è€…é«˜å¼ºåº¦çš„å†™.&lt;/p&gt;
&lt;p&gt;RocksDB æ˜¯ä¸€ä¸ªåµŒå…¥å¼çš„key-valueæ•°æ®åº“, å¹¶ä¸”æ‰€æœ‰çš„é”®éƒ½æ˜¯æœ‰åºçš„. RocksDB æ”¯æŒçš„å¸¸ç”¨æ“ä½œæœ‰ &lt;code&gt;Get(Key)&lt;/code&gt;, &lt;code&gt;Put(Key)&lt;/code&gt;, &lt;code&gt;Delete(Key)&lt;/code&gt;, &lt;code&gt;Scan(Key)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;RocksDB ä¸­ä¸‰ä¸ªæœ€åŸºç¡€çš„ç»“æ„åˆ†åˆ«æ˜¯ memtable, sstfile å’Œ logfile. memtable æ˜¯ä¸€ä¸ªå†…å­˜æ•°æ®ç»“æ„, æ–°çš„å†™å…¥é¦–å…ˆå†™å…¥åˆ°memtable, ç„¶åæœ‰å¯èƒ½å†™å…¥åˆ° logfile ä¸­. logfile æ˜¯ä¸€ä¸ªåœ¨ç¡¬ç›˜ä¸Šé¡ºåºå†™å…¥çš„æ–‡ä»¶. å½“ memtable å­˜æ»¡äº†ä¹‹å, å®ƒä¼šè¢« flush åˆ° sstfile, ç„¶åç›¸åº”çš„ logfile å°±å¯ä»¥å®‰å…¨çš„åˆ é™¤äº†. sstfile ä¸­çš„æ•°æ®ä¸ºäº†æ–¹ä¾¿æŸ¥æ‰¾keyæ’åº.&lt;/p&gt;
&lt;h2&gt;RocksDB çš„åŠŸèƒ½&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Get&lt;/code&gt; å¯ä»¥ä»æ•°æ®åº“ä¸­è¯»å‡ºä¸€ä¸ªkvå¯¹, &lt;code&gt;MultiGet&lt;/code&gt;å¯ä»¥ä»æ•°æ®åº“ä¸­è¯»å‡ºå¤šä¸ªkvå¯¹. æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®åœ¨é€»è¾‘ä¸Šéƒ½æ˜¯æœ‰åºçš„, ä¸€ä¸ªåº”ç”¨å¯ä»¥æŒ‡å®šä¸€ä¸ªkeyçš„æ¯”è¾ƒæ–¹æ³•, ä»è€Œè®©æ‰€æœ‰çš„ key æŒ‰è¿™ç§æ–¹æ³•æœ‰åº. å¯ä»¥é€šè¿‡ä½¿ç”¨ &lt;code&gt;Iterator&lt;/code&gt; API å¯ä»¥å¯¹æ•°æ®åº“åšä¸€ä¸ª &lt;code&gt;RangeScan&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;Put&lt;/code&gt; æ–¹æ³•å¯ä»¥æ›´æ–°ä¸€ä¸ªæ•°æ®, ä½¿ç”¨&lt;code&gt;Write&lt;/code&gt; å¯ä»¥åŸå­æ€§çš„æ›´æ–°å¤šä¸ªæ•°æ®. è¿™ä¸¤ä¸ªæ“ä½œéƒ½ä¼šç›´æ¥è¦†ç›–è€æ•°æ®.&lt;/p&gt;
&lt;p&gt;RocksDB ä½¿ç”¨ checksum æ¥æ ¡éªŒæ•°æ®çš„æŸå. ä¸€èˆ¬æ¥è¯´æ ¡éªŒæ˜¯æŒ‰ç…§ block æ¥è¿›è¡Œçš„. ä¸€ä¸ª block å¦‚æœè¢«å†™å…¥åˆ°ç¡¬ç›˜ä¹‹åå°±ä¸ä¼šå†å˜åŒ–äº†.&lt;/p&gt;
&lt;p&gt;æ•´ä¸ªæ•°æ®åº“å†™å…¥çš„ååå–å†³äºcompactionçš„é€Ÿç‡, æ®è§‚æµ‹, åœ¨SSDä¸Šå¤šçº¿ç¨‹compactionçš„é€Ÿç‡æ˜¯å•çº¿ç¨‹çš„10å€. æ•´ä¸ªæ•°æ®åº“è¢«å­˜å‚¨ä¸ºä¸€ç³»åˆ—çš„sstfile. å½“ä¸€ä¸ªmemtableæ»¡äº†ä¹‹å, ä»–ä¼šè¢«å†™å…¥åˆ°ä¸€ä¸ªLevel0 çš„ sstableä¸Š. åœ¨å†™å…¥åˆ°L0çš„è¿‡ç¨‹ä¸­, RocksDBä¼šæŠŠmemtableä¸­çš„é‡å¤çš„å·²åˆ é™¤çš„é”®å…¨éƒ¨éƒ½æ¸…ç†æ‰. ä¸€äº›æ–‡ä»¶ä¼šè¢«å‘¨æœŸæ€§çš„è¯»å…¥åˆå¹¶åˆ°ä¸€èµ·, è¿™ä¸ªè¡Œä¸ºå«åšcompaction.&lt;/p&gt;
&lt;p&gt;RocksDBæ”¯æŒä¸¤ç§å½¢å¼çš„comapaction. å…¶ä¸­ä¸€ç§å«åšUniversal Style Compaction. åœ¨è¿™ç§æ¨¡å¼ä¸‹, æ‰€æœ‰çš„æ–‡ä»¶éƒ½å­˜åœ¨L0æ¨¡å¼, å¹¶ä¸”æŒ‰ç…§æ—¶é—´æ’åº. è¿™æ—¶å€™ä¸€ä¸ªcompactionä¼šæŠŠæ—¶é—´ä¸Šç›¸è¿çš„ä¸¤ç»„æ–‡ä»¶åˆå¹¶å¹¶ç»„æˆä¸€ä¸ªæ–°çš„æ–‡ä»¶, å†æ”¾å›åˆ°L0. æ‰€æœ‰çš„æ–‡ä»¶éƒ½æœ‰å¯èƒ½æœ‰é‡å¤çš„é”®.&lt;/p&gt;
&lt;p&gt;å¦ä¸€ç§æ¨¡å¼ Level Style Compaction. æ•°æ®æŒ‰å±‚å­˜å‚¨, ä¹Ÿå°±æ˜¯L0...Ln. æœ€æ–°çš„æ•°æ®å­˜å‚¨åœ¨L0, æœ€è€çš„æ•°æ®å­˜å‚¨åœ¨Lmaxå±‚. åœ¨L0çš„æ–‡ä»¶å¯èƒ½ä¼šæœ‰äº¤å‰çš„key, ä½†æ˜¯åœ¨å…¶å®ƒå±‚å°±ä¸ä¼šæœ‰. compactionå‘ç”Ÿçš„æ—¶å€™, å»é™¤Lnçš„ä¸€ä¸ªæ–‡ä»¶, å’Œåœ¨Ln+1å±‚æ‰€æœ‰æœ‰ç›¸åŒkeyçš„æ–‡ä»¶, æŠŠä»–ä»¬åˆå¹¶ä¹‹åä½œä¸ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å­˜å‚¨åœ¨Ln+1å±‚. é€šå¸¸æ¥è¯´USCæ¯”LSC äº§ç”Ÿæ¯”è¾ƒå°çš„å†™å…¥æ”¾å¤§, ä½†æ˜¯æ¯”è¾ƒå¤§çš„ç©ºé—´æ”¾å¤§.&lt;/p&gt;
&lt;p&gt;MANIFEST æ–‡ä»¶å­˜å‚¨äº†æ•°æ®åº“çš„çŠ¶æ€.&lt;/p&gt;
&lt;p&gt;ç¨‹åºå¯ä»¥é€šè¿‡å®šä¹‰compaction filteræ¥å®ç°, keyçš„TTL, æ¸…æ´—æ•°æ®ç­‰åŠŸèƒ½.&lt;/p&gt;
&lt;p&gt;RocksDBæ”¯æŒå‹ç¼©. å…¸å‹çš„é…ç½®æ˜¯ L0-L2 æ²¡æœ‰å‹ç¼©ï¼Œä¸­é—´å±‚ä½¿ç”¨ snappy ç®—æ³•å‹ç¼©ï¼ŒLmax ä½¿ç”¨ zlib å‹ç¼©ã€‚&lt;/p&gt;
&lt;p&gt;RocksDB ä¼šæŠŠæ‰€æœ‰çš„transactionéƒ½å­˜è´®åœ¨logfileä¸­, é‡å¯çš„æ—¶å€™ RocksDB ä¼šå†å»å¤„ç†è¿™äº›logfile. è¿™äº›logfileå¯ä»¥å’Œsstfile å­˜æ”¾åœ¨ä¸åŒçš„ç›®å½•, æ¯”å¦‚ä¸ºäº†æ€§èƒ½æŠŠsstfileå­˜æ”¾åœ¨æ€§èƒ½æ›´é«˜çš„å­˜å‚¨ä¸Š, è€ŒæŠŠlogfileå­˜æ”¾åœ¨æ€§èƒ½ä½ä¸€ç‚¹çš„å­˜å‚¨ä¸Š.&lt;/p&gt;
&lt;p&gt;[1] https://github.com/facebook/rocksdb/wiki/RocksDB-Basics&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 09 Nov 2017 09:12:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-09:/posts/rocksdb-ji-chu-gai-nian-jiao-cheng.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>ä¸è¦æŠŠä½ çš„ä¸šä½™é¡¹ç›®æå¾—è¿‡åˆ†å¤æ‚</title><link>/posts/bu-yao-ba-ni-de-ye-yu-xiang-mu-gao-de-guo-fen-fu-za.html</link><description>&lt;p&gt;é”™è¯¯ä¸€ é¡¹ç›®ç®¡ç†&lt;/p&gt;
&lt;p&gt;ä¸è¦çæƒ³, ä¸è¦è¯•ç€ç®¡ç†ä¸€ä¸ªè¿˜ä¸å­˜åœ¨çš„é¡¹ç›®. å†™ä¸‹æ¥å¤§æ¦‚çš„ideaå’Œé¢„æœŸçš„æ—¶é—´, è¿™å°±å¤Ÿäº†.&lt;/p&gt;
&lt;p&gt;é”™è¯¯äºŒ è¿‡åº¦è®¾è®¡åŸºç¡€æ¶æ„&lt;/p&gt;
&lt;p&gt;ä½ å¯èƒ½è§‰å¾—è‡ªå·±çš„è¿™ä¸ªä¸»æ„å¤ªæ£’äº†, å¼€å§‹è®¾è®¡ä¸€ä¸ªèƒ½å¤Ÿæ»¡è¶³å‡ ç™¾ä¸‡ç”¨æˆ·åŒæ—¶åœ¨çº¿çš„ç³»ç»Ÿ. ä¸è¦çæƒ³, æœ€å¼€å§‹ä½ å¯èƒ½åªéœ€è¦çš„æ˜¯ä¸€ä¸ª512å†…å­˜çš„DigitalOceanå®ä¾‹&lt;/p&gt;
&lt;p&gt;é”™è¯¯ä¸‰ æ‹…å¿ƒæŠ€æœ¯æ ˆ&lt;/p&gt;
&lt;p&gt;å¤§éƒ¨åˆ†çš„è½¯ä»¶å·¥ç¨‹å¸ˆä¼¼ä¹æ€»æ˜¯æ‹…å¿ƒæ½œåœ¨å®¢æˆ·ä¼šå¾ˆåœ¨æ„ä»–ä»¬çš„æŠ€æœ¯æ ˆ, å®é™…ä¸Šä»–ä»¬æ‰ä¸å…³å¿ƒå‘¢...é‚£ä¸ªé¡ºæ‰‹å°±ç”¨é‚£ä¸ªå§, ç®¡ä»–æ˜¯PHPè¿˜æ˜¯Rubyå‘¢...&lt;/p&gt;
&lt;p&gt;é”™è¯¯å›› åˆ›å»ºè‡ªå·±çš„æ¡†æ¶&lt;/p&gt;
&lt;p&gt;è¿™ä¸€ç‚¹æ˜¯æˆ‘æœ€å¸¸çŠ¯çš„é”™è¯¯, æœ¬æ¥æƒ³è¦åšä¸€ä¸ªä»€ä¹ˆä¸œè¥¿, ä½†æ˜¯æ„Ÿè§‰ç°æœ‰çš„æ¡†æ¶éƒ½ä¸é¡ºæ‰‹, äºæ˜¯å†³å®šè‡ªå·±å†™ä¸€ä¸ªæ¡†æ¶, ç­‰æ¡†æ¶å†™å®Œäº†, å‘ç°åŸæœ¬çš„é¡¹ç›®æ ¹æœ¬ä¸æƒ³åšäº†...&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ³•: ä½¿ç”¨ç°æœ‰çš„æ¡†æ¶å¹¶ä¸”å®šåˆ¶ä»–ä»¬, è¿™å°±è¶³å¤Ÿäº†.&lt;/p&gt;
&lt;p&gt;é”™è¯¯äº” æŒç»­æ²¡æœ‰è¾“å‡º&lt;/p&gt;
&lt;p&gt;è¿‡åº¦è®¾è®¡è¾“å‡ºç³»ç»Ÿ, Jenkins, Drone, Travis ç­‰ç­‰, å¯¼è‡´ä¸€ç›´æ²¡æœ‰è¾“å‡º. è¿™äº›ä¸œè¥¿æ˜¯å¥½ä¸œè¥¿, ä½†æ˜¯ä¸€å¼€å§‹ä¸ç”¨çº ç»“äºé…ç½®ä»–ä»¬.&lt;/p&gt;
&lt;p&gt;åŸæ–‡: https://elsyms.com/the-art-of-over-engineering-your-side-projects/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 09 Nov 2017 09:07:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-09:/posts/bu-yao-ba-ni-de-ye-yu-xiang-mu-gao-de-guo-fen-fu-za.html</guid><category>åæ€ä¸æ€»ç»“</category></item><item><title>Python çš„å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹</title><link>/posts/python-de-duo-xian-cheng-he-duo-jin-cheng.html</link><description>&lt;h1&gt;é«˜å±‚æ¬¡å¤šçº¿ç¨‹&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ threading æ¨¡å—ï¼Œthreading.Thread&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;threading&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;worker&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;thread worker function&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Worker {}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;threads&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;threading&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;worker&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;worker&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
    &lt;span class="n"&gt;threads&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;by default, it does not start running&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;t.start  # start executing the thread
t.is_alive
t.join   # wait for a thread, daemon thread can&amp;#39;t be joined
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç›´æ¥å­ç±»åŒ– Thread æ˜¯ä¸æ¨èçš„ï¼Œå› ä¸ºè¿™æ ·ä¼šä½¿ä»£ç å’Œçº¿ç¨‹è€¦åˆåœ¨ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;Each Thread has its own stack, so when a child thread throws a exception, the main thread will not catch it&lt;/p&gt;
&lt;p&gt;http://stackoverflow.com/questions/2829329/catch-a-threads-exception-in-the-caller-thread-in-python&lt;/p&gt;
&lt;h1&gt;Daemon åŒ–çº¿ç¨‹&lt;/h1&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹çš„æ‰§è¡Œã€‚è®¾å®šä¸º Daemon çº¿ç¨‹åï¼Œä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œå¹¶ä¸ç­‰å¾…ï¼Œä½†å½“ä¸»çº¿ç¨‹é€€å‡ºæ—¶ä¼šæ€æ‰æ‰€æœ‰å­çº¿ç¨‹ã€‚å¦‚æœæƒ³è¦ä½¿ç”¨Ctrl-C, å¿…é¡»è®¾å®šä¸ºdaemon&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ t.daemon = True è®¾å®šä¸º Daemon çº¿ç¨‹&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;t.join(timeout)&lt;/code&gt; ç­‰å¾…å­çº¿ç¨‹å®Œæˆï¼Œå¦‚æœ timeout ä¹‹å†…æ²¡æœ‰å®Œæˆï¼Œç»§ç»­æ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;&lt;code&gt;threading.enumerate()&lt;/code&gt; è¿”å›æ‰€æœ‰æ´»åŠ¨çš„çº¿ç¨‹&lt;/p&gt;
&lt;p&gt;&lt;code&gt;threading.current_thread()&lt;/code&gt; è¿”å›å½“å‰è¿›ç¨‹&lt;/p&gt;
&lt;h1&gt;é•¿æ—¶é—´è¿è¡Œçš„å®ˆæŠ¤è¿›ç¨‹&lt;/h1&gt;
&lt;p&gt;å¤´æ¡çš„ä»£ç æ˜¯å¦‚ä½•å¤„ç†çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸»çº¿ç¨‹ç­‰å¾…&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰çš„ worker çº¿ç¨‹ daemon åŒ–&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ systemd ç®¡ç†è¿›ç¨‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…³äº coroutineï¼Œé¦–å…ˆï¼Œä»–ä»¬æ˜¯çº¿ç¨‹ï¼Œç”¨æˆ·çº§çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´è™½ç„¶ä»–ä»¬çš„ä»£ä»·æ¯”è¾ƒå°ï¼Œä½†æ˜¯å¦‚æœé€’å½’è°ƒç”¨ï¼Œå¾ˆå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çš„åç¨‹ã€‚åœ¨çº¿ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ˜¾ç„¶ä¸èƒ½åˆ›å»ºæ•°é‡è¿‡å¤§çš„çº¿ç¨‹ï¼Œå› æ­¤ï¼Œä¹Ÿä¸èƒ½æ— é™åœ°åˆ›é€ è¿‡å¤šçš„åç¨‹ã€‚&lt;/p&gt;
&lt;h1&gt;çº¿ç¨‹æ± å’Œè¿›ç¨‹æ± &lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;multiprocessing.Pool&lt;/code&gt; è¿›ç¨‹æ± ï¼Œåªèƒ½æ¥å— marshalable ä½œä¸º worker&lt;/li&gt;
&lt;li&gt;&lt;code&gt;multiprocessing.ThreadPool&lt;/code&gt; çº¿ç¨‹æ± ï¼ŒåŒæ ·å—åˆ°äº† GIL çš„å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”¨æ³•å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;multiporcessing.Pool.map(fn, iterable)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;çº¿ç¨‹æ± çš„ä¾‹å­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;multiprocessing.pool&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ThreadPool&lt;/span&gt;
Â 
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;square_number&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
Â Â Â  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
Â 
&lt;span class="c1"&gt;# function to be mapped over&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;calculate_parallel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;threads&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
Â Â Â  &lt;span class="n"&gt;pool&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ThreadPool&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;threads&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
Â Â Â  &lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;square_number&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
Â Â Â  &lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;Â  &lt;span class="c1"&gt;# NOTE close before join&lt;/span&gt;
Â Â Â  &lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
Â Â Â  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;
Â 
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
Â Â Â  &lt;span class="n"&gt;numbers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
Â Â Â  &lt;span class="n"&gt;squared_numbers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;calculate_parallel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numbers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
Â Â Â  &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;squared_numbers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨poolçš„ä¸€ä¸ªé™·é˜±æ˜¯ä¸å¤ªå¥½debug, çˆ†å‡ºçš„å¼‚å¸¸å¾€å¾€çœ‹ä¸æ¸…é—®é¢˜, éœ€è¦ä½¿ç”¨å•çº¿ç¨‹è°ƒè¯•ä¹‹åå†å»ä½¿ç”¨&lt;/p&gt;
&lt;h1&gt;&lt;code&gt;concurrent.futures&lt;/code&gt;&lt;/h1&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://medium.com/python-pandemonium/asyncio-coroutine-patterns-beyond-await-a6121486656f&lt;/li&gt;
&lt;li&gt;http://lucumr.pocoo.org/2016/10/30/i-dont-understand-asyncio/&lt;/li&gt;
&lt;li&gt;https://medium.com/@yeraydiazdiaz/asyncio-coroutine-patterns-errors-and-cancellation-3bb422e961ff&lt;/li&gt;
&lt;li&gt;https://pymotw.com/2/threading/&lt;/li&gt;
&lt;li&gt;https://news.ycombinator.com/item?id=9793466&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 08 Nov 2017 19:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-11-08:/posts/python-de-duo-xian-cheng-he-duo-jin-cheng.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>è›‹</title><link>/posts/dan.html</link><description>&lt;p&gt;&lt;a href="http://www.galactanet.com/oneoff/theegg_zh.html"&gt;The Egg&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Written by Andy Weir&lt;/p&gt;
&lt;p&gt;Translation: Xiuzhu Shao&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;è›‹

ä½ åœ¨å›å®¶çš„è·¯ä¸Šæ­»äº†ã€‚
é‚£æ˜¯ä¸€åœºè½¦ç¥¸ã€‚ä¸å¤§ï¼Œä½†ä»ç„¶è‡´å‘½ã€‚ä½ ç•™ä¸‹äº†å¦»å­å’Œä¸¤ä¸ªå­©å­ã€‚ä½ æ­»çš„å¹¶ä¸ç—›è‹¦ã€‚æ•‘æŠ¤å‘˜å°½åŠ›å»æ•‘ä½ ï¼Œä½†æ²¡æœ‰æˆåŠŸã€‚ä½ çš„èº«ä½“è¢«æ‘”å¾—å¤ªå½»åº•äº†ã€‚æ­»äº†å¾ˆå¥½ï¼Œç›¸ä¿¡æˆ‘ã€‚
è¿™æ—¶ä½ é‡è§äº†æˆ‘ã€‚
â€œå‘ç”Ÿäº†ä»€ä¹ˆ?â€ä½ é—®ï¼Œâ€œæˆ‘åœ¨é‚£å„¿ï¼Ÿâ€
â€œä½ æ­»äº†ã€‚â€æˆ‘è¯´ï¼Œæ²¡æœ‰å¿…è¦æ‹å¼¯æŠ¹è§’ã€‚
â€œæœ‰ä¸€è¾†ã€‚ã€‚ã€‚ä¸€è¾†å¡è½¦å¤±æ§ã€‚ã€‚ã€‚â€
â€œå¯¹ã€‚â€æˆ‘è¯´ã€‚
â€œæˆ‘ã€‚ã€‚ã€‚æˆ‘æ­»äº†?â€
â€œå¯¹ã€‚ä½†åˆ«éš¾è¿‡ï¼Œæ¯ä¸ªäººéƒ½ä¼šæ­»ã€‚â€æˆ‘è¯´ã€‚
ä½ çœ‹äº†çœ‹å‘¨å›´ï¼Œä¸€ç‰‡è™šç©ºï¼Œåªæœ‰ä½ å’Œæˆ‘ã€‚â€œè¿™æ˜¯ä»€ä¹ˆåœ°æ–¹ï¼Ÿâ€ä½ é—®ï¼Œâ€œæ˜¯æ¥ä¸–å—ï¼Ÿâ€
â€œå·®ä¸å¤šå§ã€‚â€æˆ‘è¯´ã€‚
â€œä½ æ˜¯ä¸Šå¸ï¼Ÿâ€ä½ é—®ã€‚
â€œå¯¹ï¼Œâ€æˆ‘å›ç­”ï¼Œâ€œæˆ‘æ˜¯ä¸Šå¸ã€‚â€
â€œæˆ‘çš„å­©å­ã€‚ã€‚ã€‚æˆ‘çš„è€å©†ã€‚ã€‚ã€‚â€ä½ è¯´ã€‚
â€œæ€ä¹ˆäº†ï¼Ÿâ€
â€œä»–ä»¬ä¼šå¥½å—ï¼Ÿâ€
â€œè¿™æ­£æ˜¯æˆ‘æƒ³çœ‹åˆ°çš„ï¼Œâ€æˆ‘è¯´ï¼Œâ€œä½ åˆšåˆšå»ä¸–ï¼Œä½†ä¸»è¦å…³å¿ƒçš„æ˜¯ä½ çš„å®¶äººã€‚è¿™æ˜¯å¥½äº‹ã€‚â€
ä½ å……æ»¡å¥½å¥‡åœ°çœ‹ç€æˆ‘ã€‚åœ¨ä½ çœ¼é‡Œï¼Œæˆ‘å¹¶ä¸åƒç¥ã€‚æˆ‘åªåƒä¸€ä¸ªæ™®é€šçš„ç”·äººï¼Œæˆ–è®¸ä¸€ä¸ªå¥³äººï¼Œä¸€ç§æ¨¡ç³Šçš„æƒå¨å½¢è±¡ã€‚æ¯”èµ·ä¸Šå¸ï¼Œæˆ‘é•¿å¾—æ›´åƒä¸€ä½è€å¸ˆã€‚
â€œåˆ«æ‹…å¿ƒï¼Œâ€æˆ‘è¯´ï¼Œâ€œä»–ä»¬ä¼šå¥½èµ·æ¥çš„ã€‚ä½ çš„å­©å­ä»¬ä¼šæŠŠä½ è®°å¾—åå…¨åç¾ã€‚ä»–ä»¬è¿˜æ¥ä¸åŠå‘å±•å¯¹ä½ å¾—æ•Œæ„ã€‚ä½ çš„å¦»å­è¡¨é¢ä¸Šä¼šå“­ï¼Œä½†å…¶å®ä¼šæš—æš—æ¾ä¸€å£æ°”ã€‚è¯´å®åœ¨çš„ï¼Œä½ ä»¬çš„å©šå§»å·²ç»ç ´è£‚äº†ã€‚å¦‚æœè¿™æ˜¯ä»»ä½•å®‰æ…°çš„è¯ï¼Œå¥¹ä¼šä¸ºæ­¤æ„Ÿåˆ°éå¸¸å†…ç–šã€‚â€
â€œå“¦ï¼Œâ€ä½ è¯´ï¼Œâ€œé‚£ç°åœ¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘ä¼šå»å¤©å ‚è¿˜æ˜¯åœ°ç‹±è¿˜æ˜¯åˆ°å“ªé‡Œï¼Ÿâ€
â€œéƒ½ä¸ä¼šï¼Œâ€æˆ‘è¯´ï¼Œâ€œä½ ä¼šé‡æ–°æŠ•èƒã€‚â€
â€œå•Šï¼Œâ€ä½ è¯´ï¼Œâ€œåŸæ¥å°åº¦æ•™æ˜¯å¯¹çš„ã€‚â€
â€œæ¯ä¸€ä¸ªå®—æ•™éƒ½æœ‰ä»–ä»¬è‡ªå·±å¯¹çš„åœ°æ–¹ï¼Œâ€æˆ‘è¯´ï¼Œâ€œå’Œæˆ‘ä¸€èµ·èµ°å§ã€‚â€
ä½ è·Ÿç€æˆ‘å¤§æ­¥ç©¿è¡Œäºè™šç©ºã€‚â€œæˆ‘ä»¬å»å“ªå„¿å‘¢ï¼Ÿâ€
â€œä¸æ˜¯ä»€ä¹ˆç‰¹åˆ«çš„åœ°æ–¹ï¼Œâ€æˆ‘è¯´ã€‚â€œåˆšå¥½æˆ‘ä»¬å¯ä»¥è¾¹èµ°è¾¹è°ˆã€‚â€
â€œé‚£æœ€ç»ˆçš„ç›®çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿâ€ä½ é—®ï¼Œâ€œæˆ‘é‡ç”Ÿçš„æ—¶å€™ï¼Œä¼šå˜æˆä¸€å¼ ç™½çº¸ï¼Œå¯¹å—ï¼Ÿä¸€ä¸ªå©´å„¿ã€‚æ‰€ä»¥æˆ‘æ­¤ç”Ÿæ‰€æœ‰çš„ç»å†å’Œæ‰€åšçš„ä¸€åˆ‡éƒ½ä¸å†æœ‰æ„ä¹‰ã€‚â€
â€œä¸æ˜¯è¿™æ ·ï¼â€æˆ‘è¯´ï¼Œâ€œä½ ä¹‹ä¸­åŒ…å«æœ‰ä½ ç´¯ç”Ÿç´¯ä¸–æ‰€æœ‰çš„çŸ¥è¯†å’Œç»éªŒã€‚åªæ˜¯ç°åœ¨ä½ ä¸è®°å¾—å®ƒä»¬äº†ã€‚â€
æˆ‘åœä¸‹è„šæ­¥ï¼Œæ¡ä½ä½ çš„è‚©è†€ã€‚â€œä½ çš„çµé­‚æ¯”ä½ æ‰€èƒ½æƒ³è±¡çš„ä»»ä½•ä¸œè¥¿éƒ½æ›´ä¸ºå£®è§‚ã€ç¾ä¸½å’Œå·¨å¤§ï¼Œäººç±»çš„å¤´è„‘åªå¯å®¹çº³ä½ çš„ä¸€å°éƒ¨åˆ†ã€‚å°±åƒä½ æŠŠæ‰‹æŒ‡æ”¾è¿›ä¸€æ¯æ°´é‡Œè¯•æ¢æ¸©åº¦ä¸€æ ·ï¼Œä½ åªæŠŠè‡ªå·±å°å°çš„ä¸€éƒ¨åˆ†æ”¾è¿›èº«ä½“è¿™ä¸ªå®¹å™¨ã€‚ä½†å½“ä½ æŠŠå®ƒæ‹¿å›æ—¶ï¼Œä½ å°±è·å¾—äº†è¿™ä¸ªå®¹å™¨çš„æ‰€æœ‰ç»éªŒã€‚â€
â€œä½ æ‰åœ¨ä¸€ä¸ªäººä½“é‡Œè¿‡äº†48å¹´ï¼Œæ‰€ä»¥ä½ è¿˜æ²¡æœ‰å……åˆ†ä¼¸å±•ä½ è‡ªå·±ï¼Œè§‰æ‚Ÿåˆ°ä½ å…¶ä½™çš„åºå¤§æ„è¯†ã€‚å¦‚æœæˆ‘ä»¬åœ¨è¿™é‡Œé€—ç•™è¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œä½ ä¼šå¼€å§‹è®°èµ·ä¸€åˆ‡ã€‚ä½†ä¸€ç”Ÿå’Œä¸€ç”Ÿä¹‹é—´æ²¡æœ‰å¿…è¦è¿™æ ·åšã€‚â€
â€œé‚£æˆ‘æ›¾è½¬è¿‡å¤šå°‘æ¬¡ä¸–å‘¢ï¼Ÿâ€
â€œå“¦ï¼Œå¾ˆå¤šï¼Œå¾ˆå¤šå¾ˆå¤šã€‚å¾ˆå¤šä¸åŒçš„ç”Ÿå‘½ã€‚â€æˆ‘è¯´ï¼Œâ€œæ¥ä¸‹æ¥ï¼Œä½ æ˜¯ä¸€ä¸ªæ´»åœ¨å…¬å…ƒ540å¹´çš„ä¸­å›½å†œå®¶å§‘å¨˜ã€‚â€
â€œç­‰ç­‰ï¼Œä»€ä¹ˆï¼Ÿâ€ä½ ç»“ç»“å·´å·´åœ°è¯´ï¼Œâ€œä½ è¦æŠŠæˆ‘é€å›è¿‡å»ï¼Ÿâ€
â€œç†è®ºä¸Šè¯´ï¼Œæˆ‘æƒ³æ˜¯è¿™æ ·å§ã€‚ä½ æ‰€çŸ¥é“çš„æ—¶é—´å…¶å®åªå­˜åœ¨äºä½ çš„ä¸–ç•Œé‡Œã€‚è€Œåœ¨æˆ‘çš„ä¸–ç•Œé‡Œï¼Œä¸€åˆ‡éƒ½ä¸åŒã€‚â€
â€œä½ ä»å“ªé‡Œæ¥ï¼Ÿâ€ä½ é—®ã€‚
â€œå“¦ï¼Œâ€æˆ‘è§£é‡Šé“ï¼Œâ€œæˆ‘æ¥è‡ªæŸä¸€ä¸ªåœ°æ–¹ï¼Œå¦ä¸€ä¸ªåœ°æ–¹ã€‚é‚£å„¿æœ‰å¾ˆå¤šå’Œæˆ‘ä¸€æ ·çš„å­˜åœ¨ã€‚æˆ‘çŸ¥é“ä½ æƒ³çŸ¥é“é‚£å„¿æ˜¯ä»€ä¹ˆæ ·å­ï¼Œä½†è€å®è¯´ï¼Œä½ ä¸ä¼šç†è§£ã€‚â€
â€œå“¦ï¼Œâ€ä½ è¯´ï¼Œæœ‰ç‚¹å¤±æœ›ã€‚â€œä½†ç­‰ç­‰ã€‚å¦‚æœæˆ‘æ°å·§è½¬ä¸–åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œæˆ‘å¾ˆå¯èƒ½æ›¾ç»ä¸æˆ‘è‡ªå·±åœ¨æŸä¸€ç‚¹ç›¸é‡ã€‚â€
â€œå½“ç„¶ï¼Œè¿™ç§æƒ…å†µç»å¸¸å‘ç”Ÿã€‚ä½†æ¯ä¸€ä¸ªç”Ÿå‘½åªæ™“å¾—å®ƒè‡ªå·±çš„å‘¨æœŸï¼Œæ‰€ä»¥ä½ æ ¹æœ¬ä¸çŸ¥é“å®ƒå®é™…åœ¨å‘ç”Ÿã€‚â€
â€œé‚£è¿™ä¸€åˆ‡çš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿâ€
â€œçœŸçš„å—ï¼Ÿâ€æˆ‘é—®ï¼Œâ€œå½“çœŸï¼Ÿä½ åœ¨é—®æˆ‘ç”Ÿå‘½çš„æ„ä¹‰ï¼Ÿä¸è§‰çš„æœ‰ç‚¹è€å¥—ï¼Ÿâ€
â€œä½†è¿™çš„ç¡®æ˜¯ä¸€ä¸ªåˆç†çš„é—®é¢˜ã€‚â€ä½ åšæŒã€‚
æˆ‘çœ‹ç€ä½ çš„çœ¼ç›ã€‚â€œç”Ÿå‘½çš„æ„ä¹‰ï¼Œä¹Ÿæ˜¯æˆ‘åˆ›é€ æ•´ä¸ªå®‡å®™çš„åŸå› ï¼Œæ˜¯ä¸ºäº†è®©ä½ æˆç†Ÿã€‚â€
â€œä½ æ˜¯æŒ‡äººç±»ï¼Ÿä½ æƒ³è®©æˆ‘ä»¬æˆç†Ÿï¼Ÿâ€
â€œä¸ï¼Œåªæœ‰ä½ ã€‚æˆ‘ä¸ºä½ åˆ›é€ äº†æ•´ä¸ªå®‡å®™ã€‚ä½ æ¯ä¸€æ¬¡çš„ç”Ÿå‘½éƒ½è®©ä½ æˆé•¿å’Œæˆç†Ÿï¼Œæˆä¸ºä¸€ä¸ªæ›´å¤§çš„ã€æ›´ä¼Ÿå¤§çš„æ™ºè€…ã€‚â€
â€œåªæ˜¯æˆ‘å—ï¼Ÿå…¶ä»–äººæ€ä¹ˆåŠï¼Ÿâ€
â€œæ²¡æœ‰åˆ«äººï¼Œâ€æˆ‘è¯´ï¼Œâ€œè¿™ä¸ªå®‡å®™é‡Œåªæœ‰ä½ å’Œæˆ‘ã€‚â€
ä½ èŒ«ç„¶åœ°ç›¯ç€æˆ‘ï¼Œâ€œä½†åœ°çƒä¸Šæ‰€æœ‰çš„äººã€‚ã€‚ã€‚â€
â€œå…¨æ˜¯ä½ ï¼Œä¸åŒåŒ–èº«çš„ä½ ã€‚â€
â€œç­‰ç­‰ï¼Œæˆ‘æ˜¯æ¯ä¸ªäººï¼Ÿï¼â€
â€œä½ ç»ˆäºæ‡‚äº†ï¼Œâ€æˆ‘è¯´ï¼Œç¥è´ºåœ°æ‹äº†æ‹ä½ çš„èƒŒã€‚
â€œæˆ‘æ˜¯æ¯ä¸€ä¸ªæ´»è¿‡çš„äººï¼Ÿâ€
â€œè¿˜æ˜¯æœªæ¥æ¯ä¸€ä¸ªå°†è¦æ´»çš„äººï¼Œå¯¹ã€‚â€
â€œæˆ‘æ˜¯æ—è‚¯ï¼Ÿâ€
â€œä½ ä¹Ÿæ˜¯çº¦ç¿°Â·å¸ƒæ–¯ã€‚â€æˆ‘è¯´ã€‚
â€œæˆ‘æ˜¯å¸Œç‰¹å‹’ï¼Ÿâ€ä½ éœ‡æƒŠåœ°è¯´ã€‚
â€œä½ ä¹Ÿæ˜¯è¢«ä»–æ€æ­»çš„å‡ ç™¾ä¸‡äººã€‚â€
â€œæˆ‘æ˜¯è€¶ç¨£ï¼Ÿâ€
â€œä½ ä¹Ÿæ˜¯è·Ÿéšä»–çš„æ¯ä¸€ä¸ªäººã€‚â€
ä½ æ²‰é»˜äº†ã€‚
â€œä½ æ¯æ¬¡å®³äº†ä¸€ä¸ªäººï¼Œâ€æˆ‘è¯´ï¼Œâ€œä½ å°±åœ¨å®³è‡ªå·±ã€‚ä½ æ¯ä¸€æ¬¡å–„æ„çš„è¡ŒåŠ¨ï¼Œéƒ½æ˜¯å¯¹è‡ªå·±çš„å–„æ„ã€‚ä»»ä½•äººæ‰€ç»å†çš„æ¯ä¸€ä¸ªå¿«ä¹å’Œæ‚²ä¼¤çš„æ—¶åˆ»ï¼Œéƒ½æ›¾ç»è¢«ä½ ï¼Œæˆ–å°†ä¼šè¢«ä½ ï¼Œæ‰€ç»å†ã€‚â€
ä½ æƒ³äº†å¾ˆä¹…ã€‚
â€œä¸ºä»€ä¹ˆï¼Ÿâ€ä½ é—®æˆ‘ï¼Œâ€œä¸ºä»€ä¹ˆä½ è¦åšè¿™ä¸€åˆ‡ï¼Ÿâ€
â€œå› ä¸ºæœ‰ä¸€å¤©ï¼Œä½ ä¼šå˜å¾—å’Œæˆ‘ä¸€æ ·ã€‚å› ä¸ºè¿™å°±æ˜¯ä½ çš„æœ¬æ¥é¢ç›®ï¼Œä½ å’Œæˆ‘æ˜¯åŒç±»ï¼Œä½ æ˜¯æˆ‘çš„å­©å­ã€‚â€
â€œå“‡ï¼Œâ€ä½ éš¾ä»¥ç½®ä¿¡åœ°è¯´ï¼Œâ€œä½ çš„æ„æ€æ˜¯è¯´æˆ‘æ˜¯ä¸Šå¸ï¼Ÿâ€
â€œä¸ï¼Œè¿˜ä¸æ˜¯ã€‚ä½ è¿˜æ˜¯ä¸ªèƒå„¿ï¼Œä½ è¿˜åœ¨å‘è‚²ã€‚ä¸€æ—¦ä½ æ´»è¿‡æ‰€æœ‰æ—¶é—´çš„æ‰€æœ‰äººçš„ç”Ÿå‘½ä¹‹åï¼Œä½ æ‰ä¼šå‘è‚²åˆ°è¶³å¤Ÿæˆç†Ÿå»è·å¾—æ–°ç”Ÿã€‚â€
â€œé‚£æ•´ä¸ªå®‡å®™ï¼Œâ€ä½ è¯´ï¼Œâ€œåªæ˜¯ä¸€ä¸ªã€‚ã€‚ã€‚â€
â€œè›‹ã€‚â€æˆ‘å›ç­”ï¼Œâ€œç°åœ¨æ—¶é—´åˆ°äº†ï¼Œè¯¥è®©ä½ è¿›å…¥ä¸‹ä¸€ä¸ªç”Ÿå‘½äº†ã€‚â€
ç„¶åæˆ‘æŠŠä½ é€ä¸Šäº†è·¯ã€‚
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 26 Sep 2017 22:13:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-09-26:/posts/dan.html</guid><category>æœªåˆ†ç±»</category></item><item><title>å‰ç«¯æ¡†æ¶ Vue å­¦ä¹ ç¬”è®°</title><link>/posts/qian-duan-kuang-jia-vue-xue-xi-bi-ji.html</link><description>&lt;p&gt;ä¹‹å‰åœ¨ç½‘é¡µé‡Œå°èŒƒå›´çš„ç”¨äº†vue, æ„Ÿè§‰ç”¨èµ·æ¥éå¸¸çˆ½, ç°åœ¨æ‰“ç®—åšè‡ªå·±çš„ç¬”è®°åº”ç”¨. è¿™æ¬¡æ‰“ç®—åšæˆSPAçš„å½¢å¼, å‰ç«¯å…¨éƒ¨ç”¨vueæ¥å†™. éœ€è¦nodeçš„ä¸€äº›ä¸œè¥¿, è®°å½•ä¸‹å­¦ä¹ è¿‡ç¨‹. è¿ˆå‘å…¨æ ˆï¼Œå“ˆå“ˆ ^_^&lt;/p&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆ, å…¨å±€å®‰è£…vue: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;npm install --global @vue/cli
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;data å±æ€§&lt;/h1&gt;
&lt;p&gt;åªæœ‰åœ¨åˆ›å»ºæ—¶æä¾›çš„ data å±æ€§æ‰æ˜¯å“åº”å¼çš„ï¼Œåœ¨åˆ›å»ºä¹‹ååœ¨æ·»åŠ æ–°å…ƒç´ å°±ä¸ç®¡ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶è¿˜å¯ä»¥ä½¿ç”¨ app.$watch æ–¹æ³•æ˜¾å¼åˆ›å»ºä¸€äº›ç›‘å¬å™¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;// $watch æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•
vm.$watch(&amp;#39;a&amp;#39;, function (newValue, oldValue) {
  // è¿™ä¸ªå›è°ƒå°†åœ¨ `vm.a` æ”¹å˜åè°ƒç”¨
})
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;methods å’Œ computed&lt;/h1&gt;
&lt;p&gt;methods å®šä¹‰äº†ä¸€äº›å¯ä»¥è°ƒç”¨çš„æ–¹æ³•ï¼Œä»–çš„å€¼ä¹Ÿå¯ä»¥ç”¨æ¥æ’å€¼ã€‚ä½†æ˜¯æœ€å¥½ä½¿ç”¨ computedï¼Œå› ä¸º computed æ˜¯æœ‰ç¼“å­˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;computed å±æ€§ä¹Ÿå¯ä»¥è®¾ç½® setterï¼Œæ‰€ä»¥å®é™…ä¸Šï¼Œcomputed å±æ€§ç›¸å½“äºå¯¹ç°æœ‰å±æ€§çš„ä¸€ç§æ˜ å°„å’Œå˜åŒ–ã€‚&lt;/p&gt;
&lt;h1&gt;v-bind å’Œ v-model&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;v-bind ç”¨äºå•é¡¹ç»‘å®šï¼šåœ¨ HTML å±æ€§ä¸­ä½¿ç”¨ v-bind ç»‘å®š, æ ‡ç­¾ä¸­ä½¿ç”¨ &lt;code&gt;{{ }}&lt;/code&gt;ã€‚åªèƒ½ä½¿ç”¨è¡¨è¾¾å¼ï¼Œè€Œä¸èƒ½ä½¿ç”¨è¯­å¥ã€‚&lt;/li&gt;
&lt;li&gt;v-model ç”¨äºåŒå‘ç»‘å®šï¼šåœ¨ input è¿™ç±»ç”¨æˆ·å¯ä»¥è¾“å…¥çš„ç»„ä»¶ä¸­ï¼Œéœ€è¦åŒå‘ç»‘å®šï¼Œä½¿ç”¨ v-model.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;v-bind ç±»ä¼¼çš„æŒ‡ä»¤è¿˜æœ‰ v-once å’Œ v-html&lt;/p&gt;
&lt;p&gt;v-model å®é™…ä¸Šç­‰ä»·äº&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;lt;input v-model=&amp;quot;searchText&amp;quot;&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;lt;input
  v-bind:value=&amp;quot;searchText&amp;quot;
  v-on:input=&amp;quot;searchText = $event.target.value&amp;quot;
&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¦æƒ³åœ¨è‡ªå®šä¹‰è¾“å…¥ç»„ä»¶ä¸­æ”¯æŒ v-model çš„è¯ï¼Œå°±éœ€è¦ä½¿ç”¨ v-bind å’Œ v-on ä¸¤ä¸ªæ–¹æ³•äº†ï¼Œè€Œä¸èƒ½ç›´æ¥ä½¿ç”¨ v-modelã€‚&lt;/p&gt;
&lt;h1&gt;v-if å’Œ v-for&lt;/h1&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªå°±å’Œæ‰€æœ‰æ¨¡æ¿ç³»ç»Ÿä¸­çš„ if å’Œ for ä¸€æ ·ã€‚vue ä¸­æä¾›çš„é¢å¤–æ–¹ä¾¿ä¹‹å¤„æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨ template æ ‡ç­¾ï¼Œè¿™æ ·å°±ä¸ä¼šå¤šä¸€ä¸ªæ ‡ç­¾äº†&lt;/p&gt;
&lt;p&gt;vue æ˜¯æ‡’æ¸²æŸ“çš„ï¼Œå› æ­¤ä¼šå°½å¯èƒ½åœ°å¤ç”¨ç»„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ key æ¥åŒºåˆ†&lt;/p&gt;
&lt;p&gt;v-if æ˜¯çœŸæ­£çš„æ¡ä»¶å¼æ¸²æŸ“ï¼Œv-show åˆ™åªæ˜¯åœ¨åˆ‡æ¢ display å±æ€§&lt;/p&gt;
&lt;p&gt;vue æ²¡æœ‰ä»£ç†æ•°ç»„çš„èµ‹å€¼æ–¹æ³•ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ app.$set æ–¹æ³•&lt;/p&gt;
&lt;h1&gt;@&lt;/h1&gt;
&lt;p&gt;å¦‚æœåªæ˜¯æŒ‡å®šä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°çš„è¯ï¼Œé‚£ä¹ˆå‚æ•°å°±æ˜¯ eventã€‚å¦‚æœè‡ªå·±æŒ‡å®šäº†å‚æ•°çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ $event æ¥ä»£è¡¨ event&lt;/p&gt;
&lt;p&gt;è¿˜å¯ä»¥ä½¿ç”¨ .prevent å’Œ .stop ç­‰ä¿®é¥°ç¬¦&lt;/p&gt;
&lt;h1&gt;component&lt;/h1&gt;
&lt;p&gt;vue ä¸­æœ€ç»ˆè¦çš„æ¦‚å¿µå°±æ˜¯ç»„ä»¶äº†ã€‚ä½¿ç”¨ç»„ä»¶æ¥æ¨¡å—å¼å¾—æ„å»ºåº”ç”¨ã€‚éœ€è¦é€šè¿‡ props å±æ€§æ¥å®šä¹‰ç»„ä»¶ä¸­çš„å±æ€§&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;app-7&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;ol&amp;gt;&lt;/span&gt;
    &lt;span class="c"&gt;&amp;lt;!--&lt;/span&gt;
&lt;span class="c"&gt;      ç°åœ¨æˆ‘ä»¬ä¸ºæ¯ä¸ª todo-item æä¾› todo å¯¹è±¡&lt;/span&gt;
&lt;span class="c"&gt;      todo å¯¹è±¡æ˜¯å˜é‡ï¼Œå³å…¶å†…å®¹å¯ä»¥æ˜¯åŠ¨æ€çš„ã€‚&lt;/span&gt;
&lt;span class="c"&gt;      æˆ‘ä»¬ä¹Ÿéœ€è¦ä¸ºæ¯ä¸ªç»„ä»¶æä¾›ä¸€ä¸ªâ€œkeyâ€ï¼Œç¨åå†&lt;/span&gt;
&lt;span class="c"&gt;      ä½œè¯¦ç»†è§£é‡Šã€‚&lt;/span&gt;
&lt;span class="c"&gt;    --&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;todo-item&lt;/span&gt;
      &lt;span class="na"&gt;v-for=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;item in groceryList&amp;quot;&lt;/span&gt;
      &lt;span class="na"&gt;v-bind:todo=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;item&amp;quot;&lt;/span&gt;
      &lt;span class="na"&gt;v-bind:key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;item.id&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/todo-item&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/ol&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

Vue.component(&amp;#39;todo-item&amp;#39;, {
  // todo-item ç»„ä»¶ç°åœ¨æ¥å—ä¸€ä¸ª
  // &amp;quot;prop&amp;quot;ï¼Œç±»ä¼¼äºä¸€ä¸ªè‡ªå®šä¹‰ç‰¹æ€§ã€‚
  // è¿™ä¸ª prop åä¸º todoã€‚
  props: [&amp;#39;todo&amp;#39;],
  template: &amp;#39;&lt;span class="nt"&gt;&amp;lt;li&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;todo.text&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;&amp;#39;
})
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;props æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ¥å£°æ˜ç»„å»ºçš„å±æ€§ã€‚ç„¶åé€šè¿‡å±æ€§æ¥ä¼ é€’ã€‚&lt;/p&gt;
&lt;p&gt;ç»„ä»¶è¿˜å¯ä»¥é€šè¿‡ $emit æ¥å‘é€äº‹ä»¶ï¼Œè¿™äº›äº‹ä»¶å¯ä»¥è¢«æ‰€æœ‰çš„ç»„ä»¶ç›‘å¬åˆ°ï¼Œå°±åƒæ™®é€šçš„ DOM äº‹ä»¶ä¸€æ ·ã€‚&lt;/p&gt;
&lt;h1&gt;å£°æ˜å‘¨æœŸå‡½æ•°&lt;/h1&gt;
&lt;p&gt;åœ¨å›ºå®šçš„å‘¨æœŸï¼Œvue ä¼šè°ƒç”¨çš„ä¸€äº›å‡½æ•° created, mounted ç­‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸è¦ä½¿ç”¨èƒ–ç®­å¤´å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;new Vue({
  data: {
    a: 1
  },
  created: function () {
    // `this` æŒ‡å‘ vm å®ä¾‹
    console.log(&amp;#39;a is: &amp;#39; + this.a)
  }
})
// =&amp;gt; &amp;quot;a is: 1&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åˆ›å»ºvueåº”ç”¨&lt;/h1&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬ä¼šç›´æ¥é€šè¿‡&lt;code&gt;*.vue&lt;/code&gt;æ–‡ä»¶æ¥ç¼–å†™vueçš„ç»„ä»¶, å› æ­¤éœ€è¦ä½¿ç”¨webpackæ‰“åŒ…ç¼–è¯‘. å¦å¤–æˆ‘ä»¬éœ€è¦ä½¿ç”¨å®˜æ–¹çš„vue-routeræ¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vue init webpack notelet
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™æ¡å‘½ä»¤åŸºäº webpack è¿™ä¸ªæ¨¡æ¿åˆ›å»ºäº†noteletè¿™ä¸ªåº”ç”¨, ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç¬”è®°åº”ç”¨.&lt;/p&gt;
&lt;p&gt;æ‰“å¼€ &lt;code&gt;src/router/index.js&lt;/code&gt; å¯ä»¥çœ‹åˆ° vue åˆ›å»ºçš„routerçš„ä»£ç , å…¶ä¸­&lt;code&gt;@&lt;/code&gt;æ˜¯&lt;code&gt;src&lt;/code&gt;ç›®å½•çš„ç¼©å†™.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Vue&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;vue&amp;#39;&lt;/span&gt;
  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Router&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;vue-router&amp;#39;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Hello&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;@/components/Hello&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;Vue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Router&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;export&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Router&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
  &lt;span class="n"&gt;routes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;Â¦&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="err"&gt;Â¦&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="err"&gt;Â¦&lt;/span&gt; &lt;span class="n"&gt;component&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Hello&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åæ‰“å¼€ &lt;code&gt;src/main.js&lt;/code&gt;, å¯ä»¥çœ‹åˆ°åœ¨é‡Œé¢ä½¿ç”¨äº† &lt;code&gt;App&lt;/code&gt; æ¥ä½œä¸ºæˆ‘ä»¬çš„è·Ÿç»„ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;Vue&lt;/span&gt; &lt;span class="n"&gt;build&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="sb"&gt;`import`&lt;/span&gt; &lt;span class="n"&gt;command&lt;/span&gt;
&lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;runtime&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;only&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;standalone&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;has&lt;/span&gt; &lt;span class="n"&gt;been&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;webpack&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;alias&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Vue&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;vue&amp;#39;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;App&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;./App&amp;#39;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;router&lt;/span&gt; &lt;span class="nn"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;./router&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;Vue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;productionTip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;

&lt;span class="o"&gt;/*&lt;/span&gt; &lt;span class="n"&gt;eslint&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;disable&lt;/span&gt; &lt;span class="n"&gt;no&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="o"&gt;*/&lt;/span&gt;
&lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Vue&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
  &lt;span class="n"&gt;el&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#app&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;router&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;App/&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;components&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;App&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ‰§è¡Œ &lt;code&gt;npm run dev&lt;/code&gt;, ç„¶åæ‰“å¼€ http://localhost:8080/ å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„vueåº”ç”¨äº†. æ³¨æ„, åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ node 8.x ä¸‹ä¼¼ä¹æœ‰bug, å¯¼è‡´ app.js åŠ è½½ä¸å‡ºæ¥, å®‰è£… 6.x å°±å¥½äº†. è¯¥æ­»çš„node.&lt;/p&gt;
&lt;p&gt;æ‰“å¼€ &lt;code&gt;App.vue&lt;/code&gt;, ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„æ ¹ç»„ä»¶, å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;template&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;app&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  Â¦ &lt;span class="nt"&gt;&amp;lt;router-view&amp;gt;&amp;lt;/router-view&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/template&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
export default {
  name: &amp;#39;app&amp;#39;
}
&lt;span class="nt"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;style&amp;gt;&lt;/span&gt;
#app {
  font-family: &amp;#39;Avenir&amp;#39;, Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  margin-top: 60px;
}
&lt;span class="nt"&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„å…¶ä¸­çš„ router-view ä¾¿ç­¾, æ„æ€å°±æ˜¯è·¯ç”±çš„å†…å®¹éƒ½åœ¨ router-view ä¸­æ˜¾ç¤º.&lt;/p&gt;
&lt;h1&gt;æ·»åŠ ä¸€ä¸ªæ–°çš„ç»„ä»¶å’Œè·¯ç”±&lt;/h1&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬æ·»åŠ ä¸€ä¸ª"å…³äº"é¡µé¢. æ‰“å¼€&lt;code&gt;src/router/index.js&lt;/code&gt;, æ”¹æˆä¸‹é¢è¿™æ ·:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;export default new Router({
  routes: [
  Â¦ {
  Â¦ Â¦ path: &amp;#39;/&amp;#39;,
  Â¦ Â¦ name: &amp;#39;Hello&amp;#39;,
  Â¦ Â¦ component: Hello
  Â¦ },
  Â¦ {
  Â¦ Â¦ path: &amp;#39;/about&amp;#39;,
  Â¦ Â¦ name: &amp;#39;About&amp;#39;,
  Â¦ Â¦ component: About
  Â¦ }
  ]
})
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åæ·»åŠ  &lt;code&gt;src/components/About.vue&lt;/code&gt; æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;template&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  Â¦ &lt;span class="nt"&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;About Notelet&lt;span class="nt"&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
  Â¦ &lt;span class="nt"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;This is a simple note app&lt;span class="nt"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/template&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
export default {
  name: &amp;#39;About&amp;#39;,
  data () {
  Â¦ return {
  Â¦ Â¦ msg: &amp;#39;Hello Vue&amp;#39;
  Â¦ }
  }
}
&lt;span class="nt"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åæ›´æ”¹ &lt;code&gt;App.vue&lt;/code&gt; æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;template&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;app&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  Â¦ &lt;span class="nt"&gt;&amp;lt;router-link&lt;/span&gt; &lt;span class="na"&gt;:to=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;{name: &amp;#39;Hello&amp;#39;}&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Home&lt;span class="nt"&gt;&amp;lt;/router-link&amp;gt;&lt;/span&gt;
  Â¦ &lt;span class="nt"&gt;&amp;lt;router-link&lt;/span&gt; &lt;span class="na"&gt;to=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/about&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;About&lt;span class="nt"&gt;&amp;lt;/router-link&amp;gt;&lt;/span&gt;
  Â¦ &lt;span class="nt"&gt;&amp;lt;router-view&amp;gt;&amp;lt;/router-view&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/template&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„, æˆ‘ä»¬ä½¿ç”¨aboutæŒ‡å‘äº† About è¿™ä¸ªç»„ä»¶, è€Œä½¿ç”¨ hello æŒ‡å‘äº† Hello è¿™ä¸ªç»„ä»¶, æ³¨æ„å…¶ä¸­è¿˜åŠ¨æ€ä¼ é€’äº†å‚æ•°.&lt;/p&gt;
&lt;p&gt;[1] https://scotch.io/tutorials/getting-started-with-vue-router&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 22 Sep 2017 04:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-09-22:/posts/qian-duan-kuang-jia-vue-xue-xi-bi-ji.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>HTTP è®¤è¯ä»‹ç»</title><link>/posts/http-ren-zheng-jie-shao.html</link><description>&lt;p&gt;å‘¨æœ«ç»™ä¸€ä¸ªåº“æ·»åŠ httpä»£ç†çš„æ”¯æŒï¼Œå‘ç°å¯¹http basic authä¸ç”šäº†è§£ï¼Œé˜…è¯»äº†ä¸€ä¸‹ç›¸å…³çš„æ–‡æ¡£ï¼Œå†™ç¯‡å¤‡å¿˜ã€‚&lt;/p&gt;
&lt;p&gt;http ä¸­çš„è®¤è¯ä¸»è¦æ˜¯ basic auth å’Œ digest auth ä¸¤ç§ï¼Œå…¶ä¸­ digest auth æ¯”è¾ƒå¤æ‚ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰æå‡å®‰å…¨æ€§ï¼Œå·²ç»ä¸å»ºè®®ä½¿ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;RFC 7235 [1] æè¿°äº†å®¢æˆ·ç«¯ï¼ˆé€šå¸¸æ˜¯æµè§ˆå™¨ï¼‰å’ŒæœåŠ¡å™¨å¦‚ä½•é€šè¿‡httpè¿›è¡Œèº«ä»½è®¤è¯çš„ä¸€äº›æœºåˆ¶ã€‚å®¢æˆ·ç«¯å’Œ httpä»£ç†ä¹‹é—´ä¹Ÿå¯ä»¥ä½¿ç”¨ http auth æ¥åšéªŒè¯ã€‚
Â  &lt;/p&gt;
&lt;h1&gt;éªŒè¯æµç¨‹&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;å½“å®¢æˆ·ç«¯è®¿é—®ä¸€ä¸ªé¡µé¢æ—¶ï¼Œå¦‚æœåªæœ‰éªŒè¯åæ‰èƒ½è®¿é—®ï¼Œæˆ–è€…éªŒè¯åæœ‰æ›´å¤šå†…å®¹ï¼ŒæœåŠ¡å™¨åº”è¯¥å‘é€ 401 Unauthorizedï¼Œæå‡ºä¸€ä¸ªchanllengeï¼Œè®¾å®š &lt;code&gt;WWW-Authenticate&lt;/code&gt; headerï¼Œå¹¶æŒ‡å®šéªŒè¯çš„ type å’Œ realmï¼Œå…·ä½“å®šä¹‰ä¸‹æ–‡æœ‰è®²ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯è¿™æ—¶é€šå¸¸åº”è¯¥æç¤ºç”¨æˆ·è¾“å…¥å¯†é’¥ï¼Œä¸€èˆ¬æ˜¯æµè§ˆå™¨å¼¹å‡ºç”¨æˆ·åå¯†ç å¯¹è¯æ¡†ä¾›ç”¨æˆ·å¡«å†™ï¼Œç„¶åä½¿ç”¨&lt;code&gt;Authorization&lt;/code&gt; headerå‘é€éªŒè¯çš„å¯†é’¥ã€‚å¦‚æœéªŒè¯é€šè¿‡çš„è¯ï¼Œåº”è¯¥æ­£å¸¸è®¿é—®ï¼ˆ200 OKï¼‰ï¼ŒéªŒè¯é€šè¿‡ä½†æ˜¯æ²¡æœ‰æƒé™çš„è¯åº”è¯¥è¿”å› 403 Forbiddenã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœéªŒè¯ä¸é€šè¿‡ï¼Œåº”è¯¥æœåŠ¡å™¨è¿”å›401ï¼Œå®¢æˆ·ç«¯å¯ä»¥é‡è¯•ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ³¨æ„ï¼Œå¦‚æœå®¢æˆ·ç«¯å·²ç»çŸ¥é“éœ€è¦å¯†é’¥è®¿é—®ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ç›´æ¥å‘é€å¯¹åº”çš„å¯†é’¥ï¼Œè¿™æ ·å°±é¿å…äº† 401 Unauthorizedã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="MDNä¸Šçš„æµç¨‹å›¾" src="https://mdn.mozillademos.org/files/14689/HTTPAuth.png"&gt;
Â &lt;/p&gt;
&lt;h1&gt;ä»£ç†éªŒè¯çš„ä¸åŒ&lt;/h1&gt;
&lt;p&gt;å¦‚æœä»£ç†æœåŠ¡å™¨éœ€è¦éªŒè¯çš„è¯ï¼Œæµç¨‹æ˜¯ç±»ä¼¼çš„ï¼Œæœ‰ä¸¤ç‚¹ç»†èŠ‚ä¸åŒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»£ç†æœåŠ¡å™¨åº”è¯¥å‘é€407 Proxy Authentication Required è€Œä¸æ˜¯ 401ã€‚ä½¿ç”¨çš„headersä¹Ÿå˜æˆäº† Proxy-Authenticate å’Œ Proxy-Authorization ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨çš„å¤´éƒ¨ WWW-Authenticate æ˜¯ end-to-end çš„ï¼Œä¹Ÿå°±æ˜¯ä»£ç†æœåŠ¡å™¨ä¸åº”è¯¥ç¯¡æ”¹ï¼Œåº”è¯¥åŸæ ·ä¼ é€’ã€‚è€Œä»£ç†æœåŠ¡å™¨çš„Proxy-å¤´éƒ¨æ˜¯ hop-by-hop çš„ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½å‘ä¸‹ä¼ é€’ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;å®ç°ç»†èŠ‚&lt;/h1&gt;
&lt;p&gt;æœåŠ¡å™¨æˆ–è€…ä»£ç†æœåŠ¡å™¨éšç€4XXå‘é€çš„å¤´éƒ¨ä¸º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;WWW-Authenticate: &amp;lt;type&amp;gt; realm=&amp;lt;realm&amp;gt;
or
Proxy-Authenticate: &amp;lt;type&amp;gt; realm=&amp;lt;realm&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ type æŒ‡å®šäº†ä½¿ç”¨çš„éªŒè¯çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·åå’Œå¯†ç åŠ å¯†æ–¹å¼çš„ä¸åŒï¼ŒIANAé’¦å®šäº†ä¸€æ‰¹æ–¹æ³•[2]ã€‚ç„¶é¹…ï¼Œä¸€èˆ¬æ¥è¯´å¸¸ç”¨çš„åªæœ‰ä¸¤ä¸ª Basic å’Œ Digestã€‚è€Œå…¶ä¸­ Digest çš„å®ç°å¯èƒ½ä¼šè¦æ±‚æœåŠ¡å™¨æ˜æ–‡å­˜å‚¨å¯†ç ï¼Œäºæ˜¯å¤§å®¶åˆangryäº†[3]ï¼Œè¿™é‡Œä¹Ÿä¸æ¨èä½¿ç”¨ã€‚æ‰€ä»¥è¿™é‡Œåªä»‹ç» Basicç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;realm æŒ‡å®šäº†éªŒè¯çš„é¢†åŸŸï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸åŒrealmä¸‹çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä½ è®¿é—®çš„ä¸¤ä¸ªé¡µé¢åœ¨åŒä¸€ä¸ªrealmï¼Œé‚£ä¹ˆæµè§ˆå™¨åœ¨ç¬¬äºŒæ¬¡è®¿é—®å°±ä¸ä¼šé—®ä½ å¯†ç äº†ã€‚&lt;/p&gt;
&lt;p&gt;å®¢æˆ·ç«¯å‘é€å¯¹åº”çš„å¤´éƒ¨å’Œå¯†é’¥æ¥è·å¾—è®¿é—®æƒé™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Authorization: &amp;lt;type&amp;gt; &amp;lt;credentials&amp;gt;
or
Proxy-Authorization: &amp;lt;type&amp;gt; &amp;lt;credentials&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ï¼Œtypeå°±æ˜¯åˆšåˆšçš„é‚£ä¸ª Basic æˆ–è€… Digestã€‚credentials æŒ‰ç…§å¯¹åº”çš„æ–¹æ³•è®¡ç®—ã€‚å¯¹äºBasicç±»å‹ &lt;code&gt;credentials = base64(username + ':' + password)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ç”¨æˆ·åå’Œå¯†ç åˆ†åˆ«æ˜¯ï¼šaladdinå’Œopensesameã€‚é‚£ä¹ˆå®¢æˆ·ç«¯åº”è¯¥å‘é€çš„headeræ˜¯ï¼š&lt;code&gt;Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;éœ€è¦æ³¨æ„çš„åœ°æ–¹&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;å› ä¸ºhttpåè®®æœ¬èº«æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥Authåº”è¯¥æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥æ¯æ¬¡è¯·æ±‚éƒ½åº”è¯¥æºå¸¦ã€‚
Â &lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœæ˜¯httpåè®®çš„è¯ï¼Œå¯¹äºBasic Authï¼Œé‚£ä¹ˆå¯†ç éƒ½æ˜¯æ˜æ–‡å‘é€çš„ï¼Œå¯ä»¥ä½¿ç”¨httpsæ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ï¼šhttps://username:password@www.example.com/ è¿™ç§å½¢å¼æ¥é¢„å…ˆè¾“å…¥è´¦å·å¯†ç ï¼Œä½†æ˜¯è¿™ç§å½¢å¼å·²ç»ä¸é¼“åŠ±äº†ã€‚ä¸è¿‡åœ¨è®¾å®šä¸€äº›ç¯å¢ƒå˜é‡æ—¶ï¼Œæ¯”å¦‚ http_proxyï¼Œä¹Ÿåªèƒ½ç”¨è¿™ç§æ–¹æ³•æ¥åˆ¶å®šç”¨æˆ·åå’Œå¯†ç &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹åº”çš„RFC https://tools.ietf.org/html/rfc7235&lt;/li&gt;
&lt;li&gt;IANA æ³¨å†Œçš„authç±»å‹ http://www.iana.org/assignments/http-authschemes/http-authschemes.xhtml&lt;/li&gt;
&lt;li&gt;ä¸ºä»€ä¹ˆä¸è¦ä½¿ç”¨digestéªŒè¯Â  https://stackoverflow.com/questions/2384230/what-is-digest-authentication&lt;/li&gt;
&lt;li&gt;MDNçš„æ–‡ç« è¿˜æä¾›äº†å¦‚ä½•è®©apacheå’Œnginxä½¿ç”¨basic auth https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 04 Sep 2017 03:39:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-09-04:/posts/http-ren-zheng-jie-shao.html</guid><category>HTTP</category><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>xpath generator æ˜¯å¦‚ä½•å®ç°çš„?</title><link>/posts/xpath-generator-shi-ru-he-shi-xian-de.html</link><description>&lt;p&gt;å†™çˆ¬è™«çš„è¯åšåˆ°æœ€ååŸºæœ¬ä¸Šæœ€ç»ˆæ²¡æ³•è‡ªåŠ¨åŒ–çš„å°±æ˜¯æŒ‡å®šè¦æŠ½å–çš„å…ƒç´ çš„xpathäº†, è¦å®šå‘çˆ¬ä¸€ä¸ªç½‘ç«™çš„å†…å®¹åŸºæœ¬ä¸Šéƒ½ä¼šå½’ç»“åˆ°å»æ‰¾ä¸‹ä¸€é¡µå’Œæ•°æ®å…ƒç´ çš„xpath. å¦‚æœèƒ½æŠŠxpathçš„ç”Ÿæˆäº¤ç»™ä¸ä¼šå†™ç¨‹åºçš„è¿è¥åŒå­¦æ¥åšçš„è¯, èƒ½å¤Ÿæå¤§åœ°è§£æ”¾ç¨‹åºå‘˜çš„ç”Ÿäº§åŠ›.&lt;/p&gt;
&lt;p&gt;æ¯•ç«Ÿxpathä¹Ÿç®—æ˜¯ä¸€ä¸ªDSL, å¯¹äºä¸ä¼šç¼–ç¨‹çš„åŒå­¦è¿˜æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„. SQLå†™å¾—ç†Ÿç»ƒçš„PMå¤šå¾—æ˜¯, æƒ³æ‰¾ä¸€ä¸ªä¼šå†™xpathçš„è¿è¥åŒå­¦åˆ™æ˜¯å¾ˆå›°éš¾, æ¯•ç«Ÿæœ¯ä¸šæœ‰ä¸“æ”», è¿è¥éœ€è¦é¢å¯¹çš„é—®é¢˜å’Œæˆ‘ä»¬ç¨‹åºçŒ¿è¿˜æ˜¯æœ‰å¾ˆå¤§ä¸åŒ. å¤šå¹´çš„ç»éªŒ, æ„Ÿè§‰èƒ½æ•™ä¼šä»–ä»¬yamlå·²ç»æ˜¯æé™äº†...&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆèƒ½ä¸èƒ½æœ‰ä¸€ä¸ªå›¾å½¢åŒ–çš„å·¥å…·æ¥ç”Ÿæˆxpathå‘¢? ç­”æ¡ˆæ˜¾ç„¶æ˜¯æœ‰çš„, chromeæµè§ˆå™¨å°±å†…ç½®äº†ç”Ÿæˆxpathçš„å·¥å…·, å¦‚ä¸‹å›¾æ‰€ç¤º:&lt;/p&gt;
&lt;p&gt;&lt;img alt="chrome xpath" src="https://ws4.sinaimg.cn/large/006tNc79ly1flhwpu64uvj31f20keaj4.jpg"&gt;&lt;/p&gt;
&lt;p&gt;è¿™å¹…å›¾ç”Ÿæˆçš„xpathæ˜¯: &lt;code&gt;//*[@id="fc_B_pic"]/ul[1]/li[1]/a[1]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç„¶è€Œchromeçš„xpathç”Ÿæˆå´æœ‰å‡ ä¸ªç¼ºç‚¹:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;chromeçš„xpathåªä¼šæƒ³ä¸Šå»æ‰¾å¸¦æœ‰idçš„å…ƒç´ , è€Œæ ¹æ®å®é™…çš„æƒ…å†µ, å¾€å¾€æ‰¾åˆ°å¸¦æœ‰classçš„å…ƒç´ å°±å¯ä»¥ä¿è¯æ‰¾çš„xpathæ˜¯å¯¹çš„äº†.&lt;/li&gt;
&lt;li&gt;chromeç”Ÿæˆçš„å…ƒç´ æ˜¯å°½é‡ä¿è¯å…ƒç´ å”¯ä¸€çš„, ä¹Ÿå°±æ˜¯å½“ä½ æƒ³è¦æä¸€ä¸ªèƒ½èƒ½å¤Ÿé€‰ä¸­å¤šä¸ªå…ƒç´ çš„xpathæ—¶, chrome æ— èƒ½ä¸ºåŠ›, è¿˜æ˜¯éœ€è¦è‡ªå·±å»æ”¹å†™.&lt;/li&gt;
&lt;li&gt;å¦å¤–å°±æ˜¯ç”Ÿæˆä¹‹åä¸èƒ½æ–¹ä¾¿çš„ç”¨å›¾å½¢å·¥å…·å»éªŒè¯.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœªå®Œå¾…ç»­&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 20 Aug 2017 18:57:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-20:/posts/xpath-generator-shi-ru-he-shi-xian-de.html</guid><category>å¤§å‰ç«¯</category><category>æµè§ˆå™¨æ‰©å±•</category><category>è®¡ç®—æœº</category></item><item><title>å¯¹å¤´æ¡çš„æ€è€ƒ</title><link>/posts/dui-tou-tiao-de-si-kao.html</link><description>&lt;h1&gt;è¯»å¼ ä¸€é¸£å¾®åš&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯å‡è®¾æŸä½ä¸‹å±æè¾èŒï¼Œæ„Ÿå—å¦‚æ˜¯ã€å¾ˆå¯æƒœã€ã€å¾ˆåœ¨æ„ã€é‚£ä¹ˆåº”ç°åœ¨è€ƒè™‘å¦‚ä½•ç»™å¢åŠ å›æŠ¥å’Œç©ºé—´ï¼Œç›¸åï¼Œå¦‚è§‰å¾—ã€ä¹Ÿå¥½ã€ã€æ›´å¥½ã€ç”šè‡³è½»æ¾ï¼Œé‚£åº”è€ƒè™‘æ˜¯å¦åšå‡ºè°ƒå²—æˆ–è¾é€€ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶å¸¸çœ‹çœ‹æ—§é—»ï¼Œå°±çŸ¥é“åª’ä½“å¤šä¹ˆä¸é è°±&lt;/p&gt;
&lt;p&gt;å¤§å‰‘æ— é”‹å¤§å·§ä¸å·¥&lt;/p&gt;
&lt;p&gt;åœ¨å…¨ç½‘çš„ä¸ŠæŠ“å–åˆ†ææå–ä¿¡æ¯ï¼Œé‡åˆ°çš„å¤§é—®é¢˜å°±æ˜¯ spam ä»¥åŠ spam çš„é«˜çº§å½¢å¼è½¯æ–‡æˆ–è€…æªæ–‡ï¼Œpangerank æ˜¯ç½‘é¡µçš„æŠ•ç¥¨ï¼Œsns åˆ©ç”¨å¯æ ‡è¯†çš„äººè¡Œä¸ºæ¥æŠ•ç¥¨ï¼Œsns å¹³å°ä¹‹å¤–è¿˜æœ‰å¥½æ–¹æ³•å—ã€‚&lt;/p&gt;
&lt;p&gt;é£æ™¯é•¿å®œæ”¾çœ¼é‡ã€‚å¾€äº‹ä¸å¯è°ï¼Œæ¥è€…çŠ¹å¯è¿½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»–åº”è¯¥æ˜¯ä¸€ä¸ªç±»ä¼¼å¼ å°é¾™ä¸€æ ·ï¼ŒæŠ€æœ¯å‡ºèº«çš„ä¼˜ç§€çš„äº§å“ç»ç†&lt;/p&gt;
&lt;h1&gt;åæ€&lt;/h1&gt;
&lt;p&gt;é˜¿é‡Œçš„æœˆé¥¼é£æ³¢è¿‡åï¼Œä¸€é¸£å¥½åƒè¯´è¿‡ï¼šâ€œæˆ‘ä»¬ä¸­ç§‹èŠ‚å°±ä¸å‘æœˆé¥¼ï¼Œå› ä¸ºä¼˜ç§€çš„å·¥ç¨‹å¸ˆä¸ä¼šåœ¨ä¹é‚£ä¸€ç›’æœˆé¥¼çš„ã€‚â€ å…¶å®è¿™å¥è¯å°±éå¸¸å‚»ï¼Œä¼˜ç§€çš„å‘˜å·¥å¯èƒ½è¿™æ ·æƒ³ï¼šâ€œä¸€ç›’æœˆé¥¼æ‰å¤šå°‘é’±ï¼Œå…¬å¸è¿è¿™éƒ½èˆä¸å¾—ï¼Œåœ¨å…¶ä»–äº‹æƒ…ä¸Šä¼šèˆå¾—ä¸ºå‘˜å·¥ä»˜å‡ºå—ï¼Ÿâ€ã€‚æœˆé¥¼è¿™ç§ä¸œè¥¿æ˜¾ç„¶æ˜¯ ROI éå¸¸é«˜çš„ä¸€ä¸ªå‘˜å·¥ç¦åˆ©ï¼Œæ‰€ä»¥ä¸è¦ä¸ºäº†å½°æ˜¾å’Œé˜¿é‡Œä¸åŒè€Œæ•…æ„è¯´åè¯ã€‚å½“ç„¶ï¼Œå®é™…ä¸Šå¤´æ¡çš„ç¦åˆ©å¾ˆå¥½ï¼Œä¸å…‰æœ‰æœˆé¥¼ï¼Œè¿‡å¹´ä¹Ÿæœ‰ç¤¼ç‰©ã€‚&lt;/p&gt;
&lt;p&gt;Google çš„ä»·å€¼è§‚å°±å¾ˆçŸ­ï¼šDon't be evil. ä»¥è‡³äºå¤§å®¶éƒ½çŸ¥é“ã€‚è€Œç™¾åº¦çš„ä»·å€¼è§‚ä¹Ÿå¾ˆçŸ­ï¼šç®€å•å¯ä¾èµ–ã€‚è™½ç„¶ä¸ç®¡æ˜¯ Google è¿˜æ˜¯ç™¾åº¦éƒ½æ²¡æœ‰å¾ˆå¥½åœ°è·µè¡Œä»–ä»¬çš„ä»·å€¼è§‚ï¼Œä½†æ˜¯è‡³å°‘èµ·åˆ°äº†å®£ä¼ ä½œç”¨å§ã€‚å¤´æ¡çš„ä»·å€¼è§‚å¤ªé•¿äº†ï¼Œè€Œä¸”æ˜¯äº”å…­ä¸ªç‹¬ç«‹çš„è¯è¯­ï¼Œåˆ°ç°åœ¨æˆ‘éƒ½è®°ä¸ä¸‹æ¥ã€‚å¹³å‡ä¸‹æ¥å¤´æ¡å‘˜å·¥åœ¨å¤´æ¡çš„æ—¶é—´å¯èƒ½è¿ä¸¤å¹´éƒ½ä¸åˆ°ï¼Œä½ è®©äººè®°è¿™ä¹ˆé•¿ä¸€å¤§ä¸²ä¸œè¥¿ï¼Œä½ åˆä¸æ˜¯ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 16 Aug 2017 23:53:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-16:/posts/dui-tou-tiao-de-si-kao.html</guid><category>åˆ›ä¸š</category><category>è¿è¥ä¸äº§å“</category></item><item><title>çˆ¬è™«çˆ¬æ¥çš„æ•°æ®æ˜¯å¦å¯ä¿¡</title><link>/posts/pa-chong-pa-lai-de-shu-ju-shi-fou-ke-xin.html</link><description>&lt;p&gt;å¦‚æœç”¨æ¥åˆ†æçš„æ•°æ®æœ¬æ¥å°±æ˜¯é”™çš„ï¼Œé‚£ä¹ˆå¾—å‡ºçš„ç»“è®ºå¿…ç„¶ä¹Ÿæ˜¯æœ‰é—®é¢˜çš„ã€‚æ¯”å¦‚2016å¹´ç¾å›½å¤§é€‰ä¸­ï¼Œç”±äºå·æ™®çš„æ”¯æŒè€…ç»å¸¸è¢«ä¾®è¾±ï¼Œå¯¼è‡´åœ¨ç”µè¯è°ƒæŸ¥é€‰æ°‘ä¸­ï¼Œå¤§å®¶éƒ½å£°ç§°è‡ªå·±æ”¯æŒå¸Œæ‹‰é‡Œï¼Œå¯æ˜¯å®é™…ä¸Šå¤§å®¶éƒ½æŠ•ç»™äº†å·æ™®ã€‚ç”µè¯è°ƒæŸ¥çš„ç»“æœæœ¬æ¥å°±æ˜¯é”™çš„ï¼Œæ‰€ä»¥å¤§å®¶éƒ½è®¤ä¸ºå¸Œæ‹‰é‡Œä¼šèµ¢ã€‚å·æ™®å›¢é˜Ÿåˆ™é‡‡å–çš„æ˜¯é—®é€‰æ°‘ä½ è®¤ä¸ºä½ çš„é‚»å±…ä¼šæŠ•è°ï¼Œä»è€Œå¾—åˆ°äº†æ­£ç¡®ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;çˆ¬è™«çˆ¬åˆ°çš„æ•°æ®ä¸­ä¹Ÿæœ‰å¯èƒ½æ˜¯æœ‰é—®é¢˜çš„ï¼Œæ¯”å¦‚ç§Ÿæˆ¿ç½‘ç«™çš„å‡æˆ¿æºï¼Œæ‹›è˜ç½‘ç«™ä¸Šçš„è™šå‡èŒä½ï¼Œç”¨æˆ·æ•…æ„ä¸å¡«å†™çœŸå®ä¿¡æ¯ä»¥ä¿æŠ¤éšç§ç­‰ç­‰ï¼›å¾®ä¿¡æ–‡ç« è¢«åˆ·å¤šçš„é˜…è¯»æ•°ï¼›è€Œä¸”ç¼–å†™ä¸è‰¯çš„çˆ¬è™«å¾ˆå¯èƒ½è¯¯å…¥èœœç½ï¼Œå¾—åˆ°çš„æ•°æ®æ›´æœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´å€ŸåŠ©çˆ¬æ¥çš„æ–°é—»åˆ†ææˆ¿äº§æ•°æ®ï¼Œå®é™…ä¸Šä½å»ºéƒ¨ç¦æ­¢å‘å¸ƒæ¶¨ä»·ç›¸å…³é¢„æµ‹ï¼Œä¹Ÿå°±æ˜¯å¯¹äºå¸‚åœºçš„æƒ…ç»ªè¡¨è¾¾æ˜¯æœ‰å½±å“çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœæŒ‰ç…§è¿™ä¸ªæ•°æ®æ¥åšé¢„æµ‹æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 16 Aug 2017 23:25:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-16:/posts/pa-chong-pa-lai-de-shu-ju-shi-fou-ke-xin.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>åå¹´å­¦ä¼šç¼–ç¨‹</title><link>/posts/shi-nian-xue-hui-bian-cheng.html</link><description>&lt;p&gt;å¯¹ç¼–ç¨‹äº§ç”Ÿæ„Ÿå…´è¶£å¹¶å› ä¸ºä¹è¶£è€Œå†™ç¨‹åºã€‚ç¡®ä¿¡ä½ è‡ªå§‹è‡³ç»ˆéƒ½èƒ½ä¹åœ¨å…¶ä¸­ï¼Œè¿™æ ·ä½ æ‰æ„¿æ„å°†åå¹´å…‰é˜´æŠ•å…¥ç¼–ç¨‹äº‹ä¸š.&lt;/p&gt;
&lt;p&gt;ä¸å…¶ä»–ç¨‹åºå‘˜äº¤æµï¼›é˜…è¯»åˆ«äººçš„ä»£ç ã€‚è¿™æ¯”ä»»ä½•ä¹¦ä»»ä½•åŸ¹è®­éƒ½é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;è®°ä½åœ¨ â€œè®¡ç®—æœºç§‘å­¦â€ ä¸­åŒ…æ‹¬â€è®¡ç®—æœºâ€ è¿™ä¸ªè¯ã€‚è¦çŸ¥é“ä½ çš„è®¡ç®—æœºæ‰§è¡Œä¸€æ¡æŒ‡ä»¤éœ€è¦å¤šä¹…ï¼Œåˆ°å†…å­˜ä¸­å–ä¸€ä¸ªå­—éœ€è¦å¤šä¹…(ç¼“å­˜æ˜¯å¦å‡»ä¸­), åˆ°ç£ç›˜è¯»å–è¿ç»­çš„å­—éœ€è¦å¤šä¹…ï¼Œè€Œç£ç›˜çš„å®šä½åˆéœ€è¦å¤šä¹…. &lt;/p&gt;
&lt;p&gt;Fred Brooks (äººæœˆç¥è¯ä½œè€…) åœ¨ä»–çš„æ–‡ç«  æ²¡æœ‰é“¶å¼¹ ä¸­æŒ‡å‡ºï¼Œå‘æ˜å“è¶Šè½¯ä½“è®¾è®¡è€…çš„ä¸‰éƒ¨æ›²ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°½æ—©å°½å¯èƒ½åœ°ä»¥ç³»ç»ŸåŒ–çš„æ–¹å¼å‘æ˜æœ€ä½³è®¾è®¡äººå‘˜ã€‚&lt;/li&gt;
&lt;li&gt;ç»™æœ‰æ½œåŠ›è€…æŒ‡æ´¾ç”Ÿæ¶¯è§„åˆ’å¸ˆï¼Œå¹¶è°¨æ…åœ°è§„åˆ’ä»–ä»¬çš„èŒä¸šç”Ÿæ¶¯ã€‚&lt;/li&gt;
&lt;li&gt;æä¾›æœºä¼šç»™æ­£åœ¨æˆé•¿çš„ç¨‹åºå‘˜ï¼Œè®©ä»–ä»¬èƒ½ç›¸äº’å½±å“ï¼Œå½¼æ­¤æ¿€åŠ±ã€‚&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 16 Aug 2017 23:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-16:/posts/shi-nian-xue-hui-bian-cheng.html</guid><category>æƒ³æ³•</category><category>è®¡ç®—æœº</category></item><item><title>å·¦è€³æœµè€—å­çš„ç»©æ•ˆè§‚</title><link>/posts/zuo-er-duo-hao-zi-de-ji-xiao-guan.html</link><description>&lt;p&gt;åˆ¶å®šç›®æ ‡å’Œç»©æ•ˆï¼Œç›®çš„ä¸æ˜¯ç”¨æ¥è€ƒæ ¸äººçš„ï¼Œè€Œç”¨æ¥æ”¹å–„æé«˜ç»„ç»‡å’Œäººå‘˜ä¸šç»©å’Œæ•ˆç‡çš„ã€‚&lt;/p&gt;
&lt;p&gt;äººæ˜¯å¤æ‚çš„ï¼Œäººæ˜¯æœ‰çŠ¶æ€æ³¢åŠ¨çš„ï¼Œä»»ä½•æ—¶å€™éƒ½ä¸åº”è¯¥è½»æ˜“å¦å®šäººï¼Œç»©æ•ˆè€ƒæ ¸åº”è¯¥è€ƒæ ¸çš„æ˜¯äº‹æƒ…ï¼Œè€Œä¸æ˜¯äººã€‚&lt;/p&gt;
&lt;p&gt;è€ƒæ ¸ä»·å€¼è§‚æœ€å¤§çš„é—®é¢˜å°±æ˜¯éå¸¸å®¹æ˜“çš„ä¸Šçº²ä¸Šçº¿ï¼Œä¹Ÿéå¸¸å®¹æ˜“çš„è¢«åˆ¶é€ æ”¿æ²»æ–—äº‰ï¼Œä¹Ÿéå¸¸å®¹æ˜“çš„æ‰¼æ€å„ç§ä¸åŒæ€æƒ³ï¼Œè€å®è¯´ï¼Œè¿™ä»å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ä¸€ç§æ´—è„‘çš„æ‰‹æ®µâ€”â€”é€šè¿‡å¯¹äººåˆ¶é€ ä¸€ç§ç´§å¼ æˆ–ææƒ§è€Œè¾¾åˆ°æ§åˆ¶æ€æƒ³çš„ç›®çš„ã€‚&lt;/p&gt;
&lt;p&gt;KPIé€‚åˆæŠŠäººå½“æœºå™¨ç”¨çš„è¡Œä¸šï¼Œè€ŒOKRé€‚åˆäººäººéƒ½æ˜¯å…¬å¸ä¸€å‘˜çš„åˆ›æ–°è¡Œä¸šã€‚&lt;/p&gt;
&lt;p&gt;YF:
åœ¨ä¸€ä¸ªå…¬å¸é‡Œï¼Œæ¯å¤©éƒ½ä¼šäº§ç”Ÿå¾ˆå¤šæ–°çš„æƒ³æ³•ï¼Œå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªæƒ³æ³•éƒ½ä¼šè½åˆ°å®å¤„ï¼Œå› ä¸ºæœ‰çš„äººæ²¡æœ‰æ—¶é—´åšï¼Œæœ‰çš„æƒ³æ³•çº¯å±è„‘æ´å¤§å¼€ï¼Œæœ‰çš„æƒ³æ³•æœ‰å…¶ä»–ä½ç½®é—®é¢˜ä¸å¯èƒ½å®ç°ï¼Œæœ‰çš„å¯èƒ½æå‡ºçš„äººåªæœ‰ä¸ªåˆ›æ„ï¼Œå®æ–½çš„äººåšå‡ºäº†èŠ±ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰é‡å¤§çš„äº‹ï¼Œæˆ–è€…ä¸€å®šè¦åšçš„äº‹ï¼Œè¦è½åˆ°çº¸é¢ä¸Šï¼Œæœ‰æ’æœŸï¼Œè¿™æ ·æ‰èƒ½çœŸæ­£åšèµ·æ¥ã€‚å½“ç„¶å¦‚æœåšåˆ°äº†ç®¡ç†å²—ä½ï¼Œåˆ‡å¿ŒæŠŠæ‰€æœ‰äº‹éƒ½å†™ä¸‹æ¥ï¼Œå› ä¸ºå¥½å¤§ä¸€éƒ¨åˆ†æ˜¯å‰é¢æåˆ°çš„åšä¸åšæ— æ‰€è°“çš„äº‹ã€‚è¦ç»™æ¯ä¸ªäººè‡ªç”±ï¼Œæ‰èƒ½è®©ä»–ä»¬å‘æŒ¥åˆ°è‡ªå·±çš„é•¿å¤„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè¦ç”¨okrï¼Œè€Œä¸æ˜¯kpiã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 16 Aug 2017 17:04:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-16:/posts/zuo-er-duo-hao-zi-de-ji-xiao-guan.html</guid><category>talks</category></item><item><title>é˜…è¯» instagram çš„ python å‡çº§æ–‡ç« </title><link>/posts/yue-du-instagram-de-python-sheng-ji-wen-zhang.html</link><description>&lt;p&gt;åœ¨ Instagram çš„ç”¨æˆ·æ•°è¿…é€Ÿå¢é•¿çš„è¿‡ç¨‹ä¸­ï¼Œæ€§èƒ½é—®é¢˜è¿˜æ˜¯å‡ºç°äº†ï¼šæœåŠ¡å™¨æ•°é‡çš„å¢é•¿ç‡å·²ç»æ…¢æ…¢çš„è¶…è¿‡äº†ç”¨æˆ·å¢é•¿ç‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºæ­¤ï¼Œä»–ä»¬å†³å®šè·³è¿‡ Python 2 ä¸­å“ªäº›è¹©è„šçš„å¼‚æ­¥ IO å®ç° ï¼ˆå¯æ€œçš„ geventã€tornadoã€twisted ä¼—ï¼‰ï¼Œç›´æ¥å‡çº§åˆ° Python 3ï¼Œå»æ¢ç´¢æ ‡å‡†åº“ä¸­çš„ asyncio æ¨¡å—æ‰€èƒ½å¸¦æ¥çš„å¯èƒ½æ€§ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Instagramï¼Œè¿›è¡Œ Python 3 çš„è¿ç§»éœ€è¦å¿…é¡»æ»¡è¶³ä¸¤ä¸ªå‰ææ¡ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸åœæœºï¼Œä¸èƒ½æœ‰ä»»ä½•çš„æœåŠ¡å› æ­¤ä¸å¯ç”¨&lt;/li&gt;
&lt;li&gt;ä¸èƒ½å½±å“äº§å“æ–°ç‰¹æ€§çš„å¼€å‘&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 16 Aug 2017 17:03:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-16:/posts/yue-du-instagram-de-python-sheng-ji-wen-zhang.html</guid><category>talks</category></item><item><title>Dropbox CEO's speech</title><link>/posts/dropbox-ceos-speech.html</link><description>&lt;p&gt;Dropbox CEO's speech&lt;/p&gt;
&lt;p&gt;Bill Gates's first company made software for traffic lights. Steve Jobs's first company made plastic whistles that let you make free phone calls. Both failed, but it's hard to imagine they were too upset about it. That's my favourite thing that changes today. You no longer carry around a number indicating the sum of all your mistakes. From now on, failure doesn't matter: you only have to be right once.&lt;/p&gt;
&lt;p&gt;So thatâ€™s how 30,000 ended up on the cheat sheet. That night, I realised there are no warmups, no practice rounds, no reset buttons. Every day we're writing a few more words of a story. And when you die, it's not like "here lies Drew, he came in 174th place." So from then on, I stopped trying to make my life perfect, and instead tried to make it interesting. I wanted my story to be an adventure â€” and that's made all the difference.&lt;/p&gt;
&lt;p&gt;And today on your commencement, your first day of life in the real world, that's what I wish for you. Instead of trying to make your life perfect, give yourself the freedom to make it an adventure, and go ever upward. Thank you.&lt;/p&gt;
&lt;p&gt;It took me a while to get it, but the hardest-working people don't work hard because they're disciplined. They work hard because working on an exciting problem is fun. So after today, it's not about pushing yourself; it's about finding your tennis ball, the thing that pulls you. It might take a while, but until you find it, keep listening for that little voice.&lt;/p&gt;
&lt;p&gt;Fortunately, it doesn't matter. No one has a 5.0 in real life. In fact, when you finish school, the whole notion of a GPA just goes away. When you're in school, every little mistake is a permanent crack in your windshield. But in the real world, if you're not swerving around and hitting the guard rails every now and then, you're not going fast enough. Your biggest risk isn't failing, it's getting too comfortable.&lt;/p&gt;
&lt;p&gt;Honestly, I don't think I've ever been "ready." I remember the day our first investors said yes and asked us where to send the money. For a 24 year old, this is Christmas â€” and opening your present is hitting refresh over and over on bankofamerica.com and watching your company's checking account go from 60 dollars to 1.2 million dollars. At first I was ecstatic â€” that number has two commas in it! I took a screenshot â€” but then I was sick to my stomach. Someday these guys are going to want this back. What the hell have I gotten myself into?&lt;/p&gt;
&lt;p&gt;They say that you're the average of the 5 people you spend the most time with. Think about that for a minute: who would be in your circle of 5? I have some good news: MIT is one of the best places in the world to start building that circle. If I hadn't come here, I wouldn't have met Adam, I wouldn't have met my amazing cofounder, Arash, and there would be no Dropbox.&lt;/p&gt;
&lt;p&gt;And now your circle will grow to include your coworkers and everyone around you. Where you live matters: thereâ€™s only one MIT. And there's only one Hollywood and only one Silicon Valley. This isn't a coincidence: for whatever you're doing, there's usually only one place where the top people go. You should go there. Donâ€™t settle for anywhere else. Meeting my heroes and learning from them gave me a huge advantage. Your heroes are part of your circle too â€” follow them. If the real action is happening somewhere else, move.&lt;/p&gt;
&lt;p&gt;One thing I've learned is surrounding yourself with inspiring people is now just as important as being talented or working hard. Can you imagine if Michael Jordan hadnâ€™t been in the NBA, if his circle of 5 had been a bunch of guys in Italy? Your circle pushes you to be better, just as Adam pushed me.&lt;/p&gt;
&lt;p&gt;I was thrilled for him, but it was a shock for me. Here was my faithful beer pong partner and my little brother in the fraternity, two years younger than me. I was out of excuses. He was off to the Super Bowl and I wasn't even getting drafted. He had no idea at the time, but Adam had given me just the kick I needed. It was time for a change.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 15 Aug 2017 09:25:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-15:/posts/dropbox-ceos-speech.html</guid><category>talks</category></item><item><title>çˆ¬è™«å¦‚ä½•å°½é‡æ¨¡æ‹Ÿæµè§ˆå™¨</title><link>/posts/pa-chong-ru-he-jin-liang-mo-ni-liu-lan-qi.html</link><description>&lt;h1&gt;http headers&lt;/h1&gt;
&lt;p&gt;å‘é€httpè¯·æ±‚æ—¶ï¼ŒHost, Connection, Accept, User-Agent, Referer, Accept-Encoding, Accept-Languageè¿™ä¸ƒä¸ªå¤´å¿…é¡»æ·»åŠ ï¼Œå› ä¸ºæ­£å¸¸çš„æµè§ˆå™¨éƒ½ä¼šæœ‰è¿™7ä¸ªå¤´ã€‚
Â 
å…¶ä¸­ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Hostä¸€èˆ¬å„ç§åº“éƒ½å·²ç»å¡«å……äº†&lt;/li&gt;
&lt;li&gt;Connectionå¡«Keep-Alive&lt;/li&gt;
&lt;li&gt;Acceptä¸€èˆ¬å¡«text/html æˆ–è€…application/json&lt;/li&gt;
&lt;li&gt;User-Agentä½¿ç”¨è‡ªå·±çš„çˆ¬è™«æˆ–è€…ä¼ªé€ æµè§ˆå™¨çš„UA&lt;/li&gt;
&lt;li&gt;Refererä¸€èˆ¬å¡«å½“å‰URLå³å¯ï¼Œè€ƒè™‘æŒ‰ç…§çœŸæ˜¯è®¿é—®é¡ºåºæ·»åŠ refererï¼Œåˆå§‹çš„refererå¯ä»¥ä½¿ç”¨googleã€‚&lt;/li&gt;
&lt;li&gt;Accept-Encoding ä»gzipå’Œdeflateä¸­é€‰ï¼Œå¥½å¤šç½‘ç«™ä¼šå¼ºè¡Œè¿”å›gzipçš„ç»“æœ&lt;/li&gt;
&lt;li&gt;Aceept-Languageæ ¹æ®æƒ…å†µé€‰æ‹©ï¼Œæ¯”å¦‚zh-CN, en-US&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;cookies&lt;/h1&gt;
&lt;p&gt;cookieæ˜¯éœ€è¦æ›´æ–°çš„
Â &lt;/p&gt;
&lt;h1&gt;others&lt;/h1&gt;
&lt;p&gt;å¯èƒ½æœ‰ä¸€äº›äººç±»ä¸å¯è§çš„é™·é˜±é“¾æ¥ï¼Œä¸è¦è®¿é—®è¿™äº›é“¾æ¥&lt;/p&gt;
&lt;h1&gt;çˆ¬å–é—´éš”è‡ªé€‚åº”&lt;/h1&gt;
&lt;p&gt;å°±æ˜¯å·²ç»é™åˆ¶äº†ä½ è¿™ä¸ªIPçš„æŠ“å–ï¼Œå°±ä¸è¦å‚»å‚»é‡å¤è¯•ï¼Œæ€ä¹ˆä¹Ÿå¾—ä¼‘æ¯ä¸€ä¼šã€‚ç½‘æ˜“äº‘éŸ³ä¹æ“ä½œèµ·æ¥æ¯”è¾ƒç®€å•ï¼Œsleepä¸€ä¸‹å°±å¥½äº†ã€‚å…¶å®sleepçš„é—´éš”åº”è¯¥æŒ‰æƒ…å†µç´¯åŠ ï¼Œæ¯”å¦‚ç¬¬ä¸€æ¬¡sleep 10ç§’ï¼Œå‘ç°è¿˜æ˜¯è¢«çº¦æŸã€‚é‚£ä¹ˆä¹…sleep 20ç§’... è¿™ä¸ªé—´éš”çš„è®¾ç½®å·²ç»è‡ªé€‚åº”çš„æœ€ç»ˆæ•ˆæœæ˜¯ç»éªŒå€¼ã€‚&lt;/p&gt;
&lt;p&gt;ref&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;http://www.cnblogs.com/jexus/p/5471665.html&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 14 Aug 2017 22:21:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-14:/posts/pa-chong-ru-he-jin-liang-mo-ni-liu-lan-qi.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>IPython main features</title><link>/posts/ipython-main-features.html</link><description>&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;use &lt;code&gt;?&lt;/code&gt; to get quick help, and use &lt;code&gt;??&lt;/code&gt; provides additional detail).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Searching through modules and namespaces with * wildcards, both when using the ? system and via the %psearch command.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;magic commands, % or %% prefixed commands&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Alias facility for defining your own system aliases.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Lines starting with ! are passed directly to the system shell, and using !! or var = !cmd captures shell output into python variables for further use.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;python variable prefixed with $ is expanded. A double $$ allows passing a literal $ to the shell (for access to shell and environment variables like PATH).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Filesystem navigation, via a magic %cd command, along with a persistent bookmark system (using %bookmark) for fast access to frequently visited directories.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A lightweight persistence framework via the %store command, which allows you to save arbitrary Python variables. These get restored when you run the %store -r command.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Automatic indentation and highlighting of code as you type (through the prompt_toolkit library).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;%macro command. Macros can be stored persistently via %store and edited via %edit.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Session logging (you can then later use these logs as code in your programs). Logs can optionally timestamp all input, and also store session output (marked as comments, so the log remains valid Python source code).
Session restoring: logs can be replayed to restore a previous session to the state where you left it.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Auto-parentheses via the %autocall command: callable objects can be executed without parentheses: sin 3 is automatically converted to sin(3)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Auto-quoting: using &lt;code&gt;,&lt;/code&gt;, or &lt;code&gt;;&lt;/code&gt; as the first character forces auto-quoting of the rest of the line: &lt;code&gt;,my_function a b&lt;/code&gt; becomes automatically &lt;code&gt;my_function("a","b")&lt;/code&gt;, while ;my_function a b becomes my_function("a b").&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Extensible input syntax. You can define filters that pre-process user input to simplify input in special situations. This allows for example pasting multi-line code fragments which start with &amp;gt;&amp;gt;&amp;gt; or ... such as those from other python sessions or the standard Python documentation.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Flexible configuration system. It uses a configuration file which allows permanent setting of all command-line options, module loading, code and file execution. The system allows recursive file inclusion, so you can have a base file with defaults and layers which load other customizations for particular projects.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Embeddable. You can call IPython as a python shell inside your own python programs. This can be used both for debugging code or for providing interactive abilities to your programs with knowledge about the local namespaces (very useful in debugging and data analysis situations).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Easy debugger access. You can set IPython to call up an enhanced version of the Python debugger (pdb) every time there is an uncaught exception. This drops you inside the code which triggered the exception with all the data live and it is possible to navigate the stack to rapidly isolate the source of a bug. The %run magic command (with the -d option) can run any script under pdbâ€™s control, automatically setting initial breakpoints for you. This version of pdb has IPython-specific improvements, including tab-completion and traceback coloring support. For even easier debugger access, try %debug after seeing an exception.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Profiler support. You can run single statements (similar to profile.run()) or complete programs under the profilerâ€™s control. While this is possible with standard cProfile or profile modules, IPython wraps this functionality with magic commands (see %prun and %run -p) convenient for rapid interactive work.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Simple timing information. You can use the %timeit command to get the execution time of a Python statement or expression. This machinery is intelligent enough to do more repetitions for commands that finish very quickly in order to get a better estimate of their running time.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;In [1]: %timeit 1+1
10000000 loops, best of 3: 25.5 ns per loop

In [2]: %timeit [math.sin(x) for x in range(5000)]
1000 loops, best of 3: 719 Âµs per loop
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To get the timing information for more than one expression, use the %%timeit cell magic command.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Doctest support. The special %doctest_mode command toggles a mode to use doctest-compatible prompts, so you can use IPython sessions as doctest code. By default, IPython also allows you to paste existing doctests, and strips out the leading &amp;gt;&amp;gt;&amp;gt; and ... prompts in them.&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 13 Aug 2017 03:31:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-13:/posts/ipython-main-features.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>å›¾çµå¥–è·å¾—è€…John Hopcroptè®²åº§</title><link>/posts/tu-ling-jiang-huo-de-zhe-john-hopcroptjiang-zuo.html</link><description>&lt;h1&gt;revolutions&lt;/h1&gt;
&lt;p&gt;agri revolutions 10000BC&lt;/p&gt;
&lt;p&gt;industrial revolution 1700 AD&lt;/p&gt;
&lt;p&gt;information revolution 2015 AD&lt;/p&gt;
&lt;h1&gt;jobs&lt;/h1&gt;
&lt;p&gt;there used to be elevator operators, but this job disappears, so will drivers&lt;/p&gt;
&lt;p&gt;what if 25% of the work force will be needed to produce all the goods and services&lt;/p&gt;
&lt;p&gt;we are living in a changing world, job in the future will require a sophisticated education well beyond that available today&lt;/p&gt;
&lt;h1&gt;China's education&lt;/h1&gt;
&lt;h1&gt;deep learning&lt;/h1&gt;
&lt;p&gt;many layered network, the first layers learn it's a image, the older layers learn the style and content but lose the iamge pixels&lt;/p&gt;
&lt;p&gt;SVM is a big advance, deep networks is a big advance, but we don't under deep networks&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 08 Aug 2017 17:06:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-08:/posts/tu-ling-jiang-huo-de-zhe-john-hopcroptjiang-zuo.html</guid><category>talks</category></item><item><title>å°æµ·æ˜Ÿçš„ç‹è€…è£è€€æ”»ç•¥</title><link>/posts/xiao-hai-xing-de-wang-zhe-rong-yao-gong-lue.html</link><description>&lt;h1&gt;é€‰äºº&lt;/h1&gt;
&lt;p&gt;è‰¯å¥½çš„å¼€å§‹æ˜¯æˆåŠŸçš„ä¸€åŠï¼Œå¦‚æœåœ¨é€‰äººé˜¶æ®µå°±ä¸å’Œè°ï¼ŒåŸºæœ¬å°±è¾“äº†ä¸€åŠäº†ã€‚
ä¸€èˆ¬ä¸€ä¸ªé˜Ÿä¼å¿…é¡»è¦çš„è§’è‰²æ˜¯å¦å…‹ã€å°„æ‰‹ã€æ³•å¸ˆã€‚è™½ç„¶è¯´ä¸ç»å¯¹ï¼Œä½†æ˜¯å¦‚æœä½ æ˜¯é«˜æ‰‹ä¼°è®¡å°±ä¸ä¼šæ¥çœ‹æ”»ç•¥äº†ï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸‰è€…æ˜¯ç¼ºä¸€ä¸å¯çš„ã€‚å¦‚æœä½ å¾ˆæƒ³ç©æŸä¸ªè‹±é›„ï¼Œè¯·ç›´æ¥å…ˆé€‰ï¼Œä¸€èˆ¬æ¥è¯´åé€‰çš„äººæœ‰è´£ä»»æ ¹æ®é˜µå®¹å»è¡¥ä½ï¼Œåƒä¸‡ä¸è¦æ‹–åˆ°æœ€åä¸€åˆ»ç»“æœé€‰äº†ä¸€ä¸ªå´©æºƒçš„é˜µå®¹ã€‚å½“ç„¶æ¸¸æˆçš„é£æ°”åŸºæœ¬ä¸Šæ³•å¸ˆå’Œå°„æ‰‹éƒ½ä¼šè¢«æŠ¢ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœä½ æƒ³èµ¢ï¼Œè¯·è¿˜æ˜¯è¡¥ä¸Šå¦å…‹å§ã€‚å…¶å®è¿™ç§äº‹ä¹Ÿå°±ä½ç«¯å±€å®¹æ˜“å‡ºï¼Œåªè¦åˆ†æ•°ç¨å¾®é«˜ä¸€ç‚¹ï¼Œå¤§å®¶éƒ½æ‡‚ï¼Œåªè¦æ˜¯ä¸ºäº†èµ¢è€Œä¸æ˜¯èµŒæ°”çš„è¯ï¼Œéƒ½ä¼šæ ¹æ®é˜µå®¹æ¢åˆé€‚çš„è‹±é›„çš„ã€‚æˆ‘ç†è§£å¤§å®¶å°é²œçš„å¿ƒæƒ…ï¼Œä¸è¿‡æ–°æ‰‹å°½é‡è¿˜æ˜¯ä¸è¦é¢‘ç¹æ¢ä¸ä¼šç”¨çš„è‹±é›„å‘äººå‘å·±ï¼Œå°½é‡æ¯ä¸ªä½ç½®çš„è‹±é›„éƒ½ç†Ÿä¸€ä¸ªï¼Œè¿™æ ·ä¸è®ºæ˜¯å´å“ªä¸ªä½ç½®éƒ½æœ‰çš„é€‰ã€‚æ—¢ç„¶æ˜¯è®¤çœŸç”¨é‚£å‡ ä¸ªè‹±é›„ï¼Œå½“ç„¶å¯ä»¥æœä¸€ä¸‹è‹±é›„æ€ä¹ˆç”¨ï¼Œå€’ä¸ç”¨åƒå­¦ä¹ ä¸€æ ·è®¤çœŸï¼Œä½†æ˜¯äº†è§£ä¸€ä¸‹åˆ«äººçš„ä½¿ç”¨ç»éªŒæ€»æ¯”è‡ªå·±æ‘¸ç´¢è¦å¼ºå¾ˆå¤šï¼Œå¦‚æœå¯¹é¢é€‰äº†è·Ÿä½ åŒæ ·çš„è‹±é›„è¿˜ç”¨çš„æ¯”ä½ å¥½ï¼Œè¦å¤šå­¦ä¹ ä¸€ä¸‹åˆ«äººçš„æ€è·¯å’Œè¿æ‹›ç­‰ç­‰ã€‚
é™¤äº†é‚£3ä¸ªä½ç½®ä¹‹å¤–ï¼Œè¿˜æœ‰åˆºå®¢å’Œè¾…åŠ©å¯ä»¥é€‰ï¼Œå®šä½å¤šæ ·æ€§æ˜¯å¥½çš„ï¼Œä½†å¾ˆå¤šåˆºå®¢è‹±é›„å¯¹æ–°æ‰‹æ¥è¯´ä¸Šæ‰‹æœ‰éš¾åº¦ï¼Œå®åœ¨ä¸è¡Œé€‰ä¸ªè‡ªå·±ç†Ÿç»ƒçš„å…¶å®ƒä½ç½®ï¼Œé˜Ÿå‹é€šå¸¸ä¹Ÿä¸ä¼šè¯´ä½ ä»€ä¹ˆçš„ï¼›é«˜ç«¯å±€ä¸æ˜¯è¿™æ ·ï¼Œä½†ä¹Ÿæ²¡å¿…è¦æ¥çœ‹æ”»ç•¥äº†- -ã€‚
å¬å”¤å¸ˆæŠ€èƒ½è¿™ä¸ªå› äººè€Œå¼‚ï¼Œä½†å…³é”®è¿˜æ˜¯è®²ç©¶å’Œè‹±é›„æœ¬èº«æŠ€èƒ½å’Œå®šä½çš„é…åˆï¼Œè™½ç„¶æ²¡æœ‰ç¡¬æ€§è¦æ±‚ï¼Œä½†æ˜¯ä¾‹å¦‚æˆ‘å°±æ˜¯å–œæ¬¢é—ªç°æˆ‘ä»€ä¹ˆè‹±é›„éƒ½å¸¦é—ªç°ï¼Œè¿™å¹¶ä¸æ˜¯ä¸å¯ä»¥ï¼Œä½†æ˜¯å¿ƒæ€å°±æ˜¯é”™çš„ã€‚æŸäº›è¾…åŠ©å¯èƒ½æ‹¿ä¸ªæ²»ç–—æœ¯ï¼ŒæŸäº›å¦å…‹å’Œè¾“å‡ºä¸è¶³çš„æˆ˜å£«å¯ä»¥æ‹¿æ–©æ€ï¼Œä½ç§»æŠ€èƒ½ä¸å¤Ÿå¼ºçš„åˆºå®¢å¯ä»¥æ‹¿æ€¥é€Ÿæˆ–é—ªç°ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;h1&gt;å¼€å±€åˆ†è·¯&lt;/h1&gt;
&lt;p&gt;é€šå¸¸çš„æ€è·¯ï¼Œçªè¿›å‹å¦å…‹ã€æˆ˜å£«ã€æ¯”è¾ƒè‚‰çš„åˆºå®¢éƒ½æ˜¯å•èµ°ä¸Šè·¯ï¼Œåˆºå®¢æˆ–è€…æˆ˜å£«æ‰“é‡ï¼Œæ³•å¸ˆèµ°ä¸­è·¯ï¼Œå°„æ‰‹å’Œè¾…åŠ©èµ°ä¸‹è·¯ã€‚è¾…åŠ©ä¸ä¸€å®šæ˜¯å®šä½ä¸ºè¾…åŠ©çš„è‹±é›„ï¼Œåƒå‰æœŸè¾ƒå¼±åŠ¿çš„å¦å…‹ã€æ³•å¸ˆç­‰éƒ½å¯ä»¥å’Œå°„æ‰‹ä¸€èµ·èµ°ä¸‹è·¯ã€‚
å½“ç„¶é˜µå®¹ä¹Ÿæ˜¯åƒå¥‡ç™¾æ€ªï¼Œå…³é”®æ˜¯æ ¹æ®è¿™ä¸ªæ€è·¯åˆ†è·¯å°±è¡Œã€‚å°„æ‰‹ä¸€ç›´éå¸¸è„†å¼±ï¼ŒåæœŸéœ€è¦å®ƒè¾“å‡ºå¾ˆé«˜ï¼Œå¦åˆ™å®ƒå°±æ²¡æœ‰ç”¨å•Šï¼Œæ‰€ä»¥ä¸€èˆ¬è·Ÿé˜Ÿå‹ä¸€èµ·å¸¦çº¿ã€‚è€Œæœ‰äº›è‹±é›„å¯èƒ½å‰æœŸå¹¶ä¸éœ€è¦å®ƒè¿…é€Ÿå‘åŠ›ï¼Œæˆ–è€…ä»å§‹è‡³ç»ˆéƒ½åªè¦æ”¾æ”¾æ§åˆ¶æŠ€èƒ½å°±å¥½ï¼Œè¿™æ ·çš„è‹±é›„ä¸€èˆ¬åœ¨å¼€å±€æ˜¯è¦è¾…åŠ©å°„æ‰‹çš„ã€‚åœ¨å°„æ‰‹ã€åˆºå®¢ã€å¦å…‹çš„è£…å¤‡éƒ½æ²¡æœ‰å¤ªæˆå‹çš„æ—¶å€™ï¼Œæ³•å¸ˆçš„æŠ€èƒ½æ”¾çš„å¿«ï¼Œä¼¤å®³ä¹Ÿä¸ä½ï¼Œæˆä¸ºäº†æˆ˜åœºå…³é”®ï¼Œæ‰€ä»¥ä¸€èˆ¬è®©æ³•å¸ˆèµ°ä¸­è·¯ï¼Œä¸­æœŸå¯ä»¥å¸¦åŠ¨å…¨åœºï¼Œè€Œä¸”ä¸­è·¯ä¸¤è¾¹çš„è‰ä¸›ä¹Ÿæ¯”è¾ƒå±é™©ï¼Œéœ€è¦ä¸€ä¸ªå•æ‰“èƒ½åŠ›å¼ºçš„è‹±é›„ã€‚ä¸Šè·¯é€šå¸¸ä¼šç¢°åˆ°å¯¹é¢çš„å°„æ‰‹åŠ è¾…åŠ©çš„ç»„åˆï¼Œæƒ³å ä¾¿å®œä¸æ˜¯ç‰¹åˆ«å®¹æ˜“ï¼Œæ‰€ä»¥å°±ç”±è¡€é‡é«˜çš„è‹±é›„æŠ—å‹ã€‚é‡åŒºèµ„æºä¹Ÿæ˜¯æ¸¸æˆä¸­å¾ˆé‡è¦çš„èµ„æºï¼Œæ‰“é‡ç›¸å¯¹å®‰å…¨ï¼Œåˆºå®¢åæœŸçš„è¾“å‡ºä¹Ÿæ˜¯ç›¸å½“éœ€è¦çš„ï¼Œå¦‚æœä¸­æœŸæ²¡æœ‰è¾“å‡ºæŠ¢ä¸ä¸Šå‡ ä¸ªäººå¤´ï¼ŒåæœŸæ€ä¸æ­»äººå°±åºŸäº†ï¼Œæ‰€ä»¥åˆºå®¢ä¸€èˆ¬ä¸æŠ—å‹ï¼Œè€Œæ˜¯é€‰æ‹©æ‰“é‡ã€‚1çº§æ‰“é‡æœ‰ç‚¹å›°éš¾ï¼Œä¸€èˆ¬éƒ½ä¼šå«é˜Ÿå‹å¸®å¿™æ‰“çº¢buffï¼Œä¸€èˆ¬è¿˜æ˜¯ä¸è¦è·Ÿæ‰“é‡çš„äººæŠ¢buffã€‚è‡³äºæ‰“é‡ï¼Œä¸€ä¸ªäººåœ¨ä¸¤ç‰‡é‡åŒºæ¥å›åˆ·åº”è¯¥æ˜¯å¯è¡Œçš„ï¼Œå°½é‡åˆ«ä¸¤ä¸ªäººéƒ½æ‰“é‡ï¼Œæ¯äººä¸€ç‰‡é‡åŒºä¸å¤Ÿåˆ†çš„ï¼Œå·±æ–¹å°„æ‰‹è¿˜è¦å»æŠ—å‹ï¼Œå¾—ä¸å¿å¤±ã€‚å¦‚æœé˜Ÿå‹æœ‰ç©ºçš„è¯å€’æ˜¯å¯ä»¥å¸®å¿™æ‰“å°é¾™ï¼ˆæš´å›ï¼‰ï¼Œå‰æœŸæ‰“é¾™è¿˜æ˜¯æŒºä¼¤çš„ï¼Œè¯¥è·‘å°±è·‘ï¼Œæ‰“é¾™é€šå¸¸è¦çœ‹å…µçº¿ï¼Œå¦‚æœé¾™ä¸¤ä¾§çš„ä¸¤è·¯å…µçº¿é˜Ÿå‹éƒ½æ˜¯åŠ£åŠ¿è¢«å µåœ¨å¡”ä¸‹ä¸æ•¢å‡ºå»ï¼Œè¿™ä¸ªæ—¶å€™æ‰“é¾™æ˜¯éå¸¸å±é™©çš„ï¼Œå°½é‡ä¸è¦æ‰“ã€‚&lt;/p&gt;
&lt;h1&gt;ä»€ä¹ˆæ˜¯æˆ˜å£«&lt;/h1&gt;
&lt;p&gt;æ¯”åˆºå®¢è‚‰ï¼Œæ¯”å¦å…‹è¾“å‡ºé«˜&lt;/p&gt;
&lt;h1&gt;å¦‚ä½•ä½¿ç”¨å¦å…‹&lt;/h1&gt;
&lt;p&gt;å¦å…‹ä¸€èˆ¬ä¸¤ä¸ªæ´»ï¼Œä¸€ç§æ˜¯ç»•ååˆ«è¢«å‘ç°ï¼Œé˜Ÿå‹ä¸€äº¤ç«æ³¨æ„åŠ›è¢«å¸å¼•é©¬ä¸Šå°±è´´ä¸Šå»æ‰“å¯¹é¢å°„æ‰‹å’Œå¥½æ€çš„æ³•å¸ˆï¼Œè®©å¯¹æ–¹è¾“å‡ºé«˜çš„å°„æ‰‹å’Œæ³•å¸ˆæ€»æ˜¯æ‰¾ä¸åˆ°ä½ç½®è¾“å‡ºï¼Œåˆ†éš”æˆ˜åœºï¼Œä¸€æ‰“2çš„è¯é˜Ÿå‹æš‚æ—¶å°±æ˜¯4æ‰“3ï¼Œä¸è¿‡å¿«æ²¡è¡€çš„æ—¶å€™æ³¨æ„è¦ç•™ä¸‹è·‘è·¯çš„æŠ€èƒ½ã€‚
å¦ä¸€ç§æ˜¯å¯¹é¢åˆºå®¢å·²ç»æ¥æ‰“æˆ‘ä»¬çš„å°„æ‰‹äº†ï¼Œç”¨æ§åˆ¶å’Œå‡é€ŸæŠ€èƒ½æ‹–ä½å°„æ‰‹ï¼Œè®©å®ƒå°½å¿«è§£å†³æ‰åˆºå®¢ã€‚&lt;/p&gt;
&lt;h1&gt;å¦å…‹åå­—çš„ç”±æ¥&lt;/h1&gt;
&lt;p&gt;ä¸€å¼€å§‹ç½‘æ¸¸é‡Œé¢çš„æˆ˜å£«ç‰§å¸ˆæ³•å¸ˆä½“ç³»ï¼Œè‚‰ç›¾ï¼Œæ²»ç–—ï¼Œè¾“å‡ºä¸‰ç§ä¸»è¦è§’è‰²ã€‚åæ­£åœ¨é­”å…½ä¸–ç•Œé‡Œä¸€ç›´å«å¦å…‹çš„ï¼Œå¤–å›½äººä¹Ÿæ˜¯è¿™ä¹ˆå«çš„ã€‚åæ¥æ¸¸æˆé‡Œç›´æ¥éƒ½è¿™ä¹ˆå†™äº†ã€‚
åœ¨mobaæ¸¸æˆä¸­ï¼Œè¿™3ç§è§’è‰²ç»†åˆ†å‡ºå¾ˆå¤šå®šä½ã€‚
å¦å…‹ã€æˆ˜å£«ã€åˆºå®¢ã€‚ä»è‚‰åˆ°è¾“å‡ºçš„ä¸€ç§å¹³è¡¡ã€‚èµµäº‘å±äºæˆ˜å£«/åˆºå®¢ï¼Œæœ€èµ·ç æ¸¸æˆè¯´æ˜é‡Œæ˜¯è¿™ä¹ˆå†™çš„- -ã€‚
è¾“å‡ºé‡Œé¢åˆ†ç‰©ç†å’Œæ³•æœ¯ä¸¤æ¡è·¯çº¿ï¼Œè¿™ä¹Ÿæ˜¯å¯¹å¦å…‹å‡ºè£…è·¯çº¿çš„ä¸€ä¸ªåšå¼ˆã€‚è¿œç¨‹çš„å°±æ˜¯å°„æ‰‹å’Œæ³•å¸ˆï¼Œè¿‘æˆ˜çš„æ˜¯åˆºå®¢ã€‚
mobaæ¸¸æˆé‡Œä¸€èˆ¬éƒ½æ˜¯è¾…åŠ©ï¼Œæ²»ç–—åªæ˜¯å…¶ä¸­æ¯”è¾ƒå°çš„åˆ†æ”¯ï¼Œæ¯•ç«Ÿå¦‚æœéƒ½æ²»ç–—æ»¡äº†æ‰“ä¸æ­»é‚£è¿˜ç©æ¯›å•Šã€‚è¾…åŠ©ä¸€èˆ¬æ˜¯åŠ çŠ¶æ€ã€æ§åˆ¶ã€æ²»ç–—ã€‚è¾…åŠ©å¯ä»¥å’Œå¦å…‹ã€æˆ˜å£«ã€æ³•å¸ˆç­‰ç»“åˆä¸€ä¸‹ï¼ŒåƒèŠˆæœˆèåˆå¦å…‹å’Œæ³•å¸ˆï¼Œè”¡æ–‡å§¬æ²»ç–—å’Œæ§åˆ¶ï¼Œåº„å‘¨ä¹Ÿæ˜¯å¦å…‹åŠ æ³•å¸ˆã€‚&lt;/p&gt;
&lt;h1&gt;å¤§å±€è§‚&lt;/h1&gt;
&lt;p&gt;æˆ‘è§‰å¾—å¾ˆå¤šé˜Ÿå‹æ‰“çš„éƒ½æ²¡æœ‰å¤§å±€è§‚ï¼Œå…¶å®æ— éå°±æ˜¯é æ“ä½œã€é è„‘å­ã€é ç»éªŒã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¼˜åŠ¿æ‹†ä¸äº†é«˜åœ°å¡”ï¼Œå·±æ–¹è¾“å‡ºå¤Ÿçš„è¯åº”è¯¥æ‰“é¾™ï¼Œå°†ä¼˜åŠ¿è½¬åŒ–ä¸ºæ”»åŠ¿ã€‚&lt;/li&gt;
&lt;li&gt;ä¼˜åŠ¿è¦å¼ºåŠ¿ï¼Œå°½é‡æ‹†å¡”ï¼Œå‹åˆ¶å¯¹æ–¹æ‰“å…µå’Œæ‰“é‡ï¼Œå‹åˆ¶ç»æµï¼Œä¿è¯ç¦»èƒœåˆ©æ›´è¿‘ï¼Œå½“ç„¶æˆ˜ç•¥ä¸Šä¼˜å…ˆä¿è¯æ´»ç€ï¼Œæ“ä½œå¤±è¯¯æ­»äº†å°±ç½¢äº†ï¼Œåˆ«çœ‹å¯¹æ–¹å¥½å‡ ä¸ªæ®‹è¡€å°±æ€»æƒ³ä¸Šï¼Œä¸Šä¹‹å‰ä¸€å®šè¦æƒ³å¥½æ€ä¹ˆå›æ¥ï¼›åŠ£åŠ¿å°½å¯èƒ½ä¸é²è½å¼€æˆ˜ï¼Œæ‰¾æœºä¼šæ‰“é‡å¸¦çº¿ï¼Œç¼©å°å·®è·ï¼Œç­‰å¾…æ—¶æœºã€‚&lt;/li&gt;
&lt;li&gt;æ‰“é¾™è¢«çœ‹è§ä¹Ÿåˆ†å‡ ç§æƒ…å†µï¼ŒçŠ¶æ€ä¸å¥½ä¸€å®šè¦è·‘ã€‚å¯¹é¢è™è§†çœˆçœˆçš„æƒ…å†µä¸‹ï¼Œæ‰“é¾™å¾ˆéš¾ï¼Œä½†æ˜¯é˜²æ­¢å¯¹é¢æ‰“åº”è¯¥æ¯”è¾ƒå®¹æ˜“ã€‚å¦‚æœç¡®å®æˆ‘æ–¹äººæ•°å ä¼˜å¦å…‹åˆºå®¢ä¹‹ç±»çš„åº”è¯¥æœ‰è´£ä»»å»æ‰“å¯¹é¢æ¥éªšæ‰°çš„äººã€‚&lt;/li&gt;
&lt;li&gt;é™¤äº†æœ€å¤–é¢çš„å¡”ï¼Œå…¶å®ƒçš„å¡”èƒ½å®ˆå°½é‡å®ˆï¼Œç‰¹åˆ«æ˜¯é«˜åœ°çš„å¡”ã€‚å¯¹é¢æœ‰å¤§é¾™çš„æƒ…å†µä¸‹ï¼Œå°½é‡æ‹–åˆ°å¤§é¾™ç»“æŸã€‚å·±æ–¹åˆšæ‰“å®Œå¤§é¾™å°½é‡ç­‰é¾™å‡ºæ¥äº†å†å¼€æˆ˜ï¼Œè¦ä¸ä¸‡ä¸€å›¢æˆ˜è¾“äº†é¾™éƒ½æµªè´¹äº†ï¼Œæœ€å¥½æ˜¯ä¸€å¼€å§‹ä¿æŠ¤å¥½é¾™ï¼Œå½“é¾™åˆ°å¯¹é¢åŠåœºçš„æ—¶å€™è·Ÿå¯¹æ–¹ç¼ æ–—ï¼Œè®©é¾™æ…¢æ…¢ç£¨å¯¹æ–¹çš„å¡”ã€‚&lt;/li&gt;
&lt;li&gt;å¼€å±€å¯¹çº¿å‘ç°è‡ªå·±æ‰“ä¸è¿‡å¯¹é¢çš„æ—¶å€™ï¼Œè¦çŒ¥çå‘è‚²åˆ«æµªï¼Œé™¤éé˜Ÿå‹ç‰¹æ„è¿‡æ¥å¸®å¿™å‡»æ€ã€‚åˆç†çš„åˆ©ç”¨å·±æ–¹é˜²å¾¡å¡”ä¿æŠ¤è‡ªå·±ç”šè‡³åæ€å®é™…ä¸Šæ˜¯ç”¨å¡”å¼¥è¡¥äº†ä½ è‹±é›„çš„åŠ£åŠ¿ï¼Œä»–å®¶çš„é˜²å¾¡å¡”åªèƒ½ç«™ç€çœ‹ï¼Œè¾“å‡ºéƒ½æµªè´¹äº†ã€‚&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 08 Aug 2017 04:14:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-08:/posts/xiao-hai-xing-de-wang-zhe-rong-yao-gong-lue.html</guid><category>ç”Ÿæ´»</category></item><item><title>Deep Learning çš„ä¸€äº›æ€è€ƒ</title><link>/posts/deep-learning-de-yi-xie-si-kao.html</link><description>&lt;h1&gt;é—®è‡ªå·±çš„é—®é¢˜&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;ä¸åŒçš„ç®—æ³•å¯¹æ•°æ®è¾“å…¥æœ‰ä¸åŒçš„å‡è®¾ã€‚åº”è¯¥å¦‚ä½•é¢„å¤„ç†æ•°æ®å‘¢ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•å¯¹æ•°æ®é™ç»´ï¼Œä½¿ç”¨ä»€ä¹ˆé™ç»´æ–¹æ³•å‘¢ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•æ‹†åˆ†æ•°æ®é›†&lt;/li&gt;
&lt;li&gt;æ€æ ·çŸ¥é“æ˜¯å¦å‡ºç°äº†è¿‡æ‹Ÿåˆ&lt;/li&gt;
&lt;li&gt;åº”è¯¥æ˜¯ç”¨ä»€ä¹ˆç±»å‹çš„æ€§èƒ½æŒ‡æ ‡&lt;/li&gt;
&lt;li&gt;ä¸åŒçš„å‚æ•°è°ƒæ•´ä¼šå¦‚ä½•å½±å“æ¨¡å‹çš„ç»“æœ&lt;/li&gt;
&lt;li&gt;æ¨¡å‹ç»„åˆå¯ä»¥è¾¾åˆ°æ›´å¥½çš„ç»“æœå—&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;å…³äºæ¨¡å‹çš„åŸºæœ¬å‡è®¾&lt;/h1&gt;
&lt;p&gt;åŸºæœ¬å‡è®¾æ˜¯ä¸€ä¸ªç³»ç»Ÿè¿è¡Œçš„åŸºç¡€ï¼Œç„¶è€Œå¦‚æœå‡è®¾æ˜¯é”™è¯¯çš„å‘¢ï¼Ÿwhat if the grand truth is not true?
Â 
æ¯”å¦‚å‡è®¾A å’Œ A&lt;em&gt;æ˜¯ç±»ä¼¼çš„ï¼Œå–œæ¬¢ A çš„ç”¨æˆ·ä¹Ÿä¼šå–œæ¬¢ A&lt;/em&gt;ï¼Œä½†æ˜¯å®é™…ä¸Šç”¨æˆ·åªèƒ½åœ¨ A å’Œ A&lt;em&gt;ä¹‹é—´é€‰æ‹©ä¸€ä¸ªå‘¢ï¼Œè¿™æ—¶å€™å‘è´­ä¹°äº† A çš„é¡¾å®¢å†æ¨è A&lt;/em&gt;å°±ä¸åˆé€‚äº†.
Â 
æ¯”å¦‚ç”¨æˆ·å·²ç»ä¹°äº†é’»æˆ’ç”¨æ¥æ±‚å©š, é‚£ä¹ˆå†æ¨èé’»æˆ’å°±ä¸å¥½äº†. ä½†æ˜¯å¦‚æœç”¨æˆ·ä¹°äº†å•¤é…’, é‚£å†æ¨èä¸€äº›å•¤é…’ä¹Ÿå¾ˆå¥½å•Š, å› ä¸ºå•¤é…’å¾ˆå¿«å°±å–å®Œäº†...
Â 
ç»´åŸºç™¾ç§‘ä¸Šè®²ç®—æ³•çš„æ–‡ç« ä¸€èˆ¬éƒ½å†™å¾—ä¸æ€ä¹ˆæ ·&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 06 Aug 2017 23:33:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-06:/posts/deep-learning-de-yi-xie-si-kao.html</guid><category>è®¡ç®—æœº</category><category>æœºå™¨å­¦ä¹ </category></item><item><title>æˆ‘çš„ç¼–ç è§„èŒƒ</title><link>/posts/wo-de-bian-ma-gui-fan.html</link><description>&lt;h1&gt;æŒ‡å¯¼æ€æƒ³&lt;/h1&gt;
&lt;p&gt;ä»£ç è¦åšåˆ°&lt;a href="http://jixianqianduan.com/article-translation/2016/06/22/ways-to-write-self-documenting-js.html"&gt;è‡ªæ–‡æ¡£åŒ–&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;Python&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;utilæ¨¡å—ä½¿ç”¨util.pyï¼ˆå•æ•°å½¢å¼ï¼‰ï¼Œè€Œä¸æ˜¯utils.pyï¼Œå› ä¸ºpythonæ ‡å‡†åº“ä½¿ç”¨çš„æ˜¯util&lt;/li&gt;
&lt;li&gt;æ¨¡å—çš„å‘½åï¼šå¦‚æœåªæœ‰ä¸€ä¸ªç±»ï¼Œæ¯”å¦‚ItemProcessorï¼Œé‚£ä¹ˆå¯ä»¥å‘½åä¸ºitem_processor.pyï¼Œå¦åˆ™ä¸èƒ½ä½¿ç”¨åè¯å‘½åï¼Œä½¿ç”¨æè¿°æ€§çš„çŸ­è¯­ã€åè¯+åŠ¨è¯ã€&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;django&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ queryset çš„æ—¶å€™å°½é‡ä½¿ç”¨ &lt;code&gt;.only()&lt;/code&gt;ï¼Œä»¥å‡å°‘å¯¹æ•°æ®åº“çš„å‹åŠ›&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;devops&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;using mosh is recommended over plain ssh&lt;/li&gt;
&lt;li&gt;using tmux is recommended over screen&lt;/li&gt;
&lt;li&gt;all directories/repositories should use underscore NOT hyphen&lt;/li&gt;
&lt;li&gt;åº”è¯¥ä½¿ç”¨json schemaæ¥éªŒè¯jsonæ˜¯å¦åˆè§„&lt;/li&gt;
&lt;li&gt;æ¯ä¸€ä¸ªè°ƒç”¨æ–¹éƒ½åº”è¯¥ä½¿ç”¨tokenæˆ–è€…calleræ¥è¡¨æ˜è‡ªå·±çš„èº«ä»½ï¼Œæ‹’ç»ä»»ä½•æ²¡æœ‰å£°æ˜èº«ä»½çš„æœåŠ¡ã€‚è€Œç”Ÿæˆtokenåº”è¯¥ä½¿ç”¨åº“æ¥å®ç°ï¼Œè€Œä¸æ˜¯æœåŠ¡ï¼Œä»¥é¿å…æ‰€æœ‰çš„æœåŠ¡éƒ½ä¾èµ–tokenæ£€æµ‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;coding&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å˜é‡è·¨è¶Šçš„è¡Œæ•°å¤ªå¤šï¼Œå¦åˆ™ä¸èƒ½çœ‹æ‡‚å…¶ä¸­å˜é‡çš„ç”¨é€”ï¼Œå°½é‡æ˜¯å˜é‡çš„ç”Ÿå­˜å‘¨æœŸçŸ­&lt;/li&gt;
&lt;li&gt;å‡½æ•°ä¸èƒ½å†™å¤ªå¤šè¡Œï¼ˆ20è¡Œä»¥å†…ä¸ºå®œï¼Œæœ€å¤š40è¡Œï¼‰ï¼Œä¸ç„¶è¯»èµ·æ¥å¤ªè´¹åŠ²äº†ï¼Œæ ¹æœ¬ä¸çŸ¥é“æ˜¯ä»€ä¹ˆå‡½æ•°ï¼Œå¦‚æœå¤ªé•¿ï¼Œéœ€è¦æ‹†åˆ†&lt;/li&gt;
&lt;li&gt;ä¸è¦å»å˜æ¢APIçš„ç­¾åï¼Œå¦‚æœéœ€è¦æ›´æ”¹ï¼Œåšä¸€ä¸ªæ–°çš„ç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;å¦‚æœæ²¡æœ‰å¾ˆå¥½çš„åå­—ï¼Œä½¿ç”¨retä½œä¸ºè¿”å›å€¼çš„åç§°&lt;/li&gt;
&lt;li&gt;å¦‚æœåè®®å®¹æ˜“å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆåœ¨thriftä¸­å¢åŠ ä¸€ä¸ªå­—versionï¼Œæ¯æ¬¡æ ¡éªŒæ˜¯å¦æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;variable names should use simple words if possible&lt;/li&gt;
&lt;li&gt;ä¸è¦èµ·åå­—ç›¸åŒçš„å‡½æ•°&lt;/li&gt;
&lt;li&gt;å¸¸é‡çš„å®šä¹‰ï¼Œè¦æŠŠæ¯ä¸ªç»´åº¦æ­£äº¤åŒ–ï¼Œä½¿ç”¨æ¯ä¸ªä½æ¥è¡¨ç¤ºä¸€ä¸ªå¼€å…³ï¼Œæˆ–è€…å‡ ä¸ªä½æ¥è¡¨ç¤ºä¸€ä¸ªç»„åˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;æ€ç»´&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœåœ¨ç¼–ç å®ç°çš„è¿‡ç¨‹ä¸­å‘ç°å®é™…æƒ…å†µæ›´åŠ å¤æ‚ï¼Œä¹Ÿä¸è¦ç›´æ¥æ”¹å˜æ€è·¯ï¼Œå…ˆå®ç°åŸå…ˆæƒ³å¥½çš„ç®€å•æƒ…å†µï¼Œåœ¨åšæ‹“å±•&lt;/li&gt;
&lt;li&gt;ç±»åº”è¯¥æ˜¯ sans-IOçš„ï¼Œå¦‚æœéœ€è¦IOï¼Œå°±å†™ä¸€äº› load å‡½æ•°ï¼Œä½†æ˜¯ä¸è¦åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Indent, spaces and newline&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;use spaces around &lt;code&gt;+ - * / = ==&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;use spaces only after &lt;code&gt;,&lt;/code&gt; &lt;code&gt;;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;one blank line between functions and two between classes&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;\n&lt;/code&gt; as line endings&lt;/li&gt;
&lt;li&gt;end file with a new line&lt;/li&gt;
&lt;li&gt;always use 4 spaces to indent&lt;/li&gt;
&lt;li&gt;always use K&amp;amp;R braces&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Naming and variables&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;never use HN but prefix &lt;code&gt;is&lt;/code&gt; for bool flags or methods e.g. &lt;code&gt;is_open&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;use CamelCase for class name&lt;/li&gt;
&lt;li&gt;use camelCase or snake_case for function, variable, method name, just be consistent&lt;/li&gt;
&lt;li&gt;declare local variable as late as possible&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;nullptr&lt;/code&gt; not &lt;code&gt;NULL&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Headers&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;header file should use &lt;code&gt;*.hpp&lt;/code&gt; NOT &lt;code&gt;*.h&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;always use #define guards &lt;/li&gt;
&lt;li&gt;Reduce the number of #include files in header files. It will reduce build times. Instead, put include files in source code files and use forward declarations in header files. If a class in a header file does not need to know the size of a data member class or does not need to use the class's members then forward declare the class instead of including the file with #include. To avoid the need of a full class declaration, use references (or pointers) and forward declare the class. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Namespaces&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;never use &lt;code&gt;using namespace std&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å…¶ä»–&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;put a space after &lt;code&gt;if&lt;/code&gt; &lt;code&gt;for&lt;/code&gt; &lt;code&gt;while&lt;/code&gt; so that we know it's not invokation&lt;/li&gt;
&lt;li&gt;never use if (someVar == true) or if (someVar == false), it's silly&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Documnetation and comments&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Documentations explain how to use code, and are for the users of your code&lt;/li&gt;
&lt;li&gt;Comments explain why, and are for the maintainers of your code&lt;/li&gt;
&lt;li&gt;use javadoc for documentations&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;FIX&lt;/code&gt; &lt;code&gt;BUG&lt;/code&gt; &lt;code&gt;TODO&lt;/code&gt; &lt;code&gt;???&lt;/code&gt; &lt;code&gt;!!!&lt;/code&gt; to show different kinds of comments&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html
http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml
https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Coding_Style
http://www.yolinux.com/TUTORIALS/LinuxTutorialC++CodingStyle.html&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 05 Aug 2017 03:29:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-05:/posts/wo-de-bian-ma-gui-fan.html</guid><category>æƒ³æ³•</category><category>è®¡ç®—æœº</category></item><item><title>Python çš„ import ç³»ç»Ÿä¸ importlib</title><link>/posts/python-de-import-xi-tong-yu-importlib.html</link><description>&lt;p&gt;é¦–å…ˆ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;init&lt;/strong&gt;.py is first called before the actual import&lt;/p&gt;
&lt;p&gt;if you have  the following code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;foobar/
    __init__.py
    baz.py
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;runing import foobar will not make foobar.baz available
you have to add from . import baz to &lt;strong&gt;init&lt;/strong&gt;.py&lt;/p&gt;
&lt;p&gt;add &lt;strong&gt;all&lt;/strong&gt; to &lt;strong&gt;init.&lt;/strong&gt;.py to control which to be imported by import *&lt;/p&gt;
&lt;h2&gt;relative import&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;grok&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;..B&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;bar&lt;/span&gt;
&lt;span class="n"&gt;relavtive&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;only&lt;/span&gt; &lt;span class="nn"&gt;works&lt;/span&gt; &lt;span class="nn"&gt;when&lt;/span&gt; &lt;span class="nn"&gt;using&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="n"&gt;option&lt;/span&gt;
&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="n"&gt;mypackage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spam&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;by calling import foo, foo/&lt;strong&gt;init&lt;/strong&gt;.py will be called&lt;/p&gt;
&lt;h1&gt;å¸¸è§çš„é—®é¢˜&lt;/h1&gt;
&lt;p&gt;implicit import&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ python2 ä¸­æ”¯æŒéšå¼çš„ä»å½“å‰æ–‡ä»¶importå½“å‰ç›®å½•çš„æ–‡ä»¶ã€‚ è¿™ä¸ªåŠŸèƒ½åœ¨python3 ä¸­å·²ç»è¢«å»æ‰äº†ã€‚&lt;/p&gt;
&lt;h1&gt;Q&amp;amp;A&lt;/h1&gt;
&lt;p&gt;å¦‚ä½•å¤„ç†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æŠŠä¸€äº›importè¯­å¥æ”¾åˆ°çœŸæ­£éœ€è¦ä»–ä»¬çš„åœ°æ–¹ï¼Œ æ¯”å¦‚æŸä¸ªå‡½æ•°é‡Œé¢&lt;/p&gt;
&lt;h1&gt;importlib&lt;/h1&gt;
&lt;p&gt;ä¹‹æ‰€ä»¥æƒ³ç ”ç©¶importlibï¼Œæ˜¯å› ä¸ºleaderæåˆ°äº†Thriftåº”è¯¥æŠŠæºæ–‡ä»¶æäº¤åˆ°ä»“åº“ä¸­ï¼Œè€Œä¸æ˜¯æŠŠç¼–è¯‘åçš„æ–‡ä»¶æäº¤åˆ°ä»“åº“ä¸­ï¼Œè€Œpythonè¿è¡Œæ˜¯æ²¡æœ‰é¢„ç¼–è¯‘æœºåˆ¶çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€å¥—æœºåˆ¶æ¥åœ¨runtimeåŠ¨æ€çš„ç¼–è¯‘åŠ è½½thriftæ–‡ä»¶ã€‚ç¬¬ä¸€ä¸ªæƒ³æ³•å½“ç„¶æ˜¯å†™ä¸€ä¸ªimport_thriftå‡½æ•°ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;import_thrfit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;_compile_thrift&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# compile *.thrift files&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;module_name&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;module_name&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;names&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½†æ˜¯ï¼Œæ˜¾ç„¶ç›´æ¥ä½¿ç”¨importè¯­å¥æ˜¯ä¸å¯ä»¥çš„ï¼Œå› ä¸ºimportæ˜¯ä¸€ä¸ªè¯­å¥ï¼Œåè¾¹è·Ÿçš„ä¸èƒ½æ˜¯å˜é‡ã€‚è¿™æ—¶å€™å°±éœ€è¦importèƒŒåçš„åº“importlibçš„å¸®åŠ©äº†ã€‚å†è€…ï¼Œå½“å¤šæ¬¡è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ç¼“å­˜ï¼Œè€Œä¸æ˜¯æ¯æ¬¡ç¼–è¯‘ä¸€æ¬¡&lt;/p&gt;
&lt;h1&gt;ä»‹ç»importlib&lt;/h1&gt;
&lt;p&gt;importlibå®ç°äº†ä¸¤ä¸ªåŠŸèƒ½ï¼Œ1. æä¾›äº†importçš„å®ç°ï¼Œ2. æä¾›äº†import_moduleå‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å®ç°è‡ªå·±çš„importç³»ç»Ÿã€‚æœ¬æ–‡ä¸­æˆ‘ä»¬ä¸»è¦å…³æ³¨ç¬¬äºŒç‚¹ã€‚&lt;/p&gt;
&lt;h2&gt;importlib.import_module&lt;/h2&gt;
&lt;p&gt;importlib.import_module(name, package=None) å¦‚æœnameæ˜¯ç›¸å¯¹åŒ…åï¼Œnameå°†ä»packageä¸­ç›¸å¯¹å¯¼å…¥è¿™ä¸ªåŒ…ï¼Œæ¯”å¦‚&lt;code&gt;..mod&lt;/code&gt;ï¼Œpackageæ˜¯&lt;code&gt;package.subpkg&lt;/code&gt;ï¼Œå°†ä¼šå¯¼å…¥package.modè¿™ä¸ªåŒ…ã€‚å¦‚æœnameæ˜¯ç»å¯¹åŒ…åï¼Œé‚£å°±ç›´æ¥å¯¼å…¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œè¿”å›çš„æ˜¯package.modè¿™ä¸ªåå­—è€Œä¸æ˜¯å•ç‹¬çš„modåç§°ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰äº†è¿™ä¸ªå‡½æ•°æˆ‘ä»¬å°±å¯ä»¥å®ç° import_thrift äº†&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 05 Aug 2017 01:01:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-08-05:/posts/python-de-import-xi-tong-yu-importlib.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>iterm2 tricks</title><link>/posts/iterm2-tricks.html</link><description>&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœtmuxï¼Œvimç­‰ç¨‹åºå¯ç”¨äº†é¼ æ ‡æ”¯æŒï¼Œåªéœ€è¦ä½¿ç”¨alt+é¼ æ ‡å°±å¯ä»¥è½»æ¾æ‹·è´äº†~&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥éšè—æ ‡é¢˜æ  Profile-&amp;gt;Window-&amp;gt;Style: No Title Bar&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 29 Jul 2017 23:19:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-29:/posts/iterm2-tricks.html</guid><category>å°æŠ€å·§</category><category>å°å·¥å…·</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>python-readability æºç é˜…è¯»</title><link>/posts/python-readability-yuan-ma-yue-du.html</link><description>&lt;p&gt;readability æ˜¯ä¸€ä¸ªå¯ä»¥ä»æ‚ä¹±æ— ç« çš„ç½‘é¡µä¸­æŠ½å–å‡ºæ— ç‰¹æ®Šæ ¼å¼ï¼Œé€‚åˆå†æ¬¡æ’ç‰ˆé˜…è¯»çš„æ–‡ç« çš„åº“ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„æ‰‹æœºæµè§ˆå™¨çš„é˜…è¯»æ¨¡å¼å¾ˆå¤§ç¨‹åº¦ä¸Šå°±æ˜¯é‡‡ç”¨çš„è¿™ä¸ªåº“ï¼Œè¿˜æœ‰ evernote çš„ webclipper ä¹‹ç±»çš„åº”ç”¨ä¹Ÿéƒ½æ˜¯åˆ©ç”¨äº†ç±»ä¼¼çš„åº“ã€‚readability çš„å„ä¸ªç‰ˆæœ¬éƒ½æºè‡ªreadability.jsè¿™ä¸ªåº“ï¼Œä¹‹å‰å°è¯•é˜…è¯»è¿‡jsç‰ˆæœ¬ï¼Œæ— å…³çš„è¾…åŠ©å‡½æ•°å¤ªå¤šäº†ï¼Œè€Œä¸” js çš„ dom api å®åœ¨ç§°ä¸ä¸Šä¼˜é›…ï¼Œè¯»èµ·æ¥æ™¦æ¶©éš¾é€šï¼Œæ˜ŸæœŸå¤©ç»ˆäºæœ‰æ—¶é—´æ‹œè¯»äº†ä¸€ä¸‹python-readabilityçš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;readabilityæ ¸å¿ƒæ˜¯ä¸€ä¸ªDocumentç±»ï¼Œè¿™ä¸ªç±»ä»£è¡¨äº†ä¸€ä¸ª HTML æ–‡ä»¶ï¼ŒåŒæ—¶å¯ä»¥è¾“å‡ºä¸€ä¸ªæ ¼å¼åŒ–çš„æ–‡ä»¶&lt;/p&gt;
&lt;h1&gt;å‡ ä¸ªæ ¸å¿ƒæ–¹æ³•å’Œæ¦‚å¿µ&lt;/h1&gt;
&lt;p&gt;&lt;em&gt;summaryï¼ŒæŠ½å–ä¸€ç¯‡æ–‡ç« 
&lt;/em&gt;get_articleï¼Œ è·å¾—ä¸€ç¯‡æ–‡ç« &lt;/p&gt;
&lt;h2&gt;summary&lt;/h2&gt;
&lt;p&gt;summary æ–¹æ³•æ˜¯æ ¸å¿ƒæ–¹æ³•ï¼Œå¯ä»¥æŠ½å–å‡ºä¸€ç¯‡æ–‡ç« ã€‚å¯èƒ½éœ€è¦å¯¹æ–‡ç« æŠ½å–å¤šæ¬¡æ‰èƒ½è·å¾—ç¬¦åˆæ¡ä»¶çš„æ–‡ç« ï¼Œè¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;1. ç¬¬ä¸€æ¬¡å°è¯•æŠ½å–è®¾å®š ruthlessï¼Œä¹Ÿå°±æ˜¯å¼ºåŠ›æ¨¡å¼ï¼Œå¯èƒ½ä¼šè¯¯ä¼¤åˆ°ä¸€äº›æ ‡ç­¾
2. æŠŠç»™å®šçš„ input è§£æä¸€æ¬¡å¹¶è®°å½•åˆ° self.htmlï¼Œå¹¶å»é™¤æ‰€æœ‰çš„ scriptï¼Œsytle æ ‡ç­¾ï¼Œå› ä¸ºè¿™äº›æ ‡ç­¾å¹¶ä¸è´¡çŒ®æ–‡ç« å†…å®¹
3. å¦‚æœåœ¨å¼ºåŠ›æ¨¡å¼ï¼Œä½¿ç”¨remove_unlikely_candidateså»æ‰ä¸å¤ªå¯èƒ½çš„å€™é€‰
4. transform_misused_divs_into_psæŠŠé”™è¯¯ä½¿ç”¨çš„ div è½¬æ¢æˆ p æ ‡ç­¾ï¼Œè¿™æ ·å°±ä¸ç”¨è€ƒè™‘ div æ ‡ç­¾äº†ï¼Œå…¶å®è¿™æ­¥æŒºå…³é”®çš„ã€‚å…¶å®è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å¤„ç†éœ€è¦ä½¿ç”¨ã€‚
5. ä½¿ç”¨score_paragraphsç»™æ¯æ®µï¼ˆparagraphï¼‰æ‰“åˆ†
6. ä½¿ç”¨select_best_candidatesè·å¾—æœ€ä½³å€™é€‰ï¼ˆcandidatesï¼‰
7. é€‰å‡ºæœ€ä½³å€™é€‰ï¼Œå¦‚æœé€‰å‡ºçš„è¯ï¼Œè°ƒç”¨ get_article æŠ½å–æ–‡ç« 
8. å¦‚æœæ²¡æœ‰é€‰å‡ºï¼Œæ¢å¤åˆ°éå¼ºåŠ›æ¨¡å¼å†è¯•ä¸€æ¬¡ï¼Œè¿˜ä¸è¡Œçš„è¯å°±ç›´æ¥æŠŠ html è¿”å›
9. æ¸…ç†æ–‡ç« ï¼Œä½¿ç”¨ sanitize æ–¹æ³•
10. å¦‚æœå¾—åˆ°çš„æ–‡ç« å¤ªçŸ­äº†ï¼Œå°è¯•æ¢å¤åˆ°è´¹å¼ºåŠ›æ¨¡å¼é‡è¯•ä¸€æ¬¡

å¼ºåŠ›æ¨¡å¼å’Œéå¼ºåŠ›æ¨¡å¼çš„åŒºåˆ«å°±åœ¨äºæ˜¯å¦è°ƒç”¨äº† remove_unlikely_candidates
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Yifei's Notes&lt;/h2&gt;
&lt;p&gt;å…¬å¸çš„åšæ³•åœ¨äºï¼š 1ï¼‰transformé‚£ä¸€æ­¥ä¿®æ­£äº†æ›´å¤šçš„é”™è¯¯ã€‚2ï¼‰åœ¨å¾—åˆ°best nodeä¹‹åè®°å½•äº†xpathï¼Œæ–¹ä¾¿æŠ½å–ä¸‹ä¸€é¡µå†…å®¹ã€‚3ï¼‰æŠ½å–åæ£€æŸ¥æ–‡ç« é•¿åº¦ã€‚4ï¼‰å¦‚æœæŠ½å–å¤±è´¥ï¼Œä¸æ˜¯è¿”å›æ–‡ç« ï¼Œè€Œæ˜¯è¿”å›ç©º&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æŒ‰ç…§åœ¨ summary å‡ºåœºé¡ºåºä¾æ¬¡ä»‹ç»~&lt;/p&gt;
&lt;h2&gt;remove_unlikely_candidates&lt;/h2&gt;
&lt;p&gt;åŒ¹é…æ ‡ç­¾çš„ class å’Œ idï¼Œæ ¹æ®unlikelyCandidatesReå’ŒokMaybeItsACandidateè¿™ä¸ªä¸¤ä¸ªè¡¨è¾¾å¼åˆ é™¤ä¸€éƒ¨åˆ†èŠ‚ç‚¹ã€‚
unlikelyCandidatesReï¼šcombx|comment|community|disqus|extra|... å¯ä»¥çœ‹å‡ºæ˜¯ä¸€äº›è¾¹ç¼˜æ€§çš„è¯æ±‡
okMaybeItsACandidateRe: and|article|body|column|main|shadow... å¯ä»¥çœ‹å‡ºä¸»è¦æ˜¯åˆ¶å®šæ­£æ–‡çš„è¯æ±‡&lt;/p&gt;
&lt;h2&gt;transform_misused_divs_into_paragraphs&lt;/h2&gt;
&lt;p&gt;å¯¹æ‰€æœ‰çš„ div èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰ divToPElementsRe è¿™ä¸ªè¡¨è¾¾å¼é‡Œçš„æ ‡ç­¾ï¼Œå°±æŠŠä»–è½¬åŒ–ä¸º p
å†å¯¹å‰©ä¸‹çš„ div æ ‡ç­¾ä¸­ï¼Œå¦‚æœæœ‰æ–‡å­—çš„è¯ï¼Œå°±æŠŠæ–‡å­—è½¬æ¢æˆä¸€ä¸ª p æ ‡ç­¾ï¼Œæ’å…¥åˆ°å½“å‰èŠ‚ç‚¹ï¼Œå¦‚æœå­æ ‡ç­¾æœ‰ tailèŠ‚ç‚¹çš„è¯ï¼Œä¹ŸæŠŠä»–ä½œä¸º p æ ‡ç­¾æ’å…¥åˆ°å½“å‰èŠ‚ç‚¹ä¸­
æŠŠ br æ ‡ç­¾åˆ æ‰&lt;/p&gt;
&lt;h2&gt;socore_node&lt;/h2&gt;
&lt;p&gt;æŒ‰ç…§tagã€ class å’Œ id å¦‚æœç¬¦åˆè´Ÿé¢è¯æ±‡çš„æ­£åˆ™ï¼Œå°±å‰ªæ‰25åˆ†ï¼Œå¦‚æœç¬¦åˆæ­£é¢è¯æ±‡çš„æ­£åˆ™ï¼Œå°±åŠ ä¸Š25åˆ†
div +5 åˆ†ï¼Œ preã€tdã€backquote +3 åˆ†
addressã€olã€ulã€dlã€ddã€dtã€liã€form -3åˆ†
h1-h6 th -5 åˆ†&lt;/p&gt;
&lt;h2&gt;score_paragraphs&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆå®šä¹‰å¸¸é‡ï¼ŒMIN_LEN æœ€å°æˆæ®µæ–‡æœ¬é•¿åº¦
å¯¹äºæ‰€æœ‰çš„ pï¼Œpreï¼Œtd æ ‡ç­¾ï¼Œæ‰¾åˆ°ä»–ä»¬çš„çˆ¶æ ‡ç­¾å’Œç¥–çˆ¶æ ‡ç­¾ï¼Œæ–‡æœ¬é•¿åº¦å°äº MIN_LEN çš„ç›´æ¥å¿½ç•¥
å¯¹çˆ¶æ ‡ç­¾æ‰“åˆ†ï¼ˆscore_nodeï¼‰ï¼Œå¹¶æ”¾å…¥æ’åºé˜Ÿåˆ—
ç¥–çˆ¶æ ‡ç­¾ä¹Ÿæ‰“åˆ†ï¼Œå¹¶æ”¾å…¥æ’åºé˜Ÿåˆ—
å¼€å§‹è®¡ç®—å½“å‰èŠ‚ç‚¹çš„å†…å®¹åˆ†ï¼ˆcontent_socre) åŸºç¡€åˆ†1åˆ†ï¼ŒæŒ‰ç…§é€—å·æ–­å¥ï¼Œæ¯å¥ä¸€åˆ†ï¼Œæ¯100å­—æ¯+1åˆ†ï¼Œè‡³å°‘ä¸‰åˆ†
çˆ¶å…ƒç´ åŠ ä¸Šå½“å‰å…ƒç´ çš„åˆ†ï¼Œç¥–å…ˆå…ƒç´ åŠ ä¸Š1/2
é“¾æ¥å¯†åº¦ é“¾æ¥ / (æ–‡æœ¬ + é“¾æ¥)
æœ€ç»ˆå¾—åˆ† ä¹‹å‰çš„åˆ† * ï¼ˆ1 - é“¾æ¥å¯†åº¦ï¼‰&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œå½“æœŸæ ‡ç­¾å¹¶æ²¡æœ‰åŠ å…¥ candidatesï¼Œçˆ¶æ ‡ç­¾å’Œç¥–çˆ¶æ ‡ç­¾æ‰åŠ å…¥
ç´¯è®¡åŠ åˆ†ï¼Œå¦‚æœä¸€ä¸ªå…ƒç´ æœ‰å¤šä¸ª pï¼Œé‚£ä¹ˆä¼šæŠŠæ‰€æœ‰å­å…ƒç´ çš„content scoreéƒ½åŠ ä¸Š&lt;/p&gt;
&lt;h2&gt;select_best_candidate&lt;/h2&gt;
&lt;p&gt;å°±æ˜¯ ordered ä¸­æ‰¾å‡ºæœ€å¤§çš„&lt;/p&gt;
&lt;h2&gt;get_article&lt;/h2&gt;
&lt;p&gt;å¯¹äºæœ€ä½³å€™é€‰å‘¨å›´çš„æ ‡ç­¾ï¼Œç»™äºˆå¤æ´»çš„æœºä¼šï¼Œä»¥é¿å…è¢«å¹¿å‘Šåˆ†å¼€çš„éƒ¨åˆ†è¢«å»æ‰ï¼Œé˜ˆå€¼æ˜¯10åˆ†æˆ–è€…æœ€ä½³å€™é€‰åˆ†æ•°çš„äº”åˆ†ä¹‹ä¸€ã€‚å¦‚æœæ˜¯ p çš„è¯ï¼Œnode_length &amp;gt; 80 and link_density &amp;lt; 0.25 æˆ–è€… é•¿åº¦å°äº80ï¼Œä½†æ˜¯æ²¡æœ‰è¿æ¥ï¼Œè€Œä¸”æœ€åæ˜¯å¥å·&lt;/p&gt;
&lt;h1&gt;æ€è€ƒ&lt;/h1&gt;
&lt;p&gt;readabilityä¹‹æ‰€ä»¥èƒ½å¤Ÿworkçš„åŸå› ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯åŸºäºhtmlæœ¬èº«æ˜¯ä¸€ç¯‡æ–‡æ¡£ï¼Œæ•°æ®éƒ½å·²å°†åœ¨htmlé‡Œäº†ï¼Œç„¶åé€šè¿‡æ“ä½œDOMè·å¾—æ–‡ç« ã€‚è€Œåœ¨å‰ç«¯æ¡†æ¶é£é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œéšç€reactå’Œvueç­‰çš„å´›èµ·ï¼Œè¶Šæ¥è¶Šå¤šçš„ç½‘ç«™é‡‡ç”¨äº†åŠ¨æ€åŠ è½½ï¼ŒçœŸæ­£çš„æ–‡ç« å­˜åœ¨äº†é¡µé¢çš„jsä¸­ç”šè‡³éœ€è¦ajaxåŠ è½½ï¼Œè¿™æ—¶åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨readability.jsè™½ç„¶ä¾ç„¶å¯ä»¥ï¼ˆå› ä¸ºæµè§ˆå™¨å·²ç»åŠ è½½å‡ºäº†DOMï¼‰ï¼Œä½†æ˜¯å¦‚æœç”¨äºæŠ“å–ç›®çš„çš„è¯ï¼Œéœ€è¦æ‰§è¡Œä¸€éjsï¼Œå¾—åˆ°æ¸²æŸ“è¿‡çš„DOMæ‰èƒ½æå–æ–‡ç« ï¼Œå¦‚æœèƒ½å¤Ÿæœ‰ä¸€ä¸ªç®—æ³•ï¼Œç›´æ¥è¯†åˆ«å‡ºå¤§æ®µçš„æ–‡å­—ï¼Œè€Œä¸æ˜¯ä¾èµ–DOMæå–æ–‡ç« å°±å¥½äº†~&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 29 Jul 2017 22:11:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-29:/posts/python-readability-yuan-ma-yue-du.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>å¿™ç­‰å¾…</title><link>/posts/mang-deng-dai.html</link><description>&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;while True:
    pass 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;this is busy waiting&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;while True:
    time.sleep(10)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;this is not busy waiting, bucause cpu are free to do other things, and only need trivial cpu cycles&lt;/p&gt;
&lt;p&gt;http://stackoverflow.com/questions/529034/python-pass-or-sleep-for-long-running-processes&lt;/p&gt;
&lt;p&gt;busy waiting is considered as anti-pattern, but using it in spinning-lock is ok&lt;/p&gt;
&lt;p&gt;should use select if we need to wait for something&lt;/p&gt;
&lt;p&gt;https://en.wikipedia.org/wiki/Busy_waiting&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 27 Jul 2017 23:34:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-27:/posts/mang-deng-dai.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>html Node vs Element</title><link>/posts/html-node-vs-element.html</link><description>&lt;ul&gt;
&lt;li&gt;Node vs Element&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;HTML Document consists of different node, element is one type of node.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NodeList vs HTMLCollection&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;NodeList is a collection of node, HTMLCollection is a collection of element.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HTMLCollection vs NodeList vs Array&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;HTMLCollection å’Œ NodeList éƒ½æ˜¯åŠ¨æ€çš„,ä¼šéšç€ DOM çš„å˜åŒ–è€Œå˜åŒ–&lt;/p&gt;
&lt;p&gt;Array æ˜¯é™æ€çš„æ•°æ®ç»“æ„&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 27 Jul 2017 02:41:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-27:/posts/html-node-vs-element.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>make å’Œ premake</title><link>/posts/make-he-premake.html</link><description>&lt;h1&gt;Rule&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;dependencies&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sepreated&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;spaces&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;build&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;dependencies&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Basic usage&lt;/h1&gt;
&lt;p&gt;in most projects, we have a &lt;code&gt;.h&lt;/code&gt; file for functiont interfaces, and the whole program depends on it.
typically, all &lt;code&gt;.o&lt;/code&gt; files are compiled from corresponding &lt;code&gt;.c&lt;/code&gt; source files&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;cc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; gcc              &lt;span class="c1"&gt;# marco&lt;/span&gt;
&lt;span class="nv"&gt;prom&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; calc
&lt;span class="nv"&gt;deps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; calc.h         &lt;span class="c1"&gt;# the one .h to rule them all&lt;/span&gt;
&lt;span class="nv"&gt;obj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; main.o getch.o getop.o stack.o
&lt;span class="nf"&gt;$(prom)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nv"&gt;obj&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;$(&lt;/span&gt;CC&lt;span class="k"&gt;)&lt;/span&gt; -o &lt;span class="k"&gt;$(&lt;/span&gt;prom&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;obj&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nf"&gt;%.o&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; %.&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nv"&gt;deps&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;      &lt;span class="c"&gt;#pattern rule, which means all .o depends on all .c and $(deps)&lt;/span&gt;
    &lt;span class="k"&gt;$(&lt;/span&gt;CC&lt;span class="k"&gt;)&lt;/span&gt; -c $&amp;lt; -o &lt;span class="nv"&gt;$@&lt;/span&gt; &lt;span class="c1"&gt;# $&amp;lt; means the depender and $@ means the dependee&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Functions&lt;/h1&gt;
&lt;p&gt;we can make the file even smarter by using makefile funcions
Makefile function syntax $(func params)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;cc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; gcc
&lt;span class="nv"&gt;prom&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; calc
&lt;span class="nv"&gt;deps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;shell find ./ -name &lt;span class="s2"&gt;&amp;quot;*.h&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# find all header files using the builtin shell function&lt;/span&gt;
&lt;span class="nv"&gt;src&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;shell find ./ -name &lt;span class="s2"&gt;&amp;quot;*.c&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nv"&gt;obj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;src:%.c&lt;span class="o"&gt;=&lt;/span&gt;%.o&lt;span class="k"&gt;)&lt;/span&gt; 
&lt;span class="nf"&gt;$(prom)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nv"&gt;obj&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;$(&lt;/span&gt;CC&lt;span class="k"&gt;)&lt;/span&gt; -o &lt;span class="k"&gt;$(&lt;/span&gt;prom&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;obj&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nf"&gt;%.o&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; %.&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nv"&gt;deps&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;$(&lt;/span&gt;CC&lt;span class="k"&gt;)&lt;/span&gt; -c $&amp;lt; -o &lt;span class="nv"&gt;$@&lt;/span&gt;
&lt;span class="nf"&gt;clean&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;                              &lt;span class="c"&gt;# empty target to run a commnad&lt;/span&gt;
    rm -rf &lt;span class="k"&gt;$(&lt;/span&gt;obj&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;prom&lt;span class="k"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Reference&lt;/h1&gt;
&lt;p&gt;http://www.epubit.com.cn/article/546&lt;/p&gt;
&lt;h1&gt;Autotools&lt;/h1&gt;
&lt;p&gt;Autotools is a collection of three tools:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;autoconf â€” This is used to generate the â€œconfigureâ€ shell script. As I mentioned earlier, this is the script that analyzes your system at compile-time. For example, does your system use â€œccâ€ or â€œgccâ€ as the C compiler?&lt;/li&gt;
&lt;li&gt;automake â€” This is used to generate Makefiles. It uses information provided by Autoconf. For example, if your system has â€œgccâ€, it will use â€œgccâ€ in the Makefile. Or, if it finds â€œccâ€ instead, will use â€œccâ€ in the Makefile.&lt;/li&gt;
&lt;li&gt;libtool â€” This is used to create shared libraries, platform-independently.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ autoscan                    &lt;span class="c1"&gt;#--&amp;gt; creates `autoscan.scan` file&lt;/span&gt;
$ mv autoscan.scan to &lt;span class="sb"&gt;`&lt;/span&gt;autoscan.ac&lt;span class="sb"&gt;`&lt;/span&gt; file
$ autoconf                    &lt;span class="c1"&gt;# --&amp;gt; use autoconf.ac to create `configure` file&lt;/span&gt;
&lt;span class="c1"&gt;# we need a `makefile.in` as the template for configure file to use&lt;/span&gt;
$ automake                    &lt;span class="c1"&gt;# --&amp;gt; use `makefile.in` to create `makefile`&lt;/span&gt;
$ autoheader                  &lt;span class="c1"&gt;# --&amp;gt; generate `config.h.in`&lt;/span&gt;
$ ./configure                 &lt;span class="c1"&gt;# --&amp;gt; generate the makefile and config.h&lt;/span&gt;
$ make &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; make install        &lt;span class="c1"&gt;# horry!&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To be continued at:
http://markuskimius.wikidot.com/programming:tut:autotools:5&lt;/p&gt;
&lt;h1&gt;premake åŸºæœ¬ç”¨æ³•&lt;/h1&gt;
&lt;p&gt;premake å¯ä»¥ç”Ÿæˆmakefile
premake gmake
ç”Ÿæˆçš„ makefile æ”¯æŒ 
make é»˜è®¤æ„å»º
make help   æŸ¥çœ‹å¸®åŠ©æ–‡ä»¶
make config=release æŒ‰ç…§ release æ„å»º
make clean  æ¸…é™¤æ„å»º
make config=release clean   æ¸…é™¤ release æ„å»º&lt;/p&gt;
&lt;p&gt;premake5è„šæœ¬çš„åå­—æ˜¯ premake5.lua, æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª lua è„šæœ¬, æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨, å› ä¸ºå‚æ•°æ°å¥½æ˜¯å­—ç¬¦ä¸²æˆ–è€… table, æ‰€ä»¥å¯ä»¥çœç•¥æ‹¬å·&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-- premake5.lua
workspace &amp;quot;HelloWorld&amp;quot;
   configurations { &amp;quot;Debug&amp;quot;, &amp;quot;Release&amp;quot; }
project &amp;quot;HelloWorld&amp;quot;
   kind &amp;quot;ConsoleApp&amp;quot;
   language &amp;quot;C&amp;quot;
   targetdir &amp;quot;bin/%{cfg.buildcfg}&amp;quot;
files { &amp;quot;**.h&amp;quot;, &amp;quot;**.c&amp;quot; }
filter &amp;quot;configurations:Debug&amp;quot;
      defines { &amp;quot;DEBUG&amp;quot; }
      flags { &amp;quot;Symbols&amp;quot; }
filter &amp;quot;configurations:Release&amp;quot;
      defines { &amp;quot;NDEBUG&amp;quot; }
      optimize &amp;quot;On&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å¸¸ç”¨å‡½æ•°&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;workspace   ç›¸å½“äº vs çš„ solution   
project project 
kind     æŒ‡å®šç¼–è¯‘ç›®æ ‡ç±»å‹   ConsoleApp WindowedApp    SharedLib StaticLib     
location     æŒ‡å®šç¼–è¯‘ç›®æ ‡ç›®å½•   
define   å®šä¹‰å¸¸é‡   
files   æ·»åŠ æ–‡ä»¶    æ–‡ä»¶å *.ext **.ext
removefiles  å±è”½æ–‡ä»¶   
links   é“¾æ¥åº“ 
libdirs æ·»åŠ åº“ç›®å½•   
configurations  æŒ‡å®šä¸åŒçš„ç¼–è¯‘é€‰é¡¹   éœ€è¦é€šè¿‡ filter {&amp;quot;configurations:&amp;lt;name&amp;gt;&amp;quot;} æŒ‡å®šå…·ä½“é€‰é¡¹
platforms    æŒ‡å®šä¸åŒçš„å¹³å°    å’Œ vs çš„ platform ç±»ä¼¼, ä½†æ˜¯ä¹Ÿéœ€è¦ä½¿ç”¨ filter å®šä¹‰
includedirs æ·»åŠ  include ç›®å½•   
optimize     è®¾ç½®ä¼˜åŒ–é€‰é¡¹  Off On
buildoptions    ç¼–è¯‘é€‰é¡¹    æ¯”å¦‚-std=c99
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä½œç”¨èŒƒå›´&lt;/h2&gt;
&lt;p&gt;ä½œç”¨èŒƒå›´ä¼šå‘ç”Ÿç»§æ‰¿, ä½¿ç”¨ &lt;code&gt;workspce '*'&lt;/code&gt; æˆ–è€… &lt;code&gt;project '*'&lt;/code&gt;ä»£è¡¨é€‰ä¸­äº†æ‰€æœ‰workspace æˆ–è€… project&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;premake install

newaction {
   trigger     = &amp;quot;install&amp;quot;,
   description = &amp;quot;Install the software&amp;quot;,
   execute = function ()
      -- copy files, etc. here
   end
}
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 27 Jul 2017 01:21:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-27:/posts/make-he-premake.html</guid><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Cçš„ç¼–è¯‘ã€è°ƒè¯•ä¸é™æ€æ£€æŸ¥</title><link>/posts/cde-bian-yi-diao-shi-yu-jing-tai-jian-cha.html</link><description>&lt;h1&gt;ä½¿ç”¨Clang/gcc å¸¸ç”¨çš„é€‰é¡¹&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-std=c11     è®¾å®šæ ‡å‡†ä¸º c11
-Wall   æ˜¾ç¤ºæ‰€æœ‰è­¦å‘Š
-O2 äºŒçº§ä¼˜åŒ–, é€šå¸¸å¤Ÿç”¨äº†
-march=native   é‡Šæ”¾æœ¬åœ°CPUæ‰€æœ‰æŒ‡ä»¤
-g  å¦‚æœéœ€è¦ä½¿ç”¨ gdb è°ƒè¯•çš„è¯

-Dmarco=value    å®šä¹‰å®
-Umarco undef å®
-Ipath   æ·»åŠ åˆ° include
-llibrary   é“¾æ¥åˆ° liblibbrary.a æ–‡ä»¶
-Lpath   æ·»åŠ åˆ°é“¾æ¥ 

-c  åªç¼–è¯‘è€Œä¸é“¾æ¥
-S  ç”Ÿæˆæ±‡ç¼–ä»£ç , ä½†æ˜¯ä¸ç”Ÿæˆæœºå™¨ä»£ç 
-E   åªé¢„å¤„ç†

-fopenmp     æ‰“å¼€ OpenMP æ”¯æŒ
-pthread     æ·»åŠ  pthread æ”¯æŒ
-Werror  æŠŠæ‰€æœ‰ warning æ˜¾ç¤ºä¸º error
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å¦‚ä½•ç”Ÿæˆé™æ€åº“, åŠ¨æ€åº“&lt;/h1&gt;
&lt;p&gt;see:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;http://www.adp-gmbh.ch/cpp/gcc/create_lib.html&lt;/li&gt;
&lt;li&gt;http://stackoverflow.com/questions/2734719/how-to-compile-a-static-library-in-linux&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;é™æ€åº“&lt;/h2&gt;
&lt;p&gt;é™æ€åº“çš„åˆ›å»ºåŸç†æ˜¯æŠŠä¸åŒçš„ç›®æ ‡æ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·, æ‰€ä»¥åˆ†ä¸¤æ­¥&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;gcc -c -o mean.o mean.c&lt;/li&gt;
&lt;li&gt;ar rcs libmean.a mean.o
ç”Ÿæˆçš„åº“çš„åå­—å¤šäº† lib å’Œ. a&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;gcc -static main.c -L. -lmean -o a.out&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;åŠ¨æ€åº“&lt;/h2&gt;
&lt;p&gt;åŠ¨æ€åº“éœ€è¦ç”Ÿæˆ PIC(åœ°å€æ— å…³ä»£ç ),&lt;/p&gt;
&lt;p&gt;-Wl  åé¢çš„å‘½ä»¤ä¼šä¼ é€’ç»™é“¾æ¥å™¨ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gcc -c -fPIC calc_mean.c -o calc_mean.o # å¤§å†™çš„-fPIC æ¯”- fpic æ›´é€šç”¨, è™½ç„¶åœ¨ x86å¹³å°ä¸Šæ²¡æœ‰åŒºåˆ«
gcc -shared -Wl,-soname,libmean.so.1 -o libmean.so.1.0.1  calc_mean.o
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ &lt;code&gt;gcc main.c -o a.out -L. -lmean&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;LD_LIBRARY_PATH=.
./dynamically_linked
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æœ€å¸¸ç”¨çš„æŒ‡ä»¤&lt;/h2&gt;
&lt;p&gt;cc -Wall -std=c11 source.c -o executable
g++ -Wall -std=c++11 source.cc -o executable&lt;/p&gt;
&lt;h1&gt;tips&lt;/h1&gt;
&lt;p&gt;å¤„ç†äºŒè¿›åˆ¶æ•°æ®æ—¶å°½é‡ä½¿ç”¨uint8_tï¼Œè€Œä¸è¦ä½¿ç”¨char&lt;/p&gt;
&lt;p&gt;å‡½æ•°çš„å‚æ•°ç±»å‹ï¼ˆæ¥å£ï¼‰å°½é‡ä½¿ç”¨ &lt;code&gt;void*&lt;/code&gt;
ä¸è¦è¿™ä¹ˆåš:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;void processAddBytesOverflow(uint8_t *bytes, uint32_t len) {
    for (uint32_t i = 0; i &amp;lt; len; i++) {
        bytes[0] += bytes[i];
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ä¹ˆåš:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;void processAddBytesOverflow(void *input, uint32_t len) {
    uint8_t *bytes = input;
for (uint32_t i = 0; i &amp;lt; len; i++) {
        bytes[0] += bytes[i];
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¥è‡ª &lt;a href="https://matt.sh/howto-c"&gt;https://matt.sh/howto-c&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;æäº¤ä»“åº“å‰ï¼Œç»Ÿä¸€æ ¼å¼ï¼Œè€Œä¸åº”è¯¥åœ¨ç¼–å†™è¿‡ç¨‹ä¸­æ³¨æ„&lt;/p&gt;
&lt;p&gt;ä¸è¦ä½¿ç”¨mallocï¼Œæ€»æ˜¯ä½¿ç”¨callocï¼Œå› ä¸ºæ¸…é›¶çš„æ€§èƒ½æŸå¤±å¤ªå°äº†ï¼Œä½†æ˜¯å´ç»å¸¸å¿˜è®°. è¿™ä¸€ç‚¹å­˜ç–‘&lt;/p&gt;
&lt;p&gt;å°½é‡ä¿è¯åœ¨ç¼–å†™å†…å­˜è·å–ä»£ç çš„æ—¶å€™å°±å†™å¥½é‡Šæ”¾ä»£ç &lt;/p&gt;
&lt;h2&gt;å†…å­˜æ³„æ¼çš„æ’æŸ¥&lt;/h2&gt;
&lt;p&gt;æ ¸å¿ƒæ€æƒ³ï¼Œmalloc/freeä¸é…å¯¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;windows&lt;/span&gt;&lt;span class="err"&gt;ï¼Œä½¿ç”¨&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;crtdbg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#define _CRTDBG_MAP_MALLOC&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;crtdbg.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;

&lt;span class="n"&gt;_CrtDumpMemoryLeaks&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;linuxï¼Œä½¿ç”¨mtraceå®ç°åŠ¨æ€æ£€æŸ¥
ä½¿ç”¨valgrindå®ç°é™æ€æ£€æŸ¥
valgrind --leak-check=full ./a.out
æ³¨æ„æŸ¥çœ‹definitely lostå’Œpossible lost&lt;/p&gt;
&lt;h2&gt;è°ƒè¯•çš„å·¥å…·&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;valgrind æ’æŸ¥å†…å­˜é—®é¢˜&lt;/li&gt;
&lt;li&gt;strace/ltrace æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨å’Œåº“è°ƒç”¨&lt;/li&gt;
&lt;li&gt;pmap æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;æµ‹è¯•&lt;/h2&gt;
&lt;h2&gt;rr&lt;/h2&gt;
&lt;p&gt;mozilla's rr is a promising tool to replace gdb. it can replay the recored execution of a program, so you can replay it until you find out the bug.&lt;/p&gt;
&lt;p&gt;http://rr-project.org/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 27 Jul 2017 01:14:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-27:/posts/cde-bian-yi-diao-shi-yu-jing-tai-jian-cha.html</guid><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>PEP8 ä¸­éœ€è¦æ³¨æ„çš„åœ°æ–¹</title><link>/posts/pep8-zhong-xu-yao-zhu-yi-de-di-fang.html</link><description>&lt;h1&gt;spaces&lt;/h1&gt;
&lt;p&gt;If operators with different priorities are used, consider adding whitespace around the operators with the lowest priority(ies). Use your own judgment; however, never use more than one space, and always have the same amount of whitespace on both sides of a binary operator.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Yes&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;submitted&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;hypot2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;
&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;No&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;submitted&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;hypot2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;comments&lt;/h1&gt;
&lt;p&gt;Compound statements (multiple statements on the same line) are generally discouraged.&lt;/p&gt;
&lt;p&gt;Comments that contradict the code are worse than no comments. Always make a priority of keeping the comments up-to-date when the code changes!&lt;/p&gt;
&lt;p&gt;Comments should be complete sentences. If a comment is a phrase or sentence, its first word should be capitalized, unless it is an identifier that begins with a lower case letter (never alter the case of identifiers!).&lt;/p&gt;
&lt;p&gt;If a comment is short, the period at the end can be omitted. Block comments generally consist of one or more paragraphs built out of complete sentences, and each sentence should end in a period.
You should use two spaces after a sentence-ending period.
When writing English, follow Strunk and White.
Python coders from non-English speaking countries: please write your comments in English, unless you are 120% sure that the code will never be read by people who don't speak your language.&lt;/p&gt;
&lt;p&gt;Conventions for writing good documentation strings (a.k.a. "docstrings") are immortalized inÂ PEP 257Â .
&lt;em&gt; Write docstrings for all public modules, functions, classes, and methods. Docstrings are not necessary for non-public methods, but you should have a comment that describes what the method does. This comment should appear after thedefÂ line.
&lt;/em&gt; PEP 257Â describes good docstring conventions. Note that most importantly, theÂ """Â that ends a multiline docstring should be on a line by itself, e.g.:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;&amp;quot;&amp;quot;Return a foobang

Optional plotz says to frobnicate the bizbaz first.
&amp;quot;&amp;quot;&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;For one liner docstrings, please keep the closingÂ """Â on the same line.&lt;/p&gt;
&lt;h1&gt;Nameing Conventions&lt;/h1&gt;
&lt;p&gt;Overriding Principle
Names that are visible to the user as public parts of the API should follow conventions that reflect usage rather than implementation.&lt;/p&gt;
&lt;p&gt;Names to Avoid
Never use the characters 'l' (lowercase letter el), 'O' (uppercase letter oh), or 'I' (uppercase letter eye) as single character variable names.
In some fonts, these characters are indistinguishable from the numerals one and zero. When tempted to use 'l', use 'L' instead.&lt;/p&gt;
&lt;p&gt;Exception Names
Because exceptions should be classes, the class naming convention applies here. However, you should use the suffix "Error" on your exception names (if the exception actually is an error).&lt;/p&gt;
&lt;p&gt;When implementing ordering operations with rich comparisons, it is best to implement all six operations (Â &lt;strong&gt;eq&lt;/strong&gt;Â ,&lt;strong&gt;ne&lt;/strong&gt;Â ,Â &lt;strong&gt;lt&lt;/strong&gt;Â ,Â &lt;strong&gt;le&lt;/strong&gt;Â ,Â &lt;strong&gt;gt&lt;/strong&gt;Â ,Â &lt;strong&gt;ge&lt;/strong&gt;Â ) rather than relying on other code to only exercise a particular comparison.
To minimize the effort involved, theÂ functools.total_ordering()Â decorator provides a tool to generate missing comparison methods.
PEP 207Â indicates that reflexivity rulesÂ areÂ assumed by Python. Thus, the interpreter may swapÂ y &amp;gt; xÂ withÂ x &amp;lt; yÂ ,Â y &amp;gt;= xwithÂ x &amp;lt;= yÂ , and may swap the arguments ofÂ x == yÂ andÂ x != yÂ . TheÂ sort()Â andÂ min()Â operations are guaranteed to use theÂ &amp;lt;Â operator and theÂ max()Â function uses theÂ &amp;gt;Â operator. However, it is best to implement all six operations so that confusion doesn't arise in other contexts.&lt;/p&gt;
&lt;h1&gt;lambda&lt;/h1&gt;
&lt;p&gt;Always use a def statement instead of an assignment statement that binds a lambda expression directly to an identifier.
Yes:
def f(x): return 2&lt;em&gt;x
No:
f = lambda x: 2&lt;/em&gt;x
The first form means that the name of the resulting function object is specifically 'f' instead of the generic &lt;code&gt;'&amp;lt;lambda&amp;gt;'&lt;/code&gt;. This is more useful for tracebacks and string representations in general. The use of the assignment statement eliminates the sole benefit a lambda expression can offer over an explicit def statement (i.e. that it can be embedded inside a larger expression)&lt;/p&gt;
&lt;h1&gt;exceptions&lt;/h1&gt;
&lt;p&gt;Design exception hierarchies based on the distinctions that code catching the exceptions is likely to need, rather than the locations where the exceptions are raised. Aim to answer the question "What went wrong?" programmatically, rather than only stating that "A problem occurred" (see PEP 3151 for an example of this lesson being learned for the builtin exception hierarchy)&lt;/p&gt;
&lt;p&gt;Class naming conventions apply here, although you should add the suffix "Error" to your exception classes if the exception is an error. Non-error exceptions that are used for non-local flow control or other forms of signaling need no special suffix.&lt;/p&gt;
&lt;p&gt;Use exception chaining appropriately. In Python 3, "raise X from Y" should be used to indicate explicit replacement without losing the original traceback.&lt;/p&gt;
&lt;p&gt;When deliberately replacing an inner exception (using "raise X" in Python 2 or "raise X from None" in Python 3.3+), ensure that relevant details are transferred to the new exception (such as preserving the attribute name when converting KeyError to AttributeError, or embedding the text of the original exception in the new exception message).&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 27 Jul 2017 01:04:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-27:/posts/pep8-zhong-xu-yao-zhu-yi-de-di-fang.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>python signal</title><link>/posts/python-signal.html</link><description>&lt;p&gt;Any thread can perform an alarm(), getsignal(), pause(), setitimer() or getitimer(); only the main thread can set a new signal handler, and the main thread will be the only one to receive signals&lt;/p&gt;
&lt;h1&gt;default handlers:&lt;/h1&gt;
&lt;p&gt;signal.SIG_DFL&lt;/p&gt;
&lt;p&gt;This is one of two standard signal handling options; it will simply perform the default function for the signal. For example, on most systems the default action for SIGQUIT is to dump core and exit, while the default action for SIGCHLD is to simply ignore it.&lt;/p&gt;
&lt;p&gt;signal.SIG_IGN&lt;/p&gt;
&lt;p&gt;This is another standard signal handler, which will simply ignore the given signal.&lt;/p&gt;
&lt;h1&gt;assign handerls:&lt;/h1&gt;
&lt;p&gt;signal.signal(signalnum, handler)&lt;/p&gt;
&lt;p&gt;Set the handler for signal signalnum to the function handler. handler can be a callable Python object taking two arguments&lt;/p&gt;
&lt;p&gt;handler: handler(signum, frame)&lt;/p&gt;
&lt;h1&gt;example&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Signal handler called with signal&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;signum&lt;/span&gt;
    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;IOError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Couldn&amp;#39;t open device!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Set the signal handler and a 5-second alarm&lt;/span&gt;
&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGALRM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;alarm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# This open() may hang indefinitely&lt;/span&gt;
&lt;span class="n"&gt;fd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/dev/ttyS0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;O_RDWR&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;signal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;alarm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;          &lt;span class="c1"&gt;# Disable the alarm&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Reference:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://docs.python.org/2/library/signal.html&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 24 Jul 2017 19:15:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-24:/posts/python-signal.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>shell ç¼–ç¨‹æ•™ç¨‹</title><link>/posts/shell-bian-cheng-jiao-cheng.html</link><description>&lt;h1&gt;å˜é‡å’Œå€¼&lt;/h1&gt;
&lt;p&gt;variables are referenced by $var or ${var}. Global variables are visible to all sub bash sessions, and are often called env variables, local variables are only visible to local session, not subsessions.&lt;/p&gt;
&lt;p&gt;Global variables can be viewed as &lt;code&gt;env&lt;/code&gt;, and can be created by &lt;code&gt;export&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;TEST=testing; export $TEST # or
export TEST=testing # NOTE: no $
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Useful variables&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;HOME    Same to ~
IFS 
PATH    Search path
EUID    User id
GROUPS  Groups for current user
HOSTNAME    Hostname
LANG    
LC_ALL  
OLDPWD  
PWD 
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å®šä¹‰å’Œä½¿ç”¨å˜é‡&lt;/h2&gt;
&lt;p&gt;å®šä¹‰å˜é‡ï¼Œæ³¨æ„å› ä¸º shell ä¸­çš„è¯­æ³•ä½¿ç”¨ç©ºæ ¼ä½œä¸ºå‘½ä»¤åˆ†å‰²çš„é™åˆ¶ï¼Œç­‰äºå·å‰åä¸èƒ½åŠ ç©ºæ ¼ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FOO=bar
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨å˜é‡ï¼Œéœ€è¦æ·»åŠ ä¸Š &lt;code&gt;$&lt;/code&gt; ç¬¦å·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;echo $FOO
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å­—ç¬¦ä¸²åœ¨åŒå¼•å·ä¸­å¯ä»¥ç›´æ¥æ’å…¥ï¼Œè¿™æ—¶å€™è¦åŠ ä¸Šå¤§æ‹¬å·æ¥æŒ‡ç¤ºå˜é‡åçš„èµ·å§‹ä½ç½®ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;echo &amp;quot;&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;FOO&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;xxx&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å˜é‡é»˜è®¤å®åœ¨å½“å‰çš„å›è¯ä¸­å¯è§çš„ï¼Œè€Œä¸ä¼šä½œä¸ºç¯å¢ƒå˜é‡ä¼ é€’ç»™è°ƒç”¨çš„å‘½ä»¤ã€‚å¯ä»¥ä½¿ç”¨ export å¯¼å‡ºå˜é‡ï¼Œæˆ–è€…åœ¨å‘½ä»¤å‰åŠ ä¸ŠæŒ‡å®šçš„ç¯å¢ƒå˜é‡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FOO env variable is: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FOO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;python3&lt;/span&gt; &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;span class="n"&gt;FOO&lt;/span&gt; &lt;span class="n"&gt;env&lt;/span&gt; &lt;span class="n"&gt;variable&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="bp"&gt;None&lt;/span&gt;

&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;FOO&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bar&lt;/span&gt; &lt;span class="n"&gt;python3&lt;/span&gt; &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;span class="n"&gt;FOO&lt;/span&gt; &lt;span class="n"&gt;env&lt;/span&gt; &lt;span class="n"&gt;variable&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="n"&gt;bar&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ export&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % export FOO=bar
-&amp;gt; % python3 env.py
FOO env variable is:  bar
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä¸€äº›æœ‰ç”¨çš„å†…ç½®å˜é‡&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$HOME     å®¶ç›®å½•ï¼Œæ¯”å¦‚ /home/kongyifei
$IFS      é»˜è®¤çš„åˆ†éš”ç¬¦ï¼Œå’Œ for å¾ªç¯ç´§å¯†ç›¸å…³
$PATH     æœç´¢è·¯å¾„ï¼Œå½“ä½ æ‰§è¡Œ ls çš„æ—¶å€™ï¼Œshell ä¼šåœ¨è¿™ä¸ªå˜é‡ä¸­æŸ¥æ‰¾ ls å‘½ä»¤
$EUID     å½“å‰æœ‰æ•ˆç”¨æˆ· ID
$LANG     
$LC_ALL   
$OLDPWD   ä¸Šä¸€ä¸ªå·¥ä½œç›®å½•
$PWD      å½“å‰å·¥ä½œç›®å½•
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ•°ç»„&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨å°æ‹¬å·æ¥å®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œå…³äº for å¾ªç¯éšåä¼šè®²&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;A=(1 2 3)

for el in &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;; do
    echo &lt;span class="nv"&gt;$el&lt;/span&gt;
done
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å­—ç¬¦ä¸²æ“ä½œ&lt;/h2&gt;
&lt;p&gt;å¤§æ‹¬å·é‡Œé¢çš„å­—ç¬¦ä¸²ä¼šè¢«å±•å¼€æˆç‹¬ç«‹çš„å­—ç¬¦ä¸²&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;% echo {1,2,3,4}&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="c"&gt;% mkdir -p test/{a,b,c,d}{1,2,3,4}&lt;/span&gt;
&lt;span class="c"&gt;% ls test/&lt;/span&gt;
&lt;span class="n"&gt;a1&lt;/span&gt; Â &lt;span class="n"&gt;a2&lt;/span&gt; Â &lt;span class="n"&gt;a3&lt;/span&gt; Â &lt;span class="n"&gt;a4&lt;/span&gt; Â &lt;span class="n"&gt;b1&lt;/span&gt; Â &lt;span class="n"&gt;b2&lt;/span&gt; Â &lt;span class="n"&gt;b3&lt;/span&gt; Â &lt;span class="n"&gt;b4&lt;/span&gt; Â &lt;span class="n"&gt;c1&lt;/span&gt; Â &lt;span class="n"&gt;c2&lt;/span&gt; Â &lt;span class="n"&gt;c3&lt;/span&gt; Â &lt;span class="n"&gt;c4&lt;/span&gt; Â &lt;span class="n"&gt;d1&lt;/span&gt; Â &lt;span class="n"&gt;d2&lt;/span&gt; Â &lt;span class="n"&gt;d3&lt;/span&gt; Â &lt;span class="n"&gt;d4&lt;/span&gt;
&lt;span class="c"&gt;% mv test/{a,c}.conf  # è¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯ï¼šmv test/a.conf test/c.conf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åˆ‡ç‰‡: &lt;code&gt;${string:start:length}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤å€¼ &lt;code&gt;${var:-default}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è®¾å®šå€¼ &lt;code&gt;${var:=default}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é•¿åº¦ &lt;code&gt;${#var}&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;å­—ç¬¦ä¸² Expansion and slice&lt;/h3&gt;
&lt;p&gt;[zorro@zorrozou-pc0 bash]$ mkdir -p test/zorro/{a,b,c,d}{1,2,3,4} 
[zorro@zorrozou-pc0 bash]$ ls test/zorro/ 
a1 Â a2 Â a3 Â a4 Â b1 Â b2 Â b3 Â b4 Â c1 Â c2 Â c3 Â c4 Â d1 Â d2 Â d3 Â d4&lt;/p&gt;
&lt;p&gt;[zorro@zorrozou-pc0 bash]$ mv test/{a,c}.conf
è¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯ï¼šmv test/a.conf test/c.conf&lt;/p&gt;
&lt;p&gt;${string:start :length} string slice&lt;/p&gt;
&lt;p&gt;default value: ${var:-default}
set value: ${var:=default}&lt;/p&gt;
&lt;p&gt;${#var} get variable length&lt;/p&gt;
&lt;h1&gt;Redirection&lt;/h1&gt;
&lt;p&gt;input: &amp;lt;, output &amp;gt;, append &amp;gt;&amp;gt;&lt;/p&gt;
&lt;p&gt;cat &amp;gt; file &amp;lt;&amp;lt; EOF
this 
line
will 
be redirected to
file
EOF&lt;/p&gt;
&lt;h1&gt;pipe&lt;/h1&gt;
&lt;p&gt;pipe commands will be run simultaneously, but the second command will wait for the input&lt;/p&gt;
&lt;h1&gt;Sub shell&lt;/h1&gt;
&lt;p&gt;use $(expression)&lt;/p&gt;
&lt;h1&gt;æ§åˆ¶è¯­å¥&lt;/h1&gt;
&lt;h2&gt;æ¡ä»¶è¯­å¥&lt;/h2&gt;
&lt;p&gt;if è¯­å¥æˆç«‹çš„æ¡ä»¶æ˜¯ &lt;code&gt;expr&lt;/code&gt; è¿”å›å€¼ä¸º 0ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;if expr; then
    statement;
elif expr; then
    statement;
else
    statement;
fi
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;test command&lt;/h2&gt;
&lt;p&gt;è™½ç„¶å¯ä»¥ä½¿ç”¨ä»»æ„çš„è¯­å¥ä½œä¸ºåˆ¤æ–­æ¡ä»¶ï¼Œä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯ç”¨ &lt;code&gt;[&lt;/code&gt; è¿™ä¸ªå‘½ä»¤æ¥ä½œä¸ºåˆ¤æ–­æ¡ä»¶çš„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ &lt;code&gt;[&lt;/code&gt; å¹¶ä¸æ˜¯ä¸€ä¸ªè¯­æ³•ï¼Œè€Œæ˜¯ä¸€ä¸ªå‘½ä»¤ã€‚ä¸è¿‡ç”±äº &lt;code&gt;[&lt;/code&gt; è¿™ä¸ªä¸Šå¤å‘½ä»¤å®åœ¨åŠŸèƒ½å¤ªå°‘ï¼Œç°åœ¨ä¸€èˆ¬é‡‡ç”¨ &lt;code&gt;[[&lt;/code&gt; æ¥ä½œä¸ºåˆ¤æ–­æ¡ä»¶ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;if [[ &amp;quot;a&amp;quot; == &amp;quot;b&amp;quot; ]]; then
    echo &amp;quot;wtf&amp;quot;
else
    echo &amp;quot;meh&amp;quot;
fi
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;[[&lt;/code&gt;æ”¯æŒçš„æ¡ä»¶æœ‰&lt;/p&gt;
&lt;p&gt;1 æ•°å€¼æ¯”è¾ƒ, ä»…é™æ•´æ•°ï¼Œæ³¨æ„ä¸èƒ½ä½¿ç”¨ &lt;code&gt;&amp;gt;&lt;/code&gt; &lt;code&gt;&amp;lt;&lt;/code&gt; ç­‰ç¬¦å·ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;n1 -eq n2   equal
n1 -ge n2   greater or equal
n1 -gt n2   greater
n1 -le n2       less or equal
n1 -lt n2   less
n1 -ne n2   not equal
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;2 å­—ç¬¦ä¸²æ¯”è¾ƒ&lt;/p&gt;
&lt;p&gt;Note: Variables may contain space, so the best way to comparison is to add quotes: &lt;code&gt;"$var1" = "$var2"&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;str1 == str2    equal
str1 != str2    not equal
str1 &amp;lt; str2 less
str1 &amp;gt; str2 greater
-z str  zero
-n str  not zero length
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;3 file comparison&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-d  is directory?
-e  exist?
-f  is regular file?
-r  exist and readable?
-s  exist and has content
-w  exist and writable
-x  exist and executealbe
-O  exist and owned
-G  exist and in same group
file -nt file2  newer than
file1 -ot file2     older than
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;case&lt;/h2&gt;
&lt;p&gt;case var in 
parttern | pattern2) commands;;
pattern3) commands2;
*) default commnads;;
esac&lt;/p&gt;
&lt;h2&gt;Loops&lt;/h2&gt;
&lt;h3&gt;foreach è¯­å¥&lt;/h3&gt;
&lt;p&gt;for var in list; do
     echo $var
done&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ list å¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¢« $IFS åˆ†å‰²çš„å­—ç¬¦ä¸²ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ$IFS æ˜¯ " \n\t"ã€‚å…¶ä¸­åŒ…å«äº†ç©ºæ ¼ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¦è¦†ç›– IFSï¼Œä¸€èˆ¬è¿™æ ·ä½¿ç”¨:&lt;/p&gt;
&lt;p&gt;OLDIFS=$IFS
IFS="\n" # new seperator&lt;/p&gt;
&lt;h1&gt;do things&lt;/h1&gt;
&lt;p&gt;IFS=$OLDIFS&lt;/p&gt;
&lt;h3&gt;while-loop&lt;/h3&gt;
&lt;p&gt;until/while expr; do
    # commands
done&lt;/p&gt;
&lt;h3&gt;pipe&lt;/h3&gt;
&lt;p&gt;the result of a for loop is pipe-able to other command&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;for city in beijing shanghai; do
    echo $city is big
done &amp;gt; cities.txt
# will save the result in cities.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;è¾“å…¥è¾“å‡º&lt;/h1&gt;
&lt;h2&gt;å‘½ä»¤è¡Œå‚æ•°&lt;/h2&gt;
&lt;p&gt;parameters to a script can be obtained as $1, $2, $3...ã€‚ $0 is the script name, remember to check whether the parameter is empty. $# is the number of parameters(without script name).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$0  script name / function name
$1...$x command line arguments / parameters
$#  number of arguments(without $0)
$*  all parameters as a string
$@  all parameters as a string list
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;shift&lt;/h3&gt;
&lt;p&gt;processing parameters using shift,&lt;/p&gt;
&lt;p&gt;while [ -n "$1" ]; do
    case "$1" in
        -a) echo "option -a" ;;
        --) shift
            break;;
        *) echo "$1" is not a option ;;
    esac
    shift
done&lt;/p&gt;
&lt;h2&gt;read&lt;/h2&gt;
&lt;p&gt;read OPTIONS VARNAME read input to variables&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;read -p   Prompt&lt;/li&gt;
&lt;li&gt;read -t   timeout&lt;/li&gt;
&lt;li&gt;read -s   hide input&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;we can use read to read file or stdin&lt;/p&gt;
&lt;h2&gt;redirection&lt;/h2&gt;
&lt;p&gt;2&amp;gt;  redirect STDERR
m&amp;gt;&amp;amp;n    redirect fd m to fd n's associated file&lt;/p&gt;
&lt;p&gt;Note: you have to use command &amp;gt;&amp;gt; command.log 2&amp;gt;&amp;amp;1 (put 2&amp;gt;&amp;amp;1 at the end), since this means redirect 2 to 1's 
in a scirpt
exec 2&amp;gt; filename # reopen stdout to filename&lt;/p&gt;
&lt;h1&gt;Signal&lt;/h1&gt;
&lt;p&gt;trap commnad signal is used to handle signals in shell&lt;/p&gt;
&lt;h1&gt;Functions&lt;/h1&gt;
&lt;p&gt;æœ‰ä¸¤ç§å®šä¹‰å‡½æ•°çš„æ–¹å¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;body&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;foo() {&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;body&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¦è°ƒç”¨ä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œç›´æ¥å°±è¾“å…¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;foo
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å°±å¥½äº†&lt;/p&gt;
&lt;h2&gt;return&lt;/h2&gt;
&lt;p&gt;shell functions behave like a small script, and it does NOT return a computed value...It retures a exit code, which is between 0 and 255. if no return is specified, the exit code of last command will be returned&lt;/p&gt;
&lt;p&gt;You can read the return value by $? like any normal commands&lt;/p&gt;
&lt;p&gt;the right way to to return a value from function, you will have to echo out the value, and put the function is subshell&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;foo&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="nx"&gt;some&lt;/span&gt; &lt;span class="nx"&gt;compute&lt;/span&gt;
    &lt;span class="nx"&gt;echo&lt;/span&gt; &lt;span class="nx"&gt;$result&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;retval&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Note: any thing that echos in the function body will be captured, so please keep that from happen&lt;/p&gt;
&lt;h2&gt;parameters&lt;/h2&gt;
&lt;p&gt;like a shell script, $0 holds the function name, $1 ... $9 holds the parameters, $# is the num of parameters&lt;/p&gt;
&lt;h2&gt;local variables&lt;/h2&gt;
&lt;p&gt;use &lt;code&gt;local&lt;/code&gt; to declare local variables&lt;/p&gt;
&lt;h1&gt;alias&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;alias new_name=&amp;#39;command string&amp;#39;
$ \command  # bypass alias
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;debugging&lt;/h1&gt;
&lt;p&gt;DEBUG macro&lt;/p&gt;
&lt;h1&gt;multiprocess&lt;/h1&gt;
&lt;p&gt;PID_ARRAY=()
for file in filelist; do
    md5sum file &amp;amp;;
    PID_ARRAY+=("$!")
done
wait ${PID_ARRAY[@]}&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 16 Jul 2017 01:38:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-16:/posts/shell-bian-cheng-jiao-cheng.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>docker å°æŠ€å·§</title><link>/posts/docker-xiao-ji-qiao.html</link><description>&lt;h1&gt;åˆ é™¤æ‰€æœ‰åœæ­¢çš„å®¹å™¨&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker rm `docker ps -aq`
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åˆ é™¤æ‰€æœ‰æ²¡æœ‰ tag çš„é•œåƒ&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker rmi `docker images | grep &amp;quot;^&amp;amp;lt;none&amp;amp;gt;&amp;quot; | awk &amp;#39;{print $3}&amp;#39;`
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;è¿›å…¥è¿è¡Œä¸­çš„é•œåƒ&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker exec -it CONTAINER_NAME bash
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 14 Jul 2017 21:04:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-14:/posts/docker-xiao-ji-qiao.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category><category>Docker</category></item><item><title>open sourcing a django project</title><link>/posts/open-sourcing-a-django-project.html</link><description>&lt;h1&gt;remove sensetive data&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;move settings to seperate settings_secret.py file, and import it in the settings.py&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;read all secrets from environment&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 14 Jul 2017 20:51:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-14:/posts/open-sourcing-a-django-project.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>å¦‚æœé‡åˆ°åˆšå…¥èŒåœºçš„æˆ‘ â€”â€” å°é“æ¶ˆæ¯</title><link>/posts/ru-guo-yu-dao-gang-ru-zhi-chang-de-wo-xiao-dao-xiao-xi.html</link><description>&lt;p&gt;0.èƒ½åŠ›çš„æå‡æ¯”æ¶¨å·¥èµ„æ›´é‡è¦ï¼Œè™½ç„¶ä½ ç‰¹åˆ«ç¼ºé’±ï¼Œåˆšå¼€å§‹å·¥ä½œè°ä¸ç¼ºé’±å•Šï¼Œåˆä¸æ˜¯å¯ŒäºŒä»£ã€‚åˆ«è·ŸåŒäº‹æ¯”è–ªæ°´ï¼Œã€Œé‚£ä¸ªè ¢è´§æ¯”æˆ‘æŠ€æœ¯å·®ï¼Œå‡­ä»€ä¹ˆæ¯”æˆ‘è–ªæ°´é«˜?ã€è ¢è´§ï¼Œæ¯”äº†ä¹Ÿä¸ä¼šè®©ä½ è–ªæ°´ç«‹åˆ»æ¶¨ä¸Šæ¥ã€‚&lt;/p&gt;
&lt;p&gt;1.è€æ¿ä¸æ˜¯èµ„æœ¬å®¶ï¼Œä»–/å¥¹ä¹Ÿæ²¡æœ‰å‰¥å‰Šä½ ã€‚ã€Œå·¥ä½œå—å‰¥å‰Šã€å¤§æ¦‚æ˜¯æˆ‘è¿™ä¸€å¸¦äººä¹ƒè‡³å‡ ä»£äººå—çš„æ•™è‚²é‡Œæœ€å½±å“ä½ èŒä¸šå‘å±•çš„ä¸€ä¸ªåƒåœ¾è§‚å¿µäº†ï¼Œèµ¶ç´§ä»å¤´è„‘ä¸­åˆ é™¤ã€‚æ°¸è¿œä¸è¦å†æƒ³èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;2.æ³¨æ„ä»ªå®¹ä»ªè¡¨ï¼Œå°½ç®¡ä½ æ˜¯ä¸ªå·¥ç¨‹å¸ˆï¼Œä½†ä¹Ÿä¸èƒ½ç©¿å¾—åˆ«å¤ªé‚‹é¢ï¼Œè¡£æœæ•´æ´ï¼Œæ¯å¤©æ´—å¤´ï¼Œåˆ®èƒ¡å­ã€‚&lt;/p&gt;
&lt;p&gt;3.ä½ çš„åŒäº‹ä¸æ˜¯ç¬¨è›‹ï¼Œä½ çš„å®¢æˆ·ä¹Ÿä¸æ˜¯ç™½ç—´ï¼Œä½ è‡ªå·±æ‰æ˜¯è ¢è´§ã€‚æ‰€ä»¥ï¼Œå¯¹ä»–ä»¬å‡ºç°çš„é”™è¯¯è¦èƒ½å¤Ÿç†è§£ï¼Œä½ çš„åŒäº‹å¼€å‘çš„è½¯ä»¶ä¼šæœ‰ç¼ºé™·ï¼Œå®¢æˆ·ä¸ä¼šç”¨åˆ™æ˜¯å› ä¸ºè½¯ä»¶åšå¾—ä¸å¤Ÿå¥½ã€‚&lt;/p&gt;
&lt;p&gt;4.åœ¨å®¢æˆ·é‚£é‡Œï¼Œä½ ä»£è¡¨çš„å°±æ˜¯å…¬å¸ã€‚åˆ«è·Ÿå®¢æˆ·æŠ±æ€¨å…¬å¸çš„äº§å“ä¸å¤Ÿå¥½ä¸ç»™åŠ›ï¼Œè¿™å®åœ¨å¤ªè ¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;5.åšå¥½å°äº‹ï¼Œå¤„ç†å¥½æ¯ä»¶å°äº‹çš„ç»†èŠ‚ï¼Œåšä¸å¥½çš„åœ°æ–¹è‡ªå·±è¦æœ‰æ€»ç»“ï¼Œæ‰¾åˆ°åŸå› ä»¥ä¾¿æ”¹è¿›ã€‚ç›¸ä¿¡æˆ‘ï¼Œè¿™æ—¶å€™ä½ çœŸä¸æ˜¯åšå¤§äº‹çš„æ–™ã€‚&lt;/p&gt;
&lt;p&gt;6.å…»æˆä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œæ¯”å¦‚æ¯å¤©åšå·¥ä½œè®°å½•ï¼Œæ¯å¤©å›é¡¾è‡ªå·±ã€‚è·³æ§½åä½ ä¼šå‘ç°æ¯”å¾ˆå¤šäººéƒ½ç‰›ã€‚ä¸€ä¸ªå¥½ä¹ æƒ¯èƒ½ç§’æ‰ä¸€å¤§éƒ¨åˆ†äººã€‚&lt;/p&gt;
&lt;p&gt;7.ä»ç°åœ¨èµ·ï¼Œä½ è®¤è¯†çš„æ¯ä¸ªäººä»¥åè·Ÿä½ å¯èƒ½éƒ½æœ‰åˆä½œå…³ç³»ï¼Œä»–ä»¬ä»¥åå¯èƒ½æ˜¯ä½ çš„åŒäº‹ï¼Œä½ çš„ä¸‹å±ï¼Œä½ çš„ä¸Šå¸ï¼Œä½ çš„åˆä½œä¼™ä¼´ã€‚äº‰å–è®©ä»–ä»¬ç¬¬ä¸€å°è±¡å¯¹ä½ å¥½ä¸€ç‚¹ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 08 Jul 2017 09:19:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-08:/posts/ru-guo-yu-dao-gang-ru-zhi-chang-de-wo-xiao-dao-xiao-xi.html</guid><category>talks</category></item><item><title>curio</title><link>/posts/curio.html</link><description>&lt;p&gt;curio æ˜¯ä¸€ä¸ªç¥å¥‡çš„ Python åº“ï¼Œå®ƒå®Œå…¨é¢å‘ Python 3.5 å¢åŠ çš„ async/await è¯­æ³•ï¼Œä»ä½å±‚å°±æ²¡æœ‰ä½¿ç”¨ callback çš„è¯­æ³•ï¼Œå› æ­¤ç›¸æ¯” asyncio æ¥è¯´è®¾è®¡æ›´ç®€å•ï¼ŒAPI æ›´ä¼˜é›…ï¼Œæ€§èƒ½å´æ›´å¥½ã€‚&lt;/p&gt;
&lt;h1&gt;ä¸€ä¸ªä¾‹å­&lt;/h1&gt;
&lt;p&gt;curio çš„æ–‡æ¡£ç»™äº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œä¸‹é¢æ€»ç»“ä¸€ä¸‹è¿™ä¸ªä¾‹å­ã€‚è¿™ä¸ªä¾‹å­æ¨¡æ‹Ÿäº†å­©å­åœ¨ç©Minecraftï¼Œè€Œå®¶é•¿åœ¨å‚¬ä¿ƒå­©å­è¯¥å‡ºå‘äº†çš„æƒ…æ™¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;curio&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;countdonw&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;T-minus&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;cuiro&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œä¸èƒ½ä½¿ç”¨åŒæ­¥ä»£ç ä¸­çš„ time.sleep&lt;/span&gt;
        &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="n"&gt;start_evt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cruio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Event&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;frined&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ä½ å¥½, æˆ‘å«&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å¼€å§‹ç© Minecraft&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CancelledError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;å›å®¶äº†&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fib&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;fib&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;fib&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;kid&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å¯ä»¥ç©äº†å—?&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timeout_after&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start_evt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# ç­‰å¾…ä¸€ç§’&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TaskTimeout&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å•Šå•Šå•Š&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;åœ¨ Minecraft ä¸­é€ å»ºç­‘&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TaskGroup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;friend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Max&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# ç”Ÿæˆ friend åç¨‹&lt;/span&gt;
        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;friend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Lilikan&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;friend&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Thomas&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;total&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="n"&gt;total&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_in_process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fib&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="c1"&gt;# æŠŠè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡äº¤ç»™å¦ä¸€ä¸ªè¿›ç¨‹&lt;/span&gt;
                &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_in_thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# ä¼šé˜»å¡çš„ï¼Œæ”¾åˆ°å…¶ä»–çº¿ç¨‹&lt;/span&gt;
            &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# æ¨¡æ‹Ÿå»¶è¿Ÿ&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CancelledError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å¥½çš„ï¼Œä¿å­˜ä¸­&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# å¦‚æœè¢«å–æ¶ˆäº†ï¼Œåšå¥½å–„åå·¥ä½œ&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt;  &lt;span class="c1"&gt;# éœ€è¦é‡æ–°è·‘å‡ºå¼‚å¸¸&lt;/span&gt;

&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;kid_task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# æ‰“å¼€ kid åç¨‹ï¼Œè¿™é‡Œå¹¶ä¸ä¼šç­‰å¾…kid è¿è¡Œå®Œæ¯•&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å»ç©å§&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;start_evt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;è¯¥å‡ºå‘äº†&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;count_task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;countdown&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# å¼€å§‹å€’è®¡æ—¶åç¨‹&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;count_task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c1"&gt;# ä½¿ç”¨ join ç­‰å¾…ä¸€ä¸ªåç¨‹å®Œæˆ&lt;/span&gt;

    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;çœŸçš„è¦èµ°äº†&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timeout_after&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;kid_task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# ç­‰å¾… kid åç¨‹è¿è¡Œå®Œæ¯•ï¼Œæœ€å¤šåç§’&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TaksTimeout&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;è­¦å‘Šè¿‡ä½ äº†&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;kid_task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cancel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;å‡ºå‘äº†&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;curio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="err"&gt;ï¼Œ&lt;/span&gt; &lt;span class="n"&gt;with_monitor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# å¼€å§‹æ‰§è¡Œ&lt;/span&gt;
    &lt;span class="c1"&gt;# with_monitor å¯ä»¥åœ¨å¦ä¸€ä¸ªçª—å£å®æ—¶è§‚å¯Ÿæœ‰å¤šå°‘åç¨‹åœ¨è¿è¡Œ&lt;/span&gt;
    &lt;span class="c1"&gt;# python3 -m curio.monitor&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;curio monitor çš„ä½¿ç”¨&lt;/h1&gt;
&lt;h3&gt;æ‰“å¼€ curio&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ python -m cuiro.monitor
Curio Monitor: &lt;span class="m"&gt;4&lt;/span&gt; tasks running
Type &lt;span class="nb"&gt;help&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; commands
curio&amp;gt; 
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä½¿ç”¨ ps åˆ—å‡ºå½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curio &amp;gt; ps
Task   State        Cycles     Timeout Task
------ ------------ ---------- ------- --------------------------------------------------
1      FUTURE_WAIT  1          None    Monitor.monitor_task
2      READ_WAIT    1          None    Kernel._run_coro.&amp;lt;locals&amp;gt;._kernel_task
3      TASK_JOIN    3          None    parent
4      TIME_SLEEP   1          None    kid
curio &amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä½¿ç”¨ where æŸ¥çœ‹æ¯ä¸ªåç¨‹çš„è°ƒç”¨æ ˆ&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curio &amp;gt; w 3
Stack for Task(id=3, name=&amp;#39;parent&amp;#39;, &amp;lt;coroutine object parent at 0x1024796d0&amp;gt;, state=&amp;#39;TASK_JOIN&amp;#39;) (most recent call last):
  File &amp;quot;hello.py&amp;quot;, line 23, in parent
    await kid_task.join()
  File &amp;quot;/Users/beazley/Desktop/Projects/curio/curio/task.py&amp;quot;, line 106, in join
    await self.wait()
  File &amp;quot;/Users/beazley/Desktop/Projects/curio/curio/task.py&amp;quot;, line 117, in wait
    await _scheduler_wait(self.joining, &amp;#39;TASK_JOIN&amp;#39;)
  File &amp;quot;/Users/beazley/Desktop/Projects/curio/curio/traps.py&amp;quot;, line 104, in _scheduler_wait
    yield (_trap_sched_wait, sched, state)

curio &amp;gt; w 4
Stack for Task(id=4, name=&amp;#39;kid&amp;#39;, &amp;lt;coroutine object kid at 0x102479990&amp;gt;, state=&amp;#39;TIME_SLEEP&amp;#39;) (most recent call last):
  File &amp;quot;hello.py&amp;quot;, line 12, in kid
    await curio.sleep(1000)
  File &amp;quot;/Users/beazley/Desktop/Projects/curio/curio/task.py&amp;quot;, line 440, in sleep
    return await _sleep(seconds, False)
  File &amp;quot;/Users/beazley/Desktop/Projects/curio/curio/traps.py&amp;quot;, line 80, in _sleep
    return (yield (_trap_sleep, clock, absolute))

curio &amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä½¿ç”¨cancelå–æ¶ˆä¸€ä¸ªåç¨‹&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curio &amp;gt; cancel 4
Cancelling task 4
*** Connection closed by remote host ***
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;curio çš„API&lt;/h1&gt;
&lt;h2&gt;coroutine ä¸ kernel&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;async def&lt;/code&gt;æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„coroutine. æ¯ä¸ªcoroutineä¸èƒ½å¤Ÿå•ç‹¬æ‰§è¡Œ, è€Œæ˜¯éœ€è¦é€šè¿‡ä¸€ä¸ª&lt;code&gt;kernel&lt;/code&gt;æ¥æ‰§è¡Œ(ç›¸å½“äºasyncioä¸­çš„loop). å½“ç„¶ä¸€èˆ¬æƒ…å†µä¸‹, æˆ‘ä»¬ä¸ä¼šä¸»åŠ¨å»ç”Ÿæˆä¸€ä¸ªkernel, è€Œæ˜¯è°ƒç”¨curio.runæ¥äº¤ç»™curio éšå¼æ‰§è¡Œ. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;async def hello(name):
    print(&amp;#39;hello&amp;#39;, name) 

run(hello, &amp;#39;Guido&amp;#39;)    # Preferred
run(hello(&amp;#39;Guido&amp;#39;))    # Ok
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;tasks&lt;/h2&gt;
&lt;p&gt;å‰é¢è¯´åˆ°, ä¸€ä¸ªcoroutineéœ€è¦äº¤ç»™curioæ¥è¿è¡Œ, ä½†æ˜¯å®é™…ä¸Š curio è¿è¡Œçš„å¹¶ä¸æ˜¯è¿™ä¸ªcoroutine, è€Œæ˜¯åŒ…å«äº†è¿™ä¸ªcoroutine çš„ task. task å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªçº¿ç¨‹, è€Œcoroutineåˆ™å¯ä»¥çœ‹æˆæ˜¯targetå‡½æ•°. å’Œçº¿ç¨‹ä¸€æ ·, task ä¹Ÿåˆ†ä¸ºäº†daemonçš„å’Œédaemonçš„. å½“æ‰€æœ‰édaemonçš„taskæ‰§è¡Œå®Œæ¯•ä¹‹å, kernelå°±ä¼šè‡ªåŠ¨é€€å‡º. è¿™ä¸ªå’Œçº¿ç¨‹æ˜¯ç±»ä¼¼çš„, æ‰€æœ‰çš„édaemonçš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹å, æ•´ä¸ªè¿›ç¨‹å°±ä¼šé€€å‡º. è€Œæˆ‘ä»¬é€šè¿‡ curio.run åˆ›å»ºçš„é‚£ä¸ªtaskå®é™…ä¸Šå°±ç›¸å½“äºæ˜¯æˆ‘ä»¬åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­çš„ä¸»çº¿ç¨‹äº†.&lt;/p&gt;
&lt;h3&gt;spawn&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;await spawn(corofunc, *args, daemon=False)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­, æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ &lt;code&gt;t = Theaad(target=func); t.start()&lt;/code&gt; æ¥å¼€å§‹æ‰§è¡Œæ–°çš„çº¿ç¨‹. ç„¶è€Œ, åœ¨curioä¸­,ä½ ä¸èƒ½é€šè¿‡ &lt;code&gt;t = Task(target=func); t.start()&lt;/code&gt; æ¥åˆ›å»ºæ–°çš„ task. è€Œåº”æ”¹é€šè¿‡ &lt;code&gt;t = await spawn(corofunc)&lt;/code&gt; æ¥åˆ›å»ºå¹¶å¼€å§‹æ‰§è¡Œæ–°çš„coroutine.&lt;/p&gt;
&lt;h3&gt;Task join&lt;/h3&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ &lt;code&gt;r = await task.join()&lt;/code&gt; æ¥ç­‰å¾…taskè¿è¡Œç»“æŸ, å¹¶è·å¾—è¿”å›å€¼. ä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;code&gt;await task.wait()&lt;/code&gt; ä½†æ˜¯ä¸ä¼šè¿”å›å€¼, å¿…é¡»ä¹‹åå†ä½¿ç”¨ task.result è·å¾—è¿”å›å€¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;v = await Task.join()  # è¿”å›è¿”å›å€¼

# or 

await task.wait()
v = task.result  # å¦‚æœåœ¨taskç»“æŸä¹‹å‰è®¿é—®, ä¼šraise RuntimeError
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Task Group&lt;/h3&gt;
&lt;p&gt;curio æ”¯æŒä½¿ç”¨ taskgroup æ¥ç®¡ç†ä¸€ç»„ä»»åŠ¡, &lt;code&gt;class TaskGroup(tasks=(), *, wait=all, name=None)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;åœ¨åˆ›å»ºtask groupçš„æ—¶å€™å°±å¯ä»¥æŠŠå·²ç»ç”Ÿæˆçš„taskæ”¾å…¥groupä¸­, æˆ–è€…éšåä½¿ç”¨ task_group.spawn/add_task æ¥å‘group ä¸­æ·»åŠ task.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;await TaskGroup.spawn(corofunc, *args, ignore_result=False)
# ç”Ÿæˆä¸€ä¸ªtask, å¹¶æ”¾å…¥åˆ°è¯¥task groupä¸­

await TaskGroup.add_task(coro)
# æ·»åŠ å·²æœ‰çš„ task åˆ°è¯¥ task group ä¸­
# ä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«æ·»åŠ  corofunc å’Œ task åˆ°å½“å‰ group ä¸­

await TaskGroup.join(*, wait=all)
# ç­‰å¾…æ‰€æœ‰çš„taskè¿è¡Œç»“æŸ

await TaskGroup.cancel_remaining()
# å–æ¶ˆæ‰€æœ‰è¿˜åœ¨è¿è¡Œçš„task
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;ç”¨åœ¨withè¯­å¥å’Œè¿­ä»£å™¨ä¸­&lt;/h4&gt;
&lt;p&gt;task group å¯ä»¥ç”¨åœ¨withè¯­å¥ä¸­, è¿™æ ·åœ¨withå—é€€å‡ºçš„æ—¶å€™å°±ä¼šéšå¼åœ°è°ƒç”¨ task_group.join().&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;async with TaskGroup() as g:
    t1 = await g.spawn(func1)
    t2 = await g.spawn(func2)
    t3 = await g.spawn(func3)

# all tasks done here
print(&amp;#39;t1 got&amp;#39;, t1.result)
print(&amp;#39;t2 got&amp;#39;, t2.result)
print(&amp;#39;t3 got&amp;#39;, t3.result)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;task group è¿˜å¯ä»¥ç”¨ä½œè¿­ä»£å™¨, å…¶ä¸­åŒ…å«äº†æ‰€æœ‰ task.result&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;async with TaskGroup() as g:
    t1 = await g.spawn(func1)
    t2 = await g.spawn(func2)
    t3 = await g.spawn(func3)
    async for task in g:
        print(task, &amp;#39;completed.&amp;#39;, task.result)
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;task local storage&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;class Local&lt;/code&gt; ç±»ä¼¼äºthreading.Local, ä½†æ˜¯éšç€ä¸€ä¸ªæ–°çš„ context local storage PEP çš„åˆ°æ¥, è¿™ä¸ªåŠŸèƒ½ä¼šè¢«åºŸå¼ƒæ‰&lt;/p&gt;
&lt;h2&gt;time&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ curio.sleep è€Œä¸æ˜¯ time.sleep, ä»¥ä¸ºæ•´ä¸ªåç¨‹éƒ½æ˜¯å•çº¿ç¨‹çš„.&lt;/p&gt;
&lt;h2&gt;workers&lt;/h2&gt;
&lt;p&gt;å¦‚æœéœ€è¦è¿è¡Œä¸€äº›CPUå¯†é›†çš„ä»»åŠ¡æˆ–è€…æ˜¯ä¸€äº›å¯èƒ½blockä½çš„ä»»åŠ¡, å¯ä»¥ä½¿ç”¨workers.&lt;/p&gt;
&lt;h3&gt;æœ‰ç”¨çš„å‡½æ•°&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;await curio.workers.run_in_process(callable, *args)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœå–æ¶ˆå¯¹åº”çš„coroutineçš„è¯, ç›¸åº”çš„è¿›ç¨‹ä¼šæ”¶åˆ°SIGTERMè€Œç«‹å³åœæ­¢æ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;await curio.workers.run_in_thread(callable, *args)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœå–æ¶ˆå¯¹åº”coroutineçš„è¯, ç›¸åº”çš„çº¿ç¨‹å¹¶ä¸ä¼šåœæ­¢æ‰§è¡Œ, è€Œæ˜¯è¿›å…¥ä¸€ç§ç±»ä¼¼ zombie çš„çŠ¶æ€, çŸ¥é“è¿è¡Œç»“æŸ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;await curio.workers.block_in_thread(callable, *args)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç±»ä¼¼ run_in_thread, ä½†æ˜¯å¯¹ç”¨åŒä¸€ä¸ªcallable, åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œ.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curio.workers.MAX_WORKER_THREADS  # åŒä¸€ä¸ªkernelèƒ½ä½¿ç”¨çš„æœ€å¤§çš„çº¿ç¨‹æ•°, é»˜è®¤64
curio.workers.MAX_WORKER_PROCESSES  # åŒä¸€ä¸ªkernelèƒ½ä½¿ç”¨çš„æœ€å¤§è¿›ç¨‹æ•°, é»˜è®¤ CPU æ•°é‡
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;è¯»å–æ–‡ä»¶å¯èƒ½æ˜¯ä¸ªå¾ˆè€—æ—¶çš„å·¥ä½œ, ä¸å…‰æ˜¯è¯»å†™ç£ç›˜, å¦‚æœä½ çš„æ–‡ä»¶æ˜¯åœ¨ä¸€ä¸ªç½‘ç»œæ–‡ä»¶ç³»ç»Ÿä¸Š, é‚£ä¹ˆå°†ä¼šæ›´åŠ è€—æ—¶. å¦‚æœåœ¨åç¨‹ä¸­å‘ç”Ÿè¿™ç§æ“ä½œ, æ•´ä¸ªåç¨‹kernel éƒ½ä¼šè¢«blockä½.&lt;/p&gt;
&lt;p&gt;curio.file æä¾›äº†ä¸€äº›ä¾›å¼‚æ­¥è¯»å–æ–‡ä»¶çš„æœºåˆ¶.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curio.file.aopen(*args, **kwargs)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯, è¿™ä¸ªå‡½æ•°åªèƒ½ç”¨åœ¨ Async Context Manager ä¸­, è€Œä¸èƒ½ç›´æ¥ &lt;code&gt;f = await aopen()&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;async with aopen(filename) as:
    async for line in f:
        print(line)
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;åŸè¯­&lt;/h2&gt;
&lt;p&gt;curio æä¾›äº† &lt;code&gt;Event&lt;/code&gt;, &lt;code&gt;Lock&lt;/code&gt;, &lt;code&gt;RLock&lt;/code&gt;, &lt;code&gt;Semephore&lt;/code&gt;, &lt;code&gt;BoundedSemaphore&lt;/code&gt;, &lt;code&gt;Condition&lt;/code&gt;ç­‰&lt;/p&gt;
&lt;h2&gt;queue&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚æ ‡å‡†åº“æä¾›äº† queue æ¨¡å—ç”¨äºå¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡ä¸€æ ·, curio æä¾›äº† curio.queue æ¥å®ç°task ä¹‹é—´çš„é€šä¿¡. ç”¨æ³•å’Œqueue æ¨¡å—åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„, é™¤äº†ä¸€äº›æ–¹æ³•å˜æˆäº† coroutine function, è€Œä¸æ˜¯æ™®é€šçš„å‡½æ•°äº†.&lt;/p&gt;
&lt;h2&gt;å¼‚æ­¥çº¿ç¨‹&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½ éœ€è¦æ‰§è¡Œå¾ˆå¤šçš„åŒæ­¥æ“ä½œ, ä½†æ˜¯è¿˜æ˜¯æƒ³è¦èƒ½å¤Ÿå’Œ curio æ¥äº¤äº’, å¯ä»¥ä½¿ç”¨å¼‚æ­¥çº¿ç¨‹. åœ¨å¼‚æ­¥çº¿ç¨‹å†…, å¯ä»¥ä½¿ç”¨&lt;code&gt;AWAIT&lt;/code&gt;å‡½æ•°æ¥å®ç°&lt;code&gt;await&lt;/code&gt;å…³é”®å­—çš„æ“ä½œ, å¯ä»¥ä½¿ç”¨æ™®é€šçš„&lt;code&gt;with&lt;/code&gt; å’Œ &lt;code&gt;for&lt;/code&gt;æ¥å®ç°ä½¿ç”¨äº†&lt;code&gt;async with&lt;/code&gt;. ä¹Ÿå°±æ˜¯å®ç°äº†ä¸ç”¨åœ¨coroutineå†…éƒ¨è€Œä½¿ç”¨ coroutine çš„æ“ä½œ.&lt;/p&gt;
&lt;p&gt;å¦å¤–å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯, å¦‚æœæŠŠå®šä¹‰çš„async threadå½“åšåŒæ­¥ç‰ˆæœ¬çš„çº¿ç¨‹æ¥è¿è¡Œ, é‚£ä¹ˆ &lt;code&gt;AWIAT&lt;/code&gt; å°±æ˜¯ä¸€ä¸ª no-op, ä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç›´æ¥æŠŠä»–å½“åšåŒæ­¥çº¿ç¨‹æ¥ç”¨.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 07 Jul 2017 14:56:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-07:/posts/curio.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>android public key pinning</title><link>/posts/android-public-key-pinning.html</link><description>&lt;h1&gt;What is public key pinning?&lt;/h1&gt;
&lt;p&gt;to view https traffic, you could sign your own root CA, and perform mitm attack to view the traffic. HPKP (http public key pinning) stops this sniffing by only trust given CA, thus, your self-signed certs will be invalid. To let given app to trust your certs, you will have to modify the apk file.&lt;/p&gt;
&lt;h1&gt;How to break it?&lt;/h1&gt;
&lt;h2&gt;Introducing Xposed&lt;/h2&gt;
&lt;p&gt;decompile, modify and then recompile the apk file can be very diffcult. so you'd better hook to some api to let the app you trying to intercept trust your certs. xposed offers this kind of ability. moreover, a xposed module called JustTrustMe have done the tedious work for you. just install xposed and JustTrustMe and you are off to go. Here are the detaild steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Install Xposed Installer&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;for android 5.0 above, use the xposed installer.&lt;/p&gt;
&lt;p&gt;NOTE: å¯¹äº MIUIï¼Œéœ€è¦æœç´¢ Xposed å®‰è£…å™¨ MIUI ä¸“ç‰ˆã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Install Xposed from xposed installer, note, you have to give root privilege to xposed installer&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install JustTrustMe&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 07 Jul 2017 08:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-07:/posts/android-public-key-pinning.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>android intent</title><link>/posts/android-intent.html</link><description>&lt;p&gt;You should use intent to communicate between activities and services&lt;/p&gt;
&lt;h1&gt;intent extra&lt;/h1&gt;
&lt;h2&gt;package data from activity&lt;/h2&gt;
&lt;p&gt;create a intent instance&lt;/p&gt;
&lt;p&gt;Intent intent = new Intent(getBaseContext(), SignoutActivity.class);
intent.putExtra("key", value);
startActivity(intent);&lt;/p&gt;
&lt;h2&gt;package data from service&lt;/h2&gt;
&lt;p&gt;Intent intent = new Intent(context, SignoutActivity.class);
intent.putExtra("key", value);
startService(intent);&lt;/p&gt;
&lt;h2&gt;Access data in activity&lt;/h2&gt;
&lt;p&gt;Access that intent on next activity
String s = getIntent().getStringExtra("EXTRA_SESSION_ID");
TheÂ docsÂ for Intents has more information (look at the section titled "Extras").&lt;/p&gt;
&lt;h2&gt;Access data in Service&lt;/h2&gt;
&lt;p&gt;just use the Intent parameter from onStartCommand&lt;/p&gt;
&lt;p&gt;public int onStartCommand (Intent intent, int flags, int startId) {
    String userID = intent.getStringExtra("UserID");
    return START_STICKY;
}&lt;/p&gt;
&lt;h1&gt;intent plags&lt;/h1&gt;
&lt;p&gt;see http://stackoverflow.com/questions/21833402/difference-between-intent-flag-activity-clear-task-and-intent-flag-activity-task&lt;/p&gt;
&lt;h1&gt;intent action&lt;/h1&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 06 Jul 2017 11:40:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-06:/posts/android-intent.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>android.os.handler</title><link>/posts/androidoshandler.html</link><description>&lt;p&gt;android.os.handler ç”¨äºå‘æ¯ä¸ªçº¿ç¨‹çš„ MessageQueue å‘é€æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;There are two main uses for a Handler: &lt;/p&gt;
&lt;p&gt;(1) to schedule messages and runnables to be executed as some point in the future; and &lt;/p&gt;
&lt;p&gt;(2) to enqueue an action to be performed on a different thread than your own.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 06 Jul 2017 10:48:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-06:/posts/androidoshandler.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>android vpn service</title><link>/posts/android-vpn-service.html</link><description>&lt;p&gt;VPN Service è¿è¡Œåœ¨ IP å±‚ã€‚å®ƒåˆ›å»ºäº†ä¸€ä¸ªè™šæ‹Ÿçš„ç½‘ç»œæ¥å£ï¼Œå¯ä»¥é…ç½®åœ°å€å’Œè·¯ç”±è§„åˆ™ï¼Œå¹¶è¿”å›ä¸€ä¸ª file descriptorã€‚æ¯æ¬¡è¯»è¿™ä¸ª fp è¿”å›ä¸€ä¸ªæ•°æ®åŒ…ï¼Œæ¯æ¬¡å†™å‘é€ä¸€ä¸ªæ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤ä¸ªæœ€é‡è¦çš„æ–¹æ³•åˆ†åˆ«æ˜¯&lt;code&gt;prepare(Context)&lt;/code&gt; å’Œ &lt;code&gt;establish()&lt;/code&gt;ã€‚å‰è€…æ¥å—ç”¨æˆ·å“åº”å¹¶å…³é—­å…¶ä»–åº”ç”¨çš„ VPN é“¾æ¥ï¼Œåè€…ä½¿ç”¨ &lt;code&gt;VpnService.Builder&lt;/code&gt; çš„å‚æ•°åˆ›å»º VPN æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;å®ç° VpnService çš„ç±»å¿…é¡»åœ¨ manifest ä¸­å£°æ˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;service&lt;/span&gt; &lt;span class="na"&gt;android:name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;.ExampleVpnService&amp;quot;&lt;/span&gt;
         &lt;span class="na"&gt;android:permission=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;android.permission.BIND_VPN_SERVICE&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;intent-filter&amp;gt;&lt;/span&gt;
         &lt;span class="nt"&gt;&amp;lt;action&lt;/span&gt; &lt;span class="na"&gt;android:name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;android.net.VpnService&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;/intent-filter&amp;gt;&lt;/span&gt;
 &lt;span class="nt"&gt;&amp;lt;/service&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;VpnService works on the network layer, the IP protocol is a point to point protocol, the packet changes between each hop, TCP is a end to end protocol&lt;/li&gt;
&lt;li&gt;use the vpn service as a layer4(NAT) router, and then you could modify or relay the packet&lt;/li&gt;
&lt;li&gt;IP packet contains only src and dst IP address and upper protocol, the port information is stored in TCP packet&lt;/li&gt;
&lt;li&gt;TCP is a stream protocol, so thers is no packet in tcp(see http://stackoverflow.com/q/1529680/)&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;å…³äº VPN Service çš„ä¸€äº›è®¨è®º&lt;/h1&gt;
&lt;p&gt;&lt;a href="http://stackoverflow.com/questions/17766405/android-vpnservice-to-capture-packets-wont-capture-packets"&gt;you need to reverse the ip order for ip layer headers&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/android/platform_development/tree/master/samples/ToyVpn"&gt;ToyVPN is the official example on using vpn service&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://stackoverflow.com/questions/16358589/implementing-a-simple-https-proxy-application-with-java"&gt;SSL in java&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;building a client&lt;/h1&gt;
&lt;p&gt;Your VPN will need to create a new socket, protect the socket from being routed back into the VPN usingÂ &lt;code&gt;VpnService.protect(Socket)&lt;/code&gt;, and connect the socket to 10.162.1.2. Having set up a tunnel connection to the VPN server, you should proceed to writing the input stream of the VpnService's interface into the tunnel's output stream, and in turn write the tunnel response back into the interface output stream.&lt;/p&gt;
&lt;p&gt;http://stackoverflow.com/questions/13233477/how-to-use-vpn-in-android/#answers&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;simple example&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;http://www.thegeekstuff.com/2014/06/android-vpn-service/&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;building a firewall with vpn service&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Incoming and outgoing streams of the VpnService are in the network layer( layer); you are receiving (and should in turn be transmitting) raw IP packets, as you describe in your question.&lt;/p&gt;
&lt;p&gt;also check out the OSI model and IP header format on WikiPedia&lt;/p&gt;
&lt;p&gt;When forwarding the requests, you are in the application layer; you should be transmitting theÂ contentsÂ of the UDP or TCP payload (i.e. only their data, not the headers themselves) using respectively a DatagramSocket or a Socket.&lt;/p&gt;
&lt;p&gt;Bear in mind that this skips the transport layer as those implementations take care of constructing the UDP header (in case of DatagramSocket) and the TCP header and options (in case of Socket).&lt;/p&gt;
&lt;p&gt;all I hava to do is to:&lt;/p&gt;
&lt;p&gt;check if the IP packet is for http or https:&lt;/p&gt;
&lt;p&gt;if not:&lt;/p&gt;
&lt;p&gt;act as a route, forward as is, but ack requests and reconstruct the packet with new src, and &lt;/p&gt;
&lt;p&gt;if so:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;act as the server, ack the request packet&lt;/li&gt;
&lt;li&gt;act as the client, send new http request to the server and retrive the response&lt;/li&gt;
&lt;li&gt;act as the server, send back the response packet&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The whole process is like we are the router, and dispatch different packet to different nodes(servers).&lt;/p&gt;
&lt;p&gt;http://stackoverflow.com/questions/20237743/android-firewall-with-vpnservice&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 06 Jul 2017 10:07:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-06:/posts/android-vpn-service.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>simhash</title><link>/posts/simhash.html</link><description>&lt;h1&gt;shingling&lt;/h1&gt;
&lt;p&gt;n-shingling å°±æ˜¯æŠŠä¸€ä¸ªå¥å­æˆ–è€…æ–‡ç« åˆ†æˆ n ä¸ªè¿ç»­å•è¯çš„ç»„åˆï¼Œç„¶åå»é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼š the cat sat on the cat&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥ï¼Œåˆ†ç»„ï¼š the cat, cat sat, sat on, on the, the cat
ç¬¬äºŒæ­¥ï¼Œå»é‡ï¼š the cat, cat sat, sat on, on the&lt;/p&gt;
&lt;p&gt;simhash è®¡ç®—è¿‡ç¨‹&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆ shingle&lt;/p&gt;
&lt;h1&gt;Reference&lt;/h1&gt;
&lt;p&gt;[1] http://matpalm.com/resemblance/jaccard_coeff/&lt;/p&gt;
&lt;p&gt;[2] http://blog.csdn.net/c289054531/article/details/8082952  ä¸­æ–‡è§£é‡Š&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 05 Jul 2017 09:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-05:/posts/simhash.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>mysql åŸºç¡€çŸ¥è¯†(1) - æŸ¥è¯¢æ•°æ®</title><link>/posts/mysql-ji-chu-zhi-shi-1-cha-xun-shu-ju.html</link><description>&lt;p&gt;&lt;a href="https://mp.weixin.qq.com/s/87BoE2-0mW_3qALyNSpiTw"&gt;æœ€å…¨æ€»ç»“&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;æ˜¾ç¤ºæ“ä½œ&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;show databases;
show create database DB;
show tables;
show columns from TABLE;
show create table TABLE;
show status;
shou grants;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;è¿æ¥æ•°æ®åº“&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;mysql -u root -p -h HOST -P 3306&lt;/code&gt;, å…¶ä¸­çš„å‚æ•°ä»£è¡¨äº†ç”¨æˆ·, æœºå™¨åœ°å€å’Œå¯†ç ç­‰, æ³¨æ„å…¶ä¸­çš„å¯†ç å¿…é¡»ä¹‹åè¾“å…¥, è€Œä¸èƒ½ç›´æ¥å¸¦ä¸Š, è¿™æ ·æ˜¯ä¸ºäº†é¿å…æŠŠå¯†ç è®°å½•åœ¨bashå†å²ä¸­.&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªæ›´å¥½çš„å·¥å…·æ˜¯Pythonå†™çš„mycli, è°ç”¨è°çŸ¥é“~&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;use DATABASE&lt;/code&gt;æ¥æ›´æ”¹æŒ‡å®šçš„æ•°æ®åº“.&lt;/p&gt;
&lt;h1&gt;æŸ¥è¯¢æ•°æ®åº“&lt;/h1&gt;
&lt;p&gt;ä¸‹é¢çš„éƒ¨åˆ†éƒ½ä½¿ç”¨è¿™ä¸ªè¡¨, æ–¹ä¾¿è®¨è®º.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;first_name&lt;/th&gt;
&lt;th&gt;last_name&lt;/th&gt;
&lt;th&gt;math_score&lt;/th&gt;
&lt;th&gt;english_score&lt;/th&gt;
&lt;th&gt;grade&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;master&lt;/td&gt;
&lt;td&gt;yoda&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;obiwan&lt;/td&gt;
&lt;td&gt;kenobi&lt;/td&gt;
&lt;td&gt;70&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;luke&lt;/td&gt;
&lt;td&gt;skywalker&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;70&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;leia&lt;/td&gt;
&lt;td&gt;skywalker&lt;/td&gt;
&lt;td&gt;90&lt;/td&gt;
&lt;td&gt;90&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;select field from table&lt;/code&gt;, æˆ–è€… &lt;code&gt;select * from table&lt;/code&gt;. å¥½å¤šæ—¶å€™å¾€å¾€çŠ¯æ‡’ç›´æ¥å†™æ˜Ÿå·, ä½†æ˜¯æ£€ç´¢æ— å…³çš„åˆ—ä¼šé™ä½æ•°æ®åº“çš„æ•ˆç‡.&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„å…³é”®å­—, å«åš&lt;code&gt;DISTINCT&lt;/code&gt;, é¡¾åæ€ä¹‰, å°±æ˜¯ä¸åŒçš„æ„æ€, å¦‚æœä½¿ç”¨è¿™ä¸ªå…³é”®å­—ä½œä¸ºå‰ç¼€çš„è¯, MYSQLä¼šåšä¸€ä¸ªå»é‡çš„æ“ä½œ, æœ‰ç‚¹ç±»ä¼¼äº&lt;code&gt;uniq&lt;/code&gt;å‘½ä»¤.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select distinct vendor_id from products
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœéœ€è¦é™å®šæŸ¥è¯¢çš„ç»“æœ, ä½¿ç”¨ LIMIT å’Œ OFFSET ä¸¤ä¸ªå…³é”®å­—. LIMIT é™å®šäº†è¿”å›çš„ç»“æœæ•°é‡, OFFSET æŒ‡å®šäº†ä»é‚£ä¸€æ¡å¼€å§‹è¿”å›.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select name from students limit 5 offset 3;  -- ä»æ‰€æœ‰å­¦ç”Ÿä¸­é€‰å‡ºä»ç¬¬3ä¸ªå¼€å§‹çš„5ä¸ªå­¦ç”Ÿ
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ’åº&lt;/h2&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´, mysqlè¿”å›çš„ç»“æœæ˜¯æŒ‰ç…§ä¸»é”®æ’åºçš„, å¦‚æœè¦è®©ç»“æœæŒ‰ç…§æŸä¸ªé”®æ’åº, ä½¿ç”¨ &lt;code&gt;ORDER BY&lt;/code&gt; å…³é”®å­—æ¥ç»™ä»–ä»¬æ’åº&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select name from students order by score
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹, mysqlæ˜¯æŒ‰ç…§å‡åºæ’åˆ—çš„, ä¹Ÿå°±æ˜¯å°çš„åœ¨å‰é¢, å¦‚æœéœ€è¦å¤§çš„åœ¨å‰é¢, ä½¿ç”¨ &lt;code&gt;DESC&lt;/code&gt; å…³é”®å­—&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select name from students order by score desc;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœæ’åºçš„å­—æ®µç›¸åŒæ€ä¹ˆåŠå‘¢, è¿˜å¯ä»¥æŒ‰å¤šä¸ªå­—æ®µæ’åº, è¿™æ—¶å€™éœ€è¦æ³¨æ„çš„æ˜¯descåªå¯¹ä¸€ä¸ªåˆ—ç”Ÿæ•ˆ.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select name from students order by score desc, name;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è¿‡æ»¤ç»“æœ&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ &lt;code&gt;WHERE&lt;/code&gt; å­å¥è¿‡æ»¤ç»“æœ, æ¯”å¦‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select * from students where score &amp;gt; 100;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯, å¦‚æœè¦æ¯”è¾ƒçš„æ˜¯null, é‚£ä¹ˆä¸èƒ½ä½¿ç”¨ = æ¥æ¯”è¾ƒ, éœ€è¦ä½¿ç”¨ &lt;code&gt;IS&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select * from students where name is null;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿˜å¯ä»¥ä½¿ç”¨ &lt;code&gt;AND&lt;/code&gt;, &lt;code&gt;OR&lt;/code&gt;, &lt;code&gt;NOT&lt;/code&gt; æ¥è®¡ç®—å¤åˆè¡¨è¾¾å¼.&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;IN&lt;/code&gt; æ¥è¡¨è¾¾åœ¨æŸäº›å€¼ä¹‹é—´, å°±åƒåœ¨Pythonä¸­ä¸€æ ·.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select * from students where name in (&amp;#39;yoda&amp;#39;, &amp;#39;obiwan&amp;#39;, &amp;#39;luke&amp;#39;);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä½¿ç”¨ &lt;code&gt;LIKE&lt;/code&gt; æ¥åŒ¹é…ç»“æœ, &lt;code&gt;%&lt;/code&gt; è¡¨ç¤ºä»»æ„å­—ç¬¦å‡ºç°ä»»æ„æ¬¡æ•°, &lt;code&gt;_&lt;/code&gt; è¡¨ç¤ºä»»æ„ä¸€ä¸ªå­—ç¬¦å‡ºç°ä¸€æ¬¡.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select * from students where name like &amp;#39;%walker&amp;#39;;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å‡½æ•°ä¸è®¡ç®—å­—æ®µ&lt;/h2&gt;
&lt;p&gt;MySQL ä¸­æœ‰ä¸€äº›å¸¸è§çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°, concat, trim ç­‰ç­‰, è¿™äº›å‡½æ•°åœ¨å¸¸è§çš„ç¼–ç¨‹è¯­è¨€ä¸­éƒ½æœ‰, åœ¨MySQLä¸­ä½œç”¨å¤§æ¦‚ä¹Ÿæ˜¯ç›¸åŒçš„. è¿˜å¯ä»¥ä½¿ç”¨ &lt;code&gt;AS&lt;/code&gt; æ¥ä¸ªè®¡ç®—å‡ºçš„å­—æ®µæ¥èµ·ä¸€ä¸ªåˆ«å, è¿™æ ·æ–¹ä¾¿è¾“å‡º. å¦‚æœæ˜¯æ•°å­—çš„è¯, è¿˜å¯ä»¥åšæ•°å­¦è¿ç®—.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select concat(first_name, last_name) as name from students;

select math_score + english_score as score from students;

select * from students where year(enroll_time) = 2009;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;èšåˆä¸åˆ†ç»„æ•°æ®&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰è¯´çš„ä¸€äº›å‡½æ•°éƒ½æ˜¯æŠŠä¸€ä¸ªå€¼å˜æˆäº†å¦ä¸€ä¸ªå€¼, ä¹Ÿå°±æ˜¯ä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨è¿™äº›å‡½æ•°å¾—åˆ°çš„éƒ½æ˜¯ç›¸åŒè¡Œæ•°çš„æ•°æ®. è€Œä½¿ç”¨èšåˆæˆ–è€…åˆ†ç»„å‡½æ•°ä¹‹å, ä¼šæ”¹å˜å¾—åˆ°çš„æ•°æ®çš„å¤§å°.&lt;/p&gt;
&lt;p&gt;èšé›†å‡½æ•°å¸¸ç”¨çš„ä¸€å…±æœ‰äº”ä¸ª: &lt;code&gt;AVG(), COUNT(), MAX(), MIN(), SUM()&lt;/code&gt;. è¿™å‡ ä¸ªå‡½æ•°çš„æ„æ€çœ‹åå­—ä¹Ÿåº”è¯¥çŸ¥é“äº†...ç›´æ¥ä¸Šä¾‹å­äº†.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select avg(math_score) as average_math_score from students;  -- 90, null ä¼šè¢«å¿½ç•¥
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select count(*) from students; -- 3, nullä¼šè¢«å¿½ç•¥
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;åˆ†ç»„å‡½æ•°&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ group by å…³é”®å­—å¯ä»¥è®©æ‰€æœ‰çš„è¡ŒæŒ‰ç…§æŸä¸ªå€¼, èšåˆæˆç›¸åº”çš„è¡Œ, æ¯”å¦‚åœ¨æˆ‘ä»¬çš„æ•°æ®ä¸­æœ‰3ä¸ªå¹´çºª(grade), é‚£ä¹ˆgroup by(grade) ä¹‹åå°±ä¼šå˜æˆ3è¡Œ.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select grade, count(*) as num_students from students group by grade;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯SQLçš„è®¡ç®—é¡ºåºæ˜¯å…ˆè®¡ç®— WHERE å­å¥, ç„¶åæ‰å›å»ä½¿ç”¨ &lt;code&gt;GROUP BY&lt;/code&gt; èšåˆ, é‚£ä¹ˆå¦‚æœæƒ³è¦è¿‡æ»¤GROUP BY åˆ†ç»„ä¹‹åçš„æ•°æ®å‘¢, è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ HAVING å­å¥.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select grade, count(*) as num_students from students group by grade having count(*) &amp;gt; 1;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å­æŸ¥è¯¢&lt;/h2&gt;
&lt;p&gt;å­æŸ¥è¯¢å…¶å®å¾ˆç®€å•, å°±æ˜¯ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æœæ˜¯å¦ä¸€ä¸ªæŸ¥è¯¢çš„æ•°æ®åŸºç¡€. å’Œå‡½æ•°è°ƒç”¨æœ‰ä¸€äº›ç›¸ä¼¼.&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ç§å¸¸è§ç”¨æ³•, æŠŠå­æŸ¥è¯¢çš„ç»“æœç”¨åœ¨ IN ä¸­.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select * from students where id in (select sudent_id from student_awards);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç¬¬äºŒç§ä½¿ç”¨å­æŸ¥è¯¢æ¥ä½œä¸ºç»“æœåˆ—çš„æ•°å€¼.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;select id, (select count(*) from student_awards where students.id = student_awards.student_id) from students;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Join&lt;/h2&gt;
&lt;p&gt;Join å¤ªå¤æ‚äº†, æœªå®Œå¾…ç»­&lt;/p&gt;
&lt;h2&gt;æ•°æ®ç±»å‹&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;TINYBLOB, TINYTEXT       L + 1 bytes, where L &amp;lt; 2^8    (255 Bytes)
BLOB, TEXT               L + 2 bytes, where L &amp;lt; 2^16   (64 Kibibytes)
MEDIUMBLOB, MEDIUMTEXT   L + 3 bytes, where L &amp;lt; 2^24   (16 Mebibytes)
LONGBLOB, LONGTEXT       L + 4 bytes, where L &amp;lt; 2^32   (4 Gibibytes)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å²ä¸Šæœ€å…¨çš„ mysql æ€»ç»“ï¼šhttps://mp.weixin.qq.com/s/87BoE2-0mW_3qALyNSpiTw&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 05 Jul 2017 01:22:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-05:/posts/mysql-ji-chu-zhi-shi-1-cha-xun-shu-ju.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>the ipinfo story</title><link>/posts/the-ipinfo-story.html</link><description>&lt;h1&gt;what does this guy do?&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;find a easy question, however cumbersome question on &lt;a href="https://stackoverflow.com/questions/409999"&gt;stackoverflow.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;answer the question with a solution of his api, &lt;em&gt;with full demo codes of usage&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;so many amateur programmers are not capable of or too lazy to build such an easy api, his answer and api took off.&lt;/li&gt;
&lt;li&gt;make money&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Why he succeed?&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;blockquote&gt;
&lt;p&gt;no one talks about the easiest way to â€œMake What People Wantâ€: Make What People Ask For.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;answer many questions related to this, about 1 question / 20 days&lt;/li&gt;
&lt;li&gt;his answers give the whole solution and &lt;em&gt;full examples&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;his design is simple, reliable, fast&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;see:  https://blog.ipinfo.io/api-side-project-to-250-million-requests-with-0-marketing-budget-bb0de01c01f6&lt;/p&gt;
&lt;p&gt;as pointed by one hacker news comment, it's a very competitive market, however you don't have to own the whole market, a small share is just profitable.&lt;/p&gt;
&lt;h1&gt;Comments on hacker news&lt;/h1&gt;
&lt;p&gt;1.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I see the author is posting the same thing every 20 days or so, so here is the 0 marketing...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;2.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Kudos to you guys for building this. There is always a lot of scepticism from people on "why would anyone pay for this" . Reality is not everyone has the time or resources to build their own kit. There are literally 1000s of businesses on the internet that that are in the business of selling "time" or timesavers and removing the risk of maintenance, ongoing support.
Keep improving this and with the rise of web personalization, the demand will continue to grow.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;3.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Just some rough calculations. Assuming the worst-case scenario, everyone in the highest tiers (the cheapest per request), 250M daily requests means he makes
400 * 250M / 320K = $312,500 per month.
Or $3.75M per year.
Not counting the expenses.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;4.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I think the most common business model for a website such as this is to offer premium services like:
1) more accurate details
2) fraud protection, if the ip is known for fraud or spamming
3) increased rate limits, etc
Just the top of my head s.. I'm sure you i can think of many more..&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;5.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I use ipinfo.io mostly to see my own public facing IP address and for me, it's 2 reasons:
- I somehow can remember that domain. I don't have to google "my ip" and dig through weird domains that change all the time
- The design is clean and simple. Not too many information, no ads, loads fast.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;6.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This has worked well for me, too. I saw an influx of "How to offer a time-based trial version on Android" on SO and developed a trial SDK as an answer: https://www.trialy.io/&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 02 Jul 2017 05:05:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-02:/posts/the-ipinfo-story.html</guid><category>ä»–å±±ä¹‹çŸ³</category><category>åˆ›ä¸š</category></item><item><title>å¦‚ä½•ä½¿ç”¨ letsencrypt</title><link>/posts/ru-he-shi-yong-letsencrypt.html</link><description>&lt;p&gt;letsencrypt ç°åœ¨ç»ˆäºæ”¯æŒé€šé…ç¬¦è¯ä¹¦äº†ã€‚&lt;/p&gt;
&lt;p&gt;certbot æ¯”è¾ƒå‘çˆ¹çš„ä¸€ç‚¹æ˜¯renewæ—¶å€™ä½¿ç”¨çš„æ˜¯å’Œåˆ›å»ºè¯ä¹¦ç›¸åŒçš„å‚æ•°, è€Œä¸”ä¸èƒ½æ›´æ”¹, ä¹Ÿå°±æ˜¯æœ€å¥½åœ¨åˆ›å»ºè¯ä¹¦çš„æ—¶å€™å°±é€‰æ‹©ä½¿ç”¨webrootçš„æ–¹å¼.&lt;/p&gt;
&lt;h2&gt;install certbot&lt;/h2&gt;
&lt;p&gt;see ~/.dotfiles/installs/install_certbot.sh&lt;/p&gt;
&lt;h2&gt;create new cert&lt;/h2&gt;
&lt;p&gt;sudo certbot certonly --webroot -w /opt/spider/nginx/html/ -d shujutuzi.com -d www.shujutuzi.com&lt;/p&gt;
&lt;p&gt;sudo certbot certonly --standalone --agree-tos --email kongyifei@gmail.com --domain g.yifei.me --preferred-challenges http --non-interactive&lt;/p&gt;
&lt;p&gt;the cert is placed at /etc/letsencrypt/live/shujutuzi.com/&lt;/p&gt;
&lt;p&gt;there will be four certs:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;â€¢ cert.pem: server certificate only.
â€¢ chain.pem: root and intermediate certificates only.
â€¢ fullchain.pem: combination of server, root and intermediate certificates (replacesÂ cert.pemÂ andÂ chain.pem).
â€¢ privkey.pem: private key (doÂ notÂ share this with anyone!).
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;install the cert&lt;/h2&gt;
&lt;p&gt;https://gist.github.com/cecilemuller/a26737699a7e70a7093d4dc115915de8&lt;/p&gt;
&lt;h2&gt;auto renew&lt;/h2&gt;
&lt;p&gt;create a cron job to run renew peroidcally&lt;/p&gt;
&lt;p&gt;cerbot renew --pre-hook "/opt/nginx/sbin/nginx -s stop" --post-hook "/opt/nginx/sbin/nginx -s start" --quiet&lt;/p&gt;
&lt;p&gt;optionally, you could generate a Strong Diffie-Hellman Group&lt;/p&gt;
&lt;p&gt;sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048&lt;/p&gt;
&lt;p&gt;Third, change you defautl server settings:&lt;/p&gt;
&lt;p&gt;server {
    listen 443 ssl;
    server_name example.com www.example.com;
    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;&lt;/p&gt;
&lt;p&gt;// optional&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;ssl_protocols&lt;/span&gt; &lt;span class="nt"&gt;TLSv1&lt;/span&gt; &lt;span class="nt"&gt;TLSv1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt; &lt;span class="nt"&gt;TLSv1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_prefer_server_ciphers&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_dhparam&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;certs&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;dhparam&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;pem&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_ciphers&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_session_timeout&lt;/span&gt; &lt;span class="nt"&gt;1d&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_session_cache&lt;/span&gt; &lt;span class="nt"&gt;shared&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;SSL&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;50m&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_stapling&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_stapling_verify&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;add_header&lt;/span&gt; &lt;span class="nt"&gt;Strict-Transport-Security&lt;/span&gt; &lt;span class="nt"&gt;max-age&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;15768000&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;Side Notes:&lt;/p&gt;
&lt;p&gt;what is a pem file?&lt;/p&gt;
&lt;p&gt;pem container format, may contain one or many certs, short for Privacy Enhanced Main
key just the private key file of pem format
cert, cer, crt  just pem file with different extendsion, used on windows&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 01 Jul 2017 02:48:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-07-01:/posts/ru-he-shi-yong-letsencrypt.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>docker åŸºç¡€æ¦‚å¿µ</title><link>/posts/docker-ji-chu-gai-nian.html</link><description>&lt;p&gt;Docker æ˜¯ä¸€ä¸ªè¿›ç¨‹çš„å®¹å™¨ï¼Œ&lt;strong&gt;ä¸æ˜¯è™šæ‹Ÿæœº&lt;/strong&gt;ã€‚ä»–ä¸ºä¸€ä¸ªè¿›ç¨‹éš”ç¦»äº†æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œå’Œç¯å¢ƒå˜é‡ã€‚æœ€å¥½åœ¨å…¶ä¸­è¿è¡Œä¸€ä¸ªä¸”ä»…è¿è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œä¸æ˜¯è¿è¡Œå¤šä¸ªä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;docker ä¸­æœ€å¥½è¿è¡Œçš„æ˜¯æ— çŠ¶æ€çš„æœåŠ¡ï¼Œè¿™æ ·æ–¹ä¾¿äºæ¨ªå‘æ‰©å±•ï¼Œå¯¹äºæœ‰çŠ¶æ€çš„æœåŠ¡ï¼Œå»ºè®®æŠŠçŠ¶æ€ mount å‡ºæ¥ã€‚&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨åœºæ™¯&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;ä¸ºæœ‰ä¸åŒéœ€æ±‚çš„åº”ç”¨åˆ›å»ºä¸åŒçš„éš”ç¦»ç¯å¢ƒï¼Œ æ¯”å¦‚éƒ¨ç½²ä¸¤ä¸ªè„šæœ¬ï¼Œä¸€ä¸ªéœ€è¦ç”¨ Python 2.7ï¼Œå¦ä¸€ä¸ªéœ€è¦ç”¨ Python 3.6&lt;/li&gt;
&lt;li&gt;Micro services. Micro services are easy to scale up. In this way, run only one process in a container, and use orchestration tools such as compose, kubernetes, swarm.&lt;/li&gt;
&lt;li&gt;Daemon Process Manager. Docker is very simple to use as a daemon process manager, to start and list daemon processes has never been this simple&lt;/li&gt;
&lt;li&gt;A jail for apps. Docker is good to jail you application, prevent it from hurting your system, especially when you run code from other people(e.g. uploaded by a client)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Docker is so-called kernel containerization, in contrary to user-space containerization such as rkt. Docker stores images in a central base on your machine.&lt;/p&gt;
&lt;h1&gt;Image vs Containerï¼ˆé•œåƒä¸å®¹å™¨ï¼‰&lt;/h1&gt;
&lt;p&gt;Container is a running instance of image, each time you run an image, a new container is created. You can commit a container back as an image, however, it's a little controversial&lt;/p&gt;
&lt;p&gt;Image name format: user/image:tag&lt;/p&gt;
&lt;h1&gt;basic usage&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;docker run OPTIONS IMAGE COMMAND&lt;/code&gt; to generate a container based on given image and start it.&lt;/li&gt;
&lt;li&gt;most used command is -d &lt;/li&gt;
&lt;li&gt;and -it&lt;/li&gt;
&lt;li&gt;--restart=always to always restart the container&lt;/li&gt;
&lt;li&gt;--name=NAME to name the container&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker start CONTAINER_ID&lt;/code&gt; to restart stopped container, note that this will reuse the options and command when &lt;code&gt;docker run&lt;/code&gt; is issued&lt;/li&gt;
&lt;li&gt;then use &lt;code&gt;docker attach CONTAINER_ID&lt;/code&gt; to reattach to the given container&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker exec OPTIONS CONTAINER COMMAND&lt;/code&gt; to run an extra command in container&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note, docker is all about stdio, and if you would like to read something, read it from stdin, if you would like to output something, write to stdout&lt;/p&gt;
&lt;h1&gt;building docker images&lt;/h1&gt;
&lt;p&gt;two ways:
&lt;em&gt; commit each change
&lt;/em&gt; using dockerfiles&lt;/p&gt;
&lt;h1&gt;Commands&lt;/h1&gt;
&lt;h2&gt;Container related&lt;/h2&gt;
&lt;h3&gt;run&lt;/h3&gt;
&lt;p&gt;æ¯æ¬¡æ‰§è¡Œ &lt;code&gt;docker run&lt;/code&gt;, éƒ½ä¼šæ ¹æ®é•œåƒæ¥åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ container, å¯ä»¥ä½¿ç”¨ &lt;code&gt;docker start&lt;/code&gt; æˆ–è€… &lt;code&gt;docker attach&lt;/code&gt; æ¥è¿æ¥ä¸Šå·²ç»åˆ›å»ºçš„ containerã€‚image å’Œ container çš„å…³ç³»å¤§æ¦‚ç±»ä¼¼äºç¨‹åºå’Œè¿›ç¨‹ä¹‹é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;Syntax: &lt;/p&gt;
&lt;p&gt;&lt;code&gt;docker run [options] [image name] [command]&lt;/code&gt;
&lt;code&gt;docker exec -it [container] bash&lt;/code&gt; can be used as a ssh equivalent
&lt;code&gt;-d&lt;/code&gt; detach the container and runs in background
&lt;code&gt;-p&lt;/code&gt; set ports [host:container]
&lt;code&gt;--name&lt;/code&gt; set the name
&lt;code&gt;--rm&lt;/code&gt; clean the container after running
&lt;code&gt;--net&lt;/code&gt; sets the network connected to
&lt;code&gt;-w&lt;/code&gt; sets working dir
&lt;code&gt;-e&lt;/code&gt; sets env variable
&lt;code&gt;-u&lt;/code&gt; sets user
&lt;code&gt;-v&lt;/code&gt; sets volume host_file:container_file:options&lt;/p&gt;
&lt;h3&gt;status&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;docker ps -a&lt;/code&gt; shows which container is running&lt;/p&gt;
&lt;h2&gt;Image ralated&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;docker pull&lt;/code&gt; &lt;br&gt;
&lt;code&gt;docker images&lt;/code&gt;   &lt;br&gt;
&lt;code&gt;docker search&lt;/code&gt; 
&lt;code&gt;docker build&lt;/code&gt;   docker build -t user/image [dir]&lt;/p&gt;
&lt;h2&gt;ç½‘ç»œç›¸å…³&lt;/h2&gt;
&lt;p&gt;åŸºç¡€å‘½ä»¤&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker network ls   ls the network interfaces
docker network inspect  inspect the network for details
docker network create/rm    create network interface
docker network connect/disconnect [net] [container] connect a container to a network
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;by setting network, docker automatically create /etc/hosts file inside the image, and you can use the name of the container to access the others.&lt;/p&gt;
&lt;p&gt;docker æœ‰ä¸¤ä¸ªç½‘ç»œæ¨¡å¼&lt;/p&gt;
&lt;h3&gt;æ¡¥æ¥æ¨¡å¼&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ `docker run --net="bridge"ï¼Œè¿™ç§æ¨¡å¼ä¼šä½¿ç”¨è™šæ‹Ÿç½‘å¡ docker0 åšäº†ä¸€å±‚ NAT è½¬å‘ï¼Œæ‰€ä»¥æ•ˆç‡æ¯”è¾ƒä½ï¼Œä¼˜ç‚¹æ˜¯ä¸ç”¨æ”¹å˜åº”ç”¨åˆ†é…å›ºå®šç«¯å£çš„ä»£ç ï¼Œdockerä¼šåœ¨å®¿ä¸»æœºä¸Šéšæœºåˆ†é…ä¸€ä¸ªç«¯å£ï¼Œé¿å…å†²çªã€‚&lt;/p&gt;
&lt;h3&gt;Host æ¨¡å¼&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ `docker run --net="host"ï¼Œå®¿ä¸»æœºå’Œdockerå†…éƒ¨ä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªç½‘ç»œï¼Œæ¯”å¦‚è¯´ eth0&lt;/p&gt;
&lt;h2&gt;å·&lt;/h2&gt;
&lt;p&gt;Docker å®¹å™¨ä¸€èˆ¬æ¥è¯´æ˜¯æ— çŠ¶æ€çš„ï¼Œé™¤äº†ä¿å­˜åˆ°æ•°æ®åº“ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å·æ¥æŠŠå®¹å™¨ä¸­çš„çŠ¶æ€ä¿å­˜å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;docker volume create --name hello
docker run -d -v hello:/container/path/for/volume container_image my_command&lt;/p&gt;
&lt;h2&gt;æ—¥å¿—&lt;/h2&gt;
&lt;p&gt;You could use &lt;code&gt;docker logs [contianer]&lt;/code&gt;  to view stdout logs. But the logs sent to /var/logs/*.log are by default inside the container. &lt;/p&gt;
&lt;p&gt;Remove stopped images
docker rm $(docker ps -aq)&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨dockerçš„æ—¶å€™ä¸ä½¿ç”¨ sudo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo gpasswd -a &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;USER&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt; docker
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åç™»å‡ºå†ç™»å½•å½“å‰ç”¨æˆ·å³å¯&lt;/p&gt;
&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;p&gt;https://blog.talpor.com/2015/01/docker-beginners-tutorial/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 30 Jun 2017 13:59:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-30:/posts/docker-ji-chu-gai-nian.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category><category>Docker</category></item><item><title>sudo passwordless</title><link>/posts/sudo-passwordless.html</link><description>&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;EDITOR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;vi&lt;/span&gt; &lt;span class="n"&gt;visudo&lt;/span&gt;

&lt;span class="cp"&gt;# then add this&lt;/span&gt;

&lt;span class="n"&gt;ALL&lt;/span&gt; &lt;span class="n"&gt;ALL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ALL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nl"&gt;NOPASSWD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ALL&lt;/span&gt;
&lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="n"&gt;ALL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ALL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nl"&gt;NOPASSWD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ALL&lt;/span&gt;
&lt;span class="nf"&gt;%group&lt;/span&gt; &lt;span class="n"&gt;ALL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ALL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nl"&gt;NOPASSWD&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ALL&lt;/span&gt;
&lt;span class="n"&gt;Defaults&lt;/span&gt; &lt;span class="n"&gt;env_keep&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;EDITOR&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 30 Jun 2017 13:51:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-30:/posts/sudo-passwordless.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>ä¸ºçˆ¬è™«æ­å»ºä»£ç†é›†ç¾¤</title><link>/posts/wei-pa-chong-da-jian-dai-li-ji-qun.html</link><description>&lt;p&gt;çˆ¬è™«å¦‚æœåªç”¨å›ºå®šçš„åŒä¸€ä¸ªæˆ–è€…åŒä¸€ç»„ IP çš„è¯ï¼Œå¾ˆå®¹æ˜“è¢«å°ç¦ï¼Œè½»è€…å¼¹éªŒè¯ç ï¼Œé‡è€…ç›´æ¥æ— æ³•è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä¸»è¦æ¢è®¨å¦‚ä½•æ„æ¶ä¸€ä¸ªä»£ç† IP æ± ï¼Œä»è€Œèƒ½å¤Ÿé¢‘ç¹æ›´æ¢ä»£ç† IPã€‚&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§ä»£ç† IP çš„æ¥æºï¼Œä¸»è¦æœ‰å‡ ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å»å…è´¹ä»£ç†çš„ç½‘ç«™ä¸Šçˆ¬&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨ ADSL é‡æ‹¨ä¼šæ›´æ¢ IP çš„åŸç†ï¼Œä½¿ç”¨ ADSL æœºå™¨æ­å»ºé›†ç¾¤&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨äº‘æä¾›å•†çš„ APIï¼Œè‡ªåŠ¨æ›´æ¢ IP&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;æ­å»ºä¸€ä¸ªè‡ªå·±çš„ adsl é›†ç¾¤&lt;/h1&gt;
&lt;h2&gt;æ‰¾ä»£ç†å•†&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæ‰¾åˆ°ä¸€ä¸ªé è°±çš„ç½‘ç«™å°±å®å±ä¸æ˜“ï¼Œè¿™äº› adsl æä¾›å•†çš„æŠ€æœ¯æ°´å¹³æ™®éä¸é«˜ï¼Œå¾€å¾€åªèƒ½æä¾› centos é•œåƒï¼Œæœ‰ centos 7.1å°±ç®—ä¸é”™çš„äº†ï¼Œå…¶ä¸­æœ‰ä¸€å®¶ç«Ÿç„¶æä¾›äº† ubuntu 14.04ï¼Œç»“æœè¿˜æ˜¯å„ç§é—®é¢˜ï¼Œå‘äº†æˆ‘å¤§æ¦‚åŠå¤©çš„æ—¶é—´ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 28 Jun 2017 02:40:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-28:/posts/wei-pa-chong-da-jian-dai-li-ji-qun.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>dockerfile åŸºç¡€</title><link>/posts/dockerfile-ji-chu.html</link><description>&lt;p&gt;Dockerfile åˆ—å‡ºäº†æ„å»ºä¸€ä¸ªdocker image çš„&lt;strong&gt;å¯å¤ç°&lt;/strong&gt;æ­¥éª¤ã€‚æ¯”èµ·ä¸€æ­¥ä¸€æ­¥é€šè¿‡ docker commit æ¥åˆ¶ä½œä¸€ä¸ªé•œåƒï¼Œdockerfileæ›´é€‚ç”¨äºCIè‡ªåŠ¨æµ‹è¯•ç­‰ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;h1&gt;Dockerfile å‘½ä»¤&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;FROMï¼ŒæŒ‡å®šåŸºç¡€é•œåƒ&lt;/li&gt;
&lt;li&gt;MAINTAINERï¼Œä½œè€…ï¼Œå»ºè®®æ ¼å¼ï¼ˆ&lt;code&gt;Jon Snow &amp;lt;jonsnow@westros.com&amp;gt;&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;EXPOSEï¼Œéœ€è¦æš´éœ²çš„ç«¯å£ï¼Œä½†æ˜¯ä¸€èˆ¬ä¹Ÿä¼šä½¿ç”¨ -p æ¥åˆ¶å®šç«¯å£æ˜ å°„&lt;/li&gt;
&lt;li&gt;USERï¼Œè¿è¡Œçš„ç”¨æˆ·&lt;/li&gt;
&lt;li&gt;WORKDIRï¼Œè¿›ç¨‹çš„å·¥ä½œç›®å½•&lt;/li&gt;
&lt;li&gt;COPYï¼Œå¤åˆ¶æ–‡ä»¶åˆ°&lt;/li&gt;
&lt;li&gt;RUNï¼Œè¿è¡Œshellå‘½ä»¤&lt;/li&gt;
&lt;li&gt;CMDï¼Œå¯åŠ¨è¿›ç¨‹ä½¿ç”¨çš„å‘½ä»¤&lt;/li&gt;
&lt;li&gt;ENTRYPOINTï¼Œé•œåƒå¯åŠ¨çš„å…¥å£ï¼Œé»˜è®¤æ˜¯ bash -c&lt;/li&gt;
&lt;li&gt;ENVï¼Œè®¾å®šç¯å¢ƒå˜é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å‡ ä¸ªæ¯”è¾ƒå®¹æ˜“æ··æ·†çš„&lt;/h2&gt;
&lt;h3&gt;COPY vs ADD&lt;/h3&gt;
&lt;p&gt;ADD ä¼šè‡ªåŠ¨è§£å‹å‹ç¼©åŒ…ï¼Œåœ¨ä¸éœ€è¦ç‰¹æ®Šæ“ä½œçš„æ—¶å€™ï¼Œæœ€å¥½ä½¿ç”¨COPYã€‚&lt;/p&gt;
&lt;h3&gt;ENTRYPOINT vs CMD&lt;/h3&gt;
&lt;p&gt;entrypoint æŒ‡å®šäº† Docker é•œåƒè¦è¿è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå½“ç„¶ä¹ŸåŒ…æ‹¬å‚æ•°ï¼‰ï¼Œè€Œ cmd åˆ™æŒ‡å®šäº†è¿è¡Œè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„å‚æ•°ã€‚ä¸è¿‡å› ä¸ºé»˜è®¤ entrypoint æ˜¯ bash -cï¼Œæ‰€ä»¥å®é™…ä¸Š CMD æŒ‡å®šçš„ä¹Ÿæ˜¯è¦è¿è¡Œçš„å‘½ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œdocker run æ—¶å€™åŒ…å«å‘½ä»¤è¡Œå‚æ•°ï¼Œä¼šæ‰§è¡Œå‘½ä»¤è¡Œå‚æ•°ï¼Œè€Œä¸æ˜¯ CMD çš„å†…å®¹ã€‚å¦‚æœä½¿ç”¨ /bin/bash ä½œä¸ºå‘½ä»¤è¡Œçš„æŒ‡ä»¤ï¼Œè¿™æ ·ä¾¿æ›¿æ¢æ‰ CMD çš„å†…å®¹ï¼Œä»è€Œè¿›å…¥é•œåƒä¸­æŸ¥çœ‹ç¼–è¯‘å‡ºçš„é•œåƒç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ªäººå€¾å‘äº&lt;strong&gt;åªä½¿ç”¨ CMDï¼Œè€Œä¸ä½¿ç”¨ ENTRYPOINT&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼šhttps://stackoverflow.com/a/34245657/1061155&lt;/p&gt;
&lt;h2&gt;ä½¿ç”¨Dockerfile è¿˜æ˜¯ commit æ¥æ„å»ºé•œåƒ&lt;/h2&gt;
&lt;p&gt;å¦‚æœå¯èƒ½çš„è¯ï¼Œå°½é‡ä½¿ç”¨ dockerfile&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I've been wondering the same thing, and my impression (which could be totally wrong) it that it's really the same case as with VMs --&amp;gt; you don't want to not know how to recreate the vm image. In my case I have regular .sh scripts to install, and am wondering why I can't just maintain these, run docker and effectively call these, and create the golden version image that way. My scripts work to get it installed on a local PC, and the reason I want to use docker is to deal with conflicts of multiple instances of programs/have clean file system/etc 
https://stackoverflow.com/questions/26110828/should-i-use-dockerfiles-or-image-commits&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 27 Jun 2017 03:54:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-27:/posts/dockerfile-ji-chu.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category><category>Docker</category></item><item><title>django å°æŠ€å·§</title><link>/posts/django-xiao-ji-qiao.html</link><description>&lt;h1&gt;è¿è¡Œå¼€å‘æœåŠ¡å™¨&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py runserver [host:]port
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯ä»¥æŒ‡å®šç»‘å®šçš„IP&lt;/p&gt;
&lt;h2&gt;åˆ›å»ºç”¨æˆ·å’Œæ›´æ”¹å¯†ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py createsuperuser  # åˆ›å»ºè¶…çº§ç”¨æˆ·
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py changepassword username
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è¿›å…¥å½“å‰é¡¹ç›®çš„shell&lt;/h2&gt;
&lt;p&gt;åœ¨è¿™ä¸ª python shell ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ django çš„model&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py shell
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;timezone aware time&lt;/h1&gt;
&lt;p&gt;åœ¨å‘æ•°æ®åº“ä¸­ä¿å­˜datetimeå­—æ®µçš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ° django æŠ¥è­¦ç¼ºå°‘æ—¶åŒºä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ django è‡ªå¸¦çš„ timezone.now()&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.utils&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;
&lt;span class="n"&gt;now_aware&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;timezone&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 26 Jun 2017 02:24:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-26:/posts/django-xiao-ji-qiao.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Thrift RPC æ¡†æ¶</title><link>/posts/thrift-rpc-kuang-jia.html</link><description>&lt;p&gt;Thrift æ˜¯ä¸€ä¸ªå…¨æ ˆçš„ RPC æ¡†æ¶ï¼Œå®ƒåŒ…å«äº†æ¥å£å®šä¹‰è¯­è¨€ï¼ˆIDLï¼‰å’ŒRPCæœåŠ¡ä¸¤éƒ¨åˆ†ï¼Œå¤§æ¦‚ç›¸å½“äº protobuf + gRPC çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ https://github.com/yifeikong/install ä¸­çš„è„šæœ¬æ¥å®‰è£…&lt;/p&gt;
&lt;h1&gt;Thrift ä¸­çš„ç±»å‹ä¸ IDL&lt;/h1&gt;
&lt;p&gt;åŒ…æ‹¬ &lt;code&gt;bool, byte/i8, i16, i32, i64, double, string, binary&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯”è¾ƒè›‹ç–¼çš„æ˜¯ thrift ä¸æ”¯æŒ uintï¼ŒåŸå› æ˜¯å¥½å¤šè¯­è¨€é‡Œé¢æ²¡æœ‰åŸç”Ÿæ— ç¬¦å·ç±»å‹ï¼ˆæ— è¯­ã€‚ã€‚ï¼‰&lt;/li&gt;
&lt;li&gt;binary ç±»å‹ç›¸å½“äºæŸäº›è¯­è¨€ä¸­çš„ bytes&lt;/li&gt;
&lt;li&gt;string ä½¿ç”¨ utf-8 ç¼–ç &lt;/li&gt;
&lt;li&gt;byte å’Œ i8 æ˜¯åŒä¸€ä¸ªç±»å‹ï¼Œä¹Ÿæ˜¯æœ‰ç¬¦å·çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å¤åˆç±»å‹ï¼ˆstructï¼‰&lt;/h2&gt;
&lt;p&gt;struct å°±åƒç¼–ç¨‹è¯­è¨€ä¸­çš„ç»“æ„ä½“æˆ–è€…ç±»ä¸€æ ·ï¼Œç”¨æ¥è‡ªå®šä¹‰ç±»å‹ã€‚æ³¨æ„åœ¨ Thrift ä¸­å®šä¹‰ç±»å‹çš„æ—¶å€™éœ€è¦ä½¿ç”¨æ•°å­—æ ‡è®°é¡ºåºï¼Œè¿™æ ·æ˜¯ä¸ºäº†æ›´é«˜æ•ˆåœ°åºåˆ—åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„å…¶ä¸­çš„ required å’Œ optional å­—æ®µï¼Œrequired è¡¨ç¤ºå¿…é€‰çš„å­—æ®µï¼Œoptional çš„å­—æ®µå¯ä»¥å¿½ç•¥ã€‚ä¸ºäº†å…¼å®¹æ€§è€ƒè™‘ï¼Œå»ºè®®å°½å¯èƒ½æŠŠå­—æ®µå£°æ˜ä¸º optionalã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;struct&lt;/span&gt; &lt;span class="nt"&gt;Cat&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;1:&lt;/span&gt; &lt;span class="err"&gt;required&lt;/span&gt; &lt;span class="err"&gt;i32&lt;/span&gt; &lt;span class="err"&gt;number=10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;å¯ä»¥æœ‰é»˜è®¤å€¼&lt;/span&gt;
    &lt;span class="err"&gt;2:&lt;/span&gt; &lt;span class="err"&gt;optional&lt;/span&gt; &lt;span class="err"&gt;i64&lt;/span&gt; &lt;span class="err"&gt;big_number&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;3:&lt;/span&gt; &lt;span class="err"&gt;double&lt;/span&gt; &lt;span class="err"&gt;decimal&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;4:&lt;/span&gt; &lt;span class="err"&gt;string&lt;/span&gt; &lt;span class="err"&gt;name=&amp;quot;thrifty&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æœ‰é»˜è®¤å€¼&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;exceptions&lt;/h2&gt;
&lt;p&gt;Thrift ä¸­è¿˜å¯ä»¥å®šä¹‰å¼‚å¸¸ï¼Œå…³é”®å­—æ˜¯ exceptionï¼Œå…¶ä»–è¯­æ³•å’Œ struct ä¸€æ ·ã€‚&lt;/p&gt;
&lt;h2&gt;typedef&lt;/h2&gt;
&lt;p&gt;Thrift æ”¯æŒ C/C++ ç±»å‹çš„ typedef&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;typedef i32 MyInteger   // 1
typedef Tweet ReTweet   // 2
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æšä¸¾&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;enum&lt;/span&gt; &lt;span class="n"&gt;Operation&lt;/span&gt; {
    &lt;span class="n"&gt;ADD&lt;/span&gt; = &lt;span class="mi"&gt;1&lt;/span&gt;;
    &lt;span class="n"&gt;SUB&lt;/span&gt; = &lt;span class="mi"&gt;2&lt;/span&gt;;
    &lt;span class="n"&gt;MUL&lt;/span&gt; = &lt;span class="mi"&gt;3&lt;/span&gt;;
    &lt;span class="n"&gt;DIV&lt;/span&gt; = &lt;span class="mi"&gt;4&lt;/span&gt;;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å®¹å™¨ç±»å‹&lt;/h2&gt;
&lt;p&gt;Thrift ä¸­åŒ…å«äº†å¸¸è§çš„å®¹å™¨ç±»å‹ &lt;code&gt;list set map&lt;/code&gt; ç­‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;list&amp;lt;t1&amp;gt;&lt;/code&gt;: ä¸€ä¸ªt1ç±»å‹çš„æœ‰åºæ•°ç»„&lt;/li&gt;
&lt;li&gt;&lt;code&gt;set&amp;lt;t1&amp;gt;&lt;/code&gt;: ä¸€ä¸ªt1ç±»å‹çš„æ— éœ€é›†åˆ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;map&amp;lt;t1,t2&amp;gt;&lt;/code&gt;: ä¸€ä¸ªå­—å…¸ï¼Œkey æ˜¯ t1 ç±»å‹ï¼Œvalue æ˜¯ t2 ç±»å‹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å¸¸é‡&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ const å®šä¹‰å¸¸é‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;const i32 INT_CONST = 1234;    // 1
const map&amp;lt;string,string&amp;gt; MAP_CONST = {&amp;quot;hello&amp;quot;: &amp;quot;world&amp;quot;, &amp;quot;goodnight&amp;quot;: &amp;quot;moon&amp;quot;}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ³¨é‡Š&lt;/h2&gt;
&lt;p&gt;Thrift æ”¯æŒ Python å’Œ C++ ç±»å‹çš„æ³¨é‡Šã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# This is a valid comment.

/*
 * This is a multi-line comment.
 * Just like in C.
 */

// C++/Java style single-line comments work just as well.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å‘½åç©ºé—´&lt;/h2&gt;
&lt;p&gt;for each thrift file, you have to add a namespace for it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;namespace py tutorial
namespace java tutorial
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;include&lt;/h2&gt;
&lt;p&gt;include "other.thrift"&lt;/p&gt;
&lt;h1&gt;æœåŠ¡&lt;/h1&gt;
&lt;p&gt;æœåŠ¡ç±»ä¼¼äºä¸€ä¸ªæ¥å£ï¼Œåœ¨ Thrift ä¸­å®šä¹‰ï¼Œç„¶åæ ¹æ® Thrift ç”Ÿæˆçš„æ–‡ä»¶ï¼Œå†ä½¿ç”¨å…·ä½“çš„ä»£ç å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„å…¶ä¸­çš„ &lt;code&gt;oneway&lt;/code&gt;, æ„æ€æ˜¯å®¢æˆ·ç«¯ä¸ä¼šç­‰å¾…å“åº”ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;service StringCache {
    void set(1:i32 key, 2:string value),
    string get(1:i32 key) throws (1:KeyNotFound knf),
    oneway void delete(1:i32 key)
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ç”Ÿæˆçš„ä»£ç &lt;/h2&gt;
&lt;p&gt;Thrift çš„æ•´ä¸ªç½‘ç»œæ¶æ„å¦‚å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tKfTcgy1fslz611nmfj30y40igdj2.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆçš„ä»£ç ä½äºè“è‰²çš„ä¸€å±‚ï¼ŒTransport å®ç°äº†äºŒè¿›åˆ¶æ•°æ®çš„ä¼ è¾“ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹© TCP æˆ–è€… HTTP ç­‰åè®®ä¼ è¾“æˆ‘ä»¬çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯Processorã€‚Protocol å±‚å®šä¹‰äº†å¦‚ä½•æŠŠThriftå†…éƒ¨ç»“æ„çš„æ•°æ®åºåˆ—åŒ–åˆ°äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ–è€…åè¿‡æ¥è§£æï¼Œå¯ä»¥ä½¿ç”¨ JSONã€compact ç­‰è½¬æ¢æ–¹æ³•ã€‚Processor è´Ÿè´£ä» Protocol ä¸­è¯»å–è¯·æ±‚ï¼Œè°ƒç”¨ç”¨æˆ·çš„ä»£ç ï¼Œå¹¶å†™å…¥å“åº”ã€‚Server çš„å®ç°å¯ä»¥æœ‰å¾ˆå¤šä¸­ï¼Œæ¯”å¦‚å¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹çš„ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;Processor çš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;interface&lt;/span&gt; &lt;span class="nx"&gt;TProcessor&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="nx"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;TProtocol&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;TProtocol&lt;/span&gt; &lt;span class="nx"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="kr"&gt;throws&lt;/span&gt; &lt;span class="nx"&gt;TException&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Server çš„å…·ä½“å·¥ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ª Transport ç”¨äºä¼ è¾“æ•°æ®&lt;/li&gt;
&lt;li&gt;ä¸ºè¿™ä¸ªTransportåˆ›å»ºè¾“å…¥è¾“å‡ºçš„ Protocol &lt;/li&gt;
&lt;li&gt;åŸºäºä¸Šé¢çš„ Protocol åˆ›å»º Processor&lt;/li&gt;
&lt;li&gt;ç­‰å¾…å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶ä¸”æŠŠæ”¶åˆ°çš„è¯·æ±‚äº¤ç»™ Processor å¤„ç†ï¼Œä¸€ç›´å¾ªç¯ä¸‹å»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;ç¼–è¯‘&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;thrift -r --gen py file.thrift
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç¼–è¯‘å¥½çš„æ–‡ä»¶åœ¨ gen-py ç›®å½•ä¸‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-r&lt;/code&gt; è¡¨ç¤ºé€’å½’ç¼–è¯‘&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--gen&lt;/code&gt; æŒ‡å®šè¦ç”Ÿæˆçš„è¯­è¨€&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;ä¸€ä¸ªä¾‹å­&lt;/h1&gt;
&lt;p&gt;handler å¯¹åº”å®ç° service
Server ä¸­ä½¿ç”¨ Handler&lt;/p&gt;
&lt;p&gt;Pythonçš„ server å’Œ client &lt;/p&gt;
&lt;h1&gt;å¸¸è§é—®é¢˜&lt;/h1&gt;
&lt;p&gt;YN: çº¿ç¨‹å®‰å…¨æ€§&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;thrifté»˜è®¤æä¾›äº†thread/process ç­‰ä¸åŒçš„serverç±»å‹, éœ€è¦è€ƒè™‘handlerçš„çº¿ç¨‹å®‰å…¨é—®é¢˜&lt;/li&gt;
&lt;li&gt;thrift clientä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„, åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ä½¿ç”¨éœ€è¦æ³¨æ„(http://grokbase.com/t/thrift/user/127yhv7wmx/is-the-thrift-client-thread-safe)&lt;/li&gt;
&lt;li&gt;çœ‹ä¸€ä¸‹pyutilä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„...&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½•æ—¶éœ€è¦ä¸€ä¸ª thrift æœåŠ¡å‘¢ï¼Ÿè€Œä¸æ˜¯å°è£…ä¸€ä¸ªç±»æˆ–è€… dal æ¥æ“ä½œï¼Ÿ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è·¨è¯­è¨€ï¼Œè·¨ä»£ç åº“çš„è°ƒç”¨&lt;/li&gt;
&lt;li&gt;éœ€è¦ç»´æŒä¸€ä¸ªå¾ˆé‡çš„èµ„æºçš„æœåŠ¡&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœåªæ˜¯åŒä¸€ä¸ªè¯­è¨€å†…ï¼Œéœ€è¦è¯»å†™ä¸€äº›æ•°æ®åº“ä¹‹ç±»çš„ï¼Œå°è£…æˆä¸€ä¸ªç±»å°±å¯ä»¥äº†&lt;/p&gt;
&lt;p&gt;Conståº”è¯¥å®šä¹‰åœ¨å“ªå„¿ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯ä¸€ä¸ªéœ€è¦åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ä½¿ç”¨çš„å¸¸é‡ï¼Œä½¿ç”¨ thriftï¼Œå¦‚æœæ˜¯åœ¨æ•°æ®åº“ä¸­å­˜å‚¨ï¼Œä½¿ç”¨åœ¨ä»£ç ä¸­å®šä¹‰çš„å¸¸é‡&lt;/p&gt;
&lt;h2&gt;Thrift vs http api&lt;/h2&gt;
&lt;p&gt;A few reasons other than speed:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Thrift generates the client and server code completely, including the data structures you are passing, so you don't have to deal with anything other than writing the handlers and invoking the client. and everything, including parameters and returns are automatically validated and parsed. so you are getting sanity checks on your data for free.&lt;/li&gt;
&lt;li&gt;Thrift is more compact than HTTP, and can easily be extended to support things like encryption, compression, non blocking IO, etc.&lt;/li&gt;
&lt;li&gt;Thrift can be set up to use HTTP and JSON pretty easily if you want it (say if your client is somewhere on the internet and needs to pass firewalls)&lt;/li&gt;
&lt;li&gt;Thrift supports persistent connections and avoids the continuous TCP and HTTP handshakes that HTTP incurs.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Personally, I use thrift for internal LAN RPC and HTTP when I need connections from outside.&lt;/p&gt;
&lt;h1&gt;å‚è€ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/9732381/why-thrift-why-not-http-rpcjsongzip&lt;/li&gt;
&lt;li&gt;https://thrift-tutorial.readthedocs.io/en/latest/usage-example.html#a-simple-example-to-warm-up&lt;/li&gt;
&lt;li&gt;http://thrift-tutorial.readthedocs.io/en/latest/index.html&lt;/li&gt;
&lt;li&gt;https://diwakergupta.github.io/thrift-missing-guide/&lt;/li&gt;
&lt;li&gt;http://thrift.apache.org/tutorial/py&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 23 Jun 2017 15:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-23:/posts/thrift-rpc-kuang-jia.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>uwsgi å’Œ wsgi åè®®</title><link>/posts/uwsgi-he-wsgi-xie-yi.html</link><description>&lt;p&gt;uWSGI is a web server than runs python web frameworks. uwsgi(lower case) is the protocol it communicates with front end web servers(nginx)&lt;/p&gt;
&lt;h1&gt;wsgi åè®®&lt;/h1&gt;
&lt;p&gt;YN:&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯, wsgiå®é™…ä¸Šå®šä¹‰äº†ä¸€ä¸ªåŒæ­¥çš„æ¨¡å‹, ä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ªå®¢æˆ·è¯·æ±‚ä¼šè°ƒç”¨ä¸€ä¸ªåŒæ­¥çš„å‡½æ•°, è¿™æ ·ä¹Ÿå°±æ— æ³•å‘æŒ¥å¼‚æ­¥çš„ç‰¹æ€§.&lt;/p&gt;
&lt;h1&gt;ä¸¤ä¸ªæœ€ç®€å•çš„ä¾‹å­&lt;/h1&gt;
&lt;p&gt;å…¶ä¸­å®ç° simple_app å‡½æ•°ä¹Ÿå°±æ˜¯å®ç°äº†wsgiåè®®.éœ€è¦æ³¨æ„çš„æœ‰ä¸€ä¸‹ä¸‰ç‚¹:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;environå­—å…¸ä¸­åŒ…å«çš„å˜é‡&lt;/li&gt;
&lt;li&gt;start_responseçš„å‚æ•°&lt;/li&gt;
&lt;li&gt;simple_appçš„è°ƒç”¨æ¬¡åºå’Œè¿”å›å€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;HELLO_WORLD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;b&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Hello world!\n&amp;quot;&lt;/span&gt;

&lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;simple_app&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;start_response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;Simplest possible application object&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nx"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;response_headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
    &lt;span class="nx"&gt;start_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;response_headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;HELLO_WORLD&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;AppClass&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;Produce the same output, but using a class&lt;/span&gt;
&lt;span class="s2"&gt;    (Note: &amp;#39;AppClass&amp;#39; is the &amp;quot;&lt;/span&gt;&lt;span class="nx"&gt;application&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; here, so calling it&lt;/span&gt;
&lt;span class="s2"&gt;    returns an instance of &amp;#39;AppClass&amp;#39;, which is then the iterable&lt;/span&gt;
&lt;span class="s2"&gt;    return value of the &amp;quot;&lt;/span&gt;&lt;span class="nx"&gt;application&lt;/span&gt; &lt;span class="nx"&gt;callable&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; as required by&lt;/span&gt;
&lt;span class="s2"&gt;    the spec.&lt;/span&gt;
&lt;span class="s2"&gt;    If we wanted to use *instances* of &amp;#39;AppClass&amp;#39; as application&lt;/span&gt;
&lt;span class="s2"&gt;    objects instead, we would have to implement a &amp;#39;__call__&amp;#39;&lt;/span&gt;
&lt;span class="s2"&gt;    method, which would be invoked to execute the application,&lt;/span&gt;
&lt;span class="s2"&gt;    and we would need to create an instance for use by the&lt;/span&gt;
&lt;span class="s2"&gt;    server or gateway.&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;start_response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;environ&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;environ&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;start_response&lt;/span&gt;
    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;__iter__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="nx"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;
        &lt;span class="nx"&gt;response_headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
        &lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;start&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;response_headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;yield&lt;/span&gt; &lt;span class="nx"&gt;HELLO_WORLD&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è€Œå¯¹äºserver/gatewayæ¥è¯´, æ¯æ¥æ”¶åˆ°ä¸€ä¸ªhttpå®¢æˆ·ç«¯, éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡è¿™ä¸ª application callable&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="n"&gt;enc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;esc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getfilesystemencoding&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;surrogateescape&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;unicode_to_wsgi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Convert an environment variable to a WSGI &amp;quot;bytes-as-unicode&amp;quot; string&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;enc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;esc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;iso-8859-1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wsgi_to_bytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;iso-8859-1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run_with_cgi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;environ&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;unicode_to_wsgi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;()}&lt;/span&gt;
    &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wsgi.input&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;        &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;
    &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wsgi.errors&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;       &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stderr&lt;/span&gt;
    &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wsgi.version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;      &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wsgi.multithread&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;
    &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wsgi.multiprocess&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
    &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wsgi.run_once&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;     &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;HTTPS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;off&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;on&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wsgi.url_scheme&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;wsgi.url_scheme&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;headers_set&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;headers_sent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;headers_set&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
             &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;AssertionError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;write() before start_response()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;headers_sent&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
             &lt;span class="c1"&gt;# Before the first output, send the stored headers&lt;/span&gt;
             &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response_headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;headers_sent&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;headers_set&lt;/span&gt;
             &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wsgi_to_bytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Status: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
             &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;response_headers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                 &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wsgi_to_bytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
             &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wsgi_to_bytes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;start_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response_headers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;exc_info&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;exc_info&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;headers_sent&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="c1"&gt;# Re-raise original exception if headers sent&lt;/span&gt;
                    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;exc_info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;with_traceback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exc_info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
            &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;exc_info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;     &lt;span class="c1"&gt;# avoid dangling circular ref&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;headers_set&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;AssertionError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Headers already set!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;headers_set&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response_headers&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Note: error checking on the headers should happen here,&lt;/span&gt;
        &lt;span class="c1"&gt;# *after* the headers are set.  That way, if an error&lt;/span&gt;
        &lt;span class="c1"&gt;# occurs, start_response can only be re-called with&lt;/span&gt;
        &lt;span class="c1"&gt;# exc_info set.&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;write&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start_response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;    &lt;span class="c1"&gt;# don&amp;#39;t send headers until body appears&lt;/span&gt;
                &lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;headers_sent&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="c1"&gt;# send headers now if body was empty&lt;/span&gt;
    &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;hasattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;close&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å‚è€ƒèµ„æ–™&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;https://bottlepy.org/docs/dev/async.html&lt;/li&gt;
&lt;li&gt;http://uwsgi-docs-cn.readthedocs.io/zh_CN/latest/WSGIquickstart.html&lt;/li&gt;
&lt;li&gt;https://www.digitalocean.com/community/tutorials/how-to-deploy-python-wsgi-applications-using-uwsgi-web-server-with-nginx&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 21 Jun 2017 15:37:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-21:/posts/uwsgi-he-wsgi-xie-yi.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>squid proxy</title><link>/posts/squid-proxy.html</link><description>&lt;h1&gt;Install squid&lt;/h1&gt;
&lt;p&gt;plain old &lt;code&gt;apt-get update &amp;amp;&amp;amp; apt-get install squid3 apache2-utils -y&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;Basic squid conf&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;/etc/squid3/squid.conf&lt;/code&gt;Â instead of the super bloated default config file&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# note that on ubuntu 16.04, use squid instead of squid3
auth_param basic program /usr/lib/squid3/basic_ncsa_auth /etc/squid3/passwords
auth_param basic realm proxy
acl authenticated proxy_auth REQUIRED
http_access allow authenticated
forwarded_for delete
http_port 0.0.0.0:3128
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Please note theÂ &lt;code&gt;basic_ncsa_auth&lt;/code&gt;Â program instead of the oldÂ &lt;code&gt;ncsa_auth&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;Setting up a user&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;sudo htpasswd -c /etc/squid3/passwords username_you_like&lt;/code&gt;, &lt;em&gt;on 16.04, it's squid, not squid3&lt;/em&gt;
and enter a password twice for the chosen username then
&lt;code&gt;sudo service squid3 restart&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;see: https://stackoverflow.com/questions/3297196/how-to-set-up-a-squid-proxy-with-basic-username-and-password-authentication&lt;/p&gt;
&lt;h1&gt;centos&lt;/h1&gt;
&lt;p&gt;I have to use centos, since adsl providers are not capable of providing ubuntu&lt;/p&gt;
&lt;p&gt;check out this wonderful article: https://hostpresto.com/community/tutorials/how-to-install-and-configure-squid-proxy-on-centos-7/&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;yum install -y epel-release
yum install -y squid
yum install -y httpd-tools
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;systemctl start squid
systemctl enable squid
touch /etc/squid/passwd &amp;amp;&amp;amp; chown squid /etc/squid/passwd
htpasswd -c /etc/squid/passwd root
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;edit &lt;code&gt;/etc/squid/squid.conf&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;auth_param basic program /usr/lib64/squid/basic_ncsa_auth /etc/squid/passwd
auth_param basic children 5
auth_param basic realm Squid Basic Authentication
auth_param basic credentialsttl 2 hours
acl auth_users proxy_auth REQUIRED
http_access allow auth_users
http_port 3128
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¸€ä¸ªå°é—®é¢˜&lt;/p&gt;
&lt;p&gt;squid é»˜è®¤åªå…è®¸ä»£ç† 443 ç«¯å£çš„httpsæµé‡ï¼Œè€Œä¼šæ‹’ç»å¯¹å…¶ä»–ç«¯å£çš„connectè¯·æ±‚ã€‚éœ€è¦æ›´æ”¹é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;To fix this, add your port to the line in the config file:
acl SSL_ports port 443
so it becomes
acl SSL_ports port 443 4444
squid é»˜è®¤è¿˜ç¦æ­¢äº†é™¤äº†443ä¹‹å¤–çš„æ‰€æœ‰connect 
denyÂ CONNECTÂ !SSL_Ports  # åˆ æ‰è¿™ä¸€å¥&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 20 Jun 2017 15:22:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-20:/posts/squid-proxy.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>Gracefully shutdown inside a event loop</title><link>/posts/gracefully-shutdown-inside-a-event-loop.html</link><description>&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;run_forever&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;finally&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;run_until_complete&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;shutdown_asyncgens&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;close&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 18 Jun 2017 08:37:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-18:/posts/gracefully-shutdown-inside-a-event-loop.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>steal focus from chrome omnibox on new tab</title><link>/posts/steal-focus-from-chrome-omnibox-on-new-tab.html</link><description>&lt;p&gt;chrome set focus to the omni box when you create a new tab, although there is an api to replace the new tab page. you can't steal the focus from the omni box in the new tab page simply. there are two work-arounds.&lt;/p&gt;
&lt;h1&gt;if you are creating a new tab programmatically&lt;/h1&gt;
&lt;p&gt;https://stackoverflow.com/questions/42178723/chrome-extension-creating-new-tab-and-taking-focus-to-page&lt;/p&gt;
&lt;h1&gt;if you are creating a new tab by click new tab button&lt;/h1&gt;
&lt;p&gt;https://stackoverflow.com/questions/17598778/how-to-steal-focus-from-the-omnibox-in-a-chrome-extension-on-the-new-tab-page&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 18 Jun 2017 03:02:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-18:/posts/steal-focus-from-chrome-omnibox-on-new-tab.html</guid><category>å¤§å‰ç«¯</category><category>æµè§ˆå™¨æ‰©å±•</category><category>è®¡ç®—æœº</category></item><item><title>é˜…è¯» redis æºç </title><link>/posts/yue-du-redis-yuan-ma.html</link><description>&lt;ul&gt;
&lt;li&gt;https://zhengqm.github.io/code/2015/06/20/Learn-by-hacking-redis-source-code/&lt;/li&gt;
&lt;li&gt;https://github.com/huangz1990/blog/blob/master/diary/2014/how-to-read-redis-source-code.rst&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;å­—ç¬¦ä¸²&lt;/h1&gt;
&lt;p&gt;redis å†…éƒ¨ä½¿ç”¨Simple Data String ä»£è¡¨å­—ç¬¦ä¸²ã€‚ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;sdsçš„å†…å­˜åˆ†é…ç­–ç•¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœå½“å‰å†…å­˜ä¸èƒ½å¤Ÿæ”¾å¾—ä¸‹éœ€è¦çš„å­—ç¬¦ä¸²ï¼Œé•¿åº¦ç¿»å€ã€‚æ”¾å¾—ä¸‹åˆ™ç›´æ¥æ”¾ã€‚å½“è¶…è¿‡30Mæ—¶ï¼Œåˆ™æ¯æ¬¡å¢é•¿1M&lt;/li&gt;
&lt;li&gt;å¦‚æœé‡Šæ”¾å†…å­˜æ—¶ï¼Œä¸é‡Šæ”¾ç©ºé—´&lt;/li&gt;
&lt;li&gt;redisçš„å­—ç¬¦ä¸²æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;é“¾è¡¨&lt;/h1&gt;
&lt;p&gt;redis çš„ list æ˜¯ä½¿ç”¨é“¾è¡¨å®ç°çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;typedef struct listNode {
    struct listNode * prev;
    struct listNode * next;
    void * value;
} listNode;

typedef struct list {
    listNode * head;
    listNode * tail;&amp;#39;
    unsigned long len;
    void *(*dup) (void *ptr);
    void (*free)(void *ptr);
    int (*match) (void * ptr, void * key);
} list;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 17 Jun 2017 02:15:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-17:/posts/yue-du-redis-yuan-ma.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>running chrome extension from command line</title><link>/posts/running-chrome-extension-from-command-line.html</link><description>&lt;p&gt;https://stackoverflow.com/questions/22193369/run-chrome-extensions-using-command-prompt&lt;/p&gt;
&lt;p&gt;chrome/firefox æ’ä»¶æºç çš„ä½ç½®:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ChromeÂ &lt;code&gt;~/Library/Application Support/Google/Chrome/Default/Extensions/&amp;lt;EXTENSION_ID&amp;gt;/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;FirefoxÂ  &lt;code&gt;~/Library/Application Support/Firefox/Profiles/PROFILE_ID/extensions/EXTENSION_ID/&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 17 Jun 2017 02:14:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-17:/posts/running-chrome-extension-from-command-line.html</guid><category>å¤§å‰ç«¯</category><category>æµè§ˆå™¨æ‰©å±•</category><category>è®¡ç®—æœº</category></item><item><title>chrome spider</title><link>/posts/chrome-spider.html</link><description>&lt;p&gt;Write it in javascript, &lt;/p&gt;
&lt;p&gt;start script starts chrome and opens the extension by opening extension's page&lt;/p&gt;
&lt;p&gt;another scripts opens a http server locally to feed the initial command and rules&lt;/p&gt;
&lt;p&gt;the extension then executes as instructed&lt;/p&gt;
&lt;p&gt;see also:&lt;/p&gt;
&lt;p&gt;https://chrome.google.com/webstore/detail/wild-spider/aanpchnfojihjddlocpgoekffmjkhbbe&lt;/p&gt;
&lt;p&gt;https://chrome.google.com/webstore/detail/chrome-crawler/amjiobljggbfblhmiadbhpjbjakbkldd/reviews&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 16 Jun 2017 03:23:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-16:/posts/chrome-spider.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>MySQL å¤‡ä»½ä¸æ¢å¤</title><link>/posts/mysql-bei-fen-yu-hui-fu.html</link><description>&lt;h1&gt;åŸºç¡€ä½¿ç”¨&lt;/h1&gt;
&lt;p&gt;å¸®åŠ©å‘½ä»¤å¾ˆç®€å•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Usage&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mysqldump&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;OPTIONS&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="n"&gt;database&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;OR&lt;/span&gt;     &lt;span class="n"&gt;mysqldump&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;OPTIONS&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;databases&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;OPTIONS&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="n"&gt;DB1&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;DB2&lt;/span&gt; &lt;span class="n"&gt;DB3&lt;/span&gt;&lt;span class="o"&gt;...]&lt;/span&gt;
&lt;span class="n"&gt;OR&lt;/span&gt;     &lt;span class="n"&gt;mysqldump&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;OPTIONS&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;databases&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;OPTIONS&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å¤‡ä»½&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;mysqldump -u root --password=xxx DB_NAME [TABLE_NAME] &amp;gt; backup.sql&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--password&lt;/code&gt; å¯ä»¥ç›´æ¥åœ¨å‘½ä»¤ä¸­ä½¿ç”¨å¯†ç &lt;/p&gt;
&lt;p&gt;å¯ä»¥é€‰æ‹©åª dump ä¸€ä¸ªæ•°æ®åº“æˆ–è€…ä¸€ä¸ªè¡¨ã€‚&lt;/p&gt;
&lt;h1&gt;æ¢å¤&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;mysql -u root -p DB_NAME &amp;lt; backup.sql&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;ä¸€è¡Œæ“ä½œ&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mysqldump -u root -pPassword --all-databases | ssh user@new_host.host.com &amp;#39;cat - | mysql -u root -pPassword&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;é—®é¢˜&lt;/h1&gt;
&lt;p&gt;å¦‚æœç›´æ¥å¤‡ä»½æ‰€æœ‰æ•°æ®åº“å¹¶æ¢å¤ä¼šæ›´æ”¹ root å¯†ç , å¹¶ä¸”å¯¼è‡´å†…éƒ¨æ•°æ®åº“ä¸ä¸€è‡´, å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¿®å¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mysql_upgrade --force -uroot -p
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å‚è€ƒ:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://stackoverflow.com/questions/43846950/column-count-of-mysql-user-is-wrong-expected-42-found-44-the-table-is-probabl&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 15 Jun 2017 07:06:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-15:/posts/mysql-bei-fen-yu-hui-fu.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>developer mis-charging</title><link>/posts/developer-mis-charging.html</link><description>&lt;p&gt;I find it a little funny how unrealistic people can be when evaluating the cost of their problem. Take this one for example: "We have hundreds of images uploaded to our app each day. The issue is some of these images have text that we want cropped out." -- willing to pay? $75/month. Baller!
Chances are this is a problem for a data-mining / ai-training platform that wants to create a better image set. They are charging clients tens of thousands of dollars, and yet willing to pay $100/month to improve the data. lol
reply&lt;/p&gt;
&lt;p&gt;iamwil 8 hours ago | unvote [-]&lt;/p&gt;
&lt;p&gt;On the other hand, it can also go the other way. Non-technical customers don't actually care how hard something is to build, as long as it solves their problem. So it often surprises engineers how a 1 day script can make lots of money for them.
Freelancers often make the same mistake--charging by what it costs to them, plus a little bit more. You should charge how much value it brings to the customer, not how much it costs you to make. Easy to say, hard to do.
reply&lt;/p&gt;
&lt;p&gt;shams93 10 hours ago [-]&lt;/p&gt;
&lt;p&gt;Yeah like replace Quicken for $500 a month, maybe if I was living in a place with no infrastructure I could pull that but then I would never see the site or the post.
reply&lt;/p&gt;
&lt;p&gt;duskwuff 9 hours ago [-]&lt;/p&gt;
&lt;p&gt;My guess was actually that this would be for some sort of image site, to crop attribution information out of images. :/
reply&lt;/p&gt;
&lt;p&gt;giarc 9 hours ago [-]&lt;/p&gt;
&lt;p&gt;Sounds like a project for Mechanical Turk.
reply&lt;/p&gt;
&lt;p&gt;coss 10 hours ago [-]&lt;/p&gt;
&lt;p&gt;It's just 1's and 0's, how hard can it be?
reply&lt;/p&gt;
&lt;p&gt;See: https://news.ycombinator.com/item?id=14555251&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 15 Jun 2017 06:13:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-15:/posts/developer-mis-charging.html</guid><category>åˆ›ä¸š</category></item><item><title>vim ä¸­çš„æ‹¼å†™æ£€æŸ¥</title><link>/posts/vim-zhong-de-pin-xie-jian-cha.html</link><description>&lt;h1&gt;basic usage&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;:set spell&lt;/code&gt; to open, &lt;code&gt;:set nospell&lt;/code&gt; to disable, &lt;code&gt;:set spell!&lt;/code&gt; to toggle.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;]s&lt;/code&gt; and &lt;code&gt;[s&lt;/code&gt; to go to next and previous spell error. &lt;code&gt;z=&lt;/code&gt; to see suggestions, but it's not good. use &lt;code&gt;:nnoremap \s ea&amp;lt;C-X&amp;gt;&amp;lt;C-S&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Use &lt;code&gt;set spell&lt;/code&gt; to check spellings in vim, if you find word marked wrongly, simple press &lt;code&gt;zg&lt;/code&gt; to add it the dictionary and &lt;code&gt;zw&lt;/code&gt; to remove it from the dictionary, they can be revoked with &lt;code&gt;zug&lt;/code&gt; and &lt;code&gt;zuw&lt;/code&gt;.
Use &lt;code&gt;]s&lt;/code&gt; to go forward in the highlighted errors and &lt;code&gt;[s&lt;/code&gt; to go backwards.
Use &lt;code&gt;z=&lt;/code&gt; to bring up suggestions&lt;/p&gt;
&lt;p&gt;[1] Vim cast on spell check
http://vimcasts.org/episodes/spell-checking/&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;zg       Add word under the cursor as a good word to the first
         name in &amp;#39;spellfile&amp;#39;.  A count may precede the command
         to indicate the entry in &amp;#39;spellfile&amp;#39; to be used.  A
         count of two uses the second entry.

         In Visual mode the selected characters are added as a
         word (including white space!).
         When the cursor is on text that is marked as badly
         spelled then the marked text is used.
         Otherwise the word under the cursor, separated by
         non-word characters, is used.

         If the word is explicitly marked as bad word in
         another spell file the result is unpredictable.


zG       Like &amp;quot;zg&amp;quot; but add the word to the internal word list
         |internal-wordlist|.


zw       Like &amp;quot;zg&amp;quot; but mark the word as a wrong (bad) word.
         If the word already appears in &amp;#39;spellfile&amp;#39; it is
         turned into a comment line.  See |spellfile-cleanup|
         for getting rid of those.


zW       Like &amp;quot;zw&amp;quot; but add the word to the internal word list
         |internal-wordlist|.

zuw
zug      Undo |zw| and |zg|, remove the word from the entry in
         &amp;#39;spellfile&amp;#39;.  Count used as with |zg|.

zuW
zuG      Undo |zW| and |zG|, remove the word from the internal
         word list.  Count used as with |zg|.
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 14 Jun 2017 04:20:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-14:/posts/vim-zhong-de-pin-xie-jian-cha.html</guid><category>vim</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>axios and fetch</title><link>/posts/axios-and-fetch.html</link><description>&lt;h1&gt;cookies&lt;/h1&gt;
&lt;p&gt;æµè§ˆå™¨ä¸­çš„ JavaScript è¿è¡Œåœ¨ä¸€ä¸ªæ²™ç®±ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;fetch é»˜è®¤ä¸å¸¦ cookie, see https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials&lt;/p&gt;
&lt;p&gt;axios è‡ªåŠ¨é™„åŠ è¯·æ±‚åŸŸåå¯¹åº”çš„ cookie&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ JavaScript è®¾ç½®å¯¹åº”æ‰€åœ¨åŸŸåçš„ cookieï¼Œè€Œ chrome extension å¯ä»¥è®¾ç½®æ‰€æœ‰åŸŸåçš„ cookie&lt;/p&gt;
&lt;h1&gt;basic usage&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;try {
    let response = axios.get(url)
} catch (e) {
    console.log(e)
}

// å¯ä»¥ä½¿ç”¨çš„å‡ ç§è¯­æ³•
axios.get(url)
axios.post(url, data)
axios(config)
axios(url, config)
axios.request(config)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;config fields: &lt;code&gt;params, data, headers, timeout, auth, response&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…åˆ›å»ºä¸€ä¸ªå®ä¾‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;var instance = axios.create({
  baseURL: &amp;#39;https://some-domain.com/api/&amp;#39;,
  timeout: 1000,
  headers: {&amp;#39;X-Custom-Header&amp;#39;: &amp;#39;foobar&amp;#39;}
});

instance.get(&amp;#39;/&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;see&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;https://stackoverflow.com/questions/34558264/fetch-api-with-cookie&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 14 Jun 2017 01:37:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-14:/posts/axios-and-fetch.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Chrome Extension runtime</title><link>/posts/chrome-extension-runtime.html</link><description>&lt;h1&gt;basic usage&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chrome.runtime.getBackgroundPage(function(window) {})  // retrive the background page&amp;#39;s window object
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chrome.runtime.getURL(path)  // get the absolute url for given file in extension package
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 12 Jun 2017 15:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-12:/posts/chrome-extension-runtime.html</guid><category>å¤§å‰ç«¯</category><category>æµè§ˆå™¨æ‰©å±•</category><category>è®¡ç®—æœº</category></item><item><title>Chrome Extension Tabs</title><link>/posts/chrome-extension-tabs.html</link><description>&lt;h1&gt;permissions&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;permissions: [
    &amp;quot;tabs&amp;quot;,
]
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;usage&lt;/h1&gt;
&lt;h2&gt;chrome.tabs.query to get current tab&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;chrome&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;tabs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;query&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;active&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;currentWindow&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;true&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;function&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;tabs&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;  &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="nt"&gt;tabs&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;would&lt;/span&gt; &lt;span class="nt"&gt;be&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;current&lt;/span&gt; &lt;span class="nt"&gt;tab&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;create new tab&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chrome.tabs.create({url: URL}, function(tab) {})
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;kill tab&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chrome.tabs.remove(tabId or [tabId], function() {})
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 12 Jun 2017 14:36:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-12:/posts/chrome-extension-tabs.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Chrome Extension storage</title><link>/posts/chrome-extension-storage.html</link><description>&lt;h1&gt;Basic Concepts&lt;/h1&gt;
&lt;p&gt;there are 3 storage area for chrome, &lt;code&gt;sync&lt;/code&gt;, &lt;code&gt;local&lt;/code&gt;, &lt;code&gt;managed&lt;/code&gt; areas. the &lt;code&gt;sync&lt;/code&gt; area will be synced with the cloud. managed area is read-only.&lt;/p&gt;
&lt;p&gt;all your extension scripts share the same storage, including content scripts, they don't belong to their domain's localStorage.&lt;/p&gt;
&lt;h1&gt;Usage&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;chrome.storage.local.get(&amp;#39;key&amp;#39;, function(data) {});
chrome.storage.local.get([&amp;quot;KEY1&amp;quot;, &amp;quot;KEY2&amp;quot;], function(data) {});

chrome.storage.local.set(data, function() {});  // data is key-value pair to store

chrome.storage.local.remove(&amp;#39;key&amp;#39;, function() {});
chroem.storage.local.remove([&amp;quot;KEY1&amp;quot;, &amp;quot;KEY2&amp;quot;], function() {});
chrome.storage.local.clear(function() {});
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Events&lt;/h1&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 12 Jun 2017 13:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-12:/posts/chrome-extension-storage.html</guid><category>å¤§å‰ç«¯</category><category>æµè§ˆå™¨æ‰©å±•</category><category>è®¡ç®—æœº</category></item><item><title>JavaScript snippets</title><link>/posts/javascript-snippets.html</link><description>&lt;h1&gt;get parameter from url&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;getParameterByName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;location&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;/[\[\]]/g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;\\$&amp;amp;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;regex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nb"&gt;RegExp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;[?&amp;amp;]&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;(=([^&amp;amp;#]*)|&amp;amp;|#|$)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="nx"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;regex&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;exec&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;results&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;results&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;decodeURIComponent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;results&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;/\+/g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 12 Jun 2017 12:31:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-12:/posts/javascript-snippets.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Chrome extension cookies</title><link>/posts/chrome-extension-cookies.html</link><description>&lt;h1&gt;permissions&lt;/h1&gt;
&lt;p&gt;set the cookies permission and the domain you would like to access cookies.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;permissions&amp;quot;: {
    &amp;quot;cookies&amp;quot;,
    &amp;quot;*://*.example.com/&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;type&lt;/h1&gt;
&lt;h2&gt;cookie&lt;/h2&gt;
&lt;p&gt;just a simple object with &lt;code&gt;{name, value, domain...}&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;CookieStore&lt;/h2&gt;
&lt;p&gt;normal mode and incognito mode use different cookie stores.&lt;/p&gt;
&lt;h1&gt;read&lt;/h1&gt;
&lt;p&gt;get: &lt;code&gt;chrome.cookies.get({url: URL, name: COOKIE_NAME, storeId: COOKIE_STORE_ID}, function(cookie) {})&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;get all: &lt;code&gt;chrome.cookies.get({domain: DOMAIN}, function(cookies) {})&lt;/code&gt; NOTE: there are other filters not listed here.&lt;/p&gt;
&lt;p&gt;set: &lt;code&gt;chrome.cookies.set({url, name, value}, function(cookie) {})&lt;/code&gt; if failed, the callback gets null&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 12 Jun 2017 08:01:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-12:/posts/chrome-extension-cookies.html</guid><category>å¤§å‰ç«¯</category><category>æµè§ˆå™¨æ‰©å±•</category><category>è®¡ç®—æœº</category></item><item><title>EcmaScript Set</title><link>/posts/ecmascript-set.html</link><description>&lt;h1&gt;basic usage&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;let set = new Set();
let set = new Set([a, b, c]);

set.size  // the size of set
set.add(a)
set.delete(a)
set.clear()
set.has(value)
set.keys()  // the same as keys
set.values()  // return the values as a iterator
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;reference:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Set"&gt;MDN set&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 12 Jun 2017 00:14:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-12:/posts/ecmascript-set.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>JavaScript Move Element by Draging</title><link>/posts/javascript-move-element-by-draging.html</link><description>&lt;p&gt;see: https://stackoverflow.com/questions/6230834/html5-drag-and-drop-anywhere-on-the-screen&lt;/p&gt;
&lt;p&gt;but you also need to set &lt;code&gt;-webkit-user-drag: element;&lt;/code&gt; to the element.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sun, 11 Jun 2017 11:20:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-11:/posts/javascript-move-element-by-draging.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>thinking in vue</title><link>/posts/thinking-in-vue.html</link><description>&lt;h1&gt;basic usage&lt;/h1&gt;
&lt;p&gt;The created vue instance will proxy its data member &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;app&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;ol&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;li&lt;/span&gt; &lt;span class="na"&gt;v-for=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;company in companies&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;v-bind:href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;company.link&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;company.text&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;  // bind æ›´æ–°å‚æ•°
            &lt;span class="nt"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="na"&gt;v-on:click=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;reverseText&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;é€†è½¬æ¶ˆæ¯&lt;span class="nt"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/ol&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

let vm = new Vue({
    el: &amp;#39;#app&amp;#39;,
        data: {
            companies: [
                    {text: &amp;#39;Google&amp;#39;, link: &amp;#39;http://google.com&amp;#39;},
                        {text: &amp;#39;fackbook&amp;#39;, link: &amp;#39;http://facebook.com&amp;#39;},
                        {text: &amp;#39;apple&amp;#39;, link: &amp;#39;http://apple.com&amp;#39;}
                ]
        },
        methods: {
            reverseText: function() {
            // æ³¨æ„ this ç»‘å®šåˆ°äº†è§¦å‘è¿™ä¸ªäº‹ä»¶çš„å…ƒç´ å†…éƒ¨
                    this.company.text = this.company.text.split(&amp;#39;&amp;#39;).reverse.join(&amp;#39;&amp;#39;);
                }
        }   
});

vm.companies.push({text: &amp;#39;Amazon&amp;#39;, link: &amp;#39;http://amazon.com&amp;#39;});
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;// computed å±æ€§å¯ä»¥ç»‘å®šä¸€ä¸ªè™šæ‹Ÿçš„å±æ€§åˆ°å‡ ä¸ªä¸åŒçš„å±æ€§ä¸Š, æœ‰ç‚¹ç±»ä¼¼pythonçš„@property
// ...
computed: {
  fullName: {
    // getter
    get: function () {
      return this.firstName + &amp;#39; &amp;#39; + this.lastName
    },
    // setter
    set: function (newValue) {
      var names = newValue.split(&amp;#39; &amp;#39;)
      this.firstName = names[0]
      this.lastName = names[names.length - 1]
    }
  }
}
// ...
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# é€‚åˆç”¨æ¥åšè‡ªåŠ¨ä¿å­˜æ–‡æ¡£ç­‰å·¥ä½œ
&amp;lt;script&amp;gt;
var watchExampleVM = new Vue({
  el: &amp;#39;#watch-example&amp;#39;,
  data: {
    question: &amp;#39;&amp;#39;,
    answer: &amp;#39;I cannot give you an answer until you ask a question!&amp;#39;
  },
  watch: {
    // å¦‚æœ question å‘ç”Ÿæ”¹å˜ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè¿è¡Œ
    question: function (newQuestion) {
      this.answer = &amp;#39;Waiting for you to stop typing...&amp;#39;
      this.getAnswer()
    }
  },
  methods: {
    // _.debounce æ˜¯ä¸€ä¸ªé€šè¿‡ lodash é™åˆ¶æ“ä½œé¢‘ç‡çš„å‡½æ•°ã€‚
    // åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›é™åˆ¶è®¿é—® yesno.wtf/api çš„é¢‘ç‡
    // ajax è¯·æ±‚ç›´åˆ°ç”¨æˆ·è¾“å…¥å®Œæ¯•æ‰ä¼šå‘å‡º
    // å­¦ä¹ æ›´å¤šå…³äº _.debounce function (and its cousin
    // _.throttle)ï¼Œå‚è€ƒï¼šhttps://lodash.com/docs#debounce
    getAnswer: _.debounce(
      function () {
        if (this.question.indexOf(&amp;#39;?&amp;#39;) === -1) {
          this.answer = &amp;#39;Questions usually contain a question mark. ;-)&amp;#39;
          return
        }
        this.answer = &amp;#39;Thinking...&amp;#39;
        var vm = this
        axios.get(&amp;#39;https://yesno.wtf/api&amp;#39;)
          .then(function (response) {
            vm.answer = _.capitalize(response.data.answer)
          })
          .catch(function (error) {
            vm.answer = &amp;#39;Error! Could not reach the API. &amp;#39; + error
          })
      },
      // è¿™æ˜¯æˆ‘ä»¬ä¸ºç”¨æˆ·åœæ­¢è¾“å…¥ç­‰å¾…çš„æ¯«ç§’æ•°
      500
    )
  }
})
&amp;lt;/script&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;flow control&lt;/h2&gt;
&lt;h3&gt;v-if&lt;/h3&gt;
&lt;p&gt;v-else å…ƒç´ å¿…é¡»ç´§è·Ÿåœ¨ v-if æˆ–è€… v-else-if å…ƒç´ çš„åé¢â€”â€”å¦åˆ™å®ƒå°†ä¸ä¼šè¢«è¯†åˆ«ã€‚v-else-if ä¹Ÿæ˜¯.&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨templateæ¥åŒ…è£…å¤šä¸ªå…ƒç´ :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;template&lt;/span&gt; &lt;span class="na"&gt;v-if=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;ok&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Title&lt;span class="nt"&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;Paragraph 1&lt;span class="nt"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;Paragraph 2&lt;span class="nt"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/template&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;v-for&lt;/h3&gt;
&lt;p&gt;v-forçš„åŸºæœ¬è¯­æ³•å¦‚å‰æ‰€è¿°, å¦å¤–è¿˜å¯ä»¥é‡‡ç”¨å¯é€‰å‚æ•° key. &lt;code&gt;&amp;lt;li v-for="(item, index) in items"&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;v-forè¿˜å¯ä»¥éå†å¯¹è±¡, &lt;code&gt;&amp;lt;li v-for="value in obj"&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;v-forè¿˜å¯ä»¥ç›´æ¥éå†range, &lt;code&gt;&amp;lt;li v-for="n in 10"&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;äº‹ä»¶&lt;/h2&gt;
&lt;p&gt;åœ¨vueä¸­, ç»‘å®šçš„äº‹ä»¶å¦‚æœéœ€è¦å‚æ•°, å¯ä»¥ä½¿ç”¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="na"&gt;v-on:click=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;warn(&amp;#39;Form cannot be submitted yet.&amp;#39;, $event)&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  Submit
&lt;span class="nt"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;çš„å½¢å¼, å…¶ä¸­ $event æŒ‡çš„æ˜¯åŸå£°äº‹ä»¶.&lt;/p&gt;
&lt;h3&gt;ä¿®é¥°ç¬¦&lt;/h3&gt;
&lt;p&gt;vueä¸­çš„äº‹ä»¶ç»‘å®šå‡½æ•°å¯ä»¥ä½¿ç”¨ä¸€äº›ä¿®é¥°ç¬¦æ¥æŒ‡å®šä¸€äº›é™„åŠ çš„æ•ˆæœ. å¸¸ç”¨çš„æœ‰ &lt;code&gt;.prevent&lt;/code&gt;, &lt;code&gt;.stop&lt;/code&gt;, &lt;code&gt;.self&lt;/code&gt;, &lt;code&gt;.once&lt;/code&gt; ç­‰.&lt;/p&gt;
&lt;p&gt;åƒè¿™æ ·: &lt;code&gt;&amp;lt;a v-on:click.stop="doThis"&amp;gt;&amp;lt;/a&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºé”®ç›˜æ—¶é—´, è¿˜å¯ä»¥ä½¿ç”¨ä¿®é¥°ç¬¦æ¥æŒ‡å®šé”®å€¼: &lt;code&gt;&amp;lt;input v-on:keyup.enter="submit"&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;mustache vs &lt;code&gt;v-bind&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;mustache can only be used in textContent of an element, &lt;code&gt;v-bind&lt;/code&gt; is used for attribute.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;v-bind:href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;url&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;link_text&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;shortcut&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- å®Œæ•´è¯­æ³• --&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;v-bind:href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;url&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;&amp;lt;!-- ç¼©å†™ --&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;:href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;url&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- å®Œæ•´è¯­æ³• --&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;v-on:click=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;doSomething&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;&amp;lt;!-- ç¼©å†™ --&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="na"&gt;click=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;doSomething&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;v-model åšåŒå‘ç»‘å®š&lt;/h2&gt;
&lt;p&gt;use v-model to double bind data between input and js.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;app-6&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;message&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;input&lt;/span&gt; &lt;span class="na"&gt;v-model=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;message&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

var app6 = new Vue({
  el: &amp;#39;#app-6&amp;#39;,
  data: {
    message: &amp;#39;Hello Vue!&amp;#39;
  }
})
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯, v-model æœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–. 
&lt;code&gt;&amp;lt;input v-model="something"&amp;gt;&lt;/code&gt; is just a syntax sugar to &lt;code&gt;&amp;lt;input v-bind:value="something" v-on:input="something = $event.target.value"&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;text area&lt;/h3&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯, textarea æ—¶é—´ä¸Šç›¸å½“äºä¸€ä¸ªinputç»„ä»¶, ä¸èƒ½åœ¨testareaå†…éƒ¨ä½¿ç”¨ {{value}} çš„è¯­æ³•, è€Œåº”è¯¥ä½¿ç”¨ &lt;code&gt;v-model&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;span&amp;gt;&lt;/span&gt;Multiline message is:&lt;span class="nt"&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;p&lt;/span&gt; &lt;span class="na"&gt;style=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;white-space: pre-line;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;message&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;br&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;textarea&lt;/span&gt; &lt;span class="na"&gt;v-model=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;message&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;placeholder=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;add multiple lines&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/textarea&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;ä¿®é¥°ç¬¦&lt;/h3&gt;
&lt;p&gt;å°±åƒäº‹ä»¶ä¸€æ ·, ä¹Ÿå¯ä»¥æŒ‡å®šä¸€äº›ä¿®é¥°ç¬¦ç»™ v-model, å¸¸ç”¨çš„æœ‰ &lt;code&gt;.trim&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;vue-component&lt;/h1&gt;
&lt;p&gt;&lt;img src="https://cn.vuejs.org/images/components.png" width=360 /&gt;&lt;/p&gt;
&lt;p&gt;vue çš„componentä¸­ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µ: props, events, slots.&lt;/p&gt;
&lt;p&gt;å…¶ä¸­propså‘ä¸‹ä¼ é€’, ç”¨äºparentç»„ä»¶å‘childç»„ä»¶ä¼ é€’å€¼. childç»„ä»¶å¯¹äºpropsçš„è®¿é—®åªèƒ½æ˜¯åªè¯»çš„. åœ¨childç»„ä»¶ä¸­ä½¿ç”¨&lt;code&gt;v-bind:var="var"&lt;/code&gt;æ¥è®¿é—®å®šä¹‰çš„props. æ³¨æ„åœ¨ç»„ä»¶ä¸­ä¸èƒ½æ›´æ”¹props, å¦‚æœéœ€è¦æ›´æ”¹ä»–, è¯·æŠŠä»–èµ‹å€¼ç»™å…¶ä»–å˜é‡, æˆ–è€…ä½¿ç”¨ computed å±æ€§.&lt;/p&gt;
&lt;p&gt;å¦‚æœæŠŠæ¨¡æ¿ç›´æ¥æ”¾åˆ°domä¸­ä¼šæœ‰ä¸€äº›æ ‡ç­¾æ¸²æŸ“ä¸å‡ºæ¥, å»ºè®®æ”¾åˆ° &lt;script type="text/x-template"&gt;&lt;/script&gt; ä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;// åœ¨vueä¸­æ³¨å†Œä¸€ä¸ªç»„ä»¶, å¤§å¤šæ•°ä¼ é€’ç»™vueå®ä¾‹çš„å‚æ•°éƒ½å¯ä»¥ä½¿ç”¨, é™¤äº† data å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°

Vue.component(&amp;#39;todo-item&amp;#39;, {
  // todo-item ç»„ä»¶ç°åœ¨æ¥å—ä¸€ä¸ª&amp;quot;prop&amp;quot;ï¼Œç±»ä¼¼äºä¸€ä¸ªè‡ªå®šä¹‰å±æ€§. è¿™ä¸ªå±æ€§åä¸º todoã€‚
  props: [&amp;#39;todo&amp;#39;],
  template: &amp;#39;&lt;span class="nt"&gt;&amp;lt;li&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;todo.text&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;&amp;#39;,
  data: function() {},
})

&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;app-7&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;ol&amp;gt;&lt;/span&gt;
    &lt;span class="c"&gt;&amp;lt;!-- ç°åœ¨æˆ‘ä»¬ä¸ºæ¯ä¸ªtodo-itemæä¾›å¾…åŠé¡¹å¯¹è±¡    --&amp;gt;&lt;/span&gt;
    &lt;span class="c"&gt;&amp;lt;!-- å¾…åŠé¡¹å¯¹è±¡æ˜¯å˜é‡ï¼Œå³å…¶å†…å®¹å¯ä»¥æ˜¯åŠ¨æ€çš„ --&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;todo-item&lt;/span&gt; &lt;span class="na"&gt;v-for=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;item in groceryList&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;v-bind:todo=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;item&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/todo-item&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/ol&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

Vue.component(&amp;#39;todo-item&amp;#39;, {
  props: [&amp;#39;todo&amp;#39;],
  template: &amp;#39;&lt;span class="nt"&gt;&amp;lt;li&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;todo.text&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;&amp;#39;
})
var app7 = new Vue({
  el: &amp;#39;#app-7&amp;#39;,
  data: {
    groceryList: [
      { text: &amp;#39;è”¬èœ&amp;#39; },
      { text: &amp;#39;å¥¶é…ª&amp;#39; },
      { text: &amp;#39;éšä¾¿å…¶ä»–ä»€ä¹ˆäººåƒçš„ä¸œè¥¿&amp;#39; }
    ]
  }
})
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;äº‹ä»¶&lt;/h3&gt;
&lt;p&gt;parentç»„ä»¶å¯ä»¥ç›‘å¬å­ç»„ä»¶çš„äº‹ä»¶, ä»è€Œå®ç°é€šä¿¡:&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¾‹å­ä¸­, å­ç»„ä»¶é€šè¿‡$emit()å‡½æ•°å‘é€incrementäº‹ä»¶. parentç»„ä»¶é€šè¿‡ç›‘å¬å­ç»„ä»¶çš„incrementäº‹ä»¶, ä»è€Œè·å¾—å­ç»„ä»¶çš„æ¶ˆæ¯.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;counter-event-example&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;total&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;button-counter&lt;/span&gt; &lt;span class="na"&gt;v-on:increment=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;incrementTotal&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/button-counter&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;button-counter&lt;/span&gt; &lt;span class="na"&gt;v-on:increment=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;incrementTotal&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/button-counter&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
Vue.component(&amp;#39;button-counter&amp;#39;, {
  template: &amp;#39;&lt;span class="nt"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="na"&gt;v-on:click=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;incrementCounter&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;counter&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt;&amp;#39;,
  data: function () {
    return {
      counter: 0
    }
  },
  methods: {
    incrementCounter: function () {
      this.counter += 1
      this.$emit(&amp;#39;increment&amp;#39;)
    }
  },
})
new Vue({
  el: &amp;#39;#counter-event-example&amp;#39;,
  data: {
    total: 0
  },
  methods: {
    incrementTotal: function () {
      this.total += 1
    }
  }
})
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;slots&lt;/h3&gt;
&lt;p&gt;slots vs props: slots ç”¨äºæ˜¾ç¤ºä¸€å¤§ç‰‡çš„åŒ…å«htmlä»£ç çš„æ›¿æ¢å—, è€Œprops ç”¨äºæ˜¾ç¤ºå€¼, æœ‰ç‚¹ç±»ä¼¼ v-bind å’Œ {{}} çš„åŒºåˆ«.&lt;/p&gt;
&lt;p&gt;Props å…è®¸å¤–éƒ¨ç¯å¢ƒä¼ é€’æ•°æ®ç»™ç»„ä»¶
Events å…è®¸ä»å¤–éƒ¨ç¯å¢ƒåœ¨ç»„ä»¶å†…è§¦å‘å‰¯ä½œç”¨
Slots å…è®¸å¤–éƒ¨ç¯å¢ƒå°†é¢å¤–çš„å†…å®¹ç»„åˆåœ¨ç»„ä»¶ä¸­ã€‚&lt;/p&gt;
&lt;h1&gt;vue router&lt;/h1&gt;
&lt;p&gt;basic: å°†ç»„ä»¶(components)æ˜ å°„åˆ°è·¯ç”±(routes)ï¼Œç„¶åå‘Šè¯‰ vue-router åœ¨å“ªé‡Œæ¸²æŸ“å®ƒä»¬ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;app&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;router-link&lt;/span&gt; &lt;span class="na"&gt;to=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/user/foo&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;/user/foo&lt;span class="nt"&gt;&amp;lt;/router-link&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;router-link&lt;/span&gt; &lt;span class="na"&gt;to=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/user/bar&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;/user/bar&lt;span class="nt"&gt;&amp;lt;/router-link&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;router-view&amp;gt;&amp;lt;/router-view&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
const User = {
  template: `&lt;span class="nt"&gt;&amp;lt;div&amp;gt;&lt;/span&gt;User &lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;route.params.id&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;`
}

const router = new VueRouter({
  mode: &amp;#39;history&amp;#39;,  // è¿™æ ·æ‰èƒ½ä½¿ç”¨ html5 çš„history api
  routes: [
    { path: &amp;#39;/user/:id&amp;#39;, component: User }
  ]
})

const app = new Vue({ router }).$mount(&amp;#39;#app&amp;#39;)
&lt;span class="nt"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;vue lifecycle&lt;/h1&gt;
&lt;p&gt;&lt;img src="https://cn.vuejs.org/images/lifecycle.png" width=640 /&gt;&lt;/p&gt;
&lt;h1&gt;using in chrome extension&lt;/h1&gt;
&lt;p&gt;chrome does not allow &lt;code&gt;eval&lt;/code&gt; and &lt;code&gt;new Function()&lt;/code&gt; in extensions, vue relies on it. you need to use CSP version of vue or relax the restriction by chrome.&lt;/p&gt;
&lt;p&gt;See also: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;https://developer.chrome.com/extensions/contentSecurityPolicy#relaxing-eval&lt;/li&gt;
&lt;li&gt;https://stackoverflow.com/questions/34615503/vue-js-in-chrome-extension&lt;/li&gt;
&lt;li&gt;https://vuejs.org/v2/guide/installation.html#CSP-environments&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 10 Jun 2017 04:03:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-10:/posts/thinking-in-vue.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Chrome æ‰©å±•æ’ä»¶å¼€å‘</title><link>/posts/chrome-kuo-zhan-cha-jian-kai-fa.html</link><description>&lt;p&gt;A chrome extension can inject script into the page, this is called content script.&lt;/p&gt;
&lt;p&gt;https://developer.chrome.com/extensions/getstarted
https://developer.chrome.com/extensions/content_scripts
https://developer.chrome.com/extensions/messaging&lt;/p&gt;
&lt;p&gt;å›¾æ ‡å˜ç°çš„é—®é¢˜&lt;/p&gt;
&lt;p&gt;Add browser_action.default_icon in your manifest.json file&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;{
  ...

  &amp;quot;browser_action&amp;quot;: {
    &amp;quot;default_icon&amp;quot;: &amp;quot;icons/icon-32.png&amp;quot;
  },

  ...
}
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 09 Jun 2017 05:11:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-09:/posts/chrome-kuo-zhan-cha-jian-kai-fa.html</guid><category>å¤§å‰ç«¯</category><category>æµè§ˆå™¨æ‰©å±•</category><category>è®¡ç®—æœº</category></item><item><title>åœ¨ Mac ä¸Šå®‰è£… neovim</title><link>/posts/zai-mac-shang-an-zhuang-neovim.html</link><description>&lt;p&gt;é¦–å…ˆé€šè¿‡ homebrew å®‰è£…:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;brew install neovim&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå®‰è£… python æ”¯æŒï¼Œå¥½å¤š vim æ’ä»¶éƒ½éœ€è¦&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pip install neovim&lt;/code&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 09 Jun 2017 02:42:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-09:/posts/zai-mac-shang-an-zhuang-neovim.html</guid><category>vim</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>å­¦ä¹  redis çš„åŸºç¡€å‘½ä»¤</title><link>/posts/xue-xi-redis-de-ji-chu-ming-ling.html</link><description>&lt;p&gt;basically, redis is a data structure server&lt;/p&gt;
&lt;p&gt;string list set sorted set hash&lt;/p&gt;
&lt;h2&gt;key related&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;keys &amp;lt;pattern&amp;gt;  list all keys share the pattern
exists key  
del key 
expire key expiration   
expireat key timestamp  
ttl key 
rename key  
type key    
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;string related&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;set key value   set mystr &amp;quot;hello world&amp;quot;
setex key timeout value set key with expiration
setnx key value set only not exist
get key -&amp;gt; value    get mystr
getset key new -&amp;gt; old   get old and set new
setrange key offset value   
getrange key start end  returns the value, inclusive
mget key... returns a list of values
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;incr key    mynum
decr key    mynum
incrby key value    mynum
decrby key value    mynum
getset  
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;hash&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hmset key f v ...   store kv pair in hash
hgetall key 
hdel key f  
hexists key f   
hkeys key   
hlen key    
hvals key   
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;lists&lt;/h1&gt;
&lt;p&gt;list is implemented as a double-linked list&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;lpush key value1 value2 value3   lpushx only pushes if not exist
rpush   
lpop key    
rpop    
rpoplpush src dst   
blpop key... timeout    block until one value is avaliable
lindex key index    
llen key    
lrange key start end    inclusive
linsert key     
lrem key count value    
lset key index value    
ltrim key start end 
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;tricks&lt;/h1&gt;
&lt;p&gt;to get all elements with lrange: use &lt;code&gt;lrange KYE 0 -1&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;Persistense&lt;/h1&gt;
&lt;p&gt;RDB
AOF&lt;/p&gt;
&lt;h1&gt;Transaction&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;MULTIç”¨æ¥ç»„è£…ä¸€ä¸ªäº‹åŠ¡ï¼›
EXECç”¨æ¥æ‰§è¡Œä¸€ä¸ªäº‹åŠ¡ï¼›
DISCARDç”¨æ¥å–æ¶ˆä¸€ä¸ªäº‹åŠ¡ï¼›
WATCHç”¨æ¥ç›‘è§†ä¸€äº›keyï¼Œä¸€æ—¦è¿™äº›keyåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¢«æ”¹å˜ï¼Œåˆ™å–æ¶ˆäº‹åŠ¡çš„æ‰§è¡Œã€‚
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;zset&lt;/h1&gt;
&lt;p&gt;rank is which place the value ranked by score in the zset.&lt;/p&gt;
&lt;h2&gt;add and remove cookies&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;zadd KEY SCORE MEMBER           # add a value to a zset
zincrby KEY SCORE MEMBER        # increment the member&amp;#39;s score NOTE redis-py implements wrongly
zrem KEY MEMBER...              # remove a value from zset
zremrangebyrank KEY START STOP  # removes all values in the set within the give index
zremrangebyscore KEY MIN MAX    # removes all values in the set within the given scores
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;get zset stats&lt;/h2&gt;
&lt;p&gt;this is zismember command, just use zscore KEY MEMBER is None to check&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;zcard KEY                       # get the number of elements in a zset
zcount KEY MIN MAX              # count the members in a sorted set with scores within the given scores
zrank KEY MEMBER                # get the index of member in zset
zrevrank KEY MEMBER             # the reverse index of member
zscore KEY MEMBER               # get the score of member in zset
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;read member(s)&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;zrange KEY START END            # a range of members by index
zrevrange KEY START END         # a range of memvers by index, sorted from high to low
zrangebyscore KEY MIN MAX       # a range of members within given scores
zrevrangebyscore KEY MAX MIN    # a range of members within given scores, from max to min
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;set manipulation&lt;/h2&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 08 Jun 2017 10:19:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-08:/posts/xue-xi-redis-de-ji-chu-ming-ling.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>JavaScript Selection and Range</title><link>/posts/javascript-selection-and-range.html</link><description>&lt;h1&gt;basics&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;window.getSelection&lt;/code&gt; and &lt;code&gt;document.getSelection&lt;/code&gt; all returns the &lt;code&gt;Selection&lt;/code&gt; object, the selection object is almost useless.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;window.getSelection.getRangeAt(0)&lt;/code&gt; returns a Range object. for history reasons, there is only one range in each selection.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rangeAncestor = range.commonAncestorContainer;&lt;/code&gt; commonAncestorContainer is the common ancestor of the range elements.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 08 Jun 2017 09:40:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-08:/posts/javascript-selection-and-range.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Unicode</title><link>/posts/unicode.html</link><description>&lt;h1&gt;Planeï¼ˆå¹³é¢ï¼‰&lt;/h1&gt;
&lt;p&gt;from wikipedia&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In theÂ UnicodeÂ standard, aÂ planeÂ is a continuous group ofÂ 65536Â code points. There are 17 planes, identified by the numbers 0 to 16, which corresponds with the possible values 00â€“10 hexadecimalÂ of the first two positions in six position format (hhhhhh). &lt;/p&gt;
&lt;p&gt;Plane 0 is the Basic Multilingual Plane (BMP), which contains most commonly-used characters. The higher planes 1 through 16 are called "supplementary planes", As of Unicode version 9.0, six of the planes have assigned code points (characters), and four are named.&lt;/p&gt;
&lt;p&gt;The limit of 17 (which is not aÂ power of 2) is due to the design ofÂ UTF-16, which can encode a maximum value of 0x10FFFF,[2]Â the last code point in plane 16. The encoding scheme used byÂ UTF-8Â was designed with a much larger limit of 231Â code points (32,768 planes), and can encode 221Â code points (32 planes) even if limited to 4Â bytes. Since Unicode limits the code points to the 17 planes that can be encoded by UTF-16, &lt;strong&gt;code points above 0x10FFFF are invalid in UTF-8 and UTF-32&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The 17 planes can accommodate 1,114,112 code points. Of these, 2,048 areÂ surrogates, 66 areÂ non-characters, and 137,468 areÂ reserved for private use, leaving 974,530 for public assignment.&lt;/p&gt;
&lt;p&gt;Planes are further subdivided intoÂ &lt;em&gt;Unicode blocks&lt;/em&gt;, which, unlike planes, do not have a fixed size. The 273 blocks defined in Unicode 9.0 cover 24% of the possible code point space, and range in size from a minimum of 16 code points (twelve blocks) to a maximum of 65,536 code points (Supplementary Private Use Area-A and -B, which constitute the entirety of planes 15 and 16). For future usage, ranges of characters have been tentatively mapped out for most known current and ancient writing systems.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;Plane 0(BMP)&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;0000-007F   ASCII       
0080-1FFF   å„ç§é¸Ÿè¯­        
2000-206F   å¸¸ç”¨æ ‡ç‚¹    General Punctuation åŒ…å«åŒå¼•å·
2070-209F   ä¸Šä¸‹æ ‡     
20A0-20CF   è´§å¸ç¬¦å·        
20D0-214F   å„ç§ç‰©ç†ç¬¦å·      
2150-218f   ç½—é©¬æ•°å­—        
2190-21ff   ç®­å¤´ https://en.wikipedia.org/wiki/Arrows_(Unicode_block)  æœ‰emoji
2220-22FF   æ•°å­¦ç¬¦å·        
2300-23ff   ç¬¦å·  Miscellaneous Technical æœ‰emoji
2400-245f   ç¬¦å·      
2460-24ff   åœ†åœˆ  Enclosed Alphanumerics  
2500-257f   ç”»æ–¹å—å­—ç¬¦   Box Drawing å¥½å¤šäººç”¨åšç«–çº¿
2580-259f   æ–¹å—å­—ç¬¦    Box Elements    
25A0-2e7f   å„ç§å¥‡æ€ªçš„å­—ç¬¦ï¼ŒåŒ…å«éƒ¨åˆ†è¡¨æƒ… emoji
3000-303f   ä¸­æ–‡ç¬¦å·å’Œæ ‡ç‚¹ï¼ŒåŒ…å«äº†ä¸­æ‹¬å·ç­‰ï¼Œç«Ÿç„¶æœ‰åŒå­—èŠ‚å®½çš„å¼•å·
3040-33ff   å„ç§ä¸­æ–‡ç¬¦å·ï¼Œ3190ä¹Ÿæ˜¯ç«–çº¿
4DC0-4DFF   å…«å¦ç¬¦å·        
4e00-9fff   CJKç»Ÿä¸€è¡¨æ„æ–‡å­—       
A000-D7af   å„ç§é¸Ÿè¯­        
D7B0-D7FF   UTF-16é«˜åŠåŒºï¼Œå®é™…ä½¿ç”¨D800-DBFF
DC00-DFFF   ä½åŠåŒº     
E000-F8FF   ç§ç”¨åŒº, å…¶ä¸­ F8FF è¡¨ç¤º ï£¿
F900-FAFF   CJKç»Ÿä¸€è¡¨æ„æ–‡å­—       
FB00-FE0F   å„ç§é¸Ÿè¯­        
FE10-FE1F   ç«–æ’ç¬¦å·        
FE30-FE4F   CJKå…¼å®¹æ ‡ç‚¹     
FE50-FE6F   å°æ ‡ç‚¹     
FE70-FEFF   é¸Ÿè¯­      
FF00-FFEF   å…¨è§’ä¸åŠè§’       
FFF0-FFFF   å¥‡è‘©      
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Plane 1 (SMP)&lt;/h1&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„åŒºåŸŸ&lt;/p&gt;
&lt;p&gt;1F000-1FFFF å„ç§è¡¨æƒ… emoji&lt;/p&gt;
&lt;h1&gt;emoji&lt;/h1&gt;
&lt;h2&gt;text vs emoji style&lt;/h2&gt;
&lt;p&gt;Emoji æœ‰textå’Œemoji-styleä¸¤ç§å½¢å¼ï¼Œæ¯ä¸ªemoji æœ‰ä¸€ä¸ªé»˜è®¤çš„å½¢å¼ï¼Œå¯ä»¥æ·»åŠ å­—ç¬¦æ¥å¼ºåˆ¶æŒ‡å®šå½¢å¼ï¼š&lt;code&gt;\ufe0e&lt;/code&gt; &lt;code&gt;\ufe0f&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;skin colors&lt;/h2&gt;
&lt;p&gt;Emojiå¯ä»¥è¡¨ç¤ºä¸åŒçš„è‚¤è‰²ï¼Œ&lt;code&gt;\u1F3FBâ€“\u1F3FF&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;emoji combination&lt;/h2&gt;
&lt;p&gt;ç»„åˆï¼ŒEmoji è¿˜å¯ä»¥ç»„åˆæˆæ–°çš„ emojiï¼Œè¿™æ ·æ¥æ‹Ÿè¡¥ä¸è¶³ï¼Œä½¿ç”¨&lt;code&gt;\u200d&lt;/code&gt; http://www.unicode.org/emoji/charts/emoji-zwj-sequences.html&lt;/p&gt;
&lt;p&gt;æ›´å¤š emoji è¡¨æƒ…å‚è§ï¼šhttp://www.unicode.org/Public/emoji/1.0/emoji-data.txt&lt;/p&gt;
&lt;h1&gt;Surrogate&lt;/h1&gt;
&lt;p&gt;Surrogate to Non-Surrogate:&lt;/p&gt;
&lt;p&gt;N = 0x10000 + (H - 0xd800) * 0x400 + (L - 0xDC00)&lt;/p&gt;
&lt;p&gt;Non-Surrogate to Surrogate&lt;/p&gt;
&lt;p&gt;H = (N - 0x10000) / 0x400 + 0xD800
L = (N - 0x10000) % 0x400 + 0xdc00&lt;/p&gt;
&lt;p&gt;Python&lt;/p&gt;
&lt;p&gt;narrow build python does not support SMP, python on mac are all narrow build.if you got narrow build, you will have to use to unicode char to represent.&lt;/p&gt;
&lt;p&gt;å¸¸è§é—®é¢˜&lt;/p&gt;
&lt;p&gt;èŠèŠ±æ–‡&lt;/p&gt;
&lt;p&gt;https://zh.wikipedia.org/wiki/%E8%8F%8A%E8%8A%B1%E6%96%87&lt;/p&gt;
&lt;p&gt;Unicode character orders&lt;/p&gt;
&lt;p&gt;Left-to-Right Mark/Right-to-Left Mark&lt;/p&gt;
&lt;p&gt;not very useful, fix puncutation positions&lt;/p&gt;
&lt;p&gt;https://en.wikipedia.org/wiki/Right-to-left_mark&lt;/p&gt;
&lt;p&gt;Left-to-right Order/Right-to-Left Order&lt;/p&gt;
&lt;p&gt;This is very powerful, override normal character directions&lt;/p&gt;
&lt;p&gt;U+202d   LEFT-TO-RIGHT OVERRIDE         The following text will be left-to-right. Additionally, the directionality of characters is changed to left-to-right. Used alone in an English text, this will only affect characters that are right-to-left by default, like Arabic letters.
U+202e   RIGHT-TO-LEFT OVERRIDE The following text will be right-to-left. Additionally, the directionality of characters is changed to right-to-left. Use this character to completely screw up an English text.&lt;/p&gt;
&lt;p&gt;see
https://www.explainxkcd.com/wiki/index.php/1137:_RTL
https://www.zhihu.com/question/43621727/answer/96178474&lt;/p&gt;
&lt;p&gt;white spaces&lt;/p&gt;
&lt;p&gt;https://en.wikipedia.org/wiki/Whitespace_character&lt;/p&gt;
&lt;h1&gt;reference&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;https://zh.wikibooks.org/wiki/Unicode&lt;/li&gt;
&lt;li&gt;https://en.wikipedia.org/wiki/Emoji&lt;/li&gt;
&lt;li&gt;https://zh.wikipedia.org/zh-cn/Unicode%E5%AD%97%E7%AC%A6%E5%B9%B3%E9%9D%A2%E6%98%A0%E5%B0%84&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Thu, 08 Jun 2017 07:17:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-08:/posts/unicode.html</guid><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Django ORMçš„ä½¿ç”¨</title><link>/posts/django-ormde-shi-yong.html</link><description>&lt;h1&gt;å®šä¹‰æ¨¡å‹&lt;/h1&gt;
&lt;p&gt;ç»§æ‰¿ &lt;code&gt;models.Model&lt;/code&gt; å¹¶ä½¿ç”¨ &lt;code&gt;models.XXXField&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Book&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;authors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ManyToManyField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Author&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;publisher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Publisher&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;on_delete&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DO_NOTHING&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;publication_date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;lt;Book {self.title}&amp;gt;&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ordering&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;db_table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ³¨æ„å…¶ä¸­çš„ &lt;code&gt;manytomanyfield&lt;/code&gt; and &lt;code&gt;foreignkey&lt;/code&gt; å­—æ®µã€‚æ³¨æ„ ForeignKey å­—æ®µå¿…é¡»æ·»åŠ  on_delete å‚æ•°ï¼Œå‚è€ƒ&lt;a href="https://stackoverflow.com/questions/38388423/what-does-on-delete-do-on-django-models"&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;YNï¼šon_delete æœ€å¥½ä½¿ç”¨ models.DO_NOTHINGï¼Œè™½ç„¶ä¼šé€ æˆæ•°æ®åº“çš„å®Œæ•´æ€§ç¼ºå¤±ï¼Œä½†æ˜¯æ²¡æœ‰ä¸¢å¤±ä»»ä½•ä¿¡æ¯ã€‚å¦å¤–ï¼Œå¯¹äºæ•°æ®åº“æ¥è¯´ï¼Œå°½é‡å°‘åˆ é™¤æ•°æ®ï¼Œè€Œæ˜¯ç”¨ä¸€ä¸ªå­—æ®µæ ‡è®°ä¸ºå·²åˆ é™¤ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‡å‘è‡ªå·±çš„å¤–é”®: &lt;code&gt;models.ForeignKey('self')&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;å­—æ®µçš„å‚æ•°&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;null&lt;/code&gt; is the field nullable. default False.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;blank&lt;/code&gt; could this filed be left blank, this is used for django validation, not database scheme, default False.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;db_index&lt;/code&gt; create db index on this field, default False.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;choices&lt;/code&gt; used to limit the choice to that field and the text shown. &lt;code&gt;choices = ((1, 'male'), (0, 'female'))&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;default&lt;/code&gt; value or a callable to set default value.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;help_text&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;verbose&lt;/code&gt; verbose name for the field&lt;/li&gt;
&lt;li&gt;&lt;code&gt;unique&lt;/code&gt; should this field be unique.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;primary_key&lt;/code&gt; set this field as primary_key, if this is set, django will not generate id field&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;è‡ªåŠ¨ç”Ÿæˆçš„ ID å­—æ®µ&lt;/h3&gt;
&lt;p&gt;by default, django gives each model a primary key field. if primary_key=True is set on any other field, django will not generate this.&lt;/p&gt;
&lt;h2&gt;class meta&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;db_table&lt;/code&gt;, the dafault is &lt;code&gt;APPNAME_MODEL&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ordering&lt;/code&gt;, a list of fields to set order&lt;/li&gt;
&lt;li&gt;&lt;code&gt;unique_together&lt;/code&gt;, a tuple of unique fields tuples: &lt;code&gt;unique_together = (("driver", "restaurant"),)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;index_together&lt;/code&gt;, a list of indexes, &lt;code&gt;index_together = [["pub_date", "deadline"],]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;leave field blank&lt;/h2&gt;
&lt;p&gt;to make string field optional, just add &lt;code&gt;blank = True&lt;/code&gt; if you want to allow blank values in a date field (e.g.,Â DateField,Â TimeField,Â DateTimeField) or numeric field (e.g.,IntegerField,Â DecimalField,Â FloatField), youâ€™ll need to use bothÂ &lt;code&gt;null=True&lt;/code&gt;Â andÂ &lt;code&gt;blank=True&lt;/code&gt;.&lt;/p&gt;
&lt;h1&gt;Abstract base class&lt;/h1&gt;
&lt;p&gt;æ¯”å¦‚è¯´æœ‰æ—¶å€™æˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªæ¨¡å‹éƒ½éœ€è¦åˆ›å»º &lt;code&gt;create_time&lt;/code&gt;, &lt;code&gt;modify_time&lt;/code&gt; å­—æ®µï¼Œåœ¨ meta ä¸­è®¾å®š abstract ä¸º trueã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CommonInfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;age&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PositiveIntegerField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;abstract&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Student&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;CommonInfo&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;home_group&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;others&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;å¦‚æœä½ æƒ³è¦†ç›– __init__ æ–¹æ³•, è®°å¾—

def __init__(self, *args, **kwargs):
    super().__init__(self, *args, **kwargs)
    # your code here
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;ä½¿ç”¨ Model&lt;/h1&gt;
&lt;h2&gt;Create&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Model.objects.create(**kwargs)
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Query&lt;/h2&gt;
&lt;p&gt;Model.objects.get(&lt;strong&gt;kwargs)  returns one object, may raise DoesNotExist or MultiOjbectsReturned
Model.objects.all() 
Model.objects.filter(&lt;/strong&gt;kwargs)   returns a query set
Model.objects.order_by(*colnames)   note, you could use "-" in the colnames, cool&lt;/p&gt;
&lt;p&gt;just use filter, &lt;code&gt;get&lt;/code&gt; may raise Exceptions&lt;/p&gt;
&lt;h1&gt;æŸ¥è¯¢æ¡ä»¶&lt;/h1&gt;
&lt;p&gt;field__lookuptype=value&lt;/p&gt;
&lt;p&gt;lookups&lt;/p&gt;
&lt;p&gt;&lt;empty&gt;/exact/iexact  &lt;br&gt;
contains/icontains&lt;br&gt;
(i)startswith/(i)endswith &lt;br&gt;
range &lt;br&gt;
in&lt;br&gt;
gt/gte/lt/lte &lt;br&gt;
year/month/day/week_day/hour/minute/second&lt;br&gt;
isnull&lt;br&gt;
regex/iregex    &lt;/p&gt;
&lt;h2&gt;save a model&lt;/h2&gt;
&lt;p&gt;model = Model()
model.save()    note thatÂ allÂ of the fields will be updated, not just the ones that have been changed.
model/queryset.update() 
model/queryset.delete() &lt;/p&gt;
&lt;p&gt;QuerySet slicing&lt;/p&gt;
&lt;p&gt;slicing will cause limit cause, brilliant, however, negative slicing is not supported&lt;/p&gt;
&lt;p&gt;Generally, slicing aÂ QuerySetÂ returns a newÂ QuerySetÂ â€“ it doesnâ€™t evaluate the query.An exception is if you use the step parameter of Python slice syntax. For example, this would actually execute the query in order to return a list of everyÂ secondÂ object of the first 10:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; Entry.objects.all()[:10:2]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;May raise IndexError&lt;/p&gt;
&lt;p&gt;Tricks&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; Publisher.objects.order_by(&amp;#39;name&amp;#39;)[-1]
Traceback (most recent call last):
  ...
AssertionError: Negative indexing is not supported.
This is easy to get around, though. Just change theÂ order_by()Â statement, like this:
&amp;gt;&amp;gt;&amp;gt; Publisher.objects.order_by(&amp;#39;-name&amp;#39;)[0]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Model.objects.get().delete()&lt;/p&gt;
&lt;p&gt;column can be accessed as attribute&lt;/p&gt;
&lt;p&gt;django abstract base class is fun, but should be avoided, because we want to find-grain control the db&lt;/p&gt;
&lt;p&gt;django-admin makemigrations
django-admin sqlmigrate
don't worry about the numbers of migrations&lt;/p&gt;
&lt;h2&gt;å¤æ‚æŸ¥è¯¢ï¼Œä½¿ç”¨ F å’Œ Q&lt;/h2&gt;
&lt;p&gt;https://docs.djangoproject.com/en/1.10/topics/db/queries/#complex-lookups-with-q&lt;/p&gt;
&lt;p&gt;Keyword argument queries â€“ inÂ filter(), etc. â€“ are â€œANDâ€ed together. If you need to execute more complex queries (for example, queries withÂ ORÂ statements), you can useÂ QÂ objects.&lt;/p&gt;
&lt;p&gt;F and Q
F is for field
Q is for query&lt;/p&gt;
&lt;p&gt;django queryset&lt;/p&gt;
&lt;p&gt;filter(&lt;strong&gt;kwargs)
exclude(&lt;/strong&gt;kwargs)
count
create
get_or_create
update
delete
iterate
exists
iterator&lt;/p&gt;
&lt;p&gt;QuerySets are lazy!&lt;/p&gt;
&lt;p&gt;EachÂ QuerySetÂ contains a cache to minimize database access. Understanding how it works will allow you to write the most efficient code. In a newly createdÂ QuerySet, the cache is empty. The first time aÂ QuerySetÂ is evaluated â€“ and, hence, a database query happens â€“ Django saves the query results in theÂ QuerySetâ€™s cache and returns the results that have been explicitly requested (e.g., the next element, if theÂ QuerySetÂ is being iterated over). Subsequent evaluations of theÂ QuerySetÂ reuse the cached results.&lt;/p&gt;
&lt;h2&gt;Using iterator vs directly&lt;/h2&gt;
&lt;p&gt;AÂ QuerySetÂ typically caches its results internally so that repeated evaluations do not result in additional queries. In contrast,Â iterator()Â will read results directly, without doing any caching at theÂ QuerySetÂ level (internally, the default iterator callsÂ iterator()Â and caches the return value). Using iterator would probably save your memory.&lt;/p&gt;
&lt;p&gt;Keep this caching behavior in mind, because it may bite you if you donâ€™t use yourÂ QuerySets correctly. For example, the following will create twoÂ QuerySets, evaluate them, and throw them away:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; print([e.headline for e in Entry.objects.all()]) # two querysets created and evaluated and thrown
&amp;gt;&amp;gt;&amp;gt; print([e.pub_date for e in Entry.objects.all()])
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That means the same database query will be executed twice, effectively doubling your database load. Also, thereâ€™s a possibility the two lists may not include the same database records, because anÂ EntryÂ may have been added or deleted in the split second between the two requests.
To avoid this problem, simply save theÂ QuerySetÂ and reuse it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; queryset = Entry.objects.all()        # store the queryset to a variable
&amp;gt;&amp;gt;&amp;gt; print([p.headline for p in queryset]) # Evaluate the query set.
&amp;gt;&amp;gt;&amp;gt; print([p.pub_date for p in queryset]) # Re-use the cache from the evaluation.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;When querysets are not cached?&lt;/h2&gt;
&lt;p&gt;Querysets do not always cache their results. When evaluating onlyÂ partÂ of the queryset, the cache is checked, but if it is not populated then the items returned by the subsequent query are not cached. Specifically, this means that limiting the queryset using an array slice or an index will not populate the cache.&lt;/p&gt;
&lt;p&gt;For example, repeatedly getting a certain index in a queryset object will query the database each time:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; queryset = Entry.objects.all()
&amp;gt;&amp;gt;&amp;gt; print queryset[5] # Queries the database
&amp;gt;&amp;gt;&amp;gt; print queryset[5] # Queries the database again 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;However, if the entire queryset has already been evaluated, the cache will be checked instead:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; queryset = Entry.objects.all()
&amp;gt;&amp;gt;&amp;gt; [entry for entry in queryset] # Queries the database
&amp;gt;&amp;gt;&amp;gt; print queryset[5] # Uses cache
&amp;gt;&amp;gt;&amp;gt; print queryset[5] # Uses cache 
Here are some examples of other actions that will result in the entire queryset being evaluated and therefore populate the cache:
&amp;gt;&amp;gt;&amp;gt; [entry for entry in queryset]
&amp;gt;&amp;gt;&amp;gt; bool(queryset)
&amp;gt;&amp;gt;&amp;gt; entry in queryset
&amp;gt;&amp;gt;&amp;gt; list(queryset)
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;F expressions&lt;/h2&gt;
&lt;p&gt;what if you want to compare the value of a model field with another field on the same model?
use F(colname) to reference the column value&lt;/p&gt;
&lt;h2&gt;Q Expressions&lt;/h2&gt;
&lt;p&gt;encapsulate a collection of keyword arguments.Â QÂ objects can be combined using theÂ &amp;amp;Â andÂ |Â operators. When an operator is used on twoÂ Qobjects, it yields a newÂ QÂ object.&lt;/p&gt;
&lt;p&gt;by default, all the lookups passed to filter is AND&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Q(question__startswith=&amp;#39;Who&amp;#39;) | Q(question__startswith=&amp;#39;What&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Q supports &amp;amp; / ~&lt;/p&gt;
&lt;p&gt;use Qs as args&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Poll.objects.get(
    Q(question__startswith=&amp;#39;Who&amp;#39;),
    Q(pub_date=date(2005, 5, 2)) | Q(pub_date=date(2005, 5, 6))
)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;if aÂ QÂ object is provided, it must precede the definition of any keyword arguments.&lt;/p&gt;
&lt;p&gt;if you want to add extra check in model save
just override the defualt save method aorr add post save handlers&lt;/p&gt;
&lt;p&gt;fat models is not all that good, it may cause god object problem&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ only æ¥æŒ‡å®šéœ€è¦çš„å­—æ®µã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåªéœ€è¦ä¸€ä¸ªæˆ–è€…å‡ ä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨ values_list æ–¹æ³•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;In [6]: authors = Author.objects.values_list(&amp;#39;name&amp;#39;, &amp;#39;qq&amp;#39;)

In [7]: authors

Out[7]: &amp;lt;QuerySet [(u&amp;#39;WeizhongTu&amp;#39;, u&amp;#39;336643078&amp;#39;), (u&amp;#39;twz915&amp;#39;, u&amp;#39;915792575&amp;#39;), (u&amp;#39;wangdachui&amp;#39;, u&amp;#39;353506297&amp;#39;), (u&amp;#39;xiaoming&amp;#39;, u&amp;#39;004466315&amp;#39;)]&amp;gt;

In [8]: list(authors)

Out[8]: 

[(u&amp;#39;WeizhongTu&amp;#39;, u&amp;#39;336643078&amp;#39;),

 (u&amp;#39;twz915&amp;#39;, u&amp;#39;915792575&amp;#39;),

 (u&amp;#39;wangdachui&amp;#39;, u&amp;#39;353506297&amp;#39;),

 (u&amp;#39;xiaoming&amp;#39;, u&amp;#39;004466315&amp;#39;)]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦‚æœåªéœ€è¦ 1 ä¸ªå­—æ®µï¼Œå¯ä»¥æŒ‡å®š flat=True&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;In [9]: Author.objects.values_list(&amp;#39;name&amp;#39;, flat=True)

Out[9]: &amp;lt;QuerySet [u&amp;#39;WeizhongTu&amp;#39;, u&amp;#39;twz915&amp;#39;, u&amp;#39;wangdachui&amp;#39;, u&amp;#39;xiaoming&amp;#39;]&amp;gt;

In [10]: list(Author.objects.values_list(&amp;#39;name&amp;#39;, flat=True))

Out[10]: [u&amp;#39;WeizhongTu&amp;#39;, u&amp;#39;twz915&amp;#39;, u&amp;#39;wangdachui&amp;#39;, u&amp;#39;xiaoming&amp;#39;]
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æŸ¥çœ‹æ‰§è¡Œçš„ sql è¯­å¥å’Œæ‰§è¡Œæ—¶é—´&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queries&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;why not using foreign keys&lt;/h1&gt;
&lt;p&gt;you can not use foreign keys across two databases&lt;/p&gt;
&lt;h1&gt;å¦‚ä½•åœ¨ django å¤–éƒ¨å•ç‹¬ä½¿ç”¨&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.apps&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;apps&lt;/span&gt;

&lt;span class="n"&gt;conf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;INSTALLED_APPS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;Demo&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;DATABASES&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;ENGINE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.db.backends.sqlite3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;NAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;db.sqlite3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;configure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;apps&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;populate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;INSTALLED_APPS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;blockquote&gt;
&lt;p&gt;https://stackoverflow.com/a/46050808/1061155&lt;/p&gt;
&lt;/blockquote&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 07 Jun 2017 18:28:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-07:/posts/django-ormde-shi-yong.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Python 3 ä¸­çš„ Enum</title><link>/posts/python-3-zhong-de-enum.html</link><description>&lt;p&gt;enum æ¨¡å—æ˜¯ Python 3 ä¸­æ–°å¼•å…¥çš„ä¸€ä¸ªç”¨äºå®šä¹‰æšä¸¾å¸¸é‡çš„æ¨¡å—ã€‚&lt;/p&gt;
&lt;h1&gt;åŸºæœ¬ä½¿ç”¨&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;enum&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Enum&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Color&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Enum&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;RED&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;GREEN&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;BLUE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RED&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RED&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RED&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;enum&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Color&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GREEN&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="bp"&gt;True&lt;/span&gt;

&lt;span class="c1"&gt;# å¯ä»¥éå†&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RED&lt;/span&gt;
&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GREEN&lt;/span&gt;
&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BLUE&lt;/span&gt;

&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Shape&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SQUARE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Shape&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DIAMOND&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Shape&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CIRCLE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;# å¯ä»¥å½“åšå­—å…¸ä½¿ç”¨&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RED&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;RED&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RED&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="c1"&gt;# å¯ä»¥è®¿é—® Enum çš„ name å’Œ value å±æ€§&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;red&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RED&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;red&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;RED&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;red&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è‡ªåŠ¨å€¼&lt;/h2&gt;
&lt;p&gt;å¦‚æœæšä¸¾çš„å€¼æ— å…³ç´§è¦ï¼Œå¯ä»¥ä½¿ç”¨ autoï¼Œä¸è¿‡ä¸€èˆ¬æ¥è¯´è¿˜æ˜¯ä¸è¦ä½¿ç”¨ autoï¼Œä»¥å…åç»­å­˜å‚¨çš„æ•°æ®å‡ºé—®é¢˜ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;enum&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Enum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;auto&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Color&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Enum&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;RED&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;BLUE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;GREEN&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RED&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BLUE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Color&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GREEN&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä¿è¯å€¼æ˜¯å”¯ä¸€çš„&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;enum.unique&lt;/code&gt; è£…é¥°å™¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;enum&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Enum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unique&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nd"&gt;@unique&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Mistake&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Enum&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;ONE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;TWO&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;THREE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;FOUR&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Traceback&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;recent&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;duplicate&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="n"&gt;found&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;enum&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Mistake&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;FOUR&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;THREE&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ¯”è¾ƒ&lt;/h2&gt;
&lt;p&gt;æ³¨æ„ &lt;code&gt;enum.Enum&lt;/code&gt; å¹¶ä¸æ˜¯ int, æ‰€ä»¥å¹¶ä¸èƒ½æ¯”è¾ƒå¤§å°ã€‚å¦‚æœä½ æƒ³è¦æŠŠ enum å½“åš int ä½¿ç”¨ï¼Œå¯ä»¥ç»§æ‰¿ &lt;code&gt;enum.IntEnum&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; Color.RED is Color.RED
True
&amp;gt;&amp;gt;&amp;gt; Color.RED is Color.BLUE
False
&amp;gt;&amp;gt;&amp;gt; Color.RED &amp;lt; Color.BLUE
Traceback (most recent call last):
  File &amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;, line 1, in &amp;lt;module&amp;gt;
TypeError: &amp;#39;&amp;lt;&amp;#39; not supported between instances of &amp;#39;Color&amp;#39; and &amp;#39;Color&amp;#39;

# ä½¿ç”¨ IntEnum å¯ä»¥æ¯”è¾ƒå¤§å°
&amp;gt;&amp;gt;&amp;gt; class IntColor(IntEnum):
...     RED = 1
...     GREEN = 2
...     BLUE = 3
...
&amp;gt;&amp;gt;&amp;gt; IntColor.RED &amp;lt; IntColor.GREEN
True
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å­ç±»&lt;/h1&gt;
&lt;p&gt;åªæœ‰æ²¡å®šä¹‰å€¼çš„ç±»æ‰å¯ä»¥è¢«ç»§æ‰¿ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ä¸å¯ä»¥
&amp;gt;&amp;gt;&amp;gt; class MoreColor(Color):
...     PINK = 17
...
Traceback (most recent call last):
...
TypeError: Cannot extend enumerations


å¯ä»¥
&amp;gt;&amp;gt;&amp;gt; class Foo(Enum):
...     def some_behavior(self):
...         pass
...
&amp;gt;&amp;gt;&amp;gt; class Bar(Foo):
...     HAPPY = 1
...     SAD = 2
...
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åˆ©ç”¨å‡½æ•°æ¥ç”Ÿæˆ enum å¯¹è±¡&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; Color = Enum(&amp;#39;Color&amp;#39;, &amp;#39;RED GREEN BLUE&amp;#39;)
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;IntFlag å’Œ Flag&lt;/h1&gt;
&lt;p&gt;IntFlag ä¹Ÿä¼š Enum å’Œ int çš„å­ç±»ï¼Œå¯ä»¥è®¾ç½®æ¯ä¸€ä¸ª bit ä½ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;enum&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;IntFlag&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Perm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IntFlag&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;W&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Perm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Perm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Perm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Perm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Perm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;RW&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Perm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Perm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Perm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;RW&lt;/span&gt;
&lt;span class="bp"&gt;True&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿˜å¯ä»¥ä¸ªç»™ç»„åˆèµ·æ¥çš„å˜é‡å‘½å&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; class Perm(IntFlag):
...     R = 4
...     W = 2
...     X = 1
...     RWX = 7
&amp;gt;&amp;gt;&amp;gt; Perm.RWX
&amp;lt;Perm.RWX: 7&amp;gt;
&amp;gt;&amp;gt;&amp;gt; ~Perm.RWX
&amp;lt;Perm.-8: -8&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¦å¤–ï¼Œå¦‚æœ IntFlag æ¯ä¸ªä½éƒ½æ²¡æœ‰è®¾å®šï¼Œé‚£ä¹ˆæ°å¥½æ˜¯ 0 ï¼Œä¼šè¢«å½“åš False çœ‹å¾…ã€‚&lt;/p&gt;
&lt;h1&gt;åœ¨ django æ¨¡å‹ä¸­ä½¿ç”¨&lt;/h1&gt;
&lt;p&gt;å¦‚æœæ•°æ®åº“çš„æŸä¸€ä¸ªå­—æ®µåº”è¯¥æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œé‚£ä¹ˆä½¿ç”¨ enum å†åˆé€‚ä¸è¿‡äº†ã€‚å¯ä»¥è¿™æ ·ç”¨ï¼š&lt;/p&gt;
&lt;p&gt;```
class Color(IntEnum&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 07 Jun 2017 16:31:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-07:/posts/python-3-zhong-de-enum.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>using mysql with django</title><link>/posts/using-mysql-with-django.html</link><description>&lt;p&gt;You probably need to install the followings:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install mysqlclient
apt-get install libmysqlclient-dev mysql-server
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 07 Jun 2017 08:52:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-07:/posts/using-mysql-with-django.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>MySQL â€œincorrect string valueâ€ error when save unicode string in Django</title><link>/posts/mysql-incorrect-string-value-error-when-save-unicode-string-in-django.html</link><description>&lt;h1&gt;Why this happens?&lt;/h1&gt;
&lt;p&gt;You cannot store 4-byte characters in MySQL with the utf-8 character set.&lt;/p&gt;
&lt;h1&gt;solution&lt;/h1&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#! /usr/bin/env python&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;MySQLdb&lt;/span&gt;

&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;localhost&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;passwd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;passwd&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;youruser&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;dbname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;yourdbname&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;db&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MySQLdb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;passwd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;passwd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cursor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ALTER DATABASE `&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;` CHARACTER SET &amp;#39;utf8&amp;#39; COLLATE &amp;#39;utf8_unicode_ci&amp;#39;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;sql&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SELECT DISTINCT(table_name) FROM information_schema.columns WHERE table_schema = &amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;dbname&lt;/span&gt;
&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetchall&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;sql&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ALTER TABLE `&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;` convert to character set DEFAULT COLLATE DEFAULT&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Reference:&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/2108824&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 07 Jun 2017 08:47:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-07:/posts/mysql-incorrect-string-value-error-when-save-unicode-string-in-django.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Django Admin åå°æ•™ç¨‹</title><link>/posts/django-admin-hou-tai-jiao-cheng.html</link><description>&lt;h1&gt;Basics&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;./manage.py startapp APP_NAME&lt;/code&gt; would create an &lt;code&gt;admin.py&lt;/code&gt; file, you should define your admin classes in that file.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;./manage.py createsuperuser&lt;/code&gt; creates a user, so that you could login into the admin site at http://youdomain.com/admin&lt;/p&gt;
&lt;p&gt;by default, the admin panel only contains user and group settings.&lt;/p&gt;
&lt;h1&gt;how to create your own admin&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;subclass &lt;code&gt;django.contrib.admin.ModelAdmin&lt;/code&gt; in &lt;code&gt;admin.py&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;customize this class&lt;/li&gt;
&lt;li&gt;register it to the admin site&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;subclass&lt;/h2&gt;
&lt;p&gt;æœ€ç®€å•çš„ä¸€ä¸ªä¾‹å­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mysite.books.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Publisher&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Author&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AuthorAdmin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ModelAdmin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;list_display&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;first_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;last_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;email&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;search_fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;first_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;last_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;list_filter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;publication_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;

&lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Publisher&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;customize the admin class by change class attributes:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;list_display&lt;/code&gt; æ§åˆ¶åˆ—è¡¨é¡µæ˜¾ç¤ºçš„å±æ€§, å…¶ä¸­å¯ä»¥åŒ…å« Model çš„å±æ€§æˆ–è€…å‡½æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;search_fields&lt;/code&gt; è¡¨ç¤ºæœç´¢æ¡†ä¼šæœç´¢çš„å±æ€§&lt;/li&gt;
&lt;li&gt;&lt;code&gt;list_filter&lt;/code&gt; è¡¨ç¤ºçš„æ˜¯åœ¨å³è¾¹æ˜¾ç¤ºçš„è¿‡æ»¤å™¨&lt;/li&gt;
&lt;li&gt;&lt;code&gt;fields&lt;/code&gt; è¡¨ç¤ºçš„æ˜¯åœ¨æ¯ä¸€ä¸ªobjectçš„è¯¦æƒ…é¡µæ˜¾ç¤ºçš„å±æ€§, æ›´å¤æ‚çš„å¯ä»¥ç”¨fieldset. æ³¨æ„è¿™é‡Œé¢çš„å±æ€§å¦‚æœæ˜¯å‡½æ•°çš„è¯, å¿…é¡»åŒ…å«åœ¨ &lt;code&gt;readonly_fields&lt;/code&gt; ä¸­.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;readonly_fields&lt;/code&gt; è¡¨ç¤ºçš„æ˜¯è¯¦æƒ…é¡µçš„åªè¯»å­—æ®µ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¯ä¸€ä¸ªå±æ€§éƒ½æ˜¯ä¸€ä¸ª tuple æˆ–è€… list, ä»¥ list_display ä¸ºä¾‹&lt;/p&gt;
&lt;h3&gt;&lt;code&gt;list_display&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;list_display ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¨¡å‹ä¸­çš„ä¸€ä¸ªå­—æ®µ&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ª callable&lt;/li&gt;
&lt;li&gt;A string representing a &lt;code&gt;ModelAdmin&lt;/code&gt; attribute, obj is passed to the method.&lt;/li&gt;
&lt;li&gt;A string representing a model attribute&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nx"&gt;example&lt;/span&gt;
&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;PersonAdmin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;admin&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ModelAdmin&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="nx"&gt;list_display&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;upper_case_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;

    &lt;span class="nx"&gt;def&lt;/span&gt; &lt;span class="nx"&gt;upper_case_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;%s %s&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;first_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;last_name&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="nx"&gt;upper&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="nx"&gt;upper_case_name&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;short_description&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å¯ä»¥è¦†ç›–çš„æ–¹æ³•&lt;/h2&gt;
&lt;h3&gt;ä¿å­˜&lt;/h3&gt;
&lt;p&gt;å¯ä»¥è¦†ç›– ModelAdmin.save_model æ–¹æ³•æ¥åœ¨ä¿å­˜æ¨¡å‹çš„æ—¶å€™æ·»åŠ åˆ é™¤ä¸€äº›é¢å¤–çš„å­—æ®µï¼Œå…¶ä¸­ change è¡¨ç¤ºæ˜¯åœ¨å¢åŠ è¿˜æ˜¯ä¿®æ”¹ã€‚æ³¨æ„éœ€è¦è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ¥æœ€ç»ˆä¿å­˜è¿™ä¸ªæ¨¡å‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleAdmin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ModelAdmin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;save_model&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save_model&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;åˆ é™¤&lt;/h3&gt;
&lt;p&gt;è¦†ç›– ModelAdmin.delete_model å¯ä»¥åœ¨åˆ é™¤æ¨¡å‹çš„æ—¶å€™åšä¸€äº›é¢å¤–çš„æ“ä½œï¼Œæ³¨æ„åŒæ ·éœ€è¦è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ¥æœ€ç»ˆåˆ é™¤æ¨¡å‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ModelAdmin.delete_model(request, obj)
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ›´æ”¹ admin åå°çš„ç•Œé¢&lt;/h2&gt;
&lt;p&gt;å•ç‹¬ä¿®æ”¹æŸä¸ª Admin&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="n"&gt;MyModelAdmin&lt;/span&gt;(&lt;span class="n"&gt;admin&lt;/span&gt;.&lt;span class="n"&gt;ModelAdmin&lt;/span&gt;):
        &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="n"&gt;Media:&lt;/span&gt;
            &lt;span class="n"&gt;js&lt;/span&gt; = (&lt;span class="s"&gt;&amp;#39;js/admin/my_own_admin.js&amp;#39;&lt;/span&gt;,)    
            &lt;span class="n"&gt;css&lt;/span&gt; = {
                 &lt;span class="s"&gt;&amp;#39;all&amp;#39;&lt;/span&gt;: (&lt;span class="s"&gt;&amp;#39;css/admin/my_own_admin.css&amp;#39;&lt;/span&gt;,)
            }
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¿®æ”¹æ‰€æœ‰çš„ç•Œé¢&lt;/p&gt;
&lt;p&gt;ä» &lt;code&gt;contrib/admin/templates/admin&lt;/code&gt; æ‹·è´å¯¹åº”çš„æ¨¡æ¿æ–‡ä»¶åˆ° app çš„ templates ç›®å½•. ç„¶åä¿®æ”¹å°±å¯ä»¥äº†~&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 07 Jun 2017 08:07:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-07:/posts/django-admin-hou-tai-jiao-cheng.html</guid><category>Django</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Bootstrap Basics</title><link>/posts/bootstrap-basics.html</link><description>&lt;h1&gt;BootStrapé€‚åˆåšä»€ä¹ˆ&lt;/h1&gt;
&lt;p&gt;Bootstrapé€‚åˆåšæ²¡æœ‰ç•Œé¢è®¾è®¡ï¼Œåªæœ‰åŠŸèƒ½æˆ–è€…è‰å›¾ï¼Œç›´æ¥é€šè¿‡ä»£ç å¿«é€Ÿçš„ç”Ÿæˆä¸€ä¸ªå¯ç”¨çš„ç•Œé¢&lt;/p&gt;
&lt;p&gt;Bootstrapä¸é€‚åˆ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å·²ç»æœ‰äº†è‰¯å¥½çš„ç•Œé¢è®¾è®¡ï¼ŒåŒ…å«äº†å„ç§ç»†èŠ‚&lt;/li&gt;
&lt;li&gt;åœ¨å·²æœ‰çš„éBootstrapçš„ç•Œé¢ä¸Šè¿›è¡Œæ”¹åŠ¨çš„æ—¶å€™&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;headers&lt;/h1&gt;
&lt;p&gt;add this to headers &lt;code&gt;&amp;lt;meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;grid system&lt;/h1&gt;
&lt;h2&gt;container&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;container&lt;/code&gt; class should be added to the root element where you would like to use bootstrap.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;container-fluid&lt;/code&gt; is for full-width container.&lt;/p&gt;
&lt;h2&gt;row&lt;/h2&gt;
&lt;p&gt;from the official documentation:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Content should be placed within columns, and only columns may be immediate children of rows.&lt;/li&gt;
&lt;li&gt;Columns create gutters (gaps between column content) via &lt;strong&gt;padding&lt;/strong&gt;. That padding is offset in rows for the first and last column via negative margin on &lt;code&gt;.rows&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Grid classes apply to devices with screen widths greater than or equal to the breakpoint sizes, and override grid classes targeted at smaller devices. grid classes are &lt;code&gt;col-xs-*&lt;/code&gt;, &lt;code&gt;col-sm-*&lt;/code&gt;, &lt;code&gt;col-md-*&lt;/code&gt;, &lt;code&gt;col-lg-*&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;phone&lt;/th&gt;
&lt;th&gt;tablet&lt;/th&gt;
&lt;th&gt;desktop&lt;/th&gt;
&lt;th&gt;large desktop&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Container width&lt;/td&gt;
&lt;td&gt;None (auto)&lt;/td&gt;
&lt;td&gt;750px&lt;/td&gt;
&lt;td&gt;970px&lt;/td&gt;
&lt;td&gt;1170px&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Class prefix&lt;/td&gt;
&lt;td&gt;&lt;code&gt;.col-xs-&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;.col-sm-&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;.col-md-&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;.col-lg-&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The gutter width for bootstrap is &lt;code&gt;15px&lt;/code&gt; for each column, &lt;code&gt;30px&lt;/code&gt; between.&lt;/p&gt;
&lt;p&gt;generally, you should use the &lt;code&gt;col-sm-N&lt;/code&gt; family of classes. such that it applies for all devices except phones.&lt;/p&gt;
&lt;p&gt;use &lt;code&gt;col-xs-offset-*&lt;/code&gt; classes to offset the columns.&lt;/p&gt;
&lt;p&gt;use &lt;code&gt;col-xs-pull-*&lt;/code&gt; classes to pull column to left, and &lt;code&gt;push&lt;/code&gt; to push to right.&lt;/p&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;å¼•å…¥ CSS å’Œ JS å°±å¥½å•¦ï¼Œä¸è¿‡é™äºå›½å†…çš„ç½‘ç»œæ¡ä»¶ï¼Œå¯èƒ½åšå¥½è¿˜æ˜¯ä¸‹è½½åˆ°è‡ªå·±æœåŠ¡å™¨å§ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;link&lt;/span&gt; &lt;span class="na"&gt;rel=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://code.jquery.com/jquery-3.2.1.slim.min.js&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;starter template&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;!doctype html&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;html&lt;/span&gt; &lt;span class="na"&gt;lang=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;en&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
    &lt;span class="c"&gt;&amp;lt;!-- Required meta tags --&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;charset=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;viewport&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;width=device-width, initial-scale=1, shrink-to-fit=no&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;&amp;lt;!-- Bootstrap CSS --&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;link&lt;/span&gt; &lt;span class="na"&gt;rel=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Hello, world!&lt;span class="nt"&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Hello, world!&lt;span class="nt"&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;&amp;lt;!-- Optional JavaScript --&amp;gt;&lt;/span&gt;
    &lt;span class="c"&gt;&amp;lt;!-- jQuery first, then Popper.js, then Bootstrap JS --&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://code.jquery.com/jquery-3.2.1.slim.min.js&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymous&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;bootstrap é»˜è®¤å·²ç»é‡‡ç”¨äº† border-box æ¨¡å¼ã€‚å¦‚æœéœ€è¦ä½¿ç”¨ content-box éœ€è¦è‡ªå·±æŒ‡å®šã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 07 Jun 2017 07:04:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-07:/posts/bootstrap-basics.html</guid><category>CSS</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Git ä½¿ç”¨æŠ€å·§</title><link>/posts/git-shi-yong-ji-qiao.html</link><description>&lt;p&gt;æœ€ä½³å®è·µï¼Œæ¯æ¬¡æäº¤å‰éƒ½ä½¿ç”¨git statusæŸ¥çœ‹å·²ç»æ›´æ”¹çš„æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨git addé€æ¡æ·»åŠ æ–‡ä»¶,ç„¶åå†çœ‹git statusæäº¤çš„æ–‡ä»¶æ˜¯ä¸æ˜¯éƒ½å¯¹çš„. è®¤çœŸç¼–å†™.gitignoreæ–‡ä»¶ï¼Œæœ€å¥½èƒ½å¤Ÿåšåˆ°æ¯æ¬¡å¯ä»¥ä½¿ç”¨&lt;code&gt;git add .&lt;/code&gt;æ˜¯å®‰å…¨çš„ã€‚&lt;/p&gt;
&lt;h1&gt;å–æ¶ˆä¸é‡ç½®&lt;/h1&gt;
&lt;p&gt;å½“ä½ çš„ commit å·²ç» push ä¹‹åå°±ä¸èƒ½å†æ’¤é”€äº†ï¼Œåªèƒ½ä½¿ç”¨ revertã€‚&lt;/p&gt;
&lt;h2&gt;å–æ¶ˆä¸Šä¸€ä¸ª commit&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git reset HEAD~1
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;reset --mixed will reset the index not the working dir&lt;/li&gt;
&lt;li&gt;reset --soft will only move the HEAD&lt;/li&gt;
&lt;li&gt;reset --hard will even reset the working dir&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;é‡ç½®åˆ°originåº“ä¸­çš„ HEAD&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œä¿å­˜åˆ°ä¸€ä¸ªåˆ†æ”¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git commit -a -m &amp;quot;Saving my work, just in case&amp;quot;
git branch my-saved-work
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç„¶åï¼ŒæŠŠmasteråˆ†æ”¯é‡ç½®åˆ° origin/master&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git fetch origin
git reset --hard origin/master
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä» staging area ä¸­åˆ é™¤æ–‡ä»¶&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git reset HEAD &amp;lt;file&amp;gt;  // remove a file from staging area

git reset // to remove all files from staging area
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;git checkout -- &lt;filename&gt;
git fetch origin &amp;amp;&amp;amp; git reset --hard origin/master&lt;/p&gt;
&lt;h1&gt;push&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;git push --tags&lt;/code&gt; æ¨é€ tag åˆ°è¿œç«¯ä»“åº“&lt;/p&gt;
&lt;p&gt;&lt;code&gt;git tag tagname commit_id&lt;/code&gt; ç»™æŸä¸ªcommitæ‰“ä¸Šæ ‡ç­¾&lt;/p&gt;
&lt;p&gt;&lt;code&gt;git checkout tagname&lt;/code&gt; åˆ‡æ¢åˆ°æŸä¸ªtag&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨ git bisect äºŒåˆ†æŸ¥æ‰¾é—®é¢˜&lt;/h1&gt;
&lt;p&gt;use bisect to determine when a bug is introduced by specifying a start point and a end point, and doing a binary search between the commits.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git bisect start
git bisect good xxxxxx
git bisect bad xxxxxx
# begin binary search
run test and mark commits
git bisect good/bad
# end of binary search
# git will prompt a first bad commits
# you can use git log to visualize the process
git bisect reset
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åˆ†æ”¯ä¸åˆå¹¶&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git push -u origin master
git checkout -b branch_name # create new branch
git checkout master # switch back
git branch -d branch_name # delete branch
git push origin --delete branch_name # delete remote branch
git push origin branch_name # push to remote
git branch branch -v xxxxxx
git merge branch_name # merge branch_name to current branch
git merge --squash
git merge --abort  # æ”¾å¼ƒåˆå¹¶
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å½“ç¬¬ä¸€æ¬¡æ¨é€æŸä¸ªåˆ†æ”¯çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ &lt;code&gt;--set-upstream/-u&lt;/code&gt; æ¥åˆ¶å®šè¦åŒæ­¥çš„åˆ†æ”¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä½¿commitè®°å½•æ¸…æ™°æ˜“æ‡‚ï¼Œä¸äº§ç”Ÿæ— è°“çš„commitï¼Œåº”è¯¥å°½é‡é¿å…å’Œè¿œç¨‹åˆ†æ”¯åˆå¹¶ã€‚æ¯æ¬¡æäº¤å°½é‡ä½¿ç”¨pull --rebaseï¼Œè€Œä¸æ˜¯pull and mergeã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git pull --rebase  # å¦‚æœæœ‰å†²çªçš„è¯ï¼Œå…ˆè¿è¡Œ git stash
git stash # if you and remote change the same file
git stash pop  # pull ä¹‹åå† stash pop
git commit -am &amp;quot;some change&amp;quot;
git push
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;rebase&lt;/h2&gt;
&lt;p&gt;Once you understand what rebasing is, the most important thing to learn is when not to do it. The golden rule of git rebase is to never use it on public branches.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git rebase origin/master
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;rebase vs merge&lt;/h2&gt;
&lt;p&gt;&lt;img alt="" src="https://ws4.sinaimg.cn/large/006tKfTcgy1fse6aurc89j30im0dhq3d.jpg"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tKfTcgy1fse6cbu59sj30h80dnaah.jpg"&gt;&lt;/p&gt;
&lt;h1&gt;advanced stash&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;git stash save "stash_name"  // save a stash with a name&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;apply by name&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[alias]&lt;/span&gt;
&lt;span class="na"&gt;sshow&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;!f() { git stash show stash^{/$*} -p; }; f&amp;quot;&lt;/span&gt;
&lt;span class="na"&gt;sapply&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;!f() { git stash apply stash^{/$*}; }; f&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;use these lines to show and apply stash by name&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;git stash -p  // stashes which files you select&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;git diff å¯ä»¥è·Ÿæ—¶é—´ï¼Œæ¥æŸ¥çœ‹ä¸€æ®µæ—¶é—´å†…çš„æ”¹åŠ¨&lt;/p&gt;
&lt;p&gt;æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶è°çš„æ”¹åŠ¨æœ€å¤šï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git blame file | sort -b -k 3 # sort by date
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 05 Jun 2017 10:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-05:/posts/git-shi-yong-ji-qiao.html</guid><category>git</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Android am command</title><link>/posts/android-am-command.html</link><description>&lt;p&gt;am is short for activity manager, which is used to start and stop activity in android.&lt;/p&gt;
&lt;h2&gt;basic syntax&lt;/h2&gt;
&lt;h3&gt;start an activity&lt;/h3&gt;
&lt;p&gt;you can get the activity name by decompiling the apk and view the androidmanifest.xml file&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;am start -n &amp;lt;package_name&amp;gt;/&amp;lt;activity_name&amp;gt; [parameters]
am start -n com.tencent.mm/com.tencent.mm.plugin.webview.ui.tools.WebViewUI http://zhihu.com
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;stop an activity&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;am force-stop com.tencent.mm
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Sat, 03 Jun 2017 15:36:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-03:/posts/android-am-command.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>ä½¿ç”¨ Chardet è‡ªåŠ¨æ£€æµ‹æ–‡æœ¬ç¼–ç </title><link>/posts/shi-yong-chardet-zi-dong-jian-ce-wen-ben-bian-ma.html</link><description>&lt;p&gt;python ä¸­çš„ chardet åº“å¯ä»¥ç”¨æ¥çŒœæµ‹æ–‡ä»¶çš„ç¼–ç &lt;/p&gt;
&lt;h1&gt;usage&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install cchardet
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;cchardet&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;chardet&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;chinese_bytes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ä¸­æ–‡&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;chardet&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;detect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;chinese_bytes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;confidence&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.7524999976158142&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;encoding&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Fri, 02 Jun 2017 06:23:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-06-02:/posts/shi-yong-chardet-zi-dong-jian-ce-wen-ben-bian-ma.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>CSS remove spaces between inline elements</title><link>/posts/css-remove-spaces-between-inline-elements.html</link><description>&lt;p&gt;https://css-tricks.com/fighting-the-space-between-inline-block-elements/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 31 May 2017 09:39:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-31:/posts/css-remove-spaces-between-inline-elements.html</guid><category>CSS</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Linux å‘½ä»¤è¡Œç½‘ç»œç›¸å…³ï¼ˆcurl/wget/nc...ï¼‰</title><link>/posts/linux-ming-ling-xing-wang-luo-xiang-guan-curlwgetnc.html</link><description>&lt;p&gt;æœ‰å¾…æ•´ç†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h1&gt;fuser&lt;/h1&gt;
&lt;p&gt;view which program is using which port.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;fuser XXX/tcp  # see which program is using tcp port XXX
fuser XXX/upd  # see which program is using udp port XXX
fuser -k XXX/tcp  # kill the program, if you have right permissions
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;curl&lt;/h1&gt;
&lt;p&gt;wget åŠŸèƒ½å¾ˆæœ‰é™ï¼Œhttpie è™½ç„¶æ¯”è¾ƒäººæ€§åŒ–ä½†æ˜¯æœ‰å¾ˆå¤š bugï¼Œè¿˜æ˜¯ curl æ¯”è¾ƒå¥½ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;curl -L/--follow http://example.com           follow redirect
curl -I/--head http://example.com             only headers 
curl -o/--output file http://example.com      http -d
curl -v/--verbose http://example.com  &lt;br&gt;
curl --data "key=value" http://example.com&lt;br&gt;
curl --data-urlencode "key=
curl -X/--request GET/POST http://example.com &lt;br&gt;
curl -H/--header "Accept: utf-8"  &lt;br&gt;
curl --referer http://x.com http://example.com
curl --user-agent 
curl --cookie&lt;/p&gt;
&lt;h2&gt;ä½¿ç”¨ä»£ç†&lt;/h2&gt;
&lt;p&gt;curl -x &lt;protocol&gt;://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt; --proxy-anyauth &lt;url&gt;&lt;/p&gt;
&lt;h2&gt;cookies&lt;/h2&gt;
&lt;p&gt;curl -v --cookie "USER_TOKEN=Yes" http://127.0.0.1:5000/&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;According to the man page, for option -b, --cookie, e.g. curl -b &lt;file-or-pairs&gt;, if the argument is a string having the '=' symbol, it's passed as is, otherwise it's treated as a filename to read cookie from. â€“ ryenus Oct 21 '14 at 2:10 &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;multiple cookies can be set with semicolons --cookie "key1=val1;key2=val2;..."&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;æŸ¥çœ‹ç½‘ç»œæƒ…å†µ&lt;/h1&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ Linux ä¸Š netstat å·²ç»åºŸå¼ƒäº†ï¼Œåº”è¯¥ä½¿ç”¨æ–°çš„ ss å‘½ä»¤ã€‚ä¸è¿‡åœ¨ macOS ç­‰Unixç³»ç»Ÿä¸­ï¼Œè¿˜æ˜¯åªæœ‰netstat&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;netstat -a  list all ports
netstat -at list all tcp ports
netstat -l  all listening ports
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;netstat -in æŸ¥çœ‹æä¾›ç½‘ç»œæ¥å£çš„ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;netstat -rn æ˜¾ç¤ºè·¯ç”±è¡¨&lt;/p&gt;
&lt;p&gt;ifconfig eth0 æ˜¾ç¤ºæ¥å£çš„çŠ¶æ€&lt;/p&gt;
&lt;p&gt;ifconfig -a æ‰€æœ‰æ¥å£çš„çŠ¶æ€&lt;/p&gt;
&lt;p&gt;ip addr eth0 å…¨æ–°çš„å‘½ä»¤&lt;/p&gt;
&lt;p&gt;Mac&lt;/p&gt;
&lt;p&gt;å’Œ Linux åŸºæœ¬ç›¸åŒ, ä½†æ˜¯ç¼ºå°‘ ip æŒ‡ä»¤, éœ€è¦å®‰è£… iproute2mac åŒ…&lt;/p&gt;
&lt;p&gt;traceroute&lt;/p&gt;
&lt;p&gt;nslookup&lt;/p&gt;
&lt;p&gt;host&lt;/p&gt;
&lt;p&gt;wget --noproxy&lt;/p&gt;
&lt;p&gt;mtr&lt;/p&gt;
&lt;p&gt;bt download&lt;/p&gt;
&lt;p&gt;sudo add-apt-repository ppa:t-tujikawa/ppa 
sudo apt-get update 
sudo apt-get install aria2&lt;/p&gt;
&lt;h1&gt;ä½¿ç”¨ rsync åŒæ­¥&lt;/h1&gt;
&lt;p&gt;rsync -azP local_dir remote_dir&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-a&lt;/code&gt; archiveï¼Œè¡¨ç¤ºå½’æ¡£&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-n&lt;/code&gt; dry-runï¼Œåªæ˜¾ç¤ºè¦æ‰§è¡Œçš„æ“ä½œè€Œä¸å…·ä½“æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-z&lt;/code&gt; compressï¼Œå‹ç¼©&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-P&lt;/code&gt; --progress + --partialï¼Œæ˜¾ç¤ºè¿›åº¦åŒæ—¶æ–­ç‚¹ç»­ä¼ &lt;/li&gt;
&lt;li&gt;&lt;code&gt;--exclude=&amp;lt;dir&amp;gt;&lt;/code&gt; exclude directory from being rsynced&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œrsync ä½¿ç”¨å¢é‡åŒæ­¥ï¼Œè€Œä¸ä¼šåˆ é™¤æ–‡ä»¶ã€‚ä½¿ç”¨ &lt;code&gt;--delete&lt;/code&gt; åˆ é™¤æ–‡ä»¶&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Wed, 31 May 2017 06:54:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-31:/posts/linux-ming-ling-xing-wang-luo-xiang-guan-curlwgetnc.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>redis å®æˆ˜æ€»ç»“</title><link>/posts/redis-shi-zhan-zong-jie.html</link><description>&lt;h2&gt;redisæ˜¯åšä»€ä¹ˆçš„&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªæ•°æ®ç»“æ„å­˜å‚¨å™¨ï¼Œæ•°æ®é©»ç•™åœ¨å†…å­˜é‡Œï¼Œå¯ä»¥åœ¨ç¨‹åºçš„ä¸¤æ¬¡ä¹‹é—´ä¿å­˜æ•°æ®&lt;/p&gt;
&lt;h2&gt;ä¸€äº›å®ç°ç»†èŠ‚å’Œæ¯”è¾ƒå¥½çš„åœ°æ–¹&lt;/h2&gt;
&lt;p&gt;redis çš„ string æ˜¯ binary-safe çš„ï¼Œå¯ä»¥å­˜å‚¨ä»»æ„çš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆbytesï¼‰ï¼Œç”šè‡³å¯ä»¥æŠŠå›¾ç‰‡å­˜å‚¨åœ¨ redis ä¸­&lt;/p&gt;
&lt;h2&gt;ç»å¸¸ç”¨åˆ°çš„åœºåˆ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨ä½œç¼“å­˜&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ€åŸºç¡€çš„ï¼Œæœ€ç»å…¸çš„åº”ç”¨åœºåˆï¼Œå½“æŸ¥è¯¢æ•°æ®åº“æˆ–è€…ESç­‰å­˜å‚¨ä»£ä»·æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œç›´æ¥ç”¨æŸ¥è¯¢çš„è¯­å¥åš keyï¼ŒæŸ¥è¯¢ç»“æœç”¨ä½œç¼“å­˜&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”¨åšé˜Ÿåˆ—&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”¨åšé›†åˆï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨ä¸€æ‰¹æ•°æ®çš„æ± å­ã€‚ç”¨ä½œæœ‰åºé›†åˆ&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;ç»å¸¸é‡åˆ°çš„é—®é¢˜&lt;/h2&gt;
&lt;p&gt;è¿‡æœŸä¹‹é—´åªèƒ½æŒ‡å®šåˆ°é”®çº§åˆ«ï¼Œè€Œä¸èƒ½æŒ‡å®šåˆ°é›†åˆçš„é”®çº§åˆ«&lt;/p&gt;
&lt;h2&gt;pipeline&lt;/h2&gt;
&lt;p&gt;imporve performance by combining multi command into one and reduce TCP times&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;gt;&amp;gt;&amp;gt; p = r.pipeline()        # åˆ›å»ºä¸€ä¸ªç®¡é“
&amp;gt;&amp;gt;&amp;gt; p.set(&amp;#39;hello&amp;#39;,&amp;#39;redis&amp;#39;)
&amp;gt;&amp;gt;&amp;gt; p.sadd(&amp;#39;faz&amp;#39;,&amp;#39;baz&amp;#39;)
&amp;gt;&amp;gt;&amp;gt; p.incr(&amp;#39;num&amp;#39;)
&amp;gt;&amp;gt;&amp;gt; p.execute()
[True, 1, 1]
&amp;gt;&amp;gt;&amp;gt; r.get(&amp;#39;hello&amp;#39;)
&amp;#39;redis&amp;#39;

or 
&amp;gt;&amp;gt;&amp;gt; p.set(&amp;#39;hello&amp;#39;,&amp;#39;redis&amp;#39;).sadd(&amp;#39;faz&amp;#39;,&amp;#39;baz&amp;#39;).incr(&amp;#39;num&amp;#39;).execute()
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œç®¡é“é‡Œæ‰§è¡Œçš„å‘½ä»¤å¯ä»¥ä¿è¯æ‰§è¡Œçš„åŸå­æ€§ï¼Œæ‰§è¡Œpipe = r.pipeline(transaction=False)å¯ä»¥ç¦ç”¨è¿™ä¸€ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;h2&gt;å‘&lt;/h2&gt;
&lt;p&gt;python redis å®¢æˆ·ç«¯ä¸­æ²¡æœ‰decrbyæŒ‡ä»¤&lt;/p&gt;
&lt;h1&gt;key çš„å‘½å&lt;/h1&gt;
&lt;p&gt;colon signÂ :Â is a convention when naming keys. Try to stick with a schema. For instance "object-type:id:field" can be a nice idea, like in "user:1000:password". I like to use dots for multi-words fields, like in "comment:1234:reply.to".&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 14:33:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/redis-shi-zhan-zong-jie.html</guid><category>æ•°æ®åº“</category><category>è®¡ç®—æœº</category></item><item><title>linuxbrew</title><link>/posts/linuxbrew.html</link><description>&lt;p&gt;It can be installed in your home directory and does not require root access.&lt;/p&gt;
&lt;p&gt;ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install)"
PATH="$HOME/.linuxbrew/bin:$PATH"&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 14:20:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/linuxbrew.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>caputre iOS traffic</title><link>/posts/caputre-ios-traffic.html</link><description>&lt;p&gt;RVI&lt;/p&gt;
&lt;p&gt;Step 1. Plug you iPhone with USB
Step 2. go to pgyer.cn, and find the UDID
Step 3. use rvi -x UDID
Step 4. use  wireshark and select the rvi0 device&lt;/p&gt;
&lt;p&gt;http://useyourloaf.com/blog/remote-packet-capture-for-ios-devices/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 14:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/caputre-ios-traffic.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>React</title><link>/posts/react.html</link><description>&lt;p&gt;Most important ideas:&lt;/p&gt;
&lt;p&gt;Widget based&lt;/p&gt;
&lt;p&gt;Note: You can write your whole app in React, but you can also use it as a component in your app
props&lt;/p&gt;
&lt;p&gt;state&lt;/p&gt;
&lt;p&gt;Single data flow with dom-diff&lt;/p&gt;
&lt;p&gt;Most Notable methods&lt;/p&gt;
&lt;p&gt;React.Component
React.Component.render
React.render&lt;/p&gt;
&lt;p&gt;Yifei's Notes&lt;/p&gt;
&lt;p&gt;è¿‡å»å†™ç•Œé¢çš„æ–¹æ³•æ˜¯ï¼ŒæŠŠæ‰€æœ‰çš„ç»“æ„(html)ï¼ŒåŠ¨ä½œ(js)ï¼Œæ ·å¼(css)åˆ†å¼€ï¼Œå¥½å¤„æ˜¯éä¾µå…¥ï¼Œç¦»äº†è°éƒ½é¥å·¥ä½œï¼Œç¼ºç‚¹æ˜¯æ— æ³•æ¨¡å—åŒ–ï¼Œåœ¨ js æ— è¶³è½»é‡ï¼Œç”šè‡³æœ‰ noscript è¿™ç§æ’ä»¶çš„è¿‡å»æ˜¾ç„¶æ˜¯æœ€ä½³å®è·µï¼Œä½†æ˜¯åˆ°äº† js å¤§è¡Œå…¶é“çš„ä»Šå¤©æ˜¾ç„¶æ¨¡å—åŒ–åˆè¢«æå‡ºæ¥äº†ã€‚ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 14:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/react.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Michael Sipser - Dean of Science</title><link>/posts/michael-sipser-dean-of-science.html</link><description>&lt;p&gt;Gravity Waves&lt;/p&gt;
&lt;p&gt;LIGO&lt;/p&gt;
&lt;p&gt;Rai Weiss&lt;/p&gt;
&lt;p&gt;RSA is first published in Scientific American&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 14:06:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/michael-sipser-dean-of-science.html</guid><category>talks</category></item><item><title>EcmaScript 6</title><link>/posts/ecmascript-6.html</link><description>&lt;h2&gt;using es6 with babel&lt;/h2&gt;
&lt;h3&gt;debugging mode&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;node_modules/babel-core/browser.js&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt; 
&lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;type=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/babel&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; 
// Your ES6 code
&lt;span class="nt"&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;production mode&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;babel script.js --out-file script-compiled.js&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;Yifei's Notes&lt;/h2&gt;
&lt;p&gt;the main impovements of ES6 are loops and generators, let/const, arrow functions, class syntax
small pieces are function arguments, destructuring&lt;/p&gt;
&lt;h2&gt;Looping&lt;/h2&gt;
&lt;p&gt;there are 3 ways to loop a sequence in ES5, but there are problems&lt;/p&gt;
&lt;h3&gt;ES5 Loops&lt;/h3&gt;
&lt;p&gt;// not concise
for (var index = 0; index &amp;lt; myArray.length; index++) { 
    console.log(myArray[index]);
}&lt;/p&gt;
&lt;p&gt;// no break or return
myArray.forEach(function (value) {
    console.log(value); 
});&lt;/p&gt;
&lt;p&gt;// for objects, not arrays
for (var index in myArray) { 
    // don't actually do this
    console.log(myArray[index]); 
}&lt;/p&gt;
&lt;h3&gt;Introducing ES6 Loops&lt;/h3&gt;
&lt;p&gt;// concise and correct
for (let value of myArray) { 
    console.log(value); 
}&lt;/p&gt;
&lt;p&gt;// also works on strings, sets and maps
for (let chr of "") { 
    alert(chr); 
}&lt;/p&gt;
&lt;p&gt;// make a set from an array of words
 var uniqueWords = new Set(words);
for (let word of uniqueWords) {
  console.log(word);
}&lt;/p&gt;
&lt;p&gt;for (var [key, value] of phoneBookMap) { 
    console.log(key + "'s phone number is: " + value); 
}&lt;/p&gt;
&lt;p&gt;// you can even make it work with objects
// dump an object's own enumerable properties to the console 
for (var key of Object.keys(someObject)) { console.log(key + ": " + someObject[key]); }&lt;/p&gt;
&lt;h2&gt;Generator&lt;/h2&gt;
&lt;p&gt;Inside a generator-function,Â yieldÂ is a keyword, with syntax rather like return. The difference is that while a function (even a generator-function) can only return once, a generator-function can yield any number of times. TheÂ yieldÂ expressionÂ suspends execution of the generator so it can be resumed again later.&lt;/p&gt;
&lt;p&gt;Generator functions are basically the pause-and-continue-able function. when you call a generator function, it returns an paused Generator object, which has a next() function, each time you call the next() function, a pair of yielded-value and status is returned.&lt;/p&gt;
&lt;p&gt;In technical terms, each time a generator yields, itsÂ stack frameâ€”the local variables, arguments, temporary values, and the current position of execution within the generator bodyâ€”is removed from the stack. However, the Generator object keeps a reference to (or copy of) this stack frame, so that a later .next()Â call can reactivate it and continue execution.&lt;/p&gt;
&lt;p&gt;function* fibs() {
  var a = 0;
  var b = 1;
  while (true) {
    yield a;
    [a, b] = [b, a + b];
  }
}&lt;/p&gt;
&lt;p&gt;function* range(start, stop) { for (var i = start; i &amp;lt; stop; i++) yield i; }&lt;/p&gt;
&lt;p&gt;// This should "ding" three times
for (var value of range(0, 3)) {
  alert("Ding! at floor #" + value);
}&lt;/p&gt;
&lt;p&gt;This is possible becauseÂ generators are iterators.Â All generators have a built-in implementation ofÂ .next()Â andÂ &lt;a href=""&gt;Symbol.iterator&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Template Strings&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Hello ${user.name}, welcome to our server for the ${times} times&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;Rest Parameters and Defaults&lt;/h2&gt;
&lt;p&gt;ES5 version&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;containsAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;haystack&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;arguments&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;needle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;arguments&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;haystack&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;needle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ES6 version&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;containsAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;haystack&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;needles&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;needle&lt;/span&gt; &lt;span class="nx"&gt;of&lt;/span&gt; &lt;span class="nx"&gt;needles&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;haystack&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;needle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ES6 supports default parameters, The default argument gets evaluated at call time, so unlike e.g. in Python, a new object is created each time the function is called.&lt;/p&gt;
&lt;h2&gt;Class&lt;/h2&gt;
&lt;p&gt;ES6 support static method, supuer, getter/setter
you can even subclass builtin types&lt;/p&gt;
&lt;p&gt;class Circle {
    constructor(radius) {
        this.radius = radius;
        Circle.circlesMade++;
    };&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;static draw(circle, canvas) {
    // Canvas drawing code
};

static get circlesMade() {
    return !this._count ? 0 : this._count;
};
static set circlesMade(val) {
    this._count = val;
};

area() {
    return Math.pow(this.radius, 2) * Math.PI;
};

get radius() {
    return this._radius;
};
set radius(radius) {
    if (!Number.isInteger(radius))
        throw new Error(&amp;quot;Circle radius must be an integer.&amp;quot;);
    this._radius = radius;
};
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;
&lt;p&gt;var [,,third] = ["foo", "bar", "baz"];
var [head, ...tail] = [1, 2, 3, 4];
console.log(tail);
// [2, 3, 4]&lt;/p&gt;
&lt;p&gt;var robotA = { name: "Bender" };
var robotB = { name: "Flexo" };&lt;/p&gt;
&lt;p&gt;var { name: nameA } = robotA;
var { name: nameB } = robotB;&lt;/p&gt;
&lt;p&gt;console.log(nameA);
// "Bender"
console.log(nameB);
// "Flexo"&lt;/p&gt;
&lt;p&gt;// this is a syntax sugar for variable and key share the same name
var { foo, bar } = { foo: "lorem", bar: "ipsum" };
console.log(foo);
// "lorem"
console.log(bar);
// "ipsum"&lt;/p&gt;
&lt;p&gt;var [missing = true] = [];
console.log(missing);
// true&lt;/p&gt;
&lt;p&gt;var { message: msg = "Something went wrong" } = {};
console.log(msg);
// "Something went wrong"&lt;/p&gt;
&lt;p&gt;var { x = 3 } = {};
console.log(x);
// 3&lt;/p&gt;
&lt;p&gt;// parameters
function removeBreakpoint({ url, line, column }) {
  // ...
}&lt;/p&gt;
&lt;p&gt;// super works as expected, calling super constructor and access base properties&lt;/p&gt;
&lt;p&gt;// you can even subclass builtin types&lt;/p&gt;
&lt;p&gt;CommonJS&lt;/p&gt;
&lt;p&gt;There is a special object called module.exports, when &lt;code&gt;require&lt;/code&gt;ing, the value of module.exports is returned.&lt;/p&gt;
&lt;p&gt;something like that...
var require = function(path) {
    // ...
    return module.exports;
};&lt;/p&gt;
&lt;p&gt;ES6 export&lt;/p&gt;
&lt;p&gt;use the export keyword&lt;/p&gt;
&lt;p&gt;// lib.js
export function foo() {}
export class bar {}
// or 
export {baz, foz};
export {foo as fart};&lt;/p&gt;
&lt;p&gt;// use.js
import {foo, bar} from "lib.js";
import {foo as fart} from "lib.js"; // renaming
import {* as lib} from "lib.js"; // import everything and put in a object&lt;/p&gt;
&lt;p&gt;ES6 import commonJS&lt;/p&gt;
&lt;p&gt;most packages are written in commonJS, for using as ES6 modules:
import _ from "lodash" // which is 
import {default as _} from "lodash" // which is
let _ = require("lodash");&lt;/p&gt;
&lt;p&gt;you can also do module.exports in ES6
export default value;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:54:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ecmascript-6.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Java Notes</title><link>/posts/java-notes.html</link><description>&lt;p&gt;å†…éƒ¨ç±»
OuterClassName.InnerClassName
å†…éƒ¨ç±»å¯ä»¥ç›´æ¥è®¿é—®å…¶å¤–å›´å¯¹è±¡çš„æˆå‘˜ï¼Œè€Œä¸éœ€è¦ä»»ä½•ç‰¹æ®Šæ¡ä»¶
OuterClass.this OuterClass.new  &lt;/p&gt;
&lt;p&gt;åŒ¿åå†…éƒ¨ç±»éå¸¸æœ‰ç”¨ã€‚ new ClassName() {} åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªClassNameçš„åŒ¿åç±»çš„å¯¹è±¡&lt;/p&gt;
&lt;p&gt;åµŒå¥—ç±»æ˜¯æŒ‡ä½¿ç”¨äº†static class çš„å†…éƒ¨ç±»&lt;/p&gt;
&lt;p&gt;javaä¸­ä¸å…è®¸å˜é‡éšè—&lt;/p&gt;
&lt;p&gt;åªæœ‰ç±»æˆå‘˜æ‰ä¼šé»˜è®¤åˆå§‹åŒ–ï¼Œæ™®é€šå˜é‡ä¸ä¼š&lt;/p&gt;
&lt;p&gt;int x = a.f()
å…¶ä¸­ï¼Œæ¶ˆæ¯æ˜¯f(), å¯¹è±¡æ˜¯a,é¢å‘å¯¹è±¡å°±æ˜¯ã€Œç»™å¯¹è±¡å‘æ¶ˆæ¯ã€&lt;/p&gt;
&lt;p&gt;javaä¸­ä¸å…è®¸å°†å…¶ä»–ç±»å‹ç”¨åšboolå€¼&lt;/p&gt;
&lt;p&gt;javaä¼šä¸ºä½ æä¾›é»˜è®¤æ„é€ å™¨ï¼ˆæ— å‚æ„é€ å™¨ï¼‰&lt;/p&gt;
&lt;p&gt;æ— æ³•é€šè¿‡è¿”å›å€¼æ¥é‡è½½å‡½æ•°&lt;/p&gt;
&lt;p&gt;é™æ€å—&lt;/p&gt;
&lt;p&gt;static {
    i = 47;
}&lt;/p&gt;
&lt;p&gt;å¯å˜å‚æ•°åˆ—è¡¨
doGET(Object... args)&lt;/p&gt;
&lt;p&gt;é»˜è®¤è®¿é—®æƒé™æ˜¯åŒ…è®¿é—®æƒé™&lt;/p&gt;
&lt;p&gt;.java æ–‡ä»¶ç¼–è¯‘ç”Ÿæˆ .class æ–‡ä»¶ï¼Œjaræ–‡ä»¶æ˜¯.class æ–‡ä»¶çš„æ‰“åŒ…&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨importæ—¶ï¼Œé»˜è®¤å»CLASSPATH æŸ¥æ‰¾å¯¹åº”çš„åŒ…&lt;/p&gt;
&lt;p&gt;enum&lt;/p&gt;
&lt;p&gt;enum Color {
    GREEN,
    RED,
    BLUE
}&lt;/p&gt;
&lt;p&gt;annotations&lt;/p&gt;
&lt;p&gt;@Override
@Deprecated
@SurpressWarnings&lt;/p&gt;
&lt;p&gt;Concurrency&lt;/p&gt;
&lt;p&gt;class MyRunnable implements Runnable {}
Thread t = new Thread(new Runnable())&lt;/p&gt;
&lt;p&gt;AtomicInteger AtomicLong AtomicReference&lt;/p&gt;
&lt;p&gt;Oracle Java is more stable than OpenJDK, they are baisclly the same, you can think oracle java as a bugfix version of OpenJDK&lt;/p&gt;
&lt;p&gt;èµ„æ–™&lt;/p&gt;
&lt;p&gt;learnxinyminutes
Java for c++ programmers http://pages.cs.wisc.edu/~hasti/cs368/JavaTutorial/
Effecitve Java&lt;/p&gt;
&lt;p&gt;å‘1&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªæ–‡ä»¶ä¸€ä¸ªpublicç±», è¦æ±‚ç±»çš„åç§°å¿…é¡»å’Œæ–‡ä»¶åä¸€æ ·
å½“ç„¶è¿˜å¯ä»¥å®šä¹‰ä¸€äº›å…¶ä»–çš„é public çš„ç±»
javac MyClass.java  ç”Ÿæˆ MyClass.class ç­‰å…¶ä»–ä¸€äº›æ–‡ä»¶, æ¯ä¸ªç±»å¯¹åº”ä¸€ä¸ª class æ–‡ä»¶
java MyClass // è¿™é‡Œæ²¡æœ‰ class åç¼€&lt;/p&gt;
&lt;p&gt;å‘2&lt;/p&gt;
&lt;p&gt;æ•°ç»„  int[] numbers = {1, 2, 3, 4, 5, 6, 7, 8, 9, 0}; // æœªæŒ‡å®šå…ƒç´ ä¼šè¢«åˆå§‹åŒ–
ArrayList &lt;br&gt;
LinkedList  &lt;/p&gt;
&lt;p&gt;.length å±æ€§
for è¯­å¥
for (int i : numbers) {
    // 
}&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ System.arraycopy æ¥å¤åˆ¶æ•°ç»„&lt;/p&gt;
&lt;p&gt;å‘3&lt;/p&gt;
&lt;p&gt;switchè¯­å¥
java ä¸­çš„ switch è¯­å¥å’Œ c ä¸€æ ·, ä¾ç„¶æ˜¯ fall-through, åœ¨ java 7 ä¸­å¯ä»¥ switch string äº†&lt;/p&gt;
&lt;p&gt;å‘4&lt;/p&gt;
&lt;p&gt;ç±»å‹è½¬æ¢: Integer.parseInt, Interger.toString&lt;/p&gt;
&lt;p&gt;å‘5&lt;/p&gt;
&lt;p&gt;static block
Java has no implementation of static constructors, but has a static block that can be used to initialize class variables (static variables). 
This block will be called when the class is loaded.&lt;/p&gt;
&lt;p&gt;static {
        className = "Bicycle";
    }&lt;/p&gt;
&lt;p&gt;å‘6&lt;/p&gt;
&lt;p&gt;æ„é€ å™¨å¯ä»¥è°ƒç”¨å¦ä¸€ä¸ªæ„é€ å™¨,  ä½¿ç”¨ this, è¿˜å¯ä»¥ä½¿ç”¨ super è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨
java åªèƒ½å•ç»§æ‰¿, ä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£, æ¥å£ä¸­çš„æ–¹æ³•ä¸èƒ½æœ‰å®šä¹‰&lt;/p&gt;
&lt;p&gt;å‘7&lt;/p&gt;
&lt;p&gt;ä¸èƒ½ä½¿ç”¨==æ¥åˆ¤æ–­å¯¹è±¡(åŒ…æ‹¬å­—ç¬¦ä¸²)æ˜¯å¦ç›¸ç­‰, è¿™æ ·åªèƒ½æ£€æµ‹æ˜¯å¦æŒ‡å‘åŒä¸€ä½ç½®.&lt;/p&gt;
&lt;p&gt;å‘8 - IO&lt;/p&gt;
&lt;p&gt;System.out.println&lt;/p&gt;
&lt;p&gt;å‘9 - ç±»å‹&lt;/p&gt;
&lt;p&gt;åŸå§‹ç±»å‹    æ•°å­—å‹
å¼•ç”¨ç±»å‹    æ•°ç»„å’Œç±»&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰ç±»éƒ½æ˜¯ Object çš„å­ç±»&lt;/p&gt;
&lt;p&gt;å‘10 - Java.lang&lt;/p&gt;
&lt;p&gt;String  å­—ç¬¦ä¸²ç±»
length   é•¿åº¦
equals   ç›¸ç­‰
toLowerCase/toUpperCase &lt;/p&gt;
&lt;p&gt;åŒ…è£…ç±» 
Integer 
Boolean 
Double  &lt;/p&gt;
&lt;p&gt;å‘11 - Package&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ package name; æ¥å£°æ˜åŒ…, æ‰€æœ‰çš„æºæ–‡ä»¶è¦æ”¾åœ¨ name è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹
å¯ä»¥ä½¿ç”¨ import package.class æˆ–è€… import package.* æ¥å¯¼å…¥åŒ…
CLASSPATH å­˜æ”¾ package çš„æ ¹ç›®å½•&lt;/p&gt;
&lt;p&gt;å‘12 - å¼‚å¸¸&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; try {
   // statements that might cause exceptions
   // possibly including function calls
} catch ( exception-1 id-1 ) {
   // statements to handle this exception 
} catch ( exception-2 id-2 ) {
   // statements to handle this exception 
.
.
.
} finally {
   // statements to execute every time this try block executes
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;try {
        return 0; // è¢«è¦†ç›–
    } finally {
        return 2;
    }
å°½é‡é¿å…åœ¨ try...catch...finally ä¸­ä½¿ç”¨æ§åˆ¶è½¬ç§»è¯­å¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;            +--------+
            | Object |
            +--------+
            |
            |
           +-----------+
       | Throwable |
           +-----------+
            /         \
       /           \
      +-------+      +-----------+
      | Error |      | Exception |
      +-------+      +-----------+
   /  |  \        / |        \
   \________/     \______/      \
                    +------------------+
unchecked    checked    | RuntimeException |
                +------------------+
                  /   |    |      \
                 \_________________/

                   unchecked
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;checked å’Œ unchecked exception, RuntimeException é€šå¸¸æ˜¯æŒ‡ unchecked exception
å®é™…ä¸Šï¼Œå¯¹äºè‡ªå·±ç¼–å†™çš„å¼‚å¸¸ç±»æ¥è®²ï¼Œæ¨èé»˜è®¤çš„æ˜¯ç»§æ‰¿RuntimeExceptionï¼Œé™¤éæœ‰ç‰¹æ®Šç†ç”±æ‰ç»§æ‰¿Exceptionã€‚ C#ä¸­æ²¡æœ‰Checked Exceptionçš„æ¦‚å¿µï¼Œè¿™ç§æ¨èçš„åšæ³•ç­‰äºæ˜¯é‡‡ç”¨äº†C#çš„è®¾è®¡ç†å¿µï¼šæŠŠæ˜¯å¦æ•è·å’Œä½•æ—¶æ•è·è¿™ä¸ªé—®é¢˜äº¤ç»™ä½¿ç”¨è€…å†³å®šï¼Œä¸å¼ºåˆ¶ä½¿ç”¨è€…ã€‚å½“ç„¶ï¼Œå¦‚æœæŸäº›æƒ…å†µ ä¸‹æ˜ç¡®æé†’æ•è·æ›´åŠ é‡è¦è¿˜æ˜¯å¯ä»¥é‡‡ç”¨Checked Exceptionçš„ã€‚å¯¹äºç¼–å†™ä¸€ä¸ªæ–¹æ³•æ¥è®²ï¼Œâ€œæ˜¯å¦åœ¨æ–¹æ³•ä¸Šå£°æ˜ä¸€ä¸ªå¼‚å¸¸â€è¿™ä¸ªé—®é¢˜æ¯”â€œæ˜¯å¦é‡‡ç”¨Checked Exceptionâ€æ›´åŠ é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;å‘13 - OO
Each superclass method (except its constructors) can be either 
    â€¢ inherited, or 
    â€¢ overloaded, or 
    â€¢ overridden 
inherited: If no method with the same name is (re)defined in the subclass, then the subclass has that method with the same implementation as in the superclass. 
overloaded: If the subclass defines a method with the same name, but with a different number of arguments or different argument types, then the subclass has two methods with that name: the old one defined by the superclass, and the new one it defined. 
overridden: If the subclass defines a method with the same name, and the same number and types of arguments, then the subclass has only one method with that name: the new one it defined. 
ä½¿ç”¨ super è°ƒç”¨åŸºç±»çš„æ„é€ å™¨ï¼Œä½¿ç”¨ this è°ƒç”¨è‡ªèº«å…¶ä»–çš„æ„é€ å™¨ï¼Œå¦‚æœæ²¡æœ‰è°ƒç”¨åŸºç±»çš„æ„é€ å™¨ï¼Œä¼šéšå¼è°ƒç”¨åŸºç±»çš„é»˜è®¤æ„é€ å™¨&lt;/p&gt;
&lt;p&gt;Recall that every class extends Object. So you might wonder which methods of Object you should consider overriding when you define a new class. There are four methods that often should be overridden: 
    1. toString 
    2. equals 
    3. hashCode 
    4. clone 
public String toString(): Returns a String representation of the object. It is used, for example, by System.out.print to print an object. The default version of toString is not very useful, so you should override this method whenever you want to provide a String representation of your class objects. 
public boolean equals(Object ob): Returns true iff the object (pointed to by "this") and ob are the same. The default version uses pointer equality; i.e., it returns true only if "this" and "ob" contain the same address. You may want to override this method to provide a more liberal notion of equality. For example, the String class overrides equals so that it returns true for two Strings that contain the same sequence of characters. 
public int hashCode(): Returns an integer for this object suitable for use as a hash code (e.g., for use with the Hashtable class defined in javil.util). This method should be overridden whenever the equals method is, so that hashCode returns the same value for two "equal" objects. 
protected Object clone(): Returns a copy of this object (note that no constructor is called for the new object). The default version just copies the values of all fields (i.e., a "shallow" copy). That is probably not what you want when your class has fields that contain pointers (i.e., arrays or classes). So in that case you should override the clone method to do a deep copy -- clone all pointer fields. 
Cloning
To permit your object to be cloned you must declare that your object implements the Cloneable interface. (See the notes on INTERFACES.) For example: 
    public class List implements Cloneable { 
        private Object items[]; // a pointer field! 
        ... 
    } 
If you forget to do this, an attempt to clone will cause the exception CloneNotSupportedException to be thrown. &lt;/p&gt;
&lt;p&gt;å‘14 - casting
java éœ€è¦æ˜¾å¼è½¬æ¢ç±»å‹
Assume that we have the following declarations of function f and variables h1 and h2: 
    public static void f( RaceHorse r ) { ... } 
    Horse h1 = new RaceHorse(); 
    Horse h2 = new Horse(); 
Now consider the following three calls to f: 
    1. f(h1); // compile-time error (missing cast) 
    2. f( (RaceHorse)h1 ); // fine! h1 really does point to a RaceHorse 
    3. f( (RaceHorse)h2 ); // runtime error (bad cast) h2 points to a Horse &lt;/p&gt;
&lt;p&gt;é™æ€æ–¹æ³•å’Œæˆå‘˜å˜é‡å¹¶æ²¡æœ‰ dynamic dispatching
å¯ä»¥ä½¿ç”¨ super.xxx()è°ƒç”¨çˆ¶ç±»å·²ç»è¢«é‡è½½çš„æ–¹æ³•&lt;/p&gt;
&lt;p&gt;å‘15 - Interface&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:46:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/java-notes.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>lua</title><link>/posts/lua.html</link><description>&lt;p&gt;lua_pcall æ˜¯ä½¿ç”¨ c ä¸­çš„ setjmp å®ç°çš„, å¯¹åº”åœ¨lua ä¸­çš„å‡½æ•°å°±æ˜¯ pcall&lt;/p&gt;
&lt;p&gt;pcall/error å¤§æ¦‚å°±ç›¸å½“äºå…¶ä»–è¯­è¨€ä¸­çš„ try-catch /throwäº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;local ok, errorobject = pcall(function() 
Â  Â  --here goes the protected code 
Â  Â  ... 
end) 

if not ok then 
Â  Â  --here goes the error handling code 
Â  Â  --(errorobject has more information about the error) 
Â  Â  ... 
end 
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;åç¨‹&lt;/h1&gt;
&lt;p&gt;å¯¹ç§°åç¨‹åªæœ‰ä¸€ä¸ªå…³é”®å­—: transfer, ç±»ä¼¼äº goto è¯­å¥, æŠŠæ§åˆ¶æƒç§»äº¤ç»™å…¶ä»–çš„ä»»æ„ä¸€ä¸ªåç¨‹; è€Œéå¯¹ç§°åç¨‹ä¸€èˆ¬æœ‰ä¸¤ä¸ªå…³é”®å­—:resume å’Œ yield, ä½¿ç”¨ resumeæ‰“å¼€ä¸€ä¸ªåç¨‹, ç„¶ååœ¨è¿™ä¸ªåç¨‹ä¸­ä½¿ç”¨ yield è¿”å›.&lt;/p&gt;
&lt;p&gt;å­¦ä¹ luaå¯ä»¥è·å¾—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ€æ ·å®ç°ä¸€é—¨è¯­è¨€ï¼Œç¼–è¯‘åŸç†ï¼Œç¦»æ•£æ•°å­¦&lt;/li&gt;
&lt;li&gt;luaæœ¬èº«&lt;/li&gt;
&lt;li&gt;è™šæ‹Ÿæœºï¼Œjit&lt;/li&gt;
&lt;li&gt;Cè¯­è¨€èƒ½åŠ›çš„å¢å¼º&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;lua çš„æ ‡å‡†åº“è¡¥å…… &lt;a href="https://github.com/stevedonovan/Penlight"&gt;Penlight&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://ww4.sinaimg.cn/large/006tNbRwgy1fg3q43bjn9j31kw1rgk1j.jpg"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/lua.html</guid><category>Lua</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>openresty</title><link>/posts/openresty.html</link><description>&lt;ol&gt;
&lt;li&gt;The *by_lua modules that tweak the nginx behaviour (for ex the rewrite_by_lua that is the lua equivalent of nginx http rewrite) module are always run after the standard nginx modules.&lt;/li&gt;
&lt;li&gt;The choice of *by_lua module to use largely depends upon the problem that you are trying to solve. For example the init_by_lua module is used for initialization operations where as access_by_lua may be used to implement access policies for a location block. Personally among the various directives I find most use for content_by_lua. &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;From &lt;a href="http://www.staticshin.com/programming/definitely-an-open-resty-guide/"&gt;http://www.staticshin.com/programming/definitely-an-open-resty-guide/&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;http://www.londonlua.org/scripting_nginx_with_lua/slides.html&lt;/p&gt;
&lt;p&gt;Lua can access nginx at different phase, the most important directives are:&lt;/p&gt;
&lt;p&gt;Rewrite_by_lua&lt;br&gt;
Access_by_lua &lt;br&gt;
Content_by_lua&lt;br&gt;
Init_by_lua 
Set_by_lua  &lt;/p&gt;
&lt;p&gt;Rememeber to set lua_code_cache when developing&lt;/p&gt;
&lt;p&gt;Use &lt;code&gt;ngx.location.capture&lt;/code&gt; to issue a sub-request to other locations in nginx &lt;/p&gt;
&lt;p&gt;&lt;code&gt;ngx.ctx&lt;/code&gt; is a lua table to store data with a lifetime&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:44:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/openresty.html</guid><category>Lua</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>lua coroutine</title><link>/posts/lua-coroutine.html</link><description>&lt;p&gt;Lua çš„åç¨‹æ˜¯éå¯¹ç§°çš„åç¨‹ä¹Ÿå°±æ˜¯ resume å’Œ yeild ç›¸å½“äºè°ƒç”¨å’Œè¿”å›&lt;/p&gt;
&lt;p&gt;Python çš„åç¨‹æ˜¯å¯¹ç§°çš„åç¨‹, ç›¸å½“äº goto.&lt;/p&gt;
&lt;p&gt;Luaä¸­æºç¨‹ç›¸å…³çš„å‡½æ•°éƒ½æ”¾åœ¨coroutineåŒ…ä¸­
coroutine.create(function)  è¿”å›ä¸€ä¸ªthreadç±»å‹çš„å€¼è¡¨ç¤ºä¸€ä¸ªåç¨‹ï¼Œå¹¶ä¸”å¤„äºsuspendçŠ¶æ€ã€‚
resume(co, paramsâ€¦) æ‰§è¡Œä¸€ä¸ªåç¨‹ï¼Œå¹¶ä¸”èƒ½å¤Ÿä¼ é€’å‚æ•°ï¼Œè¿”å›è¿è¡Œçš„çŠ¶æ€çš„å‡½æ•°yieldè¿”å›çš„ç»“æœ&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:43:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/lua-coroutine.html</guid><category>Lua</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Lua ä¸­çš„è¿­ä»£å™¨</title><link>/posts/lua-zhong-de-die-dai-qi.html</link><description>&lt;p&gt;Luaä¸­æœ‰ä¸¤ç§forè¯­å¥ï¼Œæœ€åŸºæœ¬çš„æ˜¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;for i = 1, 10 do
    print i
end
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿˜æœ‰ä¸€ç§æ˜¯for inè¯­å¥&lt;/p&gt;
&lt;p&gt;for I in pairs(t) do
       print I
   end&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:42:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/lua-zhong-de-die-dai-qi.html</guid><category>Lua</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>jQuery and un-jQuery</title><link>/posts/jquery-and-un-jquery.html</link><description>&lt;h1&gt;jQuery&lt;/h1&gt;
&lt;p&gt;$el.append(htmlString)
$el.prepend(htmlString)&lt;/p&gt;
&lt;p&gt;$newEl.insertBefore(queryString)
$newEl.insertAfter(queryString)&lt;/p&gt;
&lt;h1&gt;un-jQuery&lt;/h1&gt;
&lt;h2&gt;DOM æ“ä½œ&lt;/h2&gt;
&lt;p&gt;é€‰æ‹©å™¨å¯ä»¥ä½¿ç”¨ querySelector å’Œ querySelectorAll, ä½†æ˜¯è¿™ä¸¤ä¸ªçš„æ€§èƒ½å¤ªå·®äº†, æœ€å¥½ä½¿ç”¨ getElementById, getElementsByTagName, getElementsByClassName&lt;/p&gt;
&lt;p&gt;$el.val() å¯¹åº” el.value&lt;/p&gt;
&lt;h3&gt;è·å– attr&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$el.attr(&amp;#39;id&amp;#39;);
el.getAttribute(&amp;#39;id);
el.setAttribute(attr, value)
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;parent and children&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$el.children
$el.parent()
el.children
el.parentNode
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;è®¾ç½® css&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;el&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;css&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;color&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#000&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="nt"&gt;el&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;style&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#000&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nt"&gt;el&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;css&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;color&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="nt"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;getComputedStyle&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;el&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;color&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç‰¹åˆ«åœ°
$(el).hide(); // jQuery
el.style.display = 'none'; // native
$(el).show(); // jQuery
el.style.dispaly = ''&lt;/p&gt;
&lt;h3&gt;è®¾ç½® class&lt;/h3&gt;
&lt;p&gt;$el.addClass(className) // remove, has, toggle
el.classList.add(className) // remove, contains, toggle&lt;/p&gt;
&lt;p&gt;è®¾ç½®text
Get text
// jQuery
$el.text();
// Native
el.textContent;&lt;/p&gt;
&lt;p&gt;Set text
// jQuery
$el.text(string);&lt;/p&gt;
&lt;p&gt;// Native
el.textContent = string;&lt;/p&gt;
&lt;h2&gt;è®¾ç½®html&lt;/h2&gt;
&lt;p&gt;Get HTML
// jQuery
$el.html();&lt;/p&gt;
&lt;p&gt;// Native
el.innerHTML;
Set HTML
// jQuery
$el.html(htmlString);&lt;/p&gt;
&lt;p&gt;// Native
el.innerHTML = htmlString;&lt;/p&gt;
&lt;h2&gt;inserting html fragment to document&lt;/h2&gt;
&lt;p&gt;Have a look at &lt;code&gt;insertAdjacentHTML&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;var element = document.getElementById(&amp;quot;one&amp;quot;);
var newElement = &amp;#39;&lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;two&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;two&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&amp;#39;
element.insertAdjacentHTML( &amp;#39;afterend&amp;#39;, newElement )
// new DOM structure: &lt;span class="nt"&gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;one&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;one&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&amp;lt;div&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;two&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;two&lt;span class="nt"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
position is the position relative to the element you are inserting adjacent to:
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;beforebegin&lt;/code&gt; Before the element itself&lt;/p&gt;
&lt;p&gt;&lt;code&gt;afterbegin&lt;/code&gt; Just inside the element, before its first child&lt;/p&gt;
&lt;p&gt;&lt;code&gt;beforeend&lt;/code&gt; Just inside the element, after its last child&lt;/p&gt;
&lt;p&gt;&lt;code&gt;afterend&lt;/code&gt; After the element itself&lt;/p&gt;
&lt;p&gt;äº‹ä»¶&lt;/p&gt;
&lt;p&gt;ç»‘å®šäº‹ä»¶ 
$el.on(eventName, eventHandler);  // jQuery
el.addEventListener(eventName, eventHandler);  // Native&lt;/p&gt;
&lt;p&gt;è§£ç»‘äº‹ä»¶
$el.off(eventName, eventHandler);  // jQuery
el.removeEventListener(eventName, eventHandler);  // Native&lt;/p&gt;
&lt;p&gt;è§¦å‘äº‹ä»¶
// ç”¨æˆ·äº‹ä»¶
$(el).trigger('custom-event', {key1: 'data'});  // jQuery
// Native, note that
const event = new CustomEvent('custom-event', {detail: {key1: 'data'}});
el.dispatchEvent(event);&lt;/p&gt;
&lt;p&gt;// åŸç”Ÿäº‹ä»¶
$(el).trigger('change');
var ev = new Event("look", {"bubbles":true, "cancelable":false});
document.dispatchEvent(ev);&lt;/p&gt;
&lt;h2&gt;ajax&lt;/h2&gt;
&lt;p&gt;getJSON
jQuery
$.getJSON('/my/url', function(data) {
});
IE9+
var request = new XMLHttpRequest();
request.open('GET', '/my/url', true);
request.onload = function() {
  if (request.status &amp;gt;= 200 &amp;amp;&amp;amp; request.status &amp;lt; 400) {
    // Success!
    var data = JSON.parse(request.responseText);
  } else {
    // We reached our target server, but it returned an error
}
};
request.onerror = function() {
  // There was a connection error of some sort
};
request.send();
Post
jQuery
$.ajax({
  type: 'POST',
  url: '/my/url',
  data: data
});
IE8+
var request = new XMLHttpRequest();
request.open('POST', '/my/url', true);
request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
request.send(data);
Request
jQuery
$.ajax({
  type: 'GET',
  url: '/my/url',
  success: function(resp) {
},
  error: function() {
}
});
IE9+
var request = new XMLHttpRequest();
request.open('GET', '/my/url', true);
request.onload = function() {
  if (request.status &amp;gt;= 200 &amp;amp;&amp;amp; request.status &amp;lt; 400) {
    // Success!
    var resp = request.responseText;
  } else {
    // We reached our target server, but it returned an error
}
};
request.onerror = function() {
  // There was a connection error of some sort
};
request.send();&lt;/p&gt;
&lt;p&gt;DOM Ready&lt;/p&gt;
&lt;p&gt;https://github.com/oneuijs/You-Dont-Need-jQuery/blob/master/README.zh-CN.md
http://youmightnotneedjquery.com/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:41:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/jquery-and-un-jquery.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>lua ä¸‰éƒ¨æ›²</title><link>/posts/lua-san-bu-qu.html</link><description>&lt;p&gt;Programming in Lua&lt;/p&gt;
&lt;p&gt;Luaç¼–ç¨‹æ‰‹å†Œ&lt;/p&gt;
&lt;p&gt;Lua Unofficial FAQ&lt;/p&gt;
&lt;p&gt;çŸ¥ä¹ä¸Š lua ç›¸å…³çš„é—®é¢˜&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:36:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/lua-san-bu-qu.html</guid><category>Lua</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python `-m`</title><link>/posts/python-m.html</link><description>&lt;h2&gt;How &lt;code&gt;-m&lt;/code&gt; is invoked&lt;/h2&gt;
&lt;p&gt;if you have a module foo&lt;/p&gt;
&lt;p&gt;write
foo/
    &lt;strong&gt;init&lt;/strong&gt;.py
    &lt;strong&gt;main&lt;/strong&gt;.py&lt;/p&gt;
&lt;p&gt;then python -m foo will execute &lt;strong&gt;main&lt;/strong&gt;.py&lt;/p&gt;
&lt;p&gt;https://pythonwise.blogspot.sg/2015/01/python-m.html&lt;/p&gt;
&lt;p&gt;json pretty print&lt;/p&gt;
&lt;p&gt;cat some_json_file | python -m json.tool&lt;/p&gt;
&lt;p&gt;zipfile&lt;/p&gt;
&lt;p&gt;zipfile.py -l zipfile.zip Â  Â  Â  Â # Show listing of a zipfile
zipfile.py -t zipfile.zip Â  Â  Â  Â # Test if a zipfile is valid
zipfile.py -e zipfile.zip target # Extract zipfile into target dir
zipfile.py -c zipfile.zip src ... # Create zipfile from sources&lt;/p&gt;
&lt;p&gt;gzip&lt;/p&gt;
&lt;p&gt;python -m gzip wordlist.txt Â # Will create wordlist.txt.gz
python -m gzip -d wordlist.txt.gz Â # Will extract to wordlist.txt&lt;/p&gt;
&lt;p&gt;filecmp&lt;/p&gt;
&lt;p&gt;compare two directories&lt;/p&gt;
&lt;p&gt;$ python -m filecmp /tmp/a /tmp/b
diff /tmp/a /tmp/b
Only in /tmp/a : ['1']
Only in /tmp/b : ['2']
Identical files : ['4']
Differing files : ['3']&lt;/p&gt;
&lt;p&gt;Several modules lets you encode/decode in various formats:
    â€¢ base64
    â€¢ uu
    â€¢ encodings.rot_13
    â€¢ binhex
    â€¢ mimify
    â€¢ quopri
For example
$ echo 'secertpassword' | python -m encodings.rot_13
frpregcnffjbeq&lt;/p&gt;
&lt;p&gt;servers&lt;/p&gt;
&lt;p&gt;python -m SimpleHTTPServer # 2
python -m http.server #3&lt;/p&gt;
&lt;p&gt;python -m pydoc {module/func}&lt;/p&gt;
&lt;p&gt;Profiling&lt;/p&gt;
&lt;p&gt;python -m cProfile script.py
python -m timeit script.py
python -m pstats script.py
python -m trace script.py&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:19:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-m.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>do not subclass built-in classes in python</title><link>/posts/do-not-subclass-built-in-classes-in-python.html</link><description>&lt;p&gt;In short, they will not behave what you think they will. you think dict.get in implemented in python, like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def get(self, key, default=None):
    try:
        return self[key]
    except KeyError:
        return default
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;However, they dict.get do not call &lt;strong&gt;getitem&lt;/strong&gt;, and they are implemented in c separately, and do not call each other.&lt;/p&gt;
&lt;p&gt;so, when you implement &lt;strong&gt;geitem&lt;/strong&gt;, get is not automatically altered! which is very dangerous.&lt;/p&gt;
&lt;p&gt;What you need do, subclass collections.abc.Mapping&lt;/p&gt;
&lt;p&gt;source:&lt;/p&gt;
&lt;p&gt;[1] http://www.kr41.net/2016/03-23-dont_inherit_python_builtin_dict_type.html&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:17:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/do-not-subclass-built-in-classes-in-python.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­å¤åˆçš„ list comprehension</title><link>/posts/python-zhong-fu-he-de-list-comprehension.html</link><description>&lt;p&gt;Python ä¸­çš„ list comprehension å¯ä»¥å¤åˆ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[x for li in lists for x in li if x]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å°±ç›¸å½“äº&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[x
    for li in lists
        for x in li
             if x]
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:17:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-zhong-fu-he-de-list-comprehension.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>ad talks</title><link>/posts/ad-talks.html</link><description>&lt;p&gt;å¹¿å‘Šæ£€ç´¢ç›¸å½“äºå…ˆéªŒçŸ¥è¯†ï¼Œå¦‚æœå…ˆéªŒçŸ¥è¯†æœ‰æ•ˆåå¯ä»¥æ”¾å¼€&lt;/p&gt;
&lt;p&gt;å®šå‘ç»™å¹¿å‘Šä¸»å¯è§ï¼Œå“ˆå“ˆ&lt;/p&gt;
&lt;p&gt;åº”å®šå‘å’Œè½¯å®šå‘ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœslaveé•¿æœŸå¤„äº standby çŠ¶æ€ï¼ŒçœŸåˆ‡è¿‡å»çš„æ—¶å€™ä¼šä¸ä¼š slave æ ¹æœ¬ä¸å¯ç”¨å‘¢ï¼Ÿè¦ä¸è¦é•¿æœŸç›‘æ§ salve æ˜¯ä¸æ˜¯å¥½çš„&lt;/p&gt;
&lt;p&gt;å¹¿å‘Šé¢„æ§ï¼Œå–å†³äºé¢„ä¼°CPMä¸CPMçš„åŒ¹é…ç¨‹åº¦ï¼Œåœ¨å¿«è¦è¾¾åˆ°é¢„æ‰£è´¹çš„æ—¶å€™å¼€å§‹å‡æ…¢é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;PID è€ä¸€å¥—ï¼Œä½†æ˜¯è°ƒå‚å°±å¯ä»¥æ ¹æ®å†å²æ•°æ®ç”±æœºå™¨æ¥è°ƒäº†ï¼Œå¾ˆå¥½&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:13:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ad-talks.html</guid><category>talks</category></item><item><title>vim ä¸­ç”Ÿæˆå’Œä½¿ç”¨ tags</title><link>/posts/vim-zhong-sheng-cheng-he-shi-yong-tags.html</link><description>&lt;p&gt;To use go to definition and other advanced IDE feature, we need to generate tag files for vim to figure out where to find the functions or variables.&lt;/p&gt;
&lt;p&gt;To generate a tag file&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ctags -R
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;By default, the generate tag file will be located at ./tags directory, we need to let vim know where to find it by:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;:set tags+=tags
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To search for a symbol in vim, use&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;:tag [symbol-name]
:tag /[search-name]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To go to the definition, we need &lt;code&gt;Ctrl-]&lt;/code&gt;, to go back, press &lt;code&gt;Ctrl-t&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;:tn next tag
:tp prev tag
:ts all tags
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ref:&lt;/p&gt;
&lt;p&gt;[1] http://usevim.com/2013/01/18/tags/&lt;/p&gt;
&lt;p&gt;vim tags matchlist is not very user friendly. I should write my own that shows the list in quick fix window&lt;/p&gt;
&lt;p&gt;http://vim.1045645.n5.nabble.com/Putting-all-ctags-matches-into-quickfix-td1182150.html&lt;/p&gt;
&lt;p&gt;http://vim.1045645.n5.nabble.com/Open-tags-in-quickfix-window-td1188577.html&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:03:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/vim-zhong-sheng-cheng-he-shi-yong-tags.html</guid><category>vim</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>python inspect library</title><link>/posts/python-inspect-library.html</link><description>&lt;p&gt;inspect.iscoroutinefunction(fn)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 13:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-inspect-library.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>ç”µå•†åœ¨ä¸­å›½</title><link>/posts/dian-shang-zai-zhong-guo.html</link><description>&lt;p&gt;è™½ç„¶ç”µå­å•†åŠ¡å·²ç»åœ¨ä¸­å›½å‘å±•å£®å¤§ï¼Œä½†äº§å€¼è¿˜æœªè¾¾åˆ°æƒŠäººçš„è§„æ¨¡ï¼Œæµ·é‡çš„æ—¥å¸¸æœåŠ¡ä»åœ¨çº¿ä¸‹è¿›è¡Œã€‚ä¾‹å¦‚ä¸­å›½80%çš„é…’åº—å®¢æˆ¿è¿˜æ˜¯çº¿ä¸‹é¢„è®¢ã€‚ä¸­å›½æ¶ˆè´¹è€…é’çç”µå­å•†åŠ¡çš„åŸå› ä¸æ˜¯å®ƒèƒ½å¸¦æ¥ä¾¿åˆ©ï¼Œè€Œæ˜¯å®ƒæ¯”å®ä½“åº—çš„ç»è¥å…¬å¼€é€æ˜å¾—å¤šï¼Œè…è´¥å› ç´ å°‘å¾—å¤šã€‚
æ­£ å¦‚æå¼€å¤æ‰€è¯´ï¼ŒæŒ‰ç¾å›½æ ‡å‡†è¯„ä»·ï¼Œä¸­å›½çš„å®ä½“å•†å®¶æ™®éæ•ˆç‡ä½ä¸‹ï¼Œå¤§è‚†å¹å˜˜çš„è¡Œä¸ºæ¯”æ¯”çš†æ˜¯ã€‚ä»–æŒ‡å‡ºï¼šâ€œç¾å›½æœ‰å‡ ç™¾å¹´å…¬å¹³ç«äº‰çš„ä¼ ç»Ÿï¼Œå•†ç•Œç›¸å¯¹æ¯”è¾ƒå…¬å¹³é€æ˜ã€‚â€ å¯ä¸­å›½æˆªç„¶ä¸åŒï¼Œâ€œå¦‚æœè¦å‡ºå”®æˆ¿åœ°äº§ï¼Œäº¤æ˜“æ ¹æœ¬æ˜¯ä¸é€æ˜çš„ã€‚å¦‚æœæƒ³ä¹°äºŒæ‰‹è½¦ï¼Œä¹Ÿæ²¡æœ‰åƒConsumer Reportsé‚£æ ·çš„ç‹¬ç«‹è°ƒæŸ¥æœºæ„å‡ºå…·è´¨é‡æŠ¥å‘Šï¼Œæˆ–è€…å‹‡æ•¢çš„æ¶ˆè´¹è€…å‡ºé¢æŠ«éœ²æ±½è½¦å®‰å…¨é—®é¢˜ã€‚â€æå¼€å¤è®¤ä¸ºï¼Œç”µå•†æ— éœ€ä¸­é—´å•†å’Œåˆ›é€ å£°èª‰çš„ç³»ç»Ÿï¼Œè®©äº¤æ˜“æ›´é€æ˜ã€æ›´å¯ä¿¡ï¼Œâ€œæ‰€ä»¥ï¼ŒåŸºäºç¤¾äº¤çš„æ‰‹æœºè§£å†³æ–¹æ¡ˆä¼šå¥½å¾—å¤šã€‚â€&lt;/p&gt;
&lt;p&gt;æ¥è‡ª &lt;a href="http://www.cnbeta.com/articles/462897.htm"&gt;http://www.cnbeta.com/articles/462897.htm&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 12:58:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/dian-shang-zai-zhong-guo.html</guid><category>åˆ›ä¸š</category><category>è¿è¥ä¸äº§å“</category></item><item><title>m4 tool</title><link>/posts/m4-tool.html</link><description>&lt;p&gt;m4 macro language  http://mbreen.com/m4.html&lt;/p&gt;
&lt;h2&gt;comman line invoking&lt;/h2&gt;
&lt;p&gt;m4 -D&lt;MACRO&gt;&lt;/p&gt;
&lt;h2&gt;builtins&lt;/h2&gt;
&lt;p&gt;define(&lt;macro&gt;, &lt;value&gt;)
undefine(&lt;macaro&gt;)
ifdef(&lt;macro&gt;, &lt;then&gt;, &lt;else&gt;)
ifelse(&lt;a&gt;, &lt;b&gt;, &lt;then&gt;, &lt;else&gt;)
eval(&lt;expr&gt;)
len(&lt;str&gt;)
include(&lt;filename&gt;)
syscmd(&lt;cmd&gt;)
`'are quotes&lt;/p&gt;
&lt;h1&gt;for comments&lt;/h1&gt;
&lt;p&gt;M4 rules
    it reads in the macro's arguments (if any)
    it determines the expansion of the macro and inserts this expansion at the beginning of its input
    m4 continues scanning the input, starting with the expansion &lt;/p&gt;
&lt;p&gt;example:
  define(&lt;code&gt;definenum',&lt;/code&gt;define(&lt;code&gt;num',&lt;/code&gt;99')')
  num                      # -&amp;gt; num
  definenum num            # -&amp;gt; define(&lt;code&gt;num',&lt;/code&gt;99') num -&amp;gt;  99&lt;/p&gt;
&lt;p&gt;Unless a nested macro is quoted, it is expanded immediately:&lt;/p&gt;
&lt;p&gt;define(&lt;code&gt;definenum', define(&lt;/code&gt;num', `99'))
  num                      # -&amp;gt; 99
  definenum                # -&amp;gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 12:57:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/m4-tool.html</guid><category>åº“</category><category>è®¡ç®—æœº</category></item><item><title>Python doctest library</title><link>/posts/python-doctest-library.html</link><description>&lt;h2&gt;basic usage&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;quot;&amp;quot;&amp;quot;
&amp;gt;&amp;gt;&amp;gt; print &amp;#39;hello&amp;#39;
hello
&amp;quot;&amp;quot;&amp;quot;

doctest.testmod()
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;be verbose&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;doctest.testmod(verbose=True)&lt;/code&gt;
or 
&lt;code&gt;python module.py -v&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;traps&lt;/h2&gt;
&lt;p&gt;if you have unicode in your docstirng, add u to the doc string&lt;/p&gt;
&lt;p&gt;Notes on testing classes
&lt;em&gt; If it's testing the class as a whole, I'd put them in the class' docstring.
&lt;/em&gt; If it's testing the constructor, I'd put them in the constructor's docstring.
* If it's testing a method (as it seems to be in this case), I'd actually put it them in that method's docstring.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 12:55:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-doctest-library.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>markdown notes</title><link>/posts/markdown-notes.html</link><description>&lt;h2&gt;Table&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="nv"&gt;Tables&lt;/span&gt;        &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="nv"&gt;Are&lt;/span&gt;           &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="nv"&gt;Cool&lt;/span&gt;  &lt;span class="p"&gt;|&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s s-Atom"&gt;-------------&lt;/span&gt; &lt;span class="p"&gt;|:-&lt;/span&gt;&lt;span class="s s-Atom"&gt;------------:&lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s s-Atom"&gt;-----:&lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s s-Atom"&gt;col&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;is&lt;/span&gt;      &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s s-Atom"&gt;right&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="s s-Atom"&gt;aligned&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mi"&gt;1600&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s s-Atom"&gt;col&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;is&lt;/span&gt;      &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s s-Atom"&gt;centered&lt;/span&gt;      &lt;span class="p"&gt;|&lt;/span&gt;   &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s s-Atom"&gt;zebra&lt;/span&gt; &lt;span class="s s-Atom"&gt;stripes&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s s-Atom"&gt;are&lt;/span&gt; &lt;span class="s s-Atom"&gt;neat&lt;/span&gt;      &lt;span class="p"&gt;|&lt;/span&gt;    &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There must be at least &lt;em&gt;3 dashes&lt;/em&gt; separating each header cell. The outer pipes (|) are optional, and you don't need to make the raw Markdown line up prettily. You can also use inline Markdown.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Markdown | Less | Pretty
--- | --- | ---
*Still* | `renders` | **nicely**
1 | 2 | 3
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å¯ä»¥ä½¿ç”¨å†’å·æ¥å¯¹é½å•å…ƒæ ¼&lt;/p&gt;
&lt;h2&gt;å›¾ç‰‡&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Inline&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nl"&gt;style&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; 
&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;alt&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="nl"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/adam-p/markdown-here/raw/master/src/common/images/icon48.png &amp;quot;Logo Title Text 1&amp;quot;)&lt;/span&gt;
&lt;span class="n"&gt;Reference&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nl"&gt;style&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; 
&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;alt&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;logo&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;logo&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nl"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/adam-p/markdown-here/raw/master/src/common/images/icon48.png &amp;quot;Logo Title Text 2&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;æ¨ªçº¿&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Three or more...
---
Hyphens
***
Asterisks
___
Underscores
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 12:52:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/markdown-notes.html</guid><category>åº“</category><category>è®¡ç®—æœº</category></item><item><title>readline library</title><link>/posts/readline-library.html</link><description>&lt;p&gt;readline is widely used input lib, all the key bindings are from emacs&lt;/p&gt;
&lt;p&gt;GNU readline key bindings&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;key action  note
^a  moves the cursor to the beginning of the line    a æ˜¯ç¬¬ä¸€ä¸ªå­—æ¯
^b  moves it one position to the left    b æ˜¯ back çš„ç¼©å†™
^c  send SIGINT or KeybordInterrupt 
^d  send eof on empty line  
^d  erase next char 
^e  to the end   e è¡¨ç¤º end
^f   æŠŠå…‰æ ‡å‘å‰ç§»åŠ¨ä¸€æ ¼   f è¡¨ç¤º forward
^h   æŠŠå…‰æ ‡å‘å‰åˆ é™¤     h è¡¨ç¤º histroy?
^i  è‡ªåŠ¨è¡¥å…¨, å’Œ tab åŠŸèƒ½ä¸€æ ·    
^k  åˆ é™¤åˆ°è¡Œå°¾    kè¡¨ç¤ºkill
^y  ç²˜è´´åˆ é™¤çš„å­—ç¬¦  y è¡¨ç¤º yank
^_  undo    
^p  previous    
^n  next    
^r  reverse search  r for reverse
^s  search  s for search
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Using readline in python&lt;/p&gt;
&lt;p&gt;actually the input function is just readline enabled, the missing functionality is history support&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 12:51:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/readline-library.html</guid><category>åº“</category><category>è®¡ç®—æœº</category></item><item><title>Linux å‘½ä»¤è¡Œæ–‡æœ¬å¤„ç†ï¼ˆsed/awk/grep...ï¼‰</title><link>/posts/linux-ming-ling-xing-wen-ben-chu-li-sedawkgrep.html</link><description>&lt;h1&gt;sort&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-d æŒ‰ç…§å­—å…¸æ’åº(é»˜è®¤)
-n æŒ‰ç…§æ•°å­—å¤§å°æ’åº
-f å¿½ç•¥å¤§å°å†™
-g æŒ‰ç…§æµ®ç‚¹æ•°æ’åº
-M æŒ‰ç…§ Jan Feb ç­‰æ’åº

-r é€†åº
-k æŒ‡å®šç¬¬ k åˆ—æ’åº -t æŒ‡å®šåˆ†éš”ç¬¦
-b å¿½ç•¥è¡Œé¦–ç©ºæ ¼å­—ç¬¦
-m æŠŠä¸¤ä¸ªå·²ç»æ’åºçš„æ–‡ä»¶åˆå¹¶
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;uniq åˆå¹¶é‡å¤&lt;/h1&gt;
&lt;p&gt;uniq å‘½ä»¤å‡å®šæ–‡ä»¶æ˜¯å·²ç»æ’åºçš„ï¼Œå› æ­¤åŸºæœ¬è¦æ¥ç€ sort ä½¿ç”¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sort unsorted.txt | uniq&lt;/code&gt; åˆ é™¤é‡å¤è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sort unsorted.txt | uniq -c&lt;/code&gt; ç»Ÿè®¡è¡Œæ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sort unsorted.txt | uniq -d&lt;/code&gt; åªæ˜¾ç¤ºé‡å¤è¡Œ -u åªæ˜¾ç¤ºä¸é‡å¤è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;tr ç¿»è¯‘æŒ‡ä»¤&lt;/h1&gt;
&lt;p&gt;tr "source" "target" å¦‚æœç›®æ ‡å­—ç¬¦ä¸²å¤ªçŸ­çš„åŒ–ï¼Œä½¿ç”¨æœ€åä¸€ä¸ªå­—ç¬¦å¡«å……
tr -d "source" remove
tr -s "source" squeeze extra characters, useful for piping to cut
-c å‚æ•°å¯¹ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²çš„è¡¥é›†
å¯ä»¥ä½¿ç”¨åŒºé—´ a-z 0-9 ç­‰
è¿˜å¯ä»¥ä½¿ç”¨å­—ç¬¦ç±» [:class:]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;alnumï¼šå­—æ¯å’Œæ•°å­—&lt;/li&gt;
&lt;li&gt;alphaï¼šå­—æ¯&lt;/li&gt;
&lt;li&gt;digitï¼šæ•°å­—&lt;/li&gt;
&lt;li&gt;spaceï¼šç©ºç™½å­—ç¬¦&lt;/li&gt;
&lt;li&gt;lowerï¼šå°å†™&lt;/li&gt;
&lt;li&gt;upperï¼šå¤§å†™&lt;/li&gt;
&lt;li&gt;cntrlï¼šæ§åˆ¶ï¼ˆéå¯æ‰“å°ï¼‰å­—ç¬¦&lt;/li&gt;
&lt;li&gt;printï¼šå¯æ‰“å°å­—ç¬¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;cut é€‰å–æŸä¸€åˆ— sort &lt;mode&gt; &lt;which&gt;
æœ‰ä¸‰ç§æ¨¡å¼ -b æŒ‰å­—èŠ‚ -c æŒ‰å­—ç¬¦ -f æŒ‰åŸŸ -d æŒ‡å®šåˆ†éš”ç¬¦
é€‰å–çš„åˆ—å¯ä»¥ä½¿ç”¨:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;i ç¬¬ i è¡Œ&lt;/li&gt;
&lt;li&gt;a,b  i è¡Œå’Œ j è¡Œ&lt;/li&gt;
&lt;li&gt;a-b ç¬¬ i åˆ° j è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;--completment é€‰å–è¡¥é›†
--output-delimiter è¾“å‡º&lt;/p&gt;
&lt;h1&gt;wc&lt;/h1&gt;
&lt;p&gt;ç»Ÿè®¡å•è¯ -c å­—ç¬¦æ•° -w å•è¯æ•° -l è¡Œæ•°&lt;/p&gt;
&lt;h1&gt;nl&lt;/h1&gt;
&lt;p&gt;ç»™æ¯è¡Œæ·»åŠ è¡Œå· -ba æ‰€æœ‰è¡Œ&lt;/p&gt;
&lt;h1&gt;paste&lt;/h1&gt;
&lt;p&gt;æŒ‰åˆ—åˆå¹¶æ–‡æœ¬&lt;/p&gt;
&lt;h1&gt;xargs&lt;/h1&gt;
&lt;p&gt;xargs reformat the data it received and give it to next command. xargs squish all parameters into one line&lt;/p&gt;
&lt;p&gt;-d set delemeters
-t å›æ˜¾å‘½ä»¤
-I æ‰§è¡ŒæŒ‡å®šçš„ Instructionï¼Œéœ€è¦æŒ‡å®šæ“ä½œç¬¦
å¦‚ ls *.md | xargs -t -I "%" cp "%" markdown/
-n output with n args on one line&lt;/p&gt;
&lt;h1&gt;regular expression in shell&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Commands&lt;/th&gt;
&lt;th&gt;BRE&lt;/th&gt;
&lt;th&gt;ERE&lt;/th&gt;
&lt;th&gt;PCRE&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;sed&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;td&gt;-E/-r&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;awk&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;td&gt;-E&lt;/td&gt;
&lt;td&gt;-P&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;Sed&lt;/h1&gt;
&lt;h2&gt;Basic format&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sed options script file
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;by default, sed uses BRE, but you probably want sed -E to enable ERE, see http://liujiacai.net/blog/2014/12/07/regexp-favors/. basically, sed works line by line and do transformation&lt;/p&gt;
&lt;p&gt;s for substitution&lt;/p&gt;
&lt;p&gt;sed s/day/night/OPTION OLDFILE &amp;gt; NEWFILE&lt;/p&gt;
&lt;p&gt;é»˜è®¤åªæ›¿æ¢ç¬¬ä¸€å¤„å‡ºç°, /g æ›¿æ¢æ‰€æœ‰&lt;/p&gt;
&lt;p&gt;/åªæ˜¯é»˜è®¤çš„åˆ†éš”ç¬¦, å¯ä»¥ä»»æ„ä½¿ç”¨, æ¨èä½¿ç”¨:&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &amp;amp; ä½œä¸ºåŒ¹é…åˆ°çš„å­—ç¬¦, ä½¿ç”¨ \1 \2 æ¥è¡¨ç¤ºåŒ¹é…åˆ°çš„åˆ†ç»„, è¿™ç§è¡¨è¾¾æ–¹å¼å€’æ˜¯å’Œ pcreæœ‰äº›ç±»ä¼¼&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ -r(linux) æˆ–è€… -E(mac) æ‰èƒ½å¤Ÿä½¿ç”¨æ‰©å±•çš„posixæ­£åˆ™, ä¸€å®šè¦å¸¦ä¸Šè¿™ä¸¤ä¸ª&lt;/p&gt;
&lt;p&gt;OPTION&lt;/p&gt;
&lt;p&gt;å¤„ç†å‘½ä»¤è¡Œè¾“å…¥è¾“å‡ºçš„æ—¶å€™å¯èƒ½ç»å¸¸éœ€è¦trim, å°¤å…¶æ˜¯å­—ç¬¦ä¸²å¸¦äº†\nçš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;sed -n 's/PATTERN/&amp;amp;/p' file&lt;/p&gt;
&lt;p&gt;sed '/PATTERN/p' file&lt;/p&gt;
&lt;h2&gt;Options&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-i  inplace
-i.bak  inplace with backup
-E/-r   use ERE
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;script&lt;/h2&gt;
&lt;p&gt;sed command syntax: option/pattern/command parameters
pattern selects lines and do command with parameters on those lines&lt;/p&gt;
&lt;h1&gt;awk&lt;/h1&gt;
&lt;h2&gt;basic usage&lt;/h2&gt;
&lt;p&gt;gawk options program varlist file&lt;/p&gt;
&lt;p&gt;gawk, like sed, is also line-oriented&lt;/p&gt;
&lt;h2&gt;vaiables&lt;/h2&gt;
&lt;p&gt;$0  the whole line
$1...$n word in line
NR  number of rows
NF  number of fileds&lt;/p&gt;
&lt;h2&gt;awk program&lt;/h2&gt;
&lt;p&gt;awk 'BEGIN{ } pattern { } END { }' file
BEGIN in used for initilization, and END is used to print out the result, pattern {} is run against each line&lt;/p&gt;
&lt;p&gt;awk 'pattern' file
print lines with the pattern&lt;/p&gt;
&lt;h1&gt;grep&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;grep pattern file1 file2...
grep pattern *
grep pattern -r &amp;lt;dir&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;force grep to show file name: 
    grep pattern file /dev/null&lt;/p&gt;
&lt;h2&gt;options&lt;/h2&gt;
&lt;p&gt;-v  invert search
-r/-R   recursively
-c  count matching lines
-o  printing matched part in differnet lines
-b -o   output offset
-n  with line numbers
-i  ignore case
-l  list matched files
-f  pattern from 
--include   include files for grep
-Z  use \0 as delemeter
-q  no output only return value
-A n    lines after
-B n    lines before
-C n    lines combined&lt;/p&gt;
&lt;h1&gt;ag&lt;/h1&gt;
&lt;p&gt;æŒ‰æ–‡ä»¶è¿‡æ»¤ï¼Œæ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹ï¼Œå¯ä»¥ç”¨&lt;code&gt;ag --list-file-types&lt;/code&gt;æŸ¥çœ‹æ”¯æŒçš„ç±»å‹&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 12:37:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/linux-ming-ling-xing-wen-ben-chu-li-sedawkgrep.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Linux å‘½ä»¤è¡Œæ–‡ä»¶ç®¡ç†</title><link>/posts/linux-ming-ling-xing-wen-jian-guan-li.html</link><description>&lt;h2&gt;get current file path&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash &lt;/span&gt;
&lt;span class="c1"&gt;# Absolute path to this script, e.g. /home/user/bin/foo.sh&lt;/span&gt;
&lt;span class="nv"&gt;SCRIPT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;readlink -f &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Absolute path this script is in, thus /home/user/bin&lt;/span&gt;
&lt;span class="nv"&gt;SCRIPTPATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;dirname &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$SCRIPT&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$SCRIPTPATH&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;è¿™äº›ç¨‹åºåŸºæœ¬éƒ½æœ‰ä¸€ä¸ªæ¨¡å¼ï¼šå¦‚æœä¸ç»™å®šæ–‡ä»¶ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆå°±ä»stdinè¯»å–ï¼Œä» stdout è¾“å‡ºï¼Œéå¸¸é€‚åˆ pipeï¼Œè€Œä¸”ä¸€èˆ¬å¯ä»¥æ¥å—å¤šä¸ªæ–‡ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶æŠŠç»“æœåˆå¹¶&lt;/p&gt;
&lt;h2&gt;ls&lt;/h2&gt;
&lt;p&gt;ls çš„ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å‘½ä»¤ç»„åˆ &lt;code&gt;ls -sail&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;stat å’Œ file&lt;/h2&gt;
&lt;p&gt;stat è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰ä¿¡æ¯ï¼Œfile çŒœæµ‹æ–‡ä»¶çš„ç±»å‹&lt;/p&gt;
&lt;h2&gt;cat&lt;/h2&gt;
&lt;p&gt;cat &amp;gt; fiie1 ä»æ ‡å‡†è¾“å…¥è¯»å–å¹¶æ’å…¥åˆ°file1
cat -ns file -nå‘½ä»¤è¡¨ç¤ºåŠ å…¥è¡Œå·ï¼Œ-s è¡¨ç¤ºå‹ç¼©å¤šä¸ªç©ºè¡Œåˆ°ä¸€ä¸ª&lt;/p&gt;
&lt;h2&gt;chattr&lt;/h2&gt;
&lt;h2&gt;find&lt;/h2&gt;
&lt;h3&gt;Syntax&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;find &amp;lt;dir&amp;gt; [!] &amp;lt;filter&amp;gt; &amp;lt;action&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Filters&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-name   åé¢å¯ä»¥è·Ÿé€šé…ç¬¦
-wholename  
-regex  Match on a whole path -iregex ä¸åŒºåˆ†å¤§å°å†™
-type   æ–‡ä»¶ç±»å‹ f æ–‡ä»¶ d ç›®å½• l é“¾æ¥
-atime/mtime/ctime  ä½¿ç”¨+-åŒºåˆ†æœªæ¥è¿‡å»ï¼Œå¯ä»¥ä½¿ç”¨çš„å•ä½smhdw
-newer file     æ¯”
-size   åé¢è·Ÿå¤§å°å¯ä»¥ä½¿ç”¨ckMGTP
-user/-group/-nouser    ç”¨æˆ·
-perm   æƒé™
-path   åœ¨æ•´ä¸ªè·¯å¾„ä¸­ï¼Œä½¿ç”¨é€šé…ç¬¦
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Actions&lt;/h3&gt;
&lt;p&gt;æ‰§è¡Œçš„åŠ¨ä½œè·Ÿåœ¨-exec/-okåé¢&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;find ... -exec command {} + .. # give all files combined to the command
find ... -exec command {} \; # give each file
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Tips&lt;/h3&gt;
&lt;p&gt;å¦‚æœæ‰“å°å‡ºç»å¯¹è·¯å¾„ï¼Œä½¿ç”¨find $PWD ...&lt;/p&gt;
&lt;h3&gt;find with xargs&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;find ... -print0 | xargs -0 ...&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;A numeric mode is from one to four octal digits (0-7), derived by adding up the bits with values 4, 2, and 1. Omitted digits are assumed to be leading zeros. The first digit selects the set user ID (4) and set group ID (2) and restricted deletion or sticky (1) attributes. The second digit selects permissions for the user who owns the file: read (4), write (2), and execute (1); the third selects permissions for other users in the file's group, with the same values; and the fourth for other users not in the file's group, with the same values.&lt;/p&gt;
&lt;h2&gt;æƒé™&lt;/h2&gt;
&lt;p&gt;Linux æ–‡ä»¶çš„æƒé™å¯ä»¥ä½¿ç”¨0-7çš„å››ä¸ªå…«è¿›åˆ¶æ•°å­—ä»£è¡¨, ç”±1/2/4ä¸‰ä¸ªæ•°å­—ç›¸åŠ è€Œæˆ. çœç•¥çš„æ•°å­—ä¼šè¢«è®¤ä¸ºæ˜¯æŒ‰0æ‰“å¤´çš„. ç¬¬ä¸€ä¸ªæ•°å­—è®¾å®šäº† set user ID(4), set group ID(2) å’Œ é™åˆ¶åˆ é™¤æˆ–è€…å« sticky bit(1). ç¬¬äºŒä¸ªæ•°å­—è®¾å®šäº†æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™: read(4), write(2), execute(1). ç¬¬ä¸‰ä¸ªè®¾å®šäº†æ–‡ä»¶æ‰€åœ¨ç»„çš„æƒé™&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 12:31:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/linux-ming-ling-xing-wen-jian-guan-li.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Jaccard coefficient(æ°æ‹‰å¾·è·ç¦»)</title><link>/posts/jaccard-coefficientjie-la-de-ju-chi.html</link><description>&lt;p&gt;theÂ jaccard indexÂ is a simple measure of how similiar two sets are.
it's simply the ratio of the size of the intersection of the sets and the size of the union of the sets.&lt;/p&gt;
&lt;p&gt;eg. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ifÂ J(A,B)Â is jaccard index between setsÂ AÂ andÂ B
andÂ A = {1,2,3}, B = {2,3,4}, C = {4,5,6},
thenÂ J(A,B) = 2/4 = 0.5,
andÂ J(A,C) = 0/6 = 0,
andÂ J(B,C) = 1/5 = 0.2
so the most &amp;quot;similiar&amp;quot; sets areÂ AÂ andÂ BÂ and the least similiar areÂ AÂ andÂ C
(note alsoÂ J(A,A) = J(B,B) = J(C,C) = 1)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;we have to consider what the values(jaccard coefficient) would be in real world. how are the distributed.&lt;/p&gt;
&lt;p&gt;Jeccard coeffi is not transtive, so, for a set of n sentences, we have to calculate O(n2) times. There is a way to do it in O(n) time&lt;/p&gt;
&lt;p&gt;map N-grams to a set of numbers, then use bit to express whether the N-gram exists in one word/sententce.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;A = mat -&amp;gt; {ma, at} \                              / 101 \    
                    --&amp;gt; {ma(2), ca(1), at(0)} -&amp;gt;         --&amp;gt; &amp;amp;(001), |(111)
B = cat -&amp;gt; {ca, at} /                              \ 011 /
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;J(A, B) = and(A, B)/or(A, B)&lt;/p&gt;
&lt;p&gt;let X = card(A ^ B), let U = card(A U B)
let J(A, B) = X / (X + U)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 09:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/jaccard-coefficientjie-la-de-ju-chi.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>JavaScript DOM API</title><link>/posts/javascript-dom-api.html</link><description>&lt;h2&gt;document object&lt;/h2&gt;
&lt;p&gt;attributes of document object&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;document.titleÂ Â Â Â Â Â Â Â Â Â Â Â Â Â  //è®¾ç½®æ–‡æ¡£æ ‡é¢˜ç­‰ä»·äºHTMLçš„&amp;lt;title&amp;gt;æ ‡ç­¾
document.URLÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  //è®¾ç½®URLå±æ€§ä»è€Œåœ¨åŒä¸€çª—å£æ‰“å¼€å¦ä¸€ç½‘é¡µ
document.fileCreatedDateÂ Â Â Â  //æ–‡ä»¶å»ºç«‹æ—¥æœŸï¼Œåªè¯»å±æ€§
document.fileModifiedDateÂ Â Â  //æ–‡ä»¶ä¿®æ”¹æ—¥æœŸï¼Œåªè¯»å±æ€§
document.fileSizeÂ Â Â Â Â Â Â Â Â Â Â  //æ–‡ä»¶å¤§å°ï¼Œåªè¯»å±æ€§
document.cookieÂ Â Â Â Â Â Â Â Â Â Â Â Â  //è®¾ç½®å’Œè¯»å‡ºcookie
document.charsetÂ Â Â Â Â Â Â Â Â Â Â Â  //è®¾ç½®å­—ç¬¦é›† ç®€ä½“ä¸­æ–‡:gb2312
document.body         // body å…ƒç´ 
document.location.hash/host/href/port          // location
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;methods of document object&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;getElementById() // è¿”å›ä¸€ä¸ª Element
getElementsByName() // æ ¹æ® name å±æ€§è·å¾—å…ƒç´ , è¿”å›ä¸€ä¸ª NodeList
getElementsByTagName() // è¿”å›ä¸€ä¸ª HTMLCollection/NodeList(Webkit)
getElementsByClassName() // è¿”å›ä¸€ä¸ª HTMLCollection
querySelector() // è¿”å›ä¸€ä¸ªç¬¦åˆçš„å…ƒç´ , æ€§èƒ½å¾ˆå·®
querySelectorAll() // è¿”å›æ‰€æœ‰ç¬¦åˆçš„å…ƒç´ ç»„æˆçš„ NodeList, æ€§èƒ½å¾ˆå·®
document.write()
document.createElement()
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;window object&lt;/h2&gt;
&lt;h3&gt;functions in window object&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;setTimeout(func, milliseconds, parameters...)
setInterval(func, milliseconds, parameters...)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NOTE: javascript is asynchonous, even if you set 0 timeout, the function is just put into the execute queue, not invoked immediately.&lt;/p&gt;
&lt;h3&gt;window.location&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;location    setting location will cause the page to redirect to new page
location.href   
location.protocol   
location.host   
location.hostname   
location.port   
location.pathname   
location.search 
location.hash   
location.assign()    go to a new address
location.replace()   go to a new address and do not disturb the history
location.reload()   reload the page
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;window.history&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;history.back()  
history.forward()   
history.go(number)  
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;window.screen&lt;/h3&gt;
&lt;p&gt;window.screen.width screen width, not the viewport width
window.screen.height    screen height&lt;/p&gt;
&lt;h3&gt;alert, confirm and prompt&lt;/h3&gt;
&lt;p&gt;alert   show a message
confirm return a bool by user action
prompt  &lt;/p&gt;
&lt;h2&gt;Same Origin Policy&lt;/h2&gt;
&lt;p&gt;document.domain is the key to decide the origin of a script.&lt;/p&gt;
&lt;p&gt;scripts under different subdomain can set the their document.domain to a same domain, and then then can share the same cookie or communicate&lt;/p&gt;
&lt;p&gt;Cross-Origin Resource Sharing&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 09:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/javascript-dom-api.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Graph Theory</title><link>/posts/graph-theory.html</link><description>&lt;p&gt;å››ä¸ªåŸºç¡€ç®—æ³•&lt;/p&gt;
&lt;p&gt;http://www.cnblogs.com/aiyelinglong/archive/2012/03/26/2418707.html&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 09:18:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/graph-theory.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>memcacheq</title><link>/posts/memcacheq.html</link><description>&lt;h1&gt;memcacheq&lt;/h1&gt;
&lt;p&gt;memcacheq is based on memcachedb which is based on memcached and Berkeley DB
memcachedb adds persistent for memcached by using Berkeley DB and is fully compatible with the memcached API
Â 
memcached API http://www.tutorialspoint.com/memcached/memcached_set_data.htm&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;set key flags exptime bytes [noreply] 
value 
Â 
--&amp;gt; STORED // success
--&amp;gt; ERROR // error
Â 
get key
Â 
--&amp;gt;
VALUE key flags bytes
value
Â 
END
Â 
memcacheq http://memcachedb.org/memcacheq/&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;memcacheq uses only the get and set verb&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 08:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/memcacheq.html</guid><category>åº“</category><category>è®¡ç®—æœº</category></item><item><title>ncurses library</title><link>/posts/ncurses-library.html</link><description>&lt;p&gt;ncurses is a lib for building command line user interface(TUI)&lt;/p&gt;
&lt;p&gt;Hello World&lt;/p&gt;
&lt;h1&gt;include &lt;ncurses.h&gt;&lt;/h1&gt;
&lt;p&gt;int main() { 
    initscr();
    printw("Hello World !!!"); refresh();
    getch();
    endwin();
    return 0; 
} &lt;/p&gt;
&lt;p&gt;åˆå§‹åŒ–æ§åˆ¶å‡½æ•°&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 08:08:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ncurses-library.html</guid><category>åº“</category><category>è®¡ç®—æœº</category></item><item><title>JavaScript å­¦ä¹ ç¬”è®°</title><link>/posts/javascript-xue-xi-bi-ji.html</link><description>&lt;h2&gt;Values&lt;/h2&gt;
&lt;p&gt;ç±»å‹è½¬æ¢&lt;/p&gt;
&lt;p&gt;Object to boolï¼Œå…¨éƒ¨è½¬æ¢ä¸ºTrueï¼ŒåŒ…æ‹¬ [] {}å’Œnew Boolean(false)&lt;/p&gt;
&lt;p&gt;to string é¦–å…ˆè°ƒç”¨toString()ï¼Œå¦‚æœæ²¡æœ‰ç„¶åè°ƒç”¨valueOf()&lt;/p&gt;
&lt;p&gt;to number é¦–å…ˆè°ƒç”¨valueOf(),å¦‚æœæ²¡æœ‰ç„¶åè°ƒç”¨toString()&lt;/p&gt;
&lt;h2&gt;Array&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Array.join()    
Array.reverse() 
Array.sort([func])  // function cmp(a, b) {return a - b;}, implace
Array.concat(val or array)  // combination of python append and extend, will not recursively smash array, return new
Array.slice(a, b)  // allow negative
Array.splice(a, b, replacements...)  // both a and b are inclusive
push/pop    
unshift/shift   
indexOf/lastIndexOf  // return the first find index or -1 if not found
forEach  // no way to good stop the iteration
map  // return a new array
filter   //return the selected elements
every/some  // return true or false, return immediately after the result is dicided 
reduce  //reduce(function(a, b) {}, initial_value), when not supplied, the first element is used as initial value on empty array, no initial value will throw error
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ES5 functional array methods&lt;/h2&gt;
&lt;p&gt;they are both defined as Array.prototype.method and Array.method in firefox&lt;/p&gt;
&lt;h3&gt;common pattern&lt;/h3&gt;
&lt;p&gt;array.method(function(value, index, array) {}, this) // second parameter is treated as this in the function&lt;/p&gt;
&lt;h3&gt;using strings as arrays&lt;/h3&gt;
&lt;p&gt;Array.method.call(str, parameters)&lt;/p&gt;
&lt;h2&gt;this&lt;/h2&gt;
&lt;h3&gt;normal function&lt;/h3&gt;
&lt;p&gt;in ES3 and ES5, this is window by default.
in ES5 strict mode, this is undefined.
in ES6 arrow function, this is inherited from outer function&lt;/p&gt;
&lt;h3&gt;constructor function&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;MyClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;var m = new MyClass(3, 5);&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;this&lt;/code&gt; is the new constructed object, But, if something is returned from the constructor, then the temporary object is thrown&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;MyOtherClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;MyClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;MyOtherClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;method function&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;point.setX = function (x) {
    this.x = x;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;this&lt;/code&gt; is the object&lt;/p&gt;
&lt;h4&gt;tricky closure&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;constfuncs() {&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;funcs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[];&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;funcs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;}&lt;/span&gt; &lt;span class="c1"&gt;// they refers to only one i in the closure, which is 10 in the end&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;funcs&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;funcs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;constfuncs&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="nx"&gt;funcs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]()&lt;/span&gt; &lt;span class="c1"&gt;// returns 10,&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;call and apply&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;func.call(obj, params...)&lt;/code&gt; is equal to obj.func(params...)
&lt;code&gt;func.apply(obj, [params...])&lt;/code&gt;
&lt;code&gt;func.bind(obj)&lt;/code&gt; will return a function with &lt;code&gt;this&lt;/code&gt; bound as obj to the function&lt;/p&gt;
&lt;p&gt;call any method against null or undefined will result in TypeError
Â 
by default &lt;code&gt;this&lt;/code&gt; for a function in strict mode is undefined
Â 
+ prefer both operands to be numbers, comparison prefers both operands to be strings
Â 
if a property is not found in a object, it's looked up in the prototype, if not, it's looked up
object created by new 's prototype is the constructor's prototype
object created by
Â 
Â &lt;/p&gt;
&lt;h1&gt;class&lt;/h1&gt;
&lt;p&gt;if two instances inherited from the same prototype, we say then are inherited from the same class. by default, the prototype is constructor's prototype
Â &lt;/p&gt;
&lt;h2&gt;subclassing&lt;/h2&gt;
&lt;p&gt;SubClass.prototype = Object.create(Base.prototype)
SubClass.prototype.constructor = SubClass
Â &lt;/p&gt;
&lt;h1&gt;Regular Expression&lt;/h1&gt;
&lt;p&gt;syntax: /regexp/modifier
Â 
Modifiers:
Â 
i
ignore case
g
global, if not sepcified, return only one match
m
multiline
Â 
String expression methods:
Â 
String.search(pattern)
return first matched index or -1
String.replace(pattern, replacement)
back reference is used as $n, replacement can be a function
String.match(pattern)
return an array of matched groups, [0] is the whole match, [n] being each group
String.split(pattern)
return a splited elements
Â 
Regexp methods:
Â 
regexp.exec(String)
equals to String.match(regexp)
regexp.test(String)
true or false
regexp.exec(String) can be called multitimes for a string when regexp is not global mode. Each returns the 
Â &lt;/p&gt;
&lt;h1&gt;Date&lt;/h1&gt;
&lt;h2&gt;Constructs&lt;/h2&gt;
&lt;p&gt;new Data();
new Date(milliseconds);
new Data(datestring);
new Data(y, m, d, h, m, s, ms);
Â &lt;/p&gt;
&lt;h2&gt;methods&lt;/h2&gt;
&lt;p&gt;date.toString() returnÂ  a time string
date.valueOf() returns timestamp
Date.now() returns current timestamp
Date.parse() returns a timestamp
Date.UTC(y, m, d, h, m, s, ms) returns utc timestamp
Â &lt;/p&gt;
&lt;h1&gt;Globals&lt;/h1&gt;
&lt;p&gt;encodeURI()
encode URI to %xx syntax
encodeURIComponent
encode every character including /?=+,#
decodeURI
Â 
decodeURIComponent
Â 
isFinite()
Â 
isNaN
Â 
parseInt
Â 
parseFloat
Â 
Infinity
Â 
Â 
Â &lt;/p&gt;
&lt;h1&gt;Math&lt;/h1&gt;
&lt;p&gt;Math.random() // -&amp;gt; random number between 0 and 1
Â 
Number
Â 
Number.MAX_VALUE, Number.MIN_VALUE, Number.NaN, Number.NEGATIVE_INFINITY, Number.POSITIVE_INFINITY
Â &lt;/p&gt;
&lt;h1&gt;String&lt;/h1&gt;
&lt;p&gt;String.charAt()
String.charCodeAt()
String.concat()
String.indexOf/lastIndexOf()
String.slice()
String.substr(start, length)
String.substring(from, to)
String.toLowerCase()/toUpperCase()
String.trim()&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:53:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/javascript-xue-xi-bi-ji.html</guid><category>JavaScript</category><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>Chrome Hotkeys</title><link>/posts/chrome-hotkeys.html</link><description>&lt;p&gt;In Omnibar, press tab after a search-able website will search for the website
prefix ? will search forcefully&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;âŒ˜T  Open a new tab
â‡§âŒ˜T Reopen tab just closed
âŒ˜W  colse a tab
âŒ˜âŒ¥â†’ Go to left tab
âŒ˜[  / Delete    Go back in history
âŒ˜]  / Delete    Go forward in history
âŒ˜M  minimize
â‡§âŒ˜B show/hide bookmark bar
â‡§âŒ˜J Open Downloads
âŒ˜Y  Open History
âŒ˜L  omni bar
âŒ˜R  reload page
âŒ˜F  find
âŒ˜G / â  find next
âŒ˜âŒ¥I Inspect element
âŒ˜âŒ¥J JavaScript Console
âŒ˜+Shift+D   Save all tabs in one folder
^âŒ˜F Full screen(Mac style)
âŒ˜-Shift-FÂ   Real Full Screen
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:50:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/chrome-hotkeys.html</guid><category>å°æŠ€å·§</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>gitbook</title><link>/posts/gitbook.html</link><description>&lt;p&gt;Summary.md è¿™ä¸ªæ–‡ä»¶ç›¸å¯¹äºæ˜¯ä¸€æœ¬ä¹¦çš„ç›®å½•ç»“æ„ã€‚æ¯”å¦‚SUMMARY.mdÂ :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Summary
* [Introduction](README.md)
* [åŸºæœ¬å®‰è£…](howtouse/README.md)
   * [Node.jså®‰è£…](howtouse/nodejsinstall.md)
   * [Gitbookå®‰è£…](howtouse/gitbookinstall.md)
   * [Gitbookå‘½ä»¤è¡Œé€Ÿè§ˆ](howtouse/gitbookcli.md)
* [å›¾ä¹¦é¡¹ç›®ç»“æ„](book/README.md)
   * [README.md ä¸ SUMMARYç¼–å†™](book/file.md)
   * [ç›®å½•åˆå§‹åŒ–](book/prjinit.md)
* [å›¾ä¹¦è¾“å‡º](output/README.md)
   * [è¾“å‡ºä¸ºé™æ€ç½‘ç«™](output/outfile.md)
   * [è¾“å‡ºPDF](output/pdfandebook.md)
* [å‘å¸ƒ](publish/README.md)
   * [å‘å¸ƒåˆ°Github Pages](publish/gitpages.md)
* [ç»“æŸ](end/README.md)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;SUMMARY.mdåŸºæœ¬ä¸Šæ˜¯åˆ—è¡¨åŠ é“¾æ¥çš„è¯­æ³•ã€‚é“¾æ¥ä¸­å¯ä»¥ä½¿ç”¨ç›®å½•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:50:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/gitbook.html</guid><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>Macbook tricks</title><link>/posts/macbook-tricks.html</link><description>&lt;p&gt;ç”¨èµ·æ¥çš„ç¡®çˆ½ï¼Œè§†ç½‘è†œå±å¹•ç»å¯¹æ‰“å¼€æ–°çš„ä¸–ç•Œ&lt;/p&gt;
&lt;p&gt;4kå±å¹•æ‰“å¼€å¦ä¸€ä¸ªä¸–ç•Œï¼Œä¸€ä¸ªå±å¹•å¯ä»¥å¼€4ä¸ªçª—å£ï¼Œå“ˆå“ˆ&lt;/p&gt;
&lt;p&gt;PYTHONPATH å˜é‡ä¼šå¹²æ‰°brewå®‰è£…çš„python3&lt;/p&gt;
&lt;p&gt;Dockæ”¾åœ¨å·¦è¾¹ï¼Œè®¾ç½®F1ï¼Œè®¾ç½®è½»è§¦ï¼Œè®¾ç½®å…¨å±€æ§åˆ¶ ä½¿ç”¨tabé”®åˆ‡æ¢&lt;/p&gt;
&lt;p&gt;You can make movie with quick time&lt;/p&gt;
&lt;p&gt;Option + Command +Esc å¼ºåˆ¶é€€å‡ºç¨‹åº&lt;/p&gt;
&lt;p&gt;Homebrew + iterm2 çœŸä¹ƒç¥å™¨
Brew cask is a good thing &lt;/p&gt;
&lt;p&gt;Hold option+command and mouse to do a block selection&lt;/p&gt;
&lt;p&gt;Weird, mac echo not working with \e but \033&lt;/p&gt;
&lt;p&gt;ç»™pycharmæ·»åŠ PYTHONPATHï¼Œä¹Ÿä¸çŸ¥é“æ˜¯å“ªä¸ªå¼„å¯¹äº†&lt;/p&gt;
&lt;h1&gt;å¿«é€Ÿè®¾ç½®ä¸€å°æ–°çš„ Mac&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;0. Install iterm2, 
    a. set the color scheme to solarized and 
    b. change alt key to esc+
    c. Set font to monaco for powerline
1. install Homebrew from http://brew.sh
2. Generate a new ssh key by:
    a.     `ssh-keygen`
    b.     `ssh-add ~/.ssh/id_rsa`
3.  install zsh: 
4. install go and python: `brew install go python python3`
5. install tmux: `brew install tmux`
6. install dotfiles: `git clone git@github.com:yifeikong/dotfiles .dotfiles`
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å¿«æ·é”®&lt;/h1&gt;
&lt;p&gt;Command-H éšè—æœ€å‰ç«¯åº”ç”¨çš„çª—å£ã€‚è¦æŸ¥çœ‹æœ€å‰ç«¯çš„åº”ç”¨ä½†éšè—æ‰€æœ‰å…¶ä»–åº”ç”¨ï¼Œè¯·æŒ‰ Command-Option-Hã€‚&lt;/p&gt;
&lt;p&gt;Option-Command-= æœ€å¤§åŒ–çª—å£&lt;/p&gt;
&lt;p&gt;Command-M å°†æœ€å‰ç«¯çš„çª—å£æœ€å°åŒ–è‡³ Dockã€‚è¦æœ€å°åŒ–æœ€å‰ç«¯åº”ç”¨çš„æ‰€æœ‰çª—å£ï¼Œè¯·æŒ‰ Command-Option-Mã€‚&lt;/p&gt;
&lt;p&gt;Command-W å…³é—­æœ€å‰ç«¯çš„çª—å£ã€‚è¦å…³é—­è¯¥åº”ç”¨çš„æ‰€æœ‰çª—å£ï¼Œè¯·æŒ‰ Command-Option-Wã€‚&lt;/p&gt;
&lt;p&gt;Option-Command-Esc å¼ºåˆ¶é€€å‡ºï¼šé€‰æ‹©è¦å¼ºåˆ¶é€€å‡ºçš„åº”ç”¨ã€‚æˆ–è€…ï¼ŒæŒ‰ä½ Command-Shift-Option-Esc 3 ç§’é’Ÿå¯ä»…å¼ºåˆ¶æœ€å‰ç«¯çš„åº”ç”¨é€€å‡ºã€‚&lt;/p&gt;
&lt;p&gt;Shift-Command-3 å±å¹•å¿«ç…§ï¼šæ‹æ‘„æ•´ä¸ªå±å¹•çš„å±å¹•å¿«ç…§ã€‚äº†è§£æ›´å¤šå±å¹•å¿«ç…§å¿«æ·é”®ã€‚&lt;/p&gt;
&lt;p&gt;Command-é€—å·Â (,) åå¥½è®¾ç½®ï¼šæ‰“å¼€æœ€å‰ç«¯åº”ç”¨çš„åå¥½è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;Controlâ€“Commandâ€“ç”µæºæŒ‰é’® å¼ºåˆ¶ Mac é‡æ–°å¯åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;Controlâ€“Shiftâ€“ï¼ˆç”µæºæŒ‰é’®æˆ–ä»‹è´¨æ¨å‡ºé”®ï¼‰å°†æ˜¾ç¤ºå™¨ç½®äºç¡çœ çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;Command-D ä»â€œæ‰“å¼€â€å¯¹è¯æ¡†æˆ–â€œå­˜å‚¨â€å¯¹è¯æ¡†ä¸­é€‰æ‹©â€œæ¡Œé¢â€æ–‡ä»¶å¤¹ã€‚&lt;/p&gt;
&lt;p&gt;Option-Delete åˆ é™¤æ’å…¥ç‚¹å·¦è¾¹çš„å­—è¯ã€‚&lt;/p&gt;
&lt;p&gt;Fn-Deleteåœ¨æ²¡æœ‰å‘å‰åˆ é™¤é”®çš„é”®ç›˜ä¸Šå‘å‰åˆ é™¤ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ Control-Dã€‚&lt;/p&gt;
&lt;p&gt;Command-Delete åœ¨åŒ…å«â€œåˆ é™¤â€æˆ–â€œä¸å­˜å‚¨â€æŒ‰é’®çš„å¯¹è¯æ¡†ä¸­é€‰æ‹©â€œåˆ é™¤â€æˆ–â€œä¸å­˜å‚¨â€ã€‚&lt;/p&gt;
&lt;p&gt;Fnâ€“ä¸Šç®­å¤´ å‘ä¸Šç¿»é¡µï¼šå‘ä¸Šæ»šåŠ¨ä¸€é¡µã€‚Â &lt;/p&gt;
&lt;p&gt;Commandâ€“ä¸Šç®­å¤´ å°†æ’å…¥ç‚¹ç§»è‡³æ–‡ç¨¿å¼€å¤´ã€‚&lt;/p&gt;
&lt;p&gt;Commandâ€“å·¦ç®­å¤´ å°†æ’å…¥ç‚¹ç§»è‡³å½“å‰è¡Œçš„è¡Œé¦–ã€‚&lt;/p&gt;
&lt;p&gt;Optionâ€“å·¦ç®­å¤´ å°†æ’å…¥ç‚¹ç§»è‡³ä¸Šä¸€å­—è¯çš„è¯é¦–ã€‚&lt;/p&gt;
&lt;p&gt;Optionâ€“å·¦ç®­å¤´ å°†æ’å…¥ç‚¹ç§»è‡³ä¸Šä¸€å­—è¯çš„è¯é¦–ã€‚&lt;/p&gt;
&lt;p&gt;Control-L å°†å…‰æ ‡æˆ–æ‰€é€‰å†…å®¹ç½®äºå¯è§åŒºåŸŸä¸­å¤®ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:46:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/macbook-tricks.html</guid><category>å°æŠ€å·§</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>pthread</title><link>/posts/pthread.html</link><description>&lt;p&gt;pthreads online reference&lt;/p&gt;
&lt;p&gt;https://computing.llnl.gov/tutorials/pthreads/
http://pages.cs.wisc.edu/~travitch/pthreads_primer.html&lt;/p&gt;
&lt;p&gt;pthread does not define semphore&lt;/p&gt;
&lt;p&gt;http://blog.jobbole.com/59676/ ACTOR vs PROACTOR&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:43:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/pthread.html</guid><category>å¹¶å‘ç¼–ç¨‹</category><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Ngram</title><link>/posts/ngram.html</link><description>&lt;p&gt;ng&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:42:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ngram.html</guid><category>è®¡ç®—æœº</category><category>æœºå™¨å­¦ä¹ </category></item><item><title>decompile apk</title><link>/posts/decompile-apk.html</link><description>&lt;h1&gt;jadx[1]&lt;/h1&gt;
&lt;h2&gt;compile and install jadx&lt;/h2&gt;
&lt;p&gt;mkdir jadx
git clone https://github.com/skylot/jadx.git
cd jadx
./gradlew dist   # you might need to wait on this&lt;/p&gt;
&lt;h2&gt;decompile apk&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;1. change apk to zip file and unzip it
2. copy out the class.dex file
3. build/jadx/bin/jadx -d OUTDIR PATH_TO_CLASS.DEX
or jadxgui PATH
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;å·¥å…·&lt;/h1&gt;
&lt;p&gt;apk studio&lt;/p&gt;
&lt;p&gt;å¦‚ä½• signï¼šhttps://www.nevermoe.com/?p=373&lt;/p&gt;
&lt;p&gt;smali code tutorialï¼š https://forum.xda-developers.com/showthread.php?t=2193735&lt;/p&gt;
&lt;p&gt;ä¸€ç¯‡å¾ˆå¥½çš„pdfçš„æ–‡æ¡£ï¼Œåˆ©ç”¨smali codeï¼šhttp://www.security-assessment.com/files/documents/whitepapers/Bypassing%20SSL%20Pinning%20on%20Android%20via%20Reverse%20Engineering.pdf&lt;/p&gt;
&lt;p&gt;å®‰å“ä¸­ pinning çš„åŸç†&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨è‡ªå·±çš„keystoreå®ä¾‹åŒ– TrustManagerFactory&lt;/p&gt;
&lt;p&gt;å…³é”®è¯­å¥&lt;/p&gt;
&lt;p&gt;InputStream in = resources.openRawResource(certificateRawResource);//file name of res/raw keyStore = KeyStore.getInstance("BKS"); keyStore.load(resourceStream, password);&lt;/p&gt;
&lt;p&gt;http://fdwills.github.io/diary/2014/06/13/ssl-pinning.html&lt;/p&gt;
&lt;p&gt;ä¸€äº›ç°æˆçš„ å·¥å…·&lt;/p&gt;
&lt;p&gt;https://github.com/ac-pm/SSLUnpinning_Xposed  xposed æ’ä»¶ï¼Œå·²æµ‹è¯•ä¸å¥½ç”¨
https://github.com/iSECPartners/Android-SSL-TrustKiller éœ€è¦cydia&lt;/p&gt;
&lt;p&gt;è±Œè±†èšå•†åº—ä¸­æœ‰ä¸€ä¸ª xposed installer miuiä¸“ç‰ˆï¼Œä½¿ç”¨è¿™ä¸ªå¯ä»¥å¾ˆå¥½åœ°å®‰è£… xposed&lt;/p&gt;
&lt;p&gt;ä¹‹åå®‰è£…&lt;/p&gt;
&lt;p&gt;å¦ä¸€åªç§æ€è·¯ï¼Œæ‰¾åˆ°ï¼Œæ‰¾åˆ°bksæ–‡ä»¶ï¼Œæ›¿æ¢æ‰ï¼Œé‡æ–°æ‰“åŒ…ï¼Œç­¾å&lt;/p&gt;
&lt;p&gt;https://stackoverflow.com/questions/30708548/how-to-modify-the-data-in-the-assets-folder-in-existing-apk-programmatically&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€äº›å·¥å…·&lt;/p&gt;
&lt;p&gt;https://github.com/ac-pm/Inspeckage&lt;/p&gt;
&lt;p&gt;https://github.com/iSECPartners/Android-SSL-TrustKiller  éœ€è¦cydia&lt;/p&gt;
&lt;p&gt;https://github.com/iSECPartners/android-ssl-bypass ä¸€ä¸ªåŸºç¡€å·¥å…·ï¼Œé€šè¿‡æ›¿æ¢trust managerå®ç°&lt;/p&gt;
&lt;p&gt;arm æ±‡ç¼–æ•™ç¨‹&lt;/p&gt;
&lt;p&gt;https://mp.weixin.qq.com/s/DKeXqzE6bj5t0eWTkLLCBQ&lt;/p&gt;
&lt;p&gt;[1] http://www.jianshu.com/p/65c2f447946e&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:31:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/decompile-apk.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>å…³äºæ¨å¹¿å’Œå†·å¯åŠ¨çš„ä¸€äº›æƒ³æ³•</title><link>/posts/guan-yu-tui-yan-he-leng-qi-dong-de-yi-xie-xiang-fa.html</link><description>&lt;p&gt;æ€»ä½“æ€è·¯ä¸»è¦ä¸¤ä¸ªï¼Œä¸€ä¸ªå°±æ˜¯å€ŸåŠ©äºæœç´¢å¼•æ“ï¼Œå¦ä¸€ä¸ªå°±æ˜¯å€ŸåŠ©äº SNSã€‚ä¸è¿‡ä¸¤ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯å®Œå…¨å¯¹ç«‹çš„ï¼Œæ¯”å¦‚è¯´åœ¨çŸ¥ä¹çš„ç­”æ¡ˆä¸­æåˆ°è‡ªå·±çš„å…¬ä¼—å·æˆ–è€… appï¼Œé‚£ä¹ˆæ—¢æ˜¯ä¸€ç§ç¤¾ä¼šåŒ–æ¨å¹¿ï¼ˆç²‰ä¸ä¼šçœ‹åˆ°ï¼‰ï¼Œä¹Ÿæ˜¯ä¸€ç§å¾ˆå¥½çš„æœç´¢å¼•æ“æ¨å¹¿ï¼ˆçŸ¥ä¹çš„æƒé‡å¾ˆé«˜ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è·å¾—æ–°å¢ç”¨æˆ·æ— éä¸¤ä¸ªæ‰‹æ®µï¼Œä¸€ä¸ªæ˜¯ä¸»åŠ¨æ‹‰æ–°ç”¨æˆ·ï¼Œæ¯”å¦‚å» QQ ç¾¤ä¸­å®£ä¼ ï¼›å¦ä¸€ä¸ªæ˜¯è¢«åŠ¨è·å¾—ï¼Œåç­‰å…¶ä»–äººé€šè¿‡æœç´¢å¼•æ“å‘ç°è‡ªå·±çš„ç½‘ç«™ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;æ¨å¹¿çš„å¹³å°&lt;/h1&gt;
&lt;h2&gt;ä¸€äº›æƒé‡æ¯”è¾ƒé«˜çš„ç½‘ç«™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;çŸ¥ä¹&lt;/li&gt;
&lt;li&gt;çŸ¥ä¹ä¸“æ &lt;/li&gt;
&lt;li&gt;å¾®åš&lt;/li&gt;
&lt;li&gt;è±†ç“£&lt;/li&gt;
&lt;li&gt;CSDN &lt;a href="https://blog.csdn.net/ivan_/article/details/74398261"&gt;ä¸€ä¸ªæ¨å¹¿èŠ¯ç‰‡çš„ä¾‹å­&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;cnblogs&lt;/li&gt;
&lt;li&gt;ç®€ä¹¦&lt;/li&gt;
&lt;li&gt;è´´å§&lt;/li&gt;
&lt;li&gt;GitHubã€‚åœ¨ GitHub ä»“åº“ä¸­çš„å†…å®¹ä¼¼ä¹ä¹Ÿä¸é”™&lt;/li&gt;
&lt;li&gt;medium&lt;/li&gt;
&lt;li&gt;V2EX&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å¯ä»¥æäº¤é“¾æ¥çš„ç½‘ç«™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;reddit&lt;/li&gt;
&lt;li&gt;Hacker News&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å‘é€è‡ªå·±æ–‡ç« é“¾æ¥çš„å¹³å°&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;QQ ç¾¤&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;SEO&lt;/h2&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆéœ€è¦ SEOï¼Ÿå› ä¸ºä½ ç¼ºå°‘ä¸€ä¸ªè®©ç”¨æˆ·å¯ä»¥æŒç»­æ¥è§¦åˆ°ä½ çš„äº§å“çš„æ¸ é“ã€‚é—®é¢˜åœ¨äºProduct Hunt å’ŒHacker Newsä¸Šçš„ç”¨æˆ·å¯èƒ½å¹¶ä¸æ˜¯ä½ äº§å“çš„ç›®æ ‡å®¢æˆ·ï¼Œä»–ä»¬ä»…ä»…æ˜¯äº†è§£ä»Šå¤©å‘å¸ƒäº†ä»€ä¹ˆæ–°çš„äº§å“ï¼Œç„¶åç»§ç»­å¹²ä»–ä»¬è‡ªå·±çš„äº‹æƒ…ã€‚é‚£äº›çœŸæ­£çš„ç”¨æˆ·ï¼Œæ˜¯å¾ˆéš¾é è¿™ç§æ–¹æ³•è·å–åˆ°çš„ã€‚&lt;/p&gt;
&lt;p&gt;äº¤æ¢å‹é“¾è¿™ç§è¡Œä¸ºåŸºæœ¬ä¸Šå·²ç»è¿‡æ—¶äº†ï¼Œç°åœ¨æ˜¯å†…å®¹æ›´é‡è¦ã€‚æ‰€ä»¥é¦–å…ˆä½ éœ€è¦å†™ç‚¹ä»€ä¹ˆï¼Œå“ªæ€•ä½ ä»˜é’±è®©åˆ«äººå†™ä¹Ÿå¥½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå¯è¡Œçš„ç­–ç•¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å†™ä¸€äº›æœ‰è¶£çš„ï¼Œæœ‰ç”¨çš„ä¸œè¥¿&lt;/li&gt;
&lt;li&gt;å°†ç«™ç‚¹çš„é“¾æ¥ï¼Œæ”¾åˆ°ä½ æƒ³ä¸»æ¨çš„å…³é”®è¯é‡Œé¢å»&lt;/li&gt;
&lt;li&gt;åœ¨å†…å®¹å¹³å°ä¸Šè¿›è¡Œå‘å¸ƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;å†…å®¹&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å½“æœç´¢ä¸€ä¸ªé—®é¢˜æ²¡æœ‰å¥½çš„æ–‡ç« æˆ–è€…å›ç­”çš„æ—¶å€™ï¼Œè‡ªå·±å†™ä¸€ä¸ªï¼Œå¹¶æŠŠè¿æ¥è´´åˆ°å¯¹æ–¹çš„è¯„è®ºåŒº&lt;/li&gt;
&lt;li&gt;è‡ªå·±å†™äº†ä¸€ä¸ªæ–‡ç« ä¹‹åï¼Œæœç´¢ç›¸å…³çš„å…³é”®å­—ï¼Œç„¶åæŠŠè‡ªå·±çš„æ–‡ç« è´´åˆ°è¯„è®ºåŒº&lt;/li&gt;
&lt;li&gt;æŠŠé“¾æ¥æäº¤åˆ° reddit ç­‰ç¤¾åŒº&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;çŸ¥ä¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨çŸ¥ä¹ç­”é¢˜ï¼Œè¦å¸¦ä¸Šè‡ªå·±çš„å…¬ä¼—å·ã€å¤´æ¡å·å’Œåšå®¢&lt;/li&gt;
&lt;li&gt;å¦‚æœä½ ç¡®ä¿¡è‡ªå·±ç­”å¾—æ¯”è¾ƒå¥½ï¼Œå¯ä»¥æŠ€æœ¯æ€§è¸©å…¶ä»–çš„ç­”æ¡ˆï¼ˆè¿™ä¸ªé—®é¢˜é‡Œçš„å…¶ä»–å›ç­”éƒ½æ˜¯åƒåœ¾ï¼Œå®ååå¯¹æœ€é«˜ç¥¨çš„ç­”æ¡ˆï¼‰&lt;/li&gt;
&lt;li&gt;ç­”æ¡ˆæœ¬èº«éœ€è¦ä¼˜è´¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;å¤´æ¡&lt;/h2&gt;
&lt;p&gt;å¤´æ¡ä¸Šçš„ä¸å°‘è¯„è®ºæ–‡ç« å¹¶æ²¡æœ‰ä»€ä¹ˆæ·±å…¥çš„è§‚ç‚¹ï¼Œç”šè‡³æ ¹æœ¬ä¸è¶³ä»¥ç§°ä½œä¸€ç¯‡æ–‡ç« ï¼Œä½†æ˜¯å› ä¸ºè¹­çƒ­ç‚¹ï¼Œåå€’è¯„è®ºé‡Œé¢å¾ˆå¤šå®£æ³„æƒ…ç»ªçš„äººï¼Œç”šè‡³éƒ½ä¸è¯»æ–‡ç« ï¼Œç›´æ¥å¼€éª‚çš„ï¼Œè¿™æ ·åå€’åˆºæ¿€äº†æ¨èç³»ç»ŸæŠŠè¿™ç§æ–‡ç« æ¨ç»™æ›´å¤šçš„äººã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/guan-yu-tui-yan-he-leng-qi-dong-de-yi-xie-xiang-fa.html</guid><category>åˆ›ä¸š</category><category>è¿è¥ä¸äº§å“</category></item><item><title>å¦‚ä½•åšä¸€ä¸ª Code Review</title><link>/posts/ru-he-zuo-yi-ge-code-review.html</link><description>&lt;p&gt;è½¬è½½è‡ªï¼šhttps://mp.weixin.qq.com/s?__biz=MzIwMzg1ODcwMw==&amp;amp;mid=2247486399&amp;amp;idx=1&amp;amp;sn=219af64c7ecbf9e6c601cefddd0a0eba&amp;amp;source=41#wechat_redirect&lt;/p&gt;
&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨å›¢é˜Ÿä¸­è¿›è¡Œä»£ç å®¡æŸ¥ï¼ˆCode Reviewï¼‰å¯ä»¥æå‡ä»£ç è´¨é‡ï¼Œåˆ†äº«é¡¹ç›®çŸ¥è¯†ã€æ˜ç¡®è´£ä»»ï¼Œæœ€ç»ˆè¾¾åˆ°æ„å»ºæ›´å¥½çš„è½¯ä»¶ã€æ›´å¥½çš„å›¢é˜Ÿã€‚å¦‚æœä½ èŠ±å‡ ç§’é’Ÿæœç´¢ä»£ç å®¡æŸ¥çš„ç›¸å…³ä¿¡æ¯ï¼Œä½ ä¼šçœ‹åˆ°è®¸å¤šå…³äºä»£ç å®¡æŸ¥å¸¦æ¥çš„ä»·å€¼çš„æ–‡ç« ã€‚ä¹Ÿæœ‰è®¸å¤šæ–¹æ³•æ¥è¿›è¡Œä»£ç å®¡æŸ¥ï¼šåœ¨GitHubä¸­æpull requestï¼Œæˆ–ä½¿ç”¨åƒJetBrainsçš„Upsourceä¹‹ç±»çš„å·¥å…·ã€‚ç„¶è€Œå³ä½¿æ‹¥æœ‰æ¸…æ™°çš„æµç¨‹å’Œæ­£ç¡®çš„å·¥å…·ï¼Œè¿˜é—ç•™äº†ä¸€ä¸ªå¤§é—®é¢˜éœ€è¦è§£å†³â€”â€”æˆ‘ä»¬éœ€è¦æ‰¾å¯»å“ªäº›é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¯èƒ½æ²¡æœ‰æ˜ç¡®å…³äºâ€œæˆ‘ä»¬éœ€è¦æ‰¾å¯»å“ªäº›é—®é¢˜â€çš„æ–‡ç« ï¼Œæ˜¯å› ä¸ºæœ‰è®¸å¤šä¸åŒçš„è¦ç‚¹éœ€è¦è€ƒè™‘ã€‚æ­£å¦‚ä»»ä½•å…¶ä»–çš„éœ€æ±‚ï¼Œå„ä¸ªå›¢é˜Ÿå¯¹å„ä¸ªæ–¹é¢éƒ½æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡çš„ç›®æ ‡æ˜¯åˆ—å‡ºä¸€äº›å®¡æŸ¥è€…å¯ä»¥æ‰¾å¯»çš„è¦ç‚¹ï¼Œè€Œå„ä¸ªæ–¹é¢çš„ä¼˜å…ˆçº§å°±å› å„ä¸ªå›¢é˜Ÿè€Œå¼‚äº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹å¤§å®¶åœ¨ä»£ç å®¡æŸ¥æ—¶ä¼šè®¨è®ºåˆ°çš„é—®é¢˜ã€‚å¯¹äºä»£ç çš„æ ¼å¼ã€æ ·å¼å’Œå‘½åä»¥åŠç¼ºå°‘æµ‹è¯•è¿™äº›é—®é¢˜æ˜¯å¾ˆå¸¸è§çš„å‡ ç‚¹ã€‚å¦‚æœä½ æƒ³æ‹¥æœ‰å¯æŒç»­çš„ã€å¯ç»´æŠ¤çš„ä»£ç ï¼Œè¿™äº›æ˜¯æœ‰ç”¨çš„æ£€æŸ¥ç‚¹ã€‚ç„¶è€Œï¼Œåœ¨ä»£ç å®¡æŸ¥æ—¶è®¨è®ºè¿™äº›å°±æœ‰äº›æµªè´¹æ—¶é—´ï¼Œå› ä¸ºå¾ˆå¤šè¿™æ ·çš„æ£€æŸ¥å¯ä»¥ï¼ˆä¹Ÿåº”è¯¥ï¼‰è¢«è‡ªåŠ¨åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;é‚£å“ªäº›è¦ç‚¹æ˜¯åªèƒ½ç”±äººå·¥è¿›è¡Œå®¡æŸ¥è€Œä¸èƒ½ä¾é å·¥å…·çš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å›ç­”æ˜¯æœ‰æƒŠäººæ•°é‡çš„ç‚¹åªèƒ½ç”±äººå·¥è¿›è¡Œå®¡æŸ¥ã€‚åœ¨æœ¬æ–‡å‰©ä¸‹çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šè¦†ç›–ä¸€ç³»åˆ—å¹¿æ³›çš„ç‰¹æ€§ï¼Œå¹¶æ·±å…¥å…¶ä¸­çš„ä¸¤ç‚¹å…·ä½“çš„åŒºåŸŸï¼šæ€§èƒ½å’Œå®‰å…¨ã€‚&lt;/p&gt;
&lt;h1&gt;è®¾è®¡&lt;/h1&gt;
&lt;p&gt;å¦‚ä½•è®©æ–°ä»£ç ä¸å…¨å±€çš„æ¶æ„ä¿æŒä¸€è‡´ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦éµå¾ªSOLIDåŸåˆ™ï¼Œæ˜¯å¦éµå¾ªå›¢é˜Ÿä½¿ç”¨çš„è®¾è®¡è§„èŒƒï¼Œå¦‚é¢†åŸŸé©±åŠ¨å¼€å‘ç­‰ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ–°ä»£ç ä½¿ç”¨äº†ä»€ä¹ˆè®¾è®¡æ¨¡å¼ï¼Ÿè¿™æ ·ä½¿ç”¨æ˜¯å¦åˆé€‚ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åŸºç¡€ä»£ç æ˜¯å¦æœ‰ç»“åˆä½¿ç”¨äº†ä¸€äº›æ ‡å‡†æˆ–è®¾è®¡æ ·å¼ï¼Œæ–°çš„ä»£ç æ˜¯å¦éµå¾ªå½“å‰çš„è§„èŒƒï¼Ÿä»£ç æ˜¯å¦æ­£ç¡®è¿ç§»ï¼Œæˆ–å‚ç…§äº†å› ä¸è§„èŒƒè€Œæ·˜æ±°çš„æ—§ä»£ç ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»£ç çš„ä½ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿæ¯”å¦‚æ¶‰åŠè®¢å•çš„æ–°ä»£ç æ˜¯å¦åœ¨è®¢å•æœåŠ¡ç›¸å…³çš„ä½ç½®ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ–°ä»£ç æ˜¯å¦é‡ç”¨äº†ç°å­˜çš„ä»£ç ï¼Ÿæ–°ä»£ç æ˜¯å¦å¯ä»¥è¢«ç°æœ‰ä»£ç é‡ç”¨ï¼Ÿæ–°ä»£ç æ˜¯å¦æœ‰é‡å¤ä»£ç ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œæ˜¯å¦åº”è¯¥é‡æ„æˆä¸€ä¸ªæ›´å¯è¢«é‡ç”¨çš„æ¨¡å¼ï¼Œè¿˜æ˜¯å½“å‰è¿˜å¯ä»¥æ¥å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ–°ä»£ç æ˜¯å¦è¢«è¿‡åº¦è®¾è®¡äº†ï¼Ÿæ˜¯å¦å¼•å…¥ç°åœ¨è¿˜ä¸éœ€è¦çš„é‡ç”¨è®¾è®¡ï¼Ÿå›¢é˜Ÿå¦‚ä½•å¹³è¡¡å¯é‡ç”¨å’ŒYAGNI(You Ainâ€™t Gonna Need It)è¿™ä¸¤ç§è§‚ç‚¹ï¼Ÿ&lt;/p&gt;
&lt;h1&gt;å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§&lt;/h1&gt;
&lt;p&gt;å­—æ®µã€å˜é‡ã€å‚æ•°ã€æ–¹æ³•ã€ç±»çš„å‘½åæ˜¯å¦çœŸå®åæ˜ å®ƒä»¬æ‰€ä»£è¡¨çš„äº‹ç‰©ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æ˜¯å¦å¯ä»¥é€šè¿‡è¯»ä»£ç ç†è§£å®ƒåšäº†ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘æ˜¯å¦ç†è§£æµ‹è¯•ç”¨ä¾‹æµ‹äº†ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;æµ‹è¯•æ˜¯å¦å¾ˆå¥½åœ°è¦†ç›–äº†ç”¨ä¾‹çš„å„ç§æƒ…å†µï¼Ÿå®ƒä»¬æ˜¯å¦è¦†ç›–äº†æ­£å¸¸å’Œå¼‚å¸¸ç”¨ä¾‹ï¼Ÿæ˜¯å¦æœ‰å¿½ç•¥çš„æƒ…å†µï¼Ÿ&lt;/p&gt;
&lt;p&gt;é”™è¯¯ä¿¡æ¯æ˜¯å¦å¯è¢«ç†è§£ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸æ¸…æ™°çš„ä»£ç æ˜¯å¦è¢«æ–‡æ¡£ã€æ³¨é‡Šæˆ–å®¹æ˜“ç†è§£çš„æµ‹è¯•ç”¨ä¾‹æ‰€è¦†ç›–ï¼Ÿå…·ä½“å¯ä»¥æ ¹æ®å›¢é˜Ÿè‡ªèº«çš„å–œå¥½å†³å®šä½¿ç”¨å“ªç§æ–¹å¼ã€‚&lt;/p&gt;
&lt;h1&gt;åŠŸèƒ½&lt;/h1&gt;
&lt;p&gt;ä»£ç æ˜¯å¦çœŸçš„è¾¾åˆ°äº†é¢„æœŸçš„ç›®æ ‡ï¼Ÿå¦‚æœæœ‰è‡ªåŠ¨åŒ–æµ‹è¯•æ¥ç¡®ä¿ä»£ç çš„æ­£ç¡®æ€§ï¼Œæµ‹è¯•çš„ä»£ç æ˜¯å¦çœŸçš„å¯ä»¥éªŒè¯ä»£ç è¾¾åˆ°äº†åå®šçš„éœ€æ±‚ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»£ç çœ‹ä¸Šå»æ˜¯å¦åŒ…å«ä¸æ˜æ˜¾çš„bugï¼Œæ¯”å¦‚ä½¿ç”¨é”™è¯¯çš„å˜é‡è¿›è¡Œæ£€æŸ¥ï¼Œæˆ–è¯¯æŠŠandå†™æˆorï¼Ÿ&lt;/p&gt;
&lt;h1&gt;ä½ æ˜¯å¦è€ƒè™‘è¿‡â€¦â€¦ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;æ˜¯å¦éœ€è¦æ»¡è¶³ç›¸å…³ç›‘ç®¡éœ€æ±‚ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä½œè€…æ˜¯å¦éœ€è¦åˆ›å»ºå…¬å…±æ–‡æ¡£æˆ–ä¿®æ”¹ç°å­˜çš„å¸®åŠ©æ–‡æ¡£ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ˜¯å¦æ£€æŸ¥äº†é¢å‘ç”¨æˆ·çš„ä¿¡æ¯çš„æ­£ç¡®æ€§ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ˜¯å¦æœ‰ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯¼è‡´åº”ç”¨åœæ­¢è¿è¡Œçš„æ˜æ˜¾é”™è¯¯ï¼Ÿä»£ç æ˜¯å¦ä¼šé”™è¯¯åœ°æŒ‡å‘æµ‹è¯•æ•°æ®åº“ï¼Œæ˜¯å¦å­˜åœ¨åº”åœ¨çœŸå®æœåŠ¡ä¸­ç§»é™¤çš„ç¡¬ç¼–ç çš„stubä»£ç ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä½ å¯¹æ€§èƒ½çš„éœ€æ±‚æ˜¯ä»€ä¹ˆï¼Œä½ æ˜¯å¦è€ƒè™‘äº†å®‰å…¨é—®é¢˜ï¼Ÿè¿™äº›æ˜¯éœ€è¦è¦†ç›–åˆ°çš„é‡å¤§åŒºåŸŸä¹Ÿæ˜¯è‡³å…³é‡è¦çš„è¯é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ·±å…¥æ¢è®¨ä¸‹æ€§èƒ½ï¼Œè¿™æ˜¯ä¸€ä¸ªçœŸæ­£èƒ½ä»ä»£ç å®¡æŸ¥ä¸­è·ç›Šçš„æ–¹é¢ã€‚&lt;/p&gt;
&lt;p&gt;ç³»ç»Ÿå¯¹æ€§èƒ½æ–¹é¢çš„éåŠŸèƒ½æ€§éœ€æ±‚åº”å½“åŒæ‰€æœ‰æ¶æ„ã€è®¾è®¡çš„é¢†åŸŸä¸€æ ·è¢«ç½®äºé‡è¦ä½ç½®ã€‚æ— è®ºä½ æ˜¯å¼€å‘åªå®¹è®¸çº³ç§’çº§å»¶æ—¶çš„ä½å»¶è¿Ÿäº¤æ˜“ç³»ç»Ÿï¼Œè¿˜æ˜¯ç®¡ç†â€œå¾…åŠäº‹é¡¹â€çš„æ‰‹æœºåº”ç”¨ï¼Œä½ éƒ½åº”è¯¥äº†è§£ç”¨æˆ·æ‰€è®¤ä¸ºçš„â€œå¤ªæ…¢â€ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è€ƒè™‘æˆ‘ä»¬æ˜¯å¦éœ€è¦å°±ä»£ç æ€§èƒ½è¿›è¡Œä»£ç å®¡æŸ¥ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥é—®è‡ªå·±å‡ ä¸ªå…³äºå…·ä½“éœ€æ±‚æ˜¯ä»€ä¹ˆçš„é—®é¢˜ã€‚è™½ç„¶ä¸€äº›åº”ç”¨ç¡®å®ä¸éœ€è¦è€ƒè™‘æ¯æ¯«ç§’éƒ½èŠ±è´¹åœ¨å“ªé‡Œï¼Œå¯¹äºå¤§éƒ¨åˆ†åº”ç”¨ï¼ŒèŠ±è´¹å‡ ä¸ªå°æ—¶çš„æŠ˜è…¾è¿›è¡Œä¼˜åŒ–æ¥è·å¾—çš„äº›è®¸CPUä¸‹é™çš„ä»·å€¼ä¹Ÿæ˜¯æœ‰é™çš„ï¼Œä½†æœ‰äº›åœ°æ–¹è¿˜æ˜¯å®¡æŸ¥è€…å¯ä»¥æ£€æŸ¥ä¸€ä¸‹çš„ï¼Œè¿›è€Œç¡®ä¿ä»£ç ä¸ä¼šæœ‰ä¸€äº›å¸¸è§å¯é¿å…çš„æ€§èƒ½ç¼ºé™·ã€‚&lt;/p&gt;
&lt;h2&gt;è¿™æ®µä»£ç æ˜¯å¦æœ‰ç¡¬æ€§çš„æ€§èƒ½éœ€æ±‚ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;æ¥å—å®¡æŸ¥çš„ä»£ç æ˜¯å¦æ¶‰åŠä¹‹å‰å‘å¸ƒçš„æœåŠ¡ç­‰çº§åè®®ï¼ˆSLAï¼‰ï¼Ÿæˆ–è¿™ä¸ªéœ€æ±‚æœ¬èº«æœ‰ç‰¹åˆ«çš„æ€§èƒ½éœ€æ±‚ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¦‚æœä»£ç å¯¼è‡´â€œç™»å½•é¡µé¢åŠ è½½å¤ªæ…¢â€ï¼Œé‚£åŸå§‹çš„å¼€å‘è€…éœ€è¦æ‰¾å‡ºåˆé€‚çš„åŠ è½½æ—¶é—´æ˜¯å¤šä¹…ï¼Œä¸ç„¶å®¡æŸ¥è€…æˆ–ä½œè€…æœ¬äººå¦‚ä½•ç¡®ä¿æ”¹è¿›åçš„é€Ÿåº¦è¶³å¤Ÿå¿«ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰ç¡¬æ€§çš„éœ€æ±‚ï¼Œæ˜¯å¦æœ‰æµ‹è¯•èƒ½è¯æ˜æ»¡è¶³äº†è¯¥éœ€æ±‚ï¼Ÿä»»ä½•æ³¨é‡æ€§èƒ½çš„ç³»ç»Ÿåº”è¯¥å°±æ€§èƒ½æä¾›è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè¿™èƒ½ç¡®ä¿å‘å¸ƒçš„SLAè¾¾åˆ°é¢„æœŸï¼ˆå¦‚æ‰€æœ‰è®¢å•è¯·æ±‚è¦åœ¨10æ¯«ç§’å†…å¤„ç†ï¼‰ã€‚æ²¡æœ‰è¿™äº›ï¼Œä½ åªèƒ½ä¾é ä½ çš„ç”¨æˆ·æ¥å‘Šè¯‰ä½ æ²¡æœ‰è¾¾åˆ°å¯¹åº”çš„SLAã€‚è¿™ä¸ä»…æ˜¯ä¸€ç§ç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒï¼Œè¿˜ä¼šå¸¦æ¥åŸæœ¬å¯é¿å…çš„ç½šé‡‘å’Œæ”¯å‡ºã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¿®å¤æˆ–æ–°å¢çš„åŠŸèƒ½æ˜¯å¦ä¼šåå‘å½±å“åˆ°ä»»ä½•ç°å­˜çš„æ€§èƒ½æµ‹è¯•ç»“æœ
å¦‚æœä½ å®šæœŸè¿è¡Œæ€§èƒ½æµ‹è¯•æˆ–æœ‰æµ‹è¯•å¥—ä»¶å¯ä»¥æŒ‰éœ€è¿è¡Œå®ƒä»¬ï¼Œé‚£ä½ å°±éœ€è¦æ£€æŸ¥æ–°çš„ä»£ç æ˜¯å¦ä½¿å¾—æ€§èƒ½å…³é”®åŒºåŸŸçš„ç³»ç»Ÿæ€§èƒ½æœ‰æ‰€ä¸‹é™ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„æµç¨‹ï¼Œä½†ç”±äºåœ¨æŒç»­é›†æˆç¯å¢ƒä¸­æ›´å¸¸è¿è¡Œå•å…ƒæµ‹è¯•è€Œä¸æ˜¯æ€§èƒ½æµ‹è¯•ï¼Œæ‰€ä»¥å€¼å¾—ç‰¹åˆ«æŒ‡å‡ºå¯ä»¥åœ¨ä»£ç å®¡æŸ¥ä¸­æ£€æŸ¥è¿™é¡¹ã€‚&lt;/p&gt;
&lt;h2&gt;è°ƒç”¨å¤–éƒ¨çš„æœåŠ¡æˆ–åº”ç”¨çš„ä»£ä»·æ˜¯æ˜‚è´µçš„&lt;/h2&gt;
&lt;p&gt;ä»»ä½•é€šè¿‡ç½‘è·¯æ¥ä½¿ç”¨å¤–éƒ¨ç³»ç»Ÿçš„æ–¹å¼é€šå¸¸ä¼šæ¯”æ²¡æœ‰å¾ˆå¥½ä¼˜åŒ–çš„æ–¹æ³•æœ‰æ›´å·®çš„æ€§èƒ½ã€‚è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;è°ƒç”¨æ•°æ®åº“ï¼šæœ€åçš„æƒ…å†µæ˜¯é—®é¢˜éšè—åœ¨ç³»ç»ŸæŠ½è±¡ä¸­ï¼Œå¦‚å…³ç³»å¯¹è±¡æ˜ å°„ï¼ˆORMï¼‰ä¸­ã€‚ä½†æ˜¯åœ¨ä»£ç å®¡æŸ¥ä¸­ä½ åº”è¯¥å¯ä»¥æ‰¾åˆ°å¸¸è§çš„å¯¼è‡´æ€§èƒ½é—®é¢˜çš„é—®é¢˜ï¼Œå¦‚åœ¨å¾ªç¯ä¸­é€ä¸ªè°ƒç”¨æ•°æ®åº“ï¼Œä¸€ç§æƒ…å†µå°±æ˜¯åŠ è½½IDåˆ—è¡¨ä¹‹åï¼Œå†åœ¨æ•°æ®åº“ä¸­é€ä¸ªæŸ¥è¯¢IDå¯¹åº”çš„æ¯æ¡æ•°æ®ã€‚ &lt;/p&gt;
&lt;p&gt;ä¸å¿…è¦çš„ç½‘ç»œè°ƒç”¨ï¼šå°±åƒæ•°æ®åº“ä¸€æ ·ï¼Œè¿œç¨‹æœåŠ¡æœ‰æ—¶ä¹Ÿä¼šè¢«è¿‡åº¦ä½¿ç”¨ï¼ŒåŸæ¥åªè¦ä¸€ä¸ªè¿œç¨‹è°ƒç”¨å°±å¯å®ç°çš„ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨æ‰¹é‡æˆ–ç¼“å­˜é˜²æ­¢æ˜‚è´µç½‘ç»œè°ƒç”¨çš„ï¼Œå´ä½¿ç”¨å¤šä¸ªè¿œç¨‹è°ƒç”¨æ¥å®ç°ã€‚å†æ¬¡å¼ºè°ƒï¼Œåƒæ•°æ®åº“ä¸€æ ·ï¼Œæœ‰æ—¶æŠ½è±¡ç±»ä¼šéšè—è°ƒç”¨è¿œç¨‹APIçš„æ–¹æ³•ã€‚ &lt;/p&gt;
&lt;p&gt;ç§»åŠ¨æˆ–å¯ç©¿æˆ´åº”ç”¨è¿‡äºé¢‘ç¹åœ°è°ƒç”¨åç«¯ç¨‹åºï¼šè¿™åŸºæœ¬ä¸Šå’Œ&amp;ldquo;ä¸å¿…è¦çš„ç½‘ç»œè°ƒç”¨&amp;rdquo;ç›¸åŒï¼Œä½†æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šä¼šäº§ç”Ÿå…¶ä»–é—®é¢˜ï¼Œè¿™ä¸ä»…ä¼šäº§ç”Ÿä¸å¿…è¦çš„è°ƒç”¨åç«¯ä½¿å¾—æ€§èƒ½å˜å·®ï¼Œè¿˜ä¼šæ›´å¿«åœ°æ¶ˆè€—ç”µé‡ç”šè‡³å¯¼è‡´ç”¨æˆ·çš„é‡‘é’±æ”¯å‡ºã€‚&lt;/p&gt;
&lt;h2&gt;æœ‰æ•ˆä¸”é«˜æ•ˆåœ°ä½¿ç”¨èµ„æº&lt;/h2&gt;
&lt;p&gt;ä»£ç æ˜¯å¦ç”¨é”æ¥æ§åˆ¶å…±äº«èµ„æºçš„è®¿é—®ï¼Ÿè¿™æ˜¯å¦ä¼šå¯¼è‡´æ€§èƒ½é™ä½æˆ–æ­»é”ï¼Ÿ&lt;/p&gt;
&lt;p&gt;é”æ˜¯ä¸€ä¸ªæ€§èƒ½å¼€é”€å¤§æˆ·ï¼Œå¹¶åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¾ˆéš¾ç†æ¸…ã€‚è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹æ¨¡å¼ï¼šå•çº¿ç¨‹å†™æˆ–ä¿®æ”¹å€¼ï¼Œå…¶ä½™çº¿ç¨‹åªè¯»ï¼Œæˆ–ä½¿ç”¨æ— é”ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¯å¦å­˜åœ¨å†…å­˜æ³„éœ²ï¼ŸJavaä¸­ä¸€äº›å¸¸è§çš„åŸå› ä¼šæ˜¯ï¼šå¯å˜çš„é™æ€å­—æ®µï¼Œä½¿ç”¨ThreadLocalå˜é‡å’Œä½¿ç”¨ç±»åŠ è½½å™¨ã€‚ &lt;/p&gt;
&lt;p&gt;æ˜¯å¦å­˜åœ¨å†…å­˜æ— é™å¢é•¿ï¼Ÿè¿™ä¸ªå’Œå†…å­˜æ³„éœ²ä¸åŒï¼Œå†…å­˜æ³„æ¼æ˜¯æŒ‡æ— ç”¨çš„å¯¹è±¡ä¸èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚ä½†å¯¹äºä»»ä½•è¯­è¨€ï¼Œå°±ç®—æ˜¯æ²¡æœ‰åƒåœ¾å›æ”¶çš„è¯­è¨€ï¼Œä¹Ÿèƒ½åˆ›å»ºæ— é™å˜å¤§çš„æ•°æ®ç»“æ„ã€‚ä½œä¸ºå®¡æŸ¥è€…ï¼Œå¦‚æœä½ çœ‹è§æ–°çš„å˜é‡ä¸æ–­è¢«åŠ åˆ°listæˆ–mapä¸­ï¼Œä½ å°±è¦é—®ä¸‹ï¼Œè¿™ä¸ªlistæˆ–mapä»€ä¹ˆæ—¶å€™å¤±æ•ˆæˆ–æ¸…é™¤æ— ç”¨æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦å…³é—­äº†è¿æ¥æˆ–æ•°æ®æµï¼Ÿå…³é—­è¿æ¥æˆ–æ–‡ä»¶ã€ç½‘ç»œæ•°æ®æµå¾ˆå®¹æ˜“ä¼šè¢«å¿˜è®°ã€‚å½“ä½ å®¡æŸ¥åˆ«äººä»£ç æ—¶ï¼Œå¦‚æœä½¿ç”¨åˆ°æ–‡ä»¶ã€ç½‘ç»œæˆ–æ•°æ®åº“è¿æ¥ï¼Œå°±è¦ç¡®ä¿å®ƒä»¬è¢«æ­£ç¡®åœ°å…³é—­äº†ã€‚&lt;/p&gt;
&lt;p&gt;èµ„æºæ± æ˜¯å¦é…ç½®æ­£ç¡®ï¼Ÿé’ˆå¯¹ä¸€ä¸ªç¯å¢ƒçš„æœ€ä½³é…ç½®å–å†³äºå¾ˆå¤šå› ç´ ï¼Œæ‰€ä»¥ä½œä¸ºå®¡æŸ¥è€…ä½ å¾ˆéš¾é©¬ä¸ŠçŸ¥é“åƒæ•°æ®åº“è¿æ¥æ± å¤§å°æ˜¯å¦æ­£ç¡®ç­‰è¿™äº›é—®é¢˜ã€‚ä½†æ˜¯æœ‰ä¸€äº›æ˜¯ä½ ä¸€çœ¼å°±å¯ä»¥çœ‹å‡ºæ¥çš„ï¼Œåƒèµ„æºæ± æ˜¯å¦å¤ªå°ï¼ˆæ¯”å¦‚å¤§å°è®¾ç½®ä¸º1ï¼‰æˆ–å¤ªå¤§ï¼ˆå¦‚æ•°ç™¾ä¸‡çº¿ç¨‹ï¼‰ã€‚å¦‚æœæ— æ³•ç¡®å®šï¼Œå°±ä»é»˜è®¤å€¼å¼€å§‹ã€‚æ²¡æœ‰ä½¿ç”¨é»˜è®¤å€¼çš„å°±éœ€è¦æä¾›ä¸€å®šçš„æµ‹è¯•æˆ–è®¡ç®—æ¥è¯æ˜è¿™ä¹ˆé…ç½®çš„åˆç†æ€§ã€‚&lt;/p&gt;
&lt;h2&gt;å®¡æŸ¥è€…å¯ä»¥è½»æ¾æ‰¾å‡ºçš„è­¦å‘Šä¿¡å·&lt;/h2&gt;
&lt;p&gt;ä¸€äº›ä»£ç ä¸€çœ¼å°±èƒ½çœ‹å‡ºå­˜åœ¨æ½œåœ¨æ€§èƒ½é—®é¢˜ã€‚è¿™ä¾èµ–äºæ‰€ä½¿ç”¨çš„è¯­è¨€å’Œç±»åº“ã€‚&lt;/p&gt;
&lt;p&gt;åå°„ï¼šJavaçš„åå°„æ¯”æ­£å¸¸è°ƒç”¨è¦æ…¢ã€‚å¦‚æœä½ åœ¨å®¡æŸ¥å«æœ‰åå°„çš„ä»£ç ï¼Œä½ å°±è¦é—®ä¸‹æ˜¯å¦å¿…é¡»ä½¿ç”¨å®ƒã€‚&lt;/p&gt;
&lt;p&gt;è¶…æ—¶ï¼šå½“ä½ å®¡æŸ¥ä»£ç æ—¶ï¼Œä½ å¯èƒ½ä¸çŸ¥é“ä¸€ä¸ªæ“ä½œåˆé€‚çš„è¶…æ—¶æ—¶é—´ï¼Œä½†æ˜¯ä½ è¦æƒ³ä¸€ä¸‹â€œå¦‚æœè¶…æ—¶äº†ï¼Œä¼šå¯¹ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†é€ æˆä»€ä¹ˆå½±å“ï¼Ÿâ€ã€‚ä½œä¸ºå®¡æŸ¥è€…ä½ åº”è¯¥è€ƒè™‘æœ€åçš„æƒ…å†µï¼šå½“å‘ç”Ÿ5åˆ†é’Ÿçš„å»¶æ—¶ï¼Œåº”ç”¨æ˜¯å¦ä¼šé˜»å¡ï¼Ÿå¦‚æœè¶…æ—¶æ—¶é—´è®¾ç½®æˆ1ç§’é’Ÿæœ€åçš„æƒ…å†µä¼šæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿå¦‚æœä»£ç ä½œè€…ä¸èƒ½ç¡®å®šè¶…æ—¶é•¿åº¦ï¼Œä½ ä½œä¸ºå®¡æŸ¥è€…ä¹Ÿä¸çŸ¥é“ä¸€ä¸ªé€‰å®šçš„æ—¶é—´çš„å¥½åï¼Œé‚£ä¹ˆæ˜¯æ—¶å€™æ‰¾ä¸€ä¸ªç†è§£è¿™å…¶ä¸­å½±å“çš„äººå‚ä¸ä»£ç å®¡æŸ¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶è¡Œï¼šä»£ç æ˜¯å¦ä½¿ç”¨å¤šçº¿ç¨‹æ¥è¿è¡Œä¸€ä¸ªç®€å•çš„æ“ä½œï¼Ÿè¿™æ ·æ˜¯å¦èŠ±è´¹äº†æ›´å¤šçš„æ—¶é—´ä»¥åŠå¤æ‚åº¦è€Œå¹¶æ²¡æœ‰æå‡æ€§èƒ½ï¼Ÿå¦‚æœä½¿ç”¨ç°ä»£åŒ–çš„Javaï¼Œé‚£å…¶ä¸­æ½œåœ¨çš„é—®é¢˜ç›¸è¾ƒäºæ˜¾ç¤ºåˆ›å»ºçº¿ç¨‹ä¸­çš„é—®é¢˜æ›´ä¸å®¹æ˜“è¢«å‘ç°ï¼šä»£ç æ˜¯å¦ä½¿ç”¨Java 8æ–°çš„å¹¶è¡Œæµè®¡ç®—ä½†å¹¶æ²¡æœ‰ä»å¹¶è¡Œä¸­è·ç›Šï¼Ÿæ¯”å¦‚ï¼Œåœ¨å°‘é‡å…ƒç´ ä¸Šä½¿ç”¨å¹¶è¡Œæµè®¡ç®—ï¼Œæˆ–è€…åªæ˜¯è¿è¡Œéå¸¸ç®€å•çš„æ“ä½œï¼Œè¿™å¯èƒ½æ¯”åœ¨é¡ºåºæµä¸Šè¿ç®—è¿˜è¦æ…¢ã€‚&lt;/p&gt;
&lt;h2&gt;æ­£ç¡®æ€§&lt;/h2&gt;
&lt;p&gt;è¿™äº›ä¸ä¸€å®šå½±å“ç³»ç»Ÿçš„æ€§èƒ½ï¼Œä½†æ˜¯å®ƒä»¬ä¸å¤šçº¿ç¨‹ç¯å¢ƒè¿è¡Œå…³ç³»å¯†åˆ‡ï¼Œæ‰€ä»¥å’Œè¿™ä¸ªä¸»é¢˜æœ‰å…³ï¼š&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„é€‚åˆå¤šçº¿ç¨‹çš„æ•°æ®ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦å­˜åœ¨ç«æ€æ¡ä»¶ï¼ˆrace conditionsï¼‰ï¼Ÿå¤šçº¿ç¨‹ç¯å¢ƒä¸­ä»£ç éå¸¸å®¹æ˜“é€ æˆä¸æ˜æ˜¾çš„ç«æ€æ¡ä»¶ã€‚ä½œä¸ºå®¡æŸ¥è€…ï¼Œå¯ä»¥æŸ¥çœ‹ä¸æ˜¯åŸå­æ“ä½œçš„getå’Œsetã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦æ­£ç¡®ä½¿ç”¨é”ï¼Ÿå’Œç«æ€æ¡ä»¶ç›¸å…³ï¼Œä½œä¸ºå®¡æŸ¥è€…ä½ åº”è¯¥æ£€æŸ¥è¢«å®¡ä»£ç æ˜¯å¦å…è®¸å¤šä¸ªçº¿ç¨‹ä¿®æ”¹å˜é‡å¯¼è‡´ç¨‹åºå´©æºƒã€‚ä»£ç å¯èƒ½éœ€è¦åŒæ­¥ã€é”ã€åŸå­å˜é‡æ¥å¯¹ä»£ç å—è¿›è¡Œæ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç çš„æ€§èƒ½æµ‹è¯•æ˜¯å¦æœ‰ä»·å€¼ï¼Ÿå¾ˆå®¹æ˜“å°†å°å‹çš„æ€§èƒ½æµ‹è¯•ä»£ç å†™å¾—å¾ˆç³Ÿç³•ï¼Œæˆ–è€…ä½¿ç”¨ä¸èƒ½ä»£è¡¨ç”Ÿäº§ç¯å¢ƒæ•°æ®çš„æµ‹è¯•æ•°æ®ï¼Œè¿™æ ·åªä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;ç¼“å­˜ï¼šè™½ç„¶ç¼“å­˜æ˜¯ä¸€ç§èƒ½é˜²æ­¢è¿‡å¤šé«˜æ¶ˆè€—è¯·æ±‚çš„æ–¹å¼ï¼Œä½†å…¶æœ¬èº«ä¹Ÿå­˜åœ¨ä¸€äº›æŒ‘æˆ˜ã€‚å¦‚æœå®¡æŸ¥çš„ä»£ç ä½¿ç”¨äº†ç¼“å­˜ï¼Œä½ åº”è¯¥å…³æ³¨ä¸€äº›å¸¸è§çš„é—®é¢˜ï¼Œå¦‚ï¼Œä¸æ­£ç¡®çš„ç¼“å­˜å¤±æ•ˆæ–¹å¼ã€‚&lt;/p&gt;
&lt;h2&gt;ä»£ç çº§ä¼˜åŒ–&lt;/h2&gt;
&lt;p&gt;å¯¹å¤§éƒ¨åˆ†å¹¶ä¸æ˜¯è¦æ„å»ºä½å»¶æ—¶åº”ç”¨çš„æœºæ„æ¥è¯´ï¼Œä»£ç çº§ä¼˜åŒ–å¾€å¾€æ˜¯è¿‡æ—©ä¼˜åŒ–ï¼Œæ‰€ä»¥é¦–å…ˆè¦çŸ¥é“ä»£ç çº§ä¼˜åŒ–æ˜¯å¦å¿…è¦ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦åœ¨ä¸éœ€è¦çš„åœ°æ–¹ä½¿ç”¨åŒæ­¥æˆ–é”æ“ä½œï¼Ÿå¦‚æœä»£ç å§‹ç»ˆè¿è¡Œåœ¨å•çº¿ç¨‹ä¸­ï¼Œé”å¾€å¾€æ˜¯ä¸å¿…è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦å¯ä»¥ä½¿ç”¨åŸå­å˜é‡æ›¿ä»£é”æˆ–åŒæ­¥æ“ä½œï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦ä½¿ç”¨äº†ä¸å¿…è¦çš„çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„ï¼Ÿæ¯”å¦‚æ˜¯å¦å¯ä»¥ä½¿ç”¨ArrayListæ›¿ä»£Vectorï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦åœ¨é€šç”¨çš„æ“ä½œä¸­ä½¿ç”¨äº†ä½æ€§èƒ½çš„æ•°æ®ç»“æ„ï¼Ÿå¦‚åœ¨ç»å¸¸éœ€è¦æŸ¥æ‰¾æŸä¸ªç‰¹å®šå…ƒç´ çš„åœ°æ–¹ä½¿ç”¨é“¾è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦å¯ä»¥ä½¿ç”¨æ‡’åŠ è½½å¹¶ä»ä¸­è·å¾—æ€§èƒ½æå‡ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ¡ä»¶åˆ¤æ–­è¯­å¥æˆ–å…¶ä»–é€»è¾‘æ˜¯å¦å¯ä»¥å°†æœ€é«˜æ•ˆçš„æ±‚å€¼è¯­å¥æ”¾åœ¨å‰é¢æ¥ä½¿å…¶ä»–è¯­å¥çŸ­è·¯ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦å­˜åœ¨è®¸å¤šå­—ç¬¦ä¸²æ ¼å¼åŒ–ï¼Ÿæ˜¯å¦æœ‰æ–¹æ³•å¯ä»¥ä½¿ä¹‹æ›´é«˜æ•ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ—¥å¿—è¯­å¥æ˜¯å¦ä½¿ç”¨äº†å­—ç¬¦ä¸²æ ¼å¼åŒ–ï¼Ÿæ˜¯å¦å…ˆä½¿ç”¨æ¡ä»¶åˆ¤æ–­è¯­å¥æ ¡éªŒäº†æ—¥å¿—ç­‰çº§ï¼Œæˆ–ä½¿ç”¨å»¶è¿Ÿæ±‚å€¼ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;ç®€å•çš„ä»£ç å³é«˜æ•ˆçš„ä»£ç &lt;/h2&gt;
&lt;p&gt;Javaä»£ç ä¸­æœ‰ä¸€äº›ç®€å•çš„ä¸œè¥¿å¯ä»¥ä¾›å®¡æŸ¥è€…å¯»æ‰¾ï¼Œè¿™äº›ä¼šä½¿JVMå¾ˆå¥½åœ°æ›¿ä½ ä¼˜åŒ–ä½ çš„ä»£ç ï¼š&lt;/p&gt;
&lt;p&gt;çŸ­å°çš„æ–¹æ³•å’Œç±»ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•çš„é€»è¾‘ï¼Œå³æ¶ˆé™¤åµŒå¥—çš„æ¡ä»¶æˆ–å¾ªç¯è¯­å¥ã€‚&lt;/p&gt;
&lt;h1&gt;å®‰å…¨&lt;/h1&gt;
&lt;p&gt;ä½ åœ¨æ„å»ºä¸€ä¸ªå®‰å…¨ã€ç¨³å›ºçš„ç³»ç»Ÿæ‰€èŠ±è´¹çš„ç²¾åŠ›ï¼Œå’ŒèŠ±åœ¨å…¶ä»–ç‰¹æ€§ä¸Šçš„ä¸€æ ·ï¼Œå–å†³äºé¡¹ç›®æœ¬èº«ï¼Œé¡¹ç›®è¿è¡Œçš„åœ°æ–¹ã€å®ƒä½¿ç”¨çš„ç”¨æˆ·ã€éœ€è¦è®¿é—®çš„æ•°æ®ç­‰ã€‚æˆ‘ä»¬ç°åœ¨ç€é‡çœ‹ä¸€äº›ä½ å¯èƒ½åœ¨ä»£ç å®¡æŸ¥æ—¶å…³æ³¨çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;h2&gt;å°½å¯èƒ½ä½¿ç”¨è‡ªåŠ¨åŒ–&lt;/h2&gt;
&lt;p&gt;æœ‰æƒŠäººæ•°é‡çš„å®‰å…¨æ£€æŸ¥å¯ä»¥è¢«è‡ªåŠ¨åŒ–ï¼Œè€Œä¸éœ€è¦äººå·¥å¹²é¢„ã€‚å®‰å…¨æµ‹è¯•ä¸ä¸€å®šè¦å¯åŠ¨æ‰€æœ‰ç³»ç»Ÿè¿›è¡Œå®Œæ•´çš„æ¸—é€æµ‹è¯•ï¼Œä¸€äº›é—®é¢˜å¯ä»¥åœ¨ä»£ç çº§å°±èƒ½è¢«å‘ç°ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸è§é—®é¢˜å¦‚SQLæ³¨å…¥æˆ–è·¨ç«™è„šæœ¬å¯ä»¥åœ¨æŒç»­é›†æˆç¯å¢ƒé€šè¿‡ç›¸åº”å·¥å…·æ£€æŸ¥å‡ºã€‚ä½ ä¹Ÿèƒ½é€šè¿‡OWASPä¾èµ–æ£€æµ‹å·¥å…·è‡ªåŠ¨åŒ–æ£€æŸ¥ä½ ä¾èµ–ä¸­å·²çŸ¥çš„æ¼æ´ã€‚&lt;/p&gt;
&lt;h2&gt;æœ‰æ—¶éœ€è¦â€œçœ‹æƒ…å†µâ€&lt;/h2&gt;
&lt;p&gt;å¯¹æœ‰çš„æ ¡éªŒä½ å¯ä»¥ç®€å•å›ç­”â€œæ˜¯â€æˆ–â€œå¦â€ï¼Œæœ‰æ—¶ä½ éœ€è¦ä¸€ä¸ªå·¥å…·æŒ‡å‡ºæ½œåœ¨çš„é—®é¢˜ï¼Œä¹‹åå†ç”±äººå·¥æ¥å†³å®šè¿™ä¸ªæ˜¯å¦éœ€è¦è§£å†³ã€‚è¿™ä¹Ÿæ­£æ˜¯UpsourceçœŸæ­£çš„é—ªå…‰ç‚¹ã€‚Upsourceæ˜¾ç¤ºä»£ç æ£€æŸ¥ç»“æœï¼Œå®¡æŸ¥è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ¥å†³å®šä»£ç æ˜¯å¦éœ€è¦æ”¹åŠ¨æˆ–è¿˜å¯ä»¥æ¥å—ç›®å‰çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;h2&gt;ç†è§£ä½ ç”¨åˆ°çš„ä¾èµ–&lt;/h2&gt;
&lt;p&gt;ç¬¬ä¸‰æ–¹ç±»åº“æ˜¯ä¾µèš€ç³»ç»Ÿå®‰å…¨å¹¶å¼•èµ·æ¼æ´çš„ä¸€ä¸ªé€”å¾„ã€‚å½“å®¡æŸ¥ä»£ç æ—¶è‡³å°‘ä½ è¦æ£€æŸ¥æ˜¯å¦å¼•å…¥äº†æ–°çš„ä¾èµ–ï¼ˆå¦‚ç¬¬ä¸‰æ–¹ç±»åº“ï¼‰ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰è‡ªåŠ¨åŒ–æ£€æŸ¥æ¼æ´ï¼Œä½ åº”è¯¥æ£€æŸ¥æ–°å¼•å…¥çš„ç±»åº“ä¸­å·²çŸ¥çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä½ ä¹Ÿåº”è¯¥å°è¯•ç€æœ€å°åŒ–æ¯ä¸ªç±»åº“çš„ç‰ˆæœ¬ï¼Œå½“ç„¶å¦‚æœå…¶ä»–ä¾èµ–æœ‰ä¸€ä¸ªé¢å¤–çš„é—´æ¥ä¾èµ–ï¼Œè¿™ç‚¹å¯èƒ½è¾¾ä¸åˆ°ã€‚ä½†æœ€ç®€å•çš„æœ€å°åŒ–è‡ªå·±ä»£ç æš´éœ²åœ¨ä»–äººä»£ç çš„ï¼ˆé€šè¿‡ç±»åº“æˆ–æœåŠ¡ï¼‰å®‰å…¨é—®é¢˜ä¸­çš„æ–¹æ³•æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;å°½å¯èƒ½ä½¿ç”¨æºç å¹¶ç†è§£å®ƒçš„å¯ä¿¡åº¦ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä½ æ‰€èƒ½å¾—åˆ°çš„è´¨é‡æœ€é«˜çš„ç±»åº“ã€‚ &lt;/p&gt;
&lt;p&gt;è¿½è¸ªä½ åœ¨ä½•å¤„ä½¿ç”¨äº†ä»€ä¹ˆï¼Œå½“æ–°çš„æ¼æ´å‡ºç°ï¼Œä½ å¯ä»¥æŸ¥çœ‹ä½ å—å½±å“çš„ç¨‹åº¦ã€‚&lt;/p&gt;
&lt;h2&gt;æ£€æŸ¥æ˜¯å¦æ–°çš„è·¯å¾„å’ŒæœåŠ¡éœ€è¦è®¤è¯&lt;/h2&gt;
&lt;p&gt;æ— è®ºä½ å¼€å‘webåº”ç”¨ã€æä¾›webæœåŠ¡æˆ–ä¸€äº›å…¶ä»–éœ€è¦è®¤è¯çš„APIï¼Œå½“ä½ å¢åŠ ä¸€ä¸ªæ–°çš„URIæˆ–æœåŠ¡æ—¶ï¼Œä½ åº”è¯¥ç¡®ä¿å®ƒä¸èƒ½åœ¨æ²¡æœ‰è®¤è¯çš„æƒ…å†µä¸‹è¢«è®¿é—®ï¼ˆå‡è®¾è®¤è¯æ˜¯ä½ ç³»ç»Ÿçš„éœ€æ±‚ï¼‰ã€‚ä½ åªè¦ç®€å•åœ°æ£€æŸ¥ä»£ç çš„å¼€å‘è€…å†™äº†åˆé€‚çš„æµ‹è¯•ç”¨ä¾‹æ¥å±•ç¤ºè¿›è¡Œäº†è®¤è¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½ åº”è¯¥ä¸åªé’ˆå¯¹ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç çš„äººç±»ç”¨æˆ·æ¥è€ƒè™‘è®¤è¯ã€‚å…¶ä»–ç³»ç»Ÿæˆ–è‡ªåŠ¨åŒ–æµç¨‹æ¥è®¿é—®ä½ çš„åº”ç”¨æˆ–æœåŠ¡ä¹Ÿä¼šéœ€è¦è®¤è¯ã€‚è¿™å¯èƒ½å½±å“ä½ ä»¬ç³»ç»Ÿä¸­å¯¹â€œç”¨æˆ·â€çš„å®šä¹‰ã€‚&lt;/p&gt;
&lt;h2&gt;æ•°æ®æ˜¯å¦éœ€è¦åŠ å¯†&lt;/h2&gt;
&lt;p&gt;å½“ä½ ä¿å­˜ä¸€äº›æ•°æ®åˆ°ç£ç›˜æˆ–é€šè¿‡çº¿ç¼†ä¼ è¾“ï¼Œä½ éœ€è¦äº†è§£æ•°æ®æ˜¯å¦åº”è¯¥è¢«åŠ å¯†ã€‚æ˜¾ç„¶å¯†ç æ°¸è¿œä¸åº”è¯¥æ˜¯ç®€å•æ–‡æœ¬ï¼Œä½†æ˜¯æœ‰è¯¸å¤šå…¶ä»–æƒ…å†µæ•°æ®éœ€è¦åŠ å¯†ã€‚å¦‚æœè¢«å®¡æŸ¥çš„ä»£ç é€šè¿‡çº¿ç¼†æ¥ä¼ é€æ•°æ®æˆ–ä¿å­˜åœ¨æŸåœ°æˆ–ä»¥å…¶ä»–æ–¹å¼ç¦»å¼€ä½ çš„ç³»ç»Ÿï¼Œä¸”ä½ ä¸çŸ¥é“å®ƒæ˜¯å¦åº”è¯¥è¢«åŠ å¯†ï¼Œå°è¯•è¯¢é—®ä¸‹ä½ ç»„ç»‡ä¸­å¯ä»¥å›ç­”è¿™ä¸ªé—®é¢˜çš„äººã€‚&lt;/p&gt;
&lt;h2&gt;å¯†ç æ˜¯å¦è¢«å¾ˆå¥½åœ°æ§åˆ¶ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œçš„å¯†ç åŒ…å«å¯†ç ï¼ˆå¦‚ç”¨æˆ·å¯†ç ã€æ•°æ®åº“å¯†ç æˆ–å…¶ä»–ç³»ç»Ÿçš„å¯†ç ï¼‰ã€ç§˜é’¥ã€ä»¤ç‰Œç­‰ç­‰ã€‚è¿™äº›æ°¸è¿œä¸åº”è¯¥å­˜æ”¾åœ¨ä¼šæäº¤åˆ°æºç æ§åˆ¶ç³»ç»Ÿçš„ä»£ç æˆ–é…ç½®æ–‡ä»¶ä¸­ï¼Œæœ‰å…¶ä»–æ–¹å¼ç®¡ç†è¿™äº›å¯†ç ï¼Œä¾‹å¦‚é€šè¿‡å¯†ç æœåŠ¡å™¨ï¼ˆsecret serverï¼‰ã€‚å½“å®¡æŸ¥ä»£ç æ—¶ï¼Œè¦ç¡®ä¿è¿™äº›å¯†ç ä¸ä¼šæ‚„æ‚„è¿›å…¥ä½ çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ã€‚&lt;/p&gt;
&lt;h2&gt;ä»£ç çš„è¿è¡Œæ˜¯å¦åº”è¯¥è¢«æ—¥å¿—è®°å½•æˆ–ç›‘æ§ï¼Ÿæ˜¯å¦æ­£ç¡®åœ°ä½¿ç”¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;æ—¥å¿—å’Œç›‘æ§éœ€æ±‚å› å„ä¸ªé¡¹ç›®è€Œä¸åŒï¼Œä¸€äº›éœ€è¦åˆè§„ï¼Œä¸€äº›æ‹¥æœ‰æ¯”åˆ«äººä¸¥æ ¼çš„è¡Œä¸ºã€äº‹ä»¶æ—¥å¿—è§„èŒƒã€‚å¦‚æœä½ æœ‰è§„ç« è§„å®šå“ªäº›éœ€è¦è®°å½•æ—¥å¿—ï¼Œä½•æ—¶ã€å¦‚ä½•è®°å½•ï¼Œé‚£ä¹ˆä½œä¸ºä»£ç å®¡æŸ¥è€…ä½ åº”è¯¥æ£€æŸ¥æäº¤çš„ä»£ç æ˜¯å¦æ»¡è¶³è¦æ±‚ã€‚å¦‚æœä½ æ²¡æœ‰å›ºå®šçš„è§„ç« ï¼Œé‚£ä¹ˆå°±è€ƒè™‘ï¼š&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦æ”¹å˜äº†æ•°æ®ï¼ˆå¦‚å¢åˆ æ”¹æ“ä½œï¼‰ï¼Ÿæ˜¯å¦åº”è¯¥è®°å½•ç”±è°ä½•æ—¶æ”¹å˜äº†ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»£ç æ˜¯å¦æ¶‰åŠå…³é”®æ€§èƒ½çš„éƒ¨åˆ†ï¼Ÿæ˜¯å¦åº”è¯¥åœ¨æ€§èƒ½ç›‘æ§ç³»ç»Ÿä¸­è®°å½•å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ¯æ¡æ—¥å¿—çš„æ—¥å¿—ç­‰çº§æ˜¯å¦æ°å½“ï¼Ÿä¸€ä¸ªå¥½çš„ç»éªŒæ³•åˆ™æ˜¯â€œERRORâ€è§¦å‘ä¸€ä¸ªæç¤ºå‘é€åˆ°æŸå¤„ï¼Œå¦‚æœä½ ä¸æƒ³è¿™äº›æ¶ˆæ¯åœ¨å‡Œæ™¨3ç‚¹å«é†’è°ï¼Œé‚£ä¹ˆå°±å°†ä¹‹é™çº§ä¸ºâ€œINFOâ€æˆ–â€œDEBUGâ€ã€‚å½“åœ¨å¾ªç¯ä¸­æˆ–ä¸€æ¡æ•°æ®å¯èƒ½äº§ç”Ÿå¤šæ¡è¾“å‡ºçš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬ä¸éœ€è¦å°†å®ƒä»¬è®°å½•åˆ°ç”Ÿäº§æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå®ƒä»¬æ›´åº”è¯¥è¢«æ”¾åœ¨â€œDEBUGâ€çº§åˆ«ã€‚&lt;/p&gt;
&lt;h2&gt;è®°å¾—å«ä¸Šä¸“å®¶&lt;/h2&gt;
&lt;p&gt;å®‰å…¨æ˜¯ä¸ªå¾ˆå¤§çš„è¯é¢˜ï¼Œå¤§åˆ°è¶³ä»¥è®©ä½ çš„å…¬å¸è˜è¯·æŠ€æœ¯å®‰å…¨ä¸“å®¶ã€‚æˆ‘ä»¬æœ‰å®‰å…¨ä¸“å®¶å°±å¯ä»¥è·å¾—ä»–ä»¬çš„å¸®åŠ©ï¼Œå¦‚ï¼Œé‚€è¯·ä»–ä»¬å‚åŠ ä»£ç å®¡æŸ¥ï¼Œæˆ–é‚€è¯·ä»–ä»¬åœ¨å®¡æŸ¥ä»£ç æ—¶å’Œæˆ‘ä»¬ç»“å¯¹ã€‚å¦‚æœè¿™ä¸ªæ— æ³•å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†å­¦ä¹ æˆ‘ä»¬ç³»ç»Ÿçš„ç¯å¢ƒï¼Œæ¥ç†è§£æˆ‘ä»¬æœ‰å“ªç§å®‰å…¨éœ€æ±‚ï¼ˆé¢å‘å†…éƒ¨çš„ä¼ä¸šçº§åº”ç”¨å’Œé¢å‘å®¢æˆ·çš„ç½‘é¡µåº”ç”¨æœ‰ä¸åŒçš„æ ‡å‡†ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°ç†è§£æˆ‘ä»¬åº”è¯¥åœ¨ä»£ç å®¡æŸ¥ä¸­çœ‹ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;h1&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;ä»£ç å®¡æŸ¥æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼ï¼Œä¸ä»…ç¡®ä¿äº†ä»£ç è´¨é‡å’Œä¸€è‡´æ€§ï¼Œä¹Ÿåœ¨å›¢é˜Ÿä¸­æˆ–å›¢é˜Ÿé—´åˆ†äº«äº†é¡¹ç›®çŸ¥è¯†ã€‚å³ä½¿ä½ å·²ç»è‡ªåŠ¨åŒ–äº†åŸºç¡€çš„æ ¡éªŒï¼Œè¿˜æœ‰è®¸å¤šä¸åŒä»£ç ã€è®¾è®¡çš„æ–¹é¢éœ€è¦è€ƒè™‘ã€‚ä»£ç å®¡æŸ¥å·¥å…·ï¼Œå¦‚Upsourceï¼Œé€šè¿‡åœ¨æ¯ä¸ªä»£ç æäº¤çš„æ£€æŸ¥ä¸­é«˜äº®å¯ç–‘çš„ä»£ç å¹¶åˆ†æå“ªäº›é—®é¢˜å·²ç»è¢«ä¿®å¤ï¼Œæ–°å¼•å…¥å“ªäº›é—®é¢˜ï¼Œå¯ä»¥å¸®ä½ å®šä½ä¸€äº›æ½œåœ¨çš„é—®é¢˜ã€‚å·¥å…·ä¹Ÿå¯ä»¥ç®€åŒ–æµç¨‹ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€ä¸ªå¹³å°æ¥è®¨è®ºè®¾è®¡å’Œä»£ç å®ç°ï¼Œä¹Ÿå¯ä»¥é‚€è¯·å®¡æŸ¥è€…ã€ä½œè€…å’Œå…¶ä»–ç›¸å…³äººå‘˜å‚åŠ è®¨è®ºç›´åˆ°è¾¾æˆå…±è¯†ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå›¢é˜Ÿéœ€è¦èŠ±æ—¶é—´å†³å®šä»£ç è´¨é‡çš„å“ªäº›å› ç´ å¯¹ä»–ä»¬æ˜¯é‡è¦çš„ï¼Œä¹Ÿéœ€è¦ä¸“å®¶äººå·¥å†³å®šå“ªäº›è§„åˆ™åº”ç”¨åˆ°å„ä¸ªä»£ç å®¡æŸ¥ä¸­ï¼Œå‚ä¸åˆ°å®¡æŸ¥ä¸­çš„æ¯ä¸ªäººéƒ½åº”è¯¥å…·å¤‡å¹¶ä½¿ç”¨äººé™…äº¤å¾€çš„æŠ€å·§ï¼Œå¦‚ç§¯æçš„åé¦ˆã€è°ˆåˆ¤å¦¥åä»¥è¾¾åˆ°æœ€ç»ˆçš„å…±è¯†ï¼Œå³ä»£ç åº”è¯¥æ€ä¹ˆæ ·æ‰â€œè¶³å¤Ÿå¥½â€å¯ä»¥é€šè¿‡å®¡æŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºä½œè€…
Trisha Geeä¸ºä¸€ç³»åˆ—è¡Œä¸šå¼€å‘Javaåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬é‡‘èã€åˆ¶é€ ä¸šã€è½¯ä»¶å’Œéç›ˆåˆ©ç»„ç»‡ï¼ŒåŒ…æ‹¬å„ç§è§„æ¨¡çš„å…¬å¸ã€‚å¥¹åœ¨å¼€å‘Javaé«˜æ€§èƒ½ç³»ç»Ÿä¸Šæœ‰ä¸°å¯Œç»éªŒï¼Œå¹¶ç§¯æå¸®åŠ©å¼€å‘è€…ä½¿ä»–ä»¬æ‹¥æœ‰é«˜ç”Ÿäº§ç‡ï¼Œå¥¹ä¹Ÿæ¶‰è¶³å¼€æºå¼€å‘ã€‚Trishaæ˜¯Sevilla Javaç”¨æˆ·ç»„å’ŒJava Championçš„å¸¦å¤´äººï¼Œå¥¹ä¿¡ä»»ç¤¾åŒºå¹¶åˆ†äº«è‡ªå·±çš„è§‚ç‚¹ï¼Œå¸®åŠ©æˆ‘ä»¬ä»é”™è¯¯ä¸­å­¦ä¹ ï¼Œå¹¶åœ¨æˆåŠŸçš„åŸºç¡€ä¸Šç»§ç»­å‘å±•ã€‚å¥¹æ˜¯JetBrainsæŠ€æœ¯æ¨å¹¿äººï¼Œä¹Ÿå°±æ˜¯è¯´å¥¹ä¼šä¸æ–­åˆ†äº«æ‰€æœ‰æœ‰è¶£çš„å‘ç°ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://mp.weixin.qq.com/s?__biz=MzIwMzg1ODcwMw==&amp;amp;mid=2247486399&amp;amp;idx=1&amp;amp;sn=219af64c7ecbf9e6c601cefddd0a0eba&amp;amp;source=41#wechat_redirect&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 07:00:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ru-he-zuo-yi-ge-code-review.html</guid><category>æƒ³æ³•</category><category>è®¡ç®—æœº</category></item><item><title>How to publish your game</title><link>/posts/how-to-publish-your-game.html</link><description>&lt;p&gt;A few thoughts as someone who has developed games for iOS, Android, and the web:
In today's world, if you want to retain implicit ownership of your product's name, a simultaneous triple-platform release is not optional, it is required. It must be performed in precisely the following way, or your launch will fail:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Register your game's domain before announcing it to the public.&lt;/li&gt;
&lt;li&gt;Next, upload your iOS app to iTunes Connect and wait for up to one week for the app to be approved.&lt;/li&gt;
&lt;li&gt;Next, upload your Android app to the Google Play store; approval only takes a few hours.&lt;/li&gt;
&lt;li&gt;Finally, make the web version public, and announce the game along with links to the mobile versions.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If you deviate from this order, then you're screwed. One example: I released a game on the web and waited one day to upload the Android version to the Google Play store. I figured that gave me a little extra time to test and check for bugs, and what's the rush anyway? Nobody could steal a game in just 24 hours, right? Wrong. My app was rejected because Google insisted my app was attempting to impersonate another developer's app. &lt;strong&gt;The other developer's app was simply my own website, stolen line for line, tossed into Phonegap, and released the same day as my website. I explained this to Google in the appeal form, even including a link proving I owned the site the other developer stole it from, and they rejected my appeal without checking the link - I could clearly see in my server logs that they never clicked on it. Google does not allow you to file a second appeal, so I had to give my app an awful name no one would recognize it by, and the clone received all the downloads and glory thanks to the buzz my website's name was generating for it.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Another example: I was the first to publish an iOS app with the same name as my website. After the app had been waiting for review for four days, I figured it would be approved any moment now, and that it was safe for me to launch my website. I launched, and it turns out that Apple's app review process is not FIFO, because two days later, a clone with the same name and all the code stolen from my site was already approved for iOS, yet my own app was still waiting for review. My app was then rejected a few days later because it had the same name as an app that stole my code... again.
Gabriele Cirulli is an extremely unlucky man stuck in an extremely unfair landscape, and I cannot fault him for wallowing in the first of the five stages of grief. If Flappy Bird's alleged $50,000/day income can safely be assumed to be the average earned by the ads on any given #1 iTunes free app, then the entity which first claimed the name "2048" in iTunes Connect is currently a millionaire, because 2048 was at the very top of the iTunes free app charts for weeks. Gabriele seems to believe or hope that the masses will see his "repost" of his own app and be stricken by the desire to do the ethically right thing and uninstall all of the rushed clones and install the legitimate version and play it with all the fervor and excitement as if the global 2048 hype still currently existed. Unfortunately this will NEVER happen.&lt;/p&gt;
&lt;p&gt;On a side note, Phonegap is only getting worse over time. Typical Adobe rot is setting in; the last version had a catastrophic bug causing the xml manifest to simply not be read during the build process, because a critical "for" loop was referencing the child element of a nonexistent variable. They swept this under the rug; countless hapless developers were mindlessly releasing broken apps during this period. Half of Phonegap's documentation refers to "Cordova" and executing "cordova" on the command line where it should say "Phonegap". Commands that have different names between Cordova and Phonegap are still documented as the Cordova equivalent, so one must use Google to find other people who searched for hours until they themselves came across the explanation that the same command in Phonegap requires the use of a completely different word. It is an absolute trainwreck, but aside from that, the primary issue for consumers now is that apps built with Phonegap no longer work correctly on newer versions of Android and haven't for months, which is why Gabriele's extremely simple and resource-minimal app is currently getting a bunch of 1- and 2-star reviews in the Google Play store with complaints about the speed.&lt;/p&gt;
&lt;p&gt;æ¥æºï¼šÂ &lt;a href="https://news.ycombinator.com/item?id=7704800"&gt;https://news.ycombinator.com/item?id=7704800&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;ç¿»è¯‘&lt;/h2&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªæ›¾ç»ä¸ºiOS,android,webå¼€å‘è¿‡æ¸¸æˆçš„äººï¼Œä¸‹é¢æ˜¯æˆ‘çš„ä¸€äº›ç»éªŒï¼š
åœ¨ç°åœ¨çš„ä¸–ç•Œé‡Œï¼Œå¦‚æœä½ æƒ³è·å¾—ä½ äº§å“åå­—çš„æ‰€æœ‰æƒ, é‚£ä¹ˆéœ€è¦è¿‘ä¹åŒæ—¶çš„åœ¨ä¸‰ä¸ªå¹³å°å‘å¸ƒ, å¹¶ä¸”ä½ å¿…é¡»è¿™ä¹ˆåš. è€Œä¸”ä½ å¾—ä¸¥æ ¼çš„æŒ‰ç…§ä¸‹é¢è¿™å‡ æ­¥åš, ä¸ç„¶ä½ çš„å‘å¸ƒå°±å¤±è´¥äº†.&lt;/p&gt;
&lt;p&gt;åœ¨å…¬ä¹‹äºä¼—ä¹‹å‰æ³¨å†Œä½ æ¸¸æˆçš„åŸŸå
æ¥ä¸‹æ¥,ä¸Šä¼ ä½ çš„ iOS åº”ç”¨åˆ° iTunes Connect ç„¶åç­‰å¾…å¤šè¾¾ä¸€å‘¨çš„æ—¶é—´çŸ¥é“é€šè¿‡å®¡æ ¸
ç„¶åä¸Šä¼ ä½ çš„ Android åº”ç”¨åˆ° Google Play, å¤§æ¦‚åªéœ€è¦å‡ å°æ—¶å°±èƒ½é€šè¿‡
æœ€åå…¬å¸ƒä½ çš„ web ç‰ˆæœ¬, ç„¶åé™„å¸¦ç€ç§»åŠ¨ç‰ˆæœ¬çš„é“¾æ¥å‘å¸ƒä½ çš„æ¸¸æˆ&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ åç¦»çš„è¿™ä¸ªé¡ºåº, é‚£ä¹ˆä½ å°±å®Œè›‹äº†. ä¸¾ä¸ªæ —å­, æˆ‘ç°åœ¨ç½‘ä¸Šå‘å¸ƒäº†ä¸€ä¸ªæ¸¸æˆç„¶åæ‰åœ¨ä¸€å¤©ä¹‹åæ‰ä¸Šä¼ åˆ° Google Play å¸‚åœº. å› ä¸ºæˆ‘è§‰å¾—æˆ‘éœ€è¦æ›´å¤šçš„æ—¶é—´æ¥æµ‹è¯•å’Œæ£€æŸ¥ bug, è€Œä¸”ç€å•¥æ€¥å•Š? æ€»ä¸èƒ½æœ‰äººåœ¨24æ¶ˆå¤±ä¹‹å†…å°±æŠŠæˆ‘çš„æ¸¸æˆå·äº†å§? é”™äº†, æˆ‘çš„åº”ç”¨è¢« Google æ‹’ç»äº†å› ä¸ºä»–ä»¬åšæŒè®¤ä¸ºæˆ‘çš„åº”ç”¨æ­£åœ¨æ¨¡ä»¿å…¶ä»–äººçš„. å…¶ä»–å¼€å‘è€…çš„åº”ç”¨å®Œå…¨æ˜¯æŠŠæˆ‘çš„ç½‘ç«™ä¸€è¡Œä¸å·®çš„åŒ…è£…äº†ä¸€ä¸‹ï¼ˆç”¨Phonegapï¼‰ã€‚æˆ‘å‘googleè§£é‡Šäº†è¿™ä¸€åˆ‡&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 04:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/how-to-publish-your-game.html</guid><category>åˆ›ä¸š</category></item><item><title>Python æ ‡å‡†åº“ä¸­çš„å®¹å™¨</title><link>/posts/python-biao-zhun-ku-zhong-de-rong-qi.html</link><description>&lt;h2&gt;namedtuple&lt;/h2&gt;
&lt;p&gt;a class template to generated memory efficient class&lt;/p&gt;
&lt;p&gt;&lt;code&gt;MyClass = namedtuple('MyClass', [attrib_foo, attrib_bar, ...])&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;keys and items of a dict can be used as a set.&lt;/p&gt;
&lt;h2&gt;deque&lt;/h2&gt;
&lt;p&gt;deque is implemented as deque, it can be created with maxlen=N&lt;/p&gt;
&lt;p&gt;appendleft, popleft, append, pop&lt;/p&gt;
&lt;h2&gt;defaultdict&lt;/h2&gt;
&lt;p&gt;multidict = defaultdict(list) # builds a multidict using list
multidict = defaultdict(set) # builds a multidict using set&lt;/p&gt;
&lt;h2&gt;OrderedDict&lt;/h2&gt;
&lt;p&gt;it perserves the order as insertion, implemented with a linked list&lt;/p&gt;
&lt;h2&gt;Counter&lt;/h2&gt;
&lt;p&gt;words_count = Counter(words)&lt;/p&gt;
&lt;p&gt;Counter.most_common(N)  returns tuple
Counter.update(more)    add more words&lt;/p&gt;
&lt;p&gt;counter even supports +/-&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 04:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-biao-zhun-ku-zhong-de-rong-qi.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>python logging library</title><link>/posts/python-logging-library.html</link><description>&lt;h2&gt;Yifei's Notes&lt;/h2&gt;
&lt;p&gt;Very sad, logging only supports %-style string formatting&lt;/p&gt;
&lt;p&gt;&lt;code&gt;logging.exception&lt;/code&gt; is the right way to log exceptions, not &lt;code&gt;logging.error&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;Basic Usage&lt;/h2&gt;
&lt;p&gt;åº“åªåº”è¯¥å®šä¹‰è‡ªå·±çš„æ—¥å¿—çš„æ ¼å¼, è€Œä¸åº”è¯¥å®šä¹‰è‡ªå·±çš„æ—¥å¿—å¦‚ä½•è¾“å‡º, æ—¥å¿—è¾“å‡ºåº”è¯¥ç”±æœ€ç»ˆçš„ä½¿ç”¨ç¨‹åºæ¥å®šä¹‰.
Â 
å¦‚æœä½¿ç”¨systemdæ¥è¿è¡Œç¨‹åºçš„è¯, ç›´æ¥æŠŠæ‰€æœ‰æ—¥å¿—æ‰“å°åˆ°stdoutå°±å¯ä»¥äº†&lt;/p&gt;
&lt;p&gt;&lt;code&gt;logging.basicConfig(level=level, format=fmt_string, filename=file, datefmt=datefmt)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;if you don't supply filename, the log is printed to stdout&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;logging.debug(&amp;#39;%string&amp;#39;, args) # send to format string as message
logging messages

logging.getLogger.level = logging.DEBUG
# reset logging level
# basicConfig can only be called once in the main thread
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;python çš„ logging&lt;/h1&gt;
&lt;h2&gt;åŸºæœ¬ä½¿ç”¨&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# myapp.py&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;logging&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mylib&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;basicConfig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;myapp.log&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Started&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;mylib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;do_something&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Finished&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# mylib.py&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;logging&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_something&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Doing something&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you run myapp.py, you should see this in myapp.log:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Started&lt;/span&gt;
&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Doing&lt;/span&gt; &lt;span class="n"&gt;something&lt;/span&gt;
&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Finished&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;è¿›é˜¶æ•™ç¨‹&lt;/h2&gt;
&lt;p&gt;logging æ¨¡å—æä¾›äº†å››ç§ä¸åŒçš„æ¨¡å—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Loggers expose the interface that application code directly uses.&lt;/li&gt;
&lt;li&gt;Handlers send the log records (created by loggers) to the appropriate destination.&lt;/li&gt;
&lt;li&gt;Filters provide a finer grained facility for determining which log records to output.&lt;/li&gt;
&lt;li&gt;Formatters specify the layout of log records in the final output.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;logger æ˜¯ä¸€æ£µæ ‘ï¼Œé»˜è®¤çš„logger æ˜¯ root loggerï¼Œlogging æ¨¡å—çš„æ–¹æ³•ä¹Ÿéƒ½æ˜¯åœ¨è°ƒç”¨è¿™ä¸ªlogger&lt;/p&gt;
&lt;h2&gt;Logging in a library&lt;/h2&gt;
&lt;h3&gt;get Logger&lt;/h3&gt;
&lt;p&gt;by defualt, the logger is called root logger.&lt;/p&gt;
&lt;p&gt;You should use the factory method logging.getLogger(name) to instaniate a logger object, the name is supposed to be foo.bar.baz, so the recommnend value is &lt;strong&gt;name&lt;/strong&gt;ï¼ŒThatâ€™s because in a module,Â &lt;strong&gt;name&lt;/strong&gt;Â is the moduleâ€™s name in the Python package namespace.&lt;/p&gt;
&lt;h3&gt;in lib.py&lt;/h3&gt;
&lt;p&gt;logger = logging.getLogger(&lt;strong&gt;name&lt;/strong&gt;)
logger.addHandler(logging.NullHandler())&lt;/p&gt;
&lt;p&gt;logger.debug('')&lt;/p&gt;
&lt;h3&gt;in app.py&lt;/h3&gt;
&lt;p&gt;logging.basicConfig() # seems like logging.start... must be called to enable logging&lt;/p&gt;
&lt;h2&gt;turn off 3rd party logs&lt;/h2&gt;
&lt;p&gt;logging.getLogger("requests").setLevel(logging.WARNING)&lt;/p&gt;
&lt;p&gt;import logging&lt;/p&gt;
&lt;p&gt;log = logging.getLogger(&lt;strong&gt;name&lt;/strong&gt;)&lt;/p&gt;
&lt;p&gt;log.setLevel(logging.INFO)  # è®¾ç½®loggerçš„çº§åˆ«&lt;/p&gt;
&lt;p&gt;handler = logging.NullHandler()
handler.setLevel(logging.INFO)  # è®¾ç½®handlerçš„çº§åˆ«&lt;/p&gt;
&lt;p&gt;formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
handler.setFormatter(formatter)&lt;/p&gt;
&lt;p&gt;log.addHandler(handler)&lt;/p&gt;
&lt;h1&gt;æ—¥å¿—çš„ä½œç”¨&lt;/h1&gt;
&lt;p&gt;Logging serves two purposes: [1]
    â€¢ Diagnostic loggingÂ records events related to the applicationâ€™s operation. If a user calls in to report an error, for example, the logs can be searched for context.
    â€¢ Audit loggingÂ records events for business analysis. A userâ€™s transactions can be extracted and combined with other user details for reports or to optimize a business goal.&lt;/p&gt;
&lt;h1&gt;æœ€ä½³å®è·µ&lt;/h1&gt;
&lt;p&gt;Here is an example of best practice from theÂ requests sourceÂ â€“ place this in yourÂ &lt;strong&gt;init&lt;/strong&gt;.py
import logging
logging.getLogger(&lt;strong&gt;name&lt;/strong&gt;).addHandler(logging.NullHandler())&lt;/p&gt;
&lt;p&gt;æ—¥å¿—åº”è¯¥çœ‹ä½œæ˜¯äº‹ä»¶æµ, ä¸è¦è‡ªå·±ç®¡ç†æ—¥å¿—, æŠŠæ—¥å¿—è¾“å‡ºåˆ°stdout[2]&lt;/p&gt;
&lt;p&gt;[1] http://docs.python-guide.org/en/latest/writing/logging/&lt;/p&gt;
&lt;p&gt;loggingæ¨¡å—æ˜¯thread safeçš„, è‡³å°‘ç†è®ºä¸Šæ¥è¯´æ˜¯çš„...&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:54:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-logging-library.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>python3 venv</title><link>/posts/python3-venv.html</link><description>&lt;h1&gt;Yifei's Notes&lt;/h1&gt;
&lt;h2&gt;traps&lt;/h2&gt;
&lt;p&gt;venv puts the current directory's name in its source code generated, so after renaming your directory, you will have to rename the &lt;code&gt;activate&lt;/code&gt; file and the &lt;code&gt;pip&lt;/code&gt; file.&lt;/p&gt;
&lt;h1&gt;venv&lt;/h1&gt;
&lt;p&gt;In Python 3, there comes a virtual environment shipped with the standard lib called &lt;code&gt;venv&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;to create a new venv, you can simply call:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python3 -m venv &amp;amp;lt;venv-name&amp;amp;gt;
virtualenv VENV_NAME  # for python 2
    --system-site-pakcages to bring system packages
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;to activate the venv, you need source the generated shell script&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;source &amp;amp;lt;venv-name&amp;amp;gt;/bin/activate
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Note: the generated activate script contains directory infomation based on your local computer and projects, so it's NOT portable.&lt;/p&gt;
&lt;p&gt;to deactivate it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;deactivate
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;But, in most times, we don't really care about the name of the virtual env, so let's simply call it &lt;code&gt;.venv&lt;/code&gt;, and you can add the following to your &lt;code&gt;.bashrc&lt;/code&gt; for convinence&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;DEFAULT_VENV_NAME=&amp;quot;.venv&amp;quot;
alias create-venv=&amp;quot;python3 -m venv $DEFAULT_VENV_NAME&amp;quot;
alias activate=&amp;quot;source $DEFAULT_VENV_NAME/bin/activate&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;after you activated you venv, there would be a prompt before your shell prompt. You can see that &lt;code&gt;python3&lt;/code&gt; and &lt;code&gt;pip3&lt;/code&gt; is set to the venv copy of python3 by running:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;which python3 # -&amp;amp;gt; .venv/bin/python3
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;if you run &lt;code&gt;pip install&lt;/code&gt;, the packages will be install in your local venv directory, so no sudo needed!&lt;/p&gt;
&lt;p&gt;since the venv directory is not portable, the best practice would be save your dependencies is your &lt;code&gt;requirements.txt&lt;/code&gt; file.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:52:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python3-venv.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>ç”¨äºæ›¿ä»£ajaxçš„ fetch API</title><link>/posts/yong-yu-ti-dai-ajaxde-fetch-api.html</link><description>&lt;p&gt;fetch is the new and easy api for js to make request to the server, it replaces XMLHttpRequest.&lt;/p&gt;
&lt;h2&gt;Objects:&lt;/h2&gt;
&lt;p&gt;fetch, Request, Reponse, Headers&lt;/p&gt;
&lt;h2&gt;Usage:&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;fetch(&amp;#39;/path/to/fetch&amp;#39;,
    {method: &amp;#39;GET&amp;#39;}
).then(function (response) {
    // process response;
    return response.json(); // returns a json promise
    return response.text(); // returns a text promise


    return ret; // will be consumed in the next then funcion
}).then(function (data) {
    // data is a json or text
    // process
}).catch(function (err) {

    // error handling
});
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;notice, the useful method &lt;/p&gt;
&lt;p&gt;Advanced:&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/yong-yu-ti-dai-ajaxde-fetch-api.html</guid><category>å¤§å‰ç«¯</category><category>è®¡ç®—æœº</category></item><item><title>List of OpenGL online tutorials</title><link>/posts/list-of-opengl-online-tutorials.html</link><description>&lt;p&gt;So I started to learn OpenGL, but the red book and blue book is just too detailed. I googled around, and knew that modern OpenGL is preferred (version 3 and above), however, the old Nehe's tutorial which is about OpenGL 1.x is still everywhere. To help beginners from digging too much into the old and deprecated way, here is a list of tutorials targeting modern OpenGL:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://antongerdelan.net/opengl/"&gt;Anton's OpenGL Tutorials&lt;/a&gt;
Â  Â  Great, updated frequently, but there is no source code provided. Good as a reference and starting point, but you just can't get anything up and running with it, you can just get the concept of how to do things in OpenGL.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://open.gl/"&gt;open.gl&lt;/a&gt;
Â  Â  not complete, but worth a view, the source code is elegant. Uses GLFW as window management&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.opengl-tutorial.org"&gt;OpenGL Tutorial&lt;/a&gt;
Â  Â  Great, the code is horriable, but somehow they did make it clear about what they are doing. Uses GLFW and glm.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://tomdalling.com/blog/category/modern-opengl/"&gt;Tom Dalling's OpenGL Tutorials&lt;/a&gt;
Â  Â  Great, short and covers the basics&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.arcsynthesis.org/gltut"&gt;Learning Modern 3D Graphics Programming&lt;/a&gt;
Â  Â  Great, intermediate&lt;/li&gt;
&lt;li&gt;&lt;a href="http://ogldev.atspace.co.uk/index.html"&gt;ogldev's OpenGL Step by Step&lt;/a&gt;
Â  Â  Great, a little long(40 lessons), targeting linux&lt;/li&gt;
&lt;li&gt;&lt;a href="http://nopper.tv/norbert/opengl.html"&gt;OpenGL 3 and OpenGL 4 with GLSL&lt;/a&gt;
Â  Â  only source code, no guides, eclipse needed.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.scratchapixel.com/"&gt;Scratch a Pixel&lt;/a&gt;
Â  Â  a website about math used in Computer Graphics&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.swiftless.com/opengl4tuts.html"&gt;Swiftless's OpenGL Tutorial&lt;/a&gt;
Â  Â  not complete, outdated&lt;/li&gt;
&lt;li&gt;&lt;a href="http://openglbook.com/the-book/"&gt;OpenGL Book&lt;/a&gt;
Â  Â  not complete&lt;/li&gt;
&lt;li&gt;&lt;a href="http://duriansoftware.com/joe/An-intro-to-modern-OpenGL.-Table-of-Contents.html"&gt;Joe's&lt;/a&gt;
Â  Â  not complete&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:44:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/list-of-opengl-online-tutorials.html</guid><category>å›¾å½¢å­¦</category><category>è®¡ç®—æœº</category></item><item><title>è·¨è¿‡é•¿åŸçš„é•œåƒ</title><link>/posts/kua-guo-chang-cheng-de-jing-xiang.html</link><description>&lt;h2&gt;pip&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Douban pip mirrorï¼š sudo pip install -i http://pypi.douban.com/simple/ flask&lt;/li&gt;
&lt;li&gt;Aliyun pip mirrorï¼š http://mirrors.aliyun.com/pypi/simple/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:43:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/kua-guo-chang-cheng-de-jing-xiang.html</guid><category>å°æŠ€å·§</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>HTTPS å’Œ SSL ç›¸å…³ä¿¡æ¯</title><link>/posts/https-he-ssl-xiang-guan-xin-xi.html</link><description>&lt;h1&gt;è¯ä¹¦æ–‡ä»¶&lt;/h1&gt;
&lt;p&gt;the de facto SSL certs format is X.509 v3&lt;/p&gt;
&lt;p&gt;it contains:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;version   &lt;/li&gt;
&lt;li&gt;serial number &lt;/li&gt;
&lt;li&gt;algoirthm &lt;/li&gt;
&lt;li&gt;authority &lt;/li&gt;
&lt;li&gt;validate date &lt;/li&gt;
&lt;li&gt;orgnisation   &lt;/li&gt;
&lt;li&gt;pubkey    &lt;/li&gt;
&lt;li&gt;etc.  &lt;/li&gt;
&lt;li&gt;sign, the ca signs the cert using its private key&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:38:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/https-he-ssl-xiang-guan-xin-xi.html</guid><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>åŠ¨æ€è§„åˆ’</title><link>/posts/dong-tai-gui-hua.html</link><description>&lt;p&gt;å¦‚æœæ¯ä¸ªé˜¶æ®µçš„å†³ç­–éƒ½å’ŒçŠ¶æ€æ— å…³ï¼Œé‚£ä¹ˆå°±æ˜¯è´ªå¿ƒç®—æ³•&lt;/p&gt;
&lt;p&gt;å¦‚æœéœ€è¦æŠŠæ•´ä¸ªè§£ç©ºé—´éƒ½éå†ä¸€éï¼Œé‚£ä¹ˆå°±æ˜¯ç©·ä¸¾&lt;/p&gt;
&lt;p&gt;å¦‚æœå¯ä¸€ä¸ªæ ¹æ®ä¸Šä¸€æ­¥çš„ç»“æœçš„å‡ºä¸‹ä¸€æ­¥çš„ç»“æœï¼Œå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹è½¬è½½è‡ªï¼šhttps://www.zhihu.com/question/39948290/answer/155958549&lt;/p&gt;
&lt;h1&gt;1.åŠ¨æ€è§„åˆ’æ˜¯ï§½ä¹ˆ?&lt;/h1&gt;
&lt;p&gt;ç­”ï¼šåŠ¨æ€è§„åˆ’æ˜¯ä¸€ç§é€šè¿‡â€œå¤§è€ŒåŒ–å°â€çš„æ€ï¤·è§£å†³é—®é¢˜çš„ç®—æ³•ã€‚åŒºåˆ«äºä¸€äº›å›ºå®šå½¢å¼çš„ç®—æ³•ï¼Œå¦‚äºŒåˆ†æ³•ï¼Œå®½åº¦ä¼˜
å…ˆæœç´¢æ³•ï¼ŒåŠ¨æ€è§„åˆ’æ²¡æœ‰å®é™…çš„æ­¥éª¤æ¥è§„å®šç¬¬ä¸€æ­¥åšï§½ä¹ˆç¬¬äºŒæ­¥åšï§½ä¹ˆã€‚æ‰€ä»¥ï¤åŠ ç¡®åˆ‡çš„è¯´ï¼ŒåŠ¨æ€è§„åˆ’æ˜¯ä¸€ç§
è§£å†³é—®é¢˜çš„æ€æƒ³ã€‚è¿™ç§æ€æƒ³çš„æœ¬è´¨æ˜¯ï¼Œä¸€ä¸ªè§„æ¨¡æ¯”è¾ƒå¤§çš„é—®é¢˜ï¼ˆå‡å¦‚ç”¨2â€‘3ä¸ªå‚æ•°å¯ä»¥è¡¨ç¤ºï¼‰ï¼Œæ˜¯é€šè¿‡è§„æ¨¡æ¯”
è¾ƒå°çš„è‹¥å¹²é—®é¢˜çš„ç»“æœæ¥å¾—åˆ°çš„ï¼ˆé€šè¿‡å–æœ€å¤§ï¼Œå–æœ€å°ï¼Œæˆ–è€…åŠ èµ·æ¥ä¹‹ç±»çš„è¿ç®—ï¼‰æ‰€ä»¥æˆ‘ä»¬ç»å¸¸çœ‹åˆ°çš„åŠ¨æ€è§„
åˆ’çš„æ ¸å¿ƒâ€”â€”çŠ¶æ€è½¬ç§»æ–¹ç¨‹éƒ½é•¿æˆè¿™æ ·ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;f[i][j] = f[i â€‘ 1][j] + f[i][j â€‘ 1]&lt;/li&gt;
&lt;li&gt;f[i] = max{f[j] if j &amp;lt; i and â€¦} + 1&lt;/li&gt;
&lt;li&gt;f[i][j] = f[0][j â€‘ 1] &amp;amp;&amp;amp; judge(1,i) || f[1][j â€‘ 1] &amp;amp;&amp;amp; judge(2,i) || â€¦&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;2.åŠ¨æ€è§„åˆ’é¢è¯•è€ƒå¾—å¤šä¹ˆï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ç­”ï¼šå¤šã€‚å¹¶ä¸”è¶Šæ¥è¶Šå¤šã€‚éšç€CSä»ä¸šä¸æ±‚èŒè€…çš„å¢åŠ ï¼Œå¹¶ä¼´éšå¤§å®¶éƒ½æ˜¯â€œæœ‰å¤‡è€Œæ¥â€çš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬ç®€å•çš„åè½¬
é“¾è¡¨ä¹‹ç±»çš„é¢˜ç›®å·²ç»æ— æ³•å†åœ¨é¢è¯•ä¸­åšæŒºï¦ºã€‚å› æ­¤åœ¨æ±‚èŒè€…äººæ•°ä¸æ‹›è˜åé¢çš„æ¯”ï¦µè¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œå…¬å¸ä¼šå€¾å‘
äºå‡ºï¤éš¾çš„é¢è¯•é—®é¢˜ã€‚è€ŒåŠ¨æ€è§„åˆ’å°±æ˜¯ä¸€ç§æ¯”è¾ƒå…·æœ‰éš¾åº¦ï¼Œåˆæ¯”è¾ƒâ€œå¥½å‡ºâ€çš„é¢è¯•é—®é¢˜ã€‚ç›¸æ¯”å…¶ä»–çš„ç®—æ³•ä¸æ•°æ®
ç»“æ„çŸ¥è¯†æ¥è¯´ï¼Œè´ªå¿ƒæ³•åˆ†æ²»æ³•å¤ªéš¾å‡ºé¢˜ï¦ºï¼Œæœç´¢ç®—æ³•å¾€å¾€éœ€è¦è€—è´¹æ±‚èŒè€…è¿‡é•¿çš„ç¨‹åºç¼–å†™æ—¶é—´ä¸€èˆ¬ä¹Ÿï¥§å€¾å‘äº
å‡ºï¼ŒäºŒå‰æ ‘é“¾è¡¨ç­‰é—®é¢˜é¢˜ç›®å¹¶æ²¡æœ‰é‚£ä¹ˆå¤šï¼Œè€Œä¸”æ±‚èŒè€…ä¹Ÿéƒ½ä¼šç€é‡å‡†å¤‡è¿™ä¸€å—ã€‚å› æ­¤åŠ¨æ€è§„åˆ’è¿™ä¸€ç±»çš„é—®é¢˜ï¼Œ
ï¥¥è¶Šæ¥è¶Šå¤šçš„å‡ºç°åœ¨ï¦ºé¢è¯•ä¸­ã€‚&lt;/p&gt;
&lt;h1&gt;3.åŠ¨æ€è§„åˆ’å¿«åœ¨å“ªå„¿ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ç­”ï¼šåŠ¨æ€è§„åˆ’ä¸€èˆ¬æ¥è¯´æ˜¯â€œé«˜æ•ˆâ€çš„ä»£åè¯ï¼Œå› ä¸ºå…¶è§£å†³çš„é—®é¢˜ä¸€èˆ¬é€€è€Œæ±‚å…¶æ¬¡çš„ç®—æ³•åªæœ‰æœç´¢ï¦ºã€‚ä»¥â€œæ•°å­—ä¸‰
è§’å½¢â€ä¸€é¢˜ä¸ºï¦µå­ï¼ˆlintcode.com/problem/trï¼‰ ï¼Œåœ¨â€œä¸‰è§’çŸ©é˜µâ€ä¸­æ‰¾ä¸€æ¡ä»ä¸Šåˆ°ä¸‹çš„ï¤·å¾„ï¼Œä½¿å¾—æƒå€¼ä¹‹å’Œæœ€
å°ã€‚å¦‚æœä½¿ç”¨ï¨†ï¦Šæœç´¢çš„ç®—æ³•ï¼Œé‚£ä¹ˆéœ€æ±‚ç©·ä¸¾å‡º2^(nâ€‘1)æ¡ï¤·å¾„ï¼ˆnä¸ºä¸‰è§’å½¢é«˜åº¦ï¼‰ï¼Œè€Œä½¿ç”¨åŠ¨æ€è§„åˆ’çš„è¯ï¼Œåˆ™
æ—¶é—´å¤æ‚åº¦é™ä½åˆ°ï¦ºn^2ï¼Œå®Œæˆï¦ºè´¨çš„é£è·ƒã€‚é‚£ä¹ˆç©¶ç«Ÿä¸ºï§½ä¹ˆè¿™ä¹ˆå¿«å‘¢ï¼ŸåŸå› åœ¨äºåŠ¨æ€è§„åˆ’ç®—æ³•å»æ‰ï¦ºâ€œæ— ç”¨å’Œ
é‡å¤çš„è¿ç®—â€ã€‚åœ¨æœç´¢ç®—æ³•ä¸­ï¼Œå‡å¦‚ä»Aâ€‘&amp;gt;Bæœ‰2æ¡ï¤·å¾„ï¼Œä¸€æ¡ä»£ä»·ä¸º10ï¼Œå¦å¤–ä¸€æ¡ä»£ä»·ä¸º100ï¼ŒBâ€‘&amp;gt;ç»ˆç‚¹æœ‰1024
æ¡ï¤·å¾„ã€‚å½“æˆ‘ä»¬é€‰æ‹©ï¦ºä»£ä»·ä¸º10çš„é‚£æ¡ï¤·å¾„èµ°åˆ°Bæ—¶ï¼Œå¯ä»¥ç»§ç»­å¾€ä¸‹èµ°å®Œ1024æ¡ï¤·å¾„åˆ°ç»ˆç‚¹ï¼Œä½†æ˜¯åœ¨æ­¤ä¹‹åï¼Œ
æˆ‘ä»¬å†ä»ä»£ä»·ä¸º100çš„ï¤·å¾„ä»Aèµ°åˆ°Bæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ­¤æ—¶æ— è®ºå¦‚ä½•èµ°ï¼Œéƒ½ï¥§å¯èƒ½æœ‰åˆšæ‰ä»10çš„ï¤·å¾„èµ°è¿‡æ¥ï¤
å¥½ï¼Œæ‰€ä»¥è¿™äº›è®¡ç®—æ˜¯â€œæ— ç”¨â€çš„è®¡ç®—ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯â€œé‡å¤â€çš„è®¡ç®—ã€‚è¿™å°±æ˜¯åŠ¨æ€è§„åˆ’ä¹‹æ‰€ä»¥â€œå¿«â€çš„é‡è¦åŸå› ã€‚&lt;/p&gt;
&lt;h1&gt;4.å­¦ä¹ åŠ¨æ€è§„åˆ’æœ‰ï§½ä¹ˆæ·å¾„ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ç­”ï¼šæˆ‘ä»¬å°†åŠ¨æ€è§„åˆ’çš„å¸¸è§ç±»å‹åˆ†ä¸ºå¦‚ä¸‹å‡ ç§ï¼š
&lt;em&gt; çŸ©é˜µå‹
&lt;/em&gt; åºï¦œå‹
&lt;em&gt; åŒåºï¦œå‹
&lt;/em&gt; åˆ’åˆ†å‹
&lt;em&gt; åŒºé—´å‹
&lt;/em&gt; èƒŒåŒ…å‹
&lt;em&gt; çŠ¶æ€å‹ç¼©å‹
&lt;/em&gt; æ ‘å‹
å…¶ä¸­ï¼Œåœ¨æŠ€æœ¯é¢è¯•ä¸­ç»å¸¸å‡ºç°çš„æ˜¯çŸ©é˜µå‹ï¼Œåºï¦œå‹å’ŒåŒåºï¦œå‹ã€‚åˆ’åˆ†å‹ï¼ŒåŒºé—´å‹å’ŒèƒŒåŒ…å‹å¶å°”å‡ºç°ã€‚çŠ¶æ€å‹ç¼©
å’Œæ ‘å‹åŸºæœ¬ï¥§ä¼šå‡ºç°ï¼ˆä¸€èˆ¬åœ¨ç®—æ³•ç«èµ›ä¸­æ‰ä¼šå‡ºç°ï¼‰ã€‚
æ¯ç§ç±»å‹éƒ½æœ‰ç€è‡ªå·±çš„é¢˜ç›®ç‰¹ç‚¹å’ŒçŠ¶æ€çš„è¡¨ç¤ºæ–¹æ³•ã€‚ä»¥çŸ©é˜µå‹åŠ¨æ€è§„åˆ’ä¸ºï¦µï¼Œä¸€èˆ¬é¢˜ç›®ä¼šç»™ä½ ä¸€ä¸ªçŸ©é˜µï¼Œå‘Šè¯‰
ä½ æœ‰ä¸€ä¸ªå°äººåœ¨ä¸Šé¢èµ°åŠ¨ï¼Œæ¯æ¬¡åªèƒ½å‘å³å’Œå‘ä¸‹èµ°ï¼Œç„¶åé—®ä½ æ¯”å¦‚æœ‰å¤šå°‘ç§æ–¹æ¡ˆä»å·¦ä¸Šèµ°åˆ°å³ä¸‹
(lintcode.com/problem/un)ã€‚è¿™ç§ç±»å‹çŠ¶æ€è¡¨ç¤ºçš„ç‰¹ç‚¹ä¸€èˆ¬æ˜¯ä½¿ç”¨åæ ‡ä½œä¸ºçŠ¶æ€ï¼Œå¦‚f[i][j]è¡¨ç¤ºèµ°åˆ°(i,j)è¿™ä¸ªä½
ç½®çš„æ—¶å€™ï¼Œä¸€å…±æœ‰å¤šå°‘ç§æ–¹æ¡ˆã€‚çŠ¶æ€çš„è½¬ç§»åˆ™æ˜¯è€ƒè™‘æ˜¯ä»å“ªå„¿èµ°åˆ°(i,j)è¿™ä¸ªåæ ‡çš„ã€‚è€Œåºï¦œå‹çš„åŠ¨æ€è§„åˆ’ï¼Œä¸€
èˆ¬æ˜¯å‘Šè¯‰ä½ ä¸€ä¸ªåºï¦œï¼›åŒåºï¦œçš„åŠ¨æ€è§„åˆ’ä¸€èˆ¬æ˜¯å‘Šè¯‰ä½ ä¸¤ä¸ªå­—ç¬¦ï¤…æˆ–è€…ä¸¤ä¸ªåºï¦œã€‚
å°†æ‰€åšè¿‡çš„åŠ¨æ€è§„åˆ’é—®é¢˜æŒ‰ç…§è¿™äº›ç±»åˆ«è¿›ï¨ˆå½’ç±»ï¼Œåˆ†æçŠ¶æ€çš„è¡¨ç¤ºæ–¹æ³•å’ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹çš„æ„é€ æ–¹æ³•åœ¨æ¯ç§ç±»å‹
ä¸­çš„è¿‘ä¼¼ä¹‹å¤„ï¼Œä¼šè®©ä½ ï¤å¿«çš„å­¦ä¼šåŠ¨æ€è§„åˆ’ã€‚&lt;/p&gt;
&lt;h1&gt;5.ï§½ä¹ˆæ ·çš„é—®é¢˜é€‚åˆä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ç­”ï¼šå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„é—®é¢˜ä¸€èˆ¬éƒ½æœ‰ä¸€äº›ç‰¹ç‚¹å¯ä»¥éµå¾ªã€‚å¦‚é¢˜ç›®çš„é—®æ³•ä¸€èˆ¬æ˜¯ä¸‰ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ±‚æœ€å¤§å€¼/æœ€å°å€¼&lt;/li&gt;
&lt;li&gt;æ±‚å¯ï¥§å¯ï¨ˆ&lt;/li&gt;
&lt;li&gt;æ±‚æ–¹æ¡ˆæ€»æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœä½ ç¢°åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯é—®ä½ è¿™ä¸‰ä¸ªé—®é¢˜ä¹‹ä¸€çš„ï¼Œé‚£ä¹ˆæœ‰90%çš„æ¦‚ç‡æ˜¯ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥æ±‚è§£ã€‚
è¦é‡ç‚¹è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªé—®é¢˜è®©ä½ æ±‚å‡ºâ€œæ‰€æœ‰çš„â€æ–¹æ¡ˆå’Œç»“æœï¼Œåˆ™è‚¯å®šï¥§æ˜¯ä½¿ç”¨åŠ¨æ€è§„åˆ’ã€‚&lt;/p&gt;
&lt;h1&gt;6.è§£å†³ä¸€ä¸ªåŠ¨æ€è§„åˆ’é—®é¢˜çš„æ­¥éª¤æ˜¯ï§½ä¹ˆï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ç­”ï¼šé¦–å…ˆæ ¹æ®â€œé—®5â€åˆ¤æ–­æ˜¯å¦æ˜¯åŠ¨æ€è§„åˆ’çš„é—®é¢˜ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°è¯•å°†å…¶æŒ‰ç…§â€œé—®4â€è¿›ï¨ˆåˆ†ç±»ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç±»åˆ«å’Œ
ç›¸ä¼¼çš„é—®é¢˜ã€‚æ¥ç€ä»ä¸‹é¢çš„4ä¸ªè¦ç´ å»é€æ­¥å‰–æè§£å†³è¿™é“é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çŠ¶æ€æ˜¯ï§½ä¹ˆ&lt;/li&gt;
&lt;li&gt;çŠ¶æ€è½¬ç§»æ–¹ç¨‹æ˜¯ï§½ä¹ˆ&lt;/li&gt;
&lt;li&gt;çŠ¶æ€çš„åˆå§‹å€¼æ˜¯ï§½ä¹ˆ&lt;/li&gt;
&lt;li&gt;é—®é¢˜è¦æ±‚çš„æœ€åç­”æ¡ˆæ˜¯ï§½ä¹ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¯ä¸ªæ­¥éª¤åˆ†æå®Œæˆä¹‹åï¼Œå°±åŸºæœ¬ä¸Šè§£å†³ï¦ºæ•´é“åŠ¨æ€è§„åˆ’çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1&gt;7.æ€ä¹ˆä¼˜åŒ–åŠ¨æ€è§„åˆ’çš„æ—¶é—´ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ç­”ï¼šä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£çš„é—®é¢˜ï¼Œæ—¶é—´ä¸Šå·²ç»æ¯”ï¨†ï¦Šæœç´¢è¦ä¼˜åŒ–å¾ˆå¤šï¦ºã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨ç€ä¸€äº›å¯ä»¥ä¼˜
åŒ–çš„ç©ºé—´ã€‚é€šå¸¸æ¥è¯´ï¼ŒåŠ¨æ€è§„åˆ’çš„æ—¶é—´ä¼˜åŒ–ï¼Œæœ‰å¦‚ä¸‹ä¸¤ç§å¸¸è§çš„æ–¹å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡å˜æ¢çŠ¶æ€ä¼˜åŒ–&lt;/li&gt;
&lt;li&gt;é€šè¿‡å†³ç­–å•è°ƒä¼˜åŒ–&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯¹äºé€šè¿‡å˜æ¢çŠ¶æ€æ¥ä¼˜åŒ–çš„é—®é¢˜æ¯”è¾ƒéš¾ï¼Œéœ€è¦ä¸€äº›ç»éªŒå’Œçµæ„Ÿã€‚è€Œå¯¹äºå†³ç­–å•è°ƒçš„ä¼˜åŒ–ï¼Œåˆ™æ¯”è¾ƒç®€å•ï¼Œä½†é€‚ç”¨
èŒƒå›´ï¥§å¹¿ï¼Œä¸€èˆ¬åªé€‚ç”¨äºåˆ’åˆ†å‹åŠ¨æ€è§„åˆ’å½“ä¸­ï¼Œé€šå¸¸è¿™ä¸ªæ–¹æ³•å¯ä»¥å°†å¤æ‚åº¦é™ä½ä¸€ä¸ªæ•°ï¥¾çº§ã€‚&lt;/p&gt;
&lt;h1&gt;8.æ€æ ·ä¼˜åŒ–åŠ¨æ€è§„åˆ’çš„ç©ºé—´ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ç­”ï¼šåŠ¨æ€è§„åˆ’çš„ç©ºé—´ä¼˜åŒ–å¾€å¾€é‡‡ç”¨æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ã€‚ä»¥ä¸€ä¸ªäºŒç»´çš„åŠ¨æ€è§„åˆ’ä¸ºï¦µå­ã€‚å‡å¦‚çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;f[i][j] = f[i â€‘ 1][j] + f[i][j â€‘ 1]ã€‚
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç¬¬iå±‚çš„çŠ¶æ€ï¼Œå·²ç»å’Œç¬¬iâ€‘2å±‚çš„çŠ¶æ€æ²¡æœ‰å…³ç³»ï¦ºï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œç”¨äºå­˜å‚¨ç¬¬iâ€‘2å±‚çš„ç©ºé—´å°±å¯ä»¥è¢«é‡å¤ï§ç”¨ã€‚æ–¹æ³•éå¸¸ç®€å•ï¼ŒæŠŠæ•°ç»„çš„ç¬¬ä¸€ç»´å¯¹2å–æ¨¡å°±å¯ä»¥ï¦ºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;f[i % 2][j] = f[(i â€‘ 1) % 2][j] + f[i % 2][jâ€‘1]ã€‚
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿™ç§æ–¹æ³•é€šå¸¸å¯ä»¥å°†ç©ºé—´å¤æ‚åº¦é™ä½ä¸€ä¸ªæ•°ï¥¾çº§ã€‚&lt;/p&gt;
&lt;h1&gt;9.æœ‰ï§½ä¹ˆä¹¦ç±å’Œå‚è€ƒèµ„ï¦¾å¯ä»¥æ¨èä¹ˆï¼Ÿ&lt;/h1&gt;
&lt;p&gt;è‘—åçš„èƒŒåŒ…ä¹è®²ï¼š
vdisk.weibo.com/s/tanGy ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥åœ¨ç½‘ä¸Šæœç´¢èƒŒåŒ…ä¹è®²ï¼‰&lt;/p&gt;
&lt;h1&gt;10.æœ‰å“ªäº›åŠ¨æ€è§„åˆ’é¢˜ç›®å¿…é¡»è¦ç»ƒä¹ çš„ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;åœ¨LintCodeä¸ŠåŒ…å«ï¦º30ä½™é“åŠ¨æ€è§„åˆ’çš„ç»ƒä¹ é¢˜ï¼Œéƒ½æ˜¯ä»å®é™…çš„é¢è¯•é—®é¢˜ä¸­æ±‡æ€»çš„ç²¾é€‰ç»ƒä¹ ï¼š
lintcode.com/tag/dynami&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼ŒåŠ¨æ€è§„åˆ’è‡ªå­¦å¹¶ï¥§éš¾ï¼Œå…³é”®æ˜¯ä½ è¦æŒæ¡å­¦ä¹ çš„æ–¹æ³•ã€‚
å¦‚æœä½ è§‰å¾—æˆ‘è¯´çš„å¾ˆæœ‰ç”¨ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ï¼šninechapterï¼Œï§©é¢æœ‰ï©…ï¥¾çš„ç®—æ³•é¢˜ç­‰ä½ é¢†å–~&lt;/p&gt;
&lt;h2&gt;åŸºç¡€ä»‹ç»&lt;/h2&gt;
&lt;p&gt;http://www.hawstein.com/posts/dp-novice-to-advanced.html&lt;/p&gt;
&lt;h2&gt;æ•°ç»„åˆ†å‰²é—®é¢˜&lt;/h2&gt;
&lt;p&gt;http://www.cnblogs.com/liyukuneed/archive/2013/05/27/3090454.html&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:36:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/dong-tai-gui-hua.html</guid><category>ç®—æ³•</category><category>è®¡ç®—æœº</category></item><item><title>åŸºç¡€ socket ç¼–ç¨‹</title><link>/posts/ji-chu-socket-bian-cheng.html</link><description>&lt;p&gt;åˆ›å»ºä¸ä½¿ç”¨ socket, ä¸€ä¸ª echo server å’Œ client&lt;/p&gt;
&lt;p&gt;socket å®¢æˆ·ç«¯çš„å››ä¸ªæ­¥éª¤: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨ socket å‡½æ•°åˆ›å»ºè¿æ¥&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ connect è¿æ¥åˆ°æœåŠ¡å™¨&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ send å’Œ recv æ¥æ”¶å’Œå‘é€æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ close å…³é—­è¿æ¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥ åˆ›å»ºä¸€ä¸ª TCP socket
int sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
è¿”å›çš„ sock å¯ä»¥çœ‹åšä¸€ä¸ª handle, æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦( file descriptor) , å°äº0è¡¨ç¤ºé”™è¯¯&lt;/p&gt;
&lt;p&gt;è¡¨ç¤º socket åœ°å€çš„ç»“æ„ sockaddr_in, å…¶ä¸­ in è¡¨ç¤º internet, ä¸æ˜¯input&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;struct sockaddr_in {
    __uint8_t   sin_len;
    sa_family_t sin_family;
    in_port_t   sin_port;
    struct in_addr    sin_addr;
    char        sin_zero[8];
};
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;å…¶ä¸­ sin_familyå’Œ sin_portå’Œ sin_addr.s_addr å­—æ®µå¿…é¡»å¡«å†™&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ inet_ptonæŠŠ IP å­—ç¬¦ä¸²è½¬åŒ–ä¸º32ä½æ•´å½¢
ç«¯å£å·éœ€è¦ä½¿ç”¨ htons è½¬åŒ–&lt;/p&gt;
&lt;p&gt;ä¸‹ä¸€æ­¥å°±æ˜¯è¿æ¥äº†, æ³¨æ„ connect å’Œå¥½å¤šå‡½æ•°éƒ½è¦æ±‚æŠŠå‚æ•°ä» sockaddr_in è½¬åŒ–åˆ° sockaddr, ç„¶åå†è·Ÿä¸€ä¸ªå‚æ•°è¡¨ç¤ºå®é™…çš„æ•°æ®ç»“æ„çš„é•¿åº¦. è¿™æ˜¯å› ä¸º C ä¸æ”¯æŒå¤šæ€.&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ­¥å°±æ˜¯å‘é€å’Œæ¥æ”¶æ•°æ®, æˆ‘ä»¬ä½¿ç”¨ send å‡½æ•°å‘é€, sendæˆåŠŸçš„è¯ä¼šè¿”å›å‘é€æˆåŠŸçš„æ•°æ®çš„é•¿åº¦, å¯èƒ½å’ŒæŒ‡å®šçš„æ•°æ®ä¸ç­‰, å› æ­¤éœ€è¦åˆ¤æ–­æ˜¯å¦å‘é€æˆåŠŸ. recv ä¹Ÿå¯èƒ½è¿”å›ä»»æ„é•¿åº¦çš„æ•°æ®, å› æ­¤éœ€è¦åœ¨ä¸€ä¸ªå¾ªç¯é‡Œæ¥å—. send å’Œ recv éƒ½æ˜¯é˜»å¡çš„&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;int send(int socket, const void* buffer, size_t length, int flags);
int recv(int socket, const void* buffer, size_t length, int flags);
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æœ€åå…³é—­è¿æ¥&lt;/p&gt;
&lt;p&gt;éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯, æ°¸è¿œä¸è¦æŠŠæ¥è‡ªå…¶ä»–ä¸»æœºçš„æ¶ˆæ¯ä½¿ç”¨ pritnf ç­‰ä¸å®‰å…¨çš„å‡½æ•°æ‰“å°å‡ºæ¥&lt;/p&gt;
&lt;p&gt;socket æœåŠ¡å™¨çš„å››ä¸ªæµç¨‹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨ socket å‡½æ•°åˆ›å»ºé“¾æ¥&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ bind å‡½æ•°ç»‘å®šç«¯å£å·&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ listenæ‰“å¼€ç›‘å¬æ¨¡å¼&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ accept æ¥æ”¶æ–°çš„å®¢æˆ·, å¹¶ä¸ºä¹‹æœåŠ¡
    a.  accept ä¼šä¸ºæ¯ä¸ªå®¢æˆ·åˆ›å»ºæ–°çš„ socket
    b. é€šè¿‡è¿™ä¸ª socket ä¸å®¢æˆ·ç«¯ä¹‹é—´ send/recv
    c. å…³é—­è¯¥ socket&lt;/li&gt;
&lt;li&gt;å…³é—­ç›‘å¬çš„ socket&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥,åˆ›å»º socket, å’Œå®¢æˆ·ç«¯å®Œå…¨ä¸€æ ·
æ³¨æ„, æœåŠ¡ç«¯çš„åœ°å€æœ‰æ‰€ä¸åŒ, ä¸ºäº†æ¥å—ä»»ä½•ä¸€ä¸ªå®¢æˆ·, æˆ‘ä»¬éœ€è¦ç›‘å¬æœåŠ¡å™¨çš„æ‰€æœ‰ IP (æœåŠ¡å™¨å¯èƒ½æœ‰å¤šä¸ªç½‘å¡, ä¹Ÿå°±æœ‰å¤šä¸ª IP).&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒæ­¥, ä½¿ç”¨ bind ç»‘å®šåˆ°å¯¹åº”çš„ ip å’Œç«¯å£å·, listen æŠŠ socket è®¾å®šä¸ºç›‘å¬çŠ¶æ€. æ³¨æ„ listen è¿˜æœ‰ä¸€ä¸ªå‚æ•°ä»£è¡¨&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ­¥, ä½¿ç”¨ accept å¼€å§‹é˜»å¡åœ°ç­‰å¾…å®¢æˆ·ç«¯. æ³¨æ„ accept å®é™…ä¸Šæœ‰ä¸¤ä¸ªè¿”å›å€¼,ä¸€ä¸ªé€šè¿‡å‡½æ•°è¿”å›çš„å½¢å¼è¿”å›ä¸€ä¸ªå®¢æˆ·ç«¯çš„ socket, è¿˜æœ‰ä¸€ä¸ªé€šè¿‡æŒ‡é’ˆçš„å½¢å¼è¿”å›ä¸€ä¸ª sockaddr_in&lt;/p&gt;
&lt;p&gt;ç¬¬å››æ­¥,æ¥ä¸‹æ¥, æŠŠæ¯ä¸€ä¸ªè·å¾—çš„ client socket éƒ½å¯¹åº”åœ°å¤„ç†&lt;/p&gt;
&lt;p&gt;å…³é—­ä¸» socket&lt;/p&gt;
&lt;p&gt;æœ€åéœ€è¦æ³¨æ„çš„æ˜¯, &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨åˆ°çš„ä¸€äº›è½¬åŒ–å‡½æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;inet_pton/inetntop htons, ntohs, htonl, ntohl&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;socket  ä¸ºåœ°å€å®šä¹‰äº†é€šç”¨çš„æ•°æ®ç»“æ„ sockaddr, ä¹Ÿå°±æ˜¯ sockaddr_in ç­‰ç»“æ„åº”è¯¥çœ‹ä½œæ˜¯ sockaddr çš„å­ç±». åœ¨ connect å’Œ bind ç­‰å‡½æ•°ä¸­çš„å‚æ•°éƒ½æ˜¯ sockaddr* ä»¥åŠå®é™…æ•°æ®ç±»å‹çš„ size.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;ä½¿ç”¨ UDP socket&lt;/h1&gt;
&lt;p&gt;ç›¸æ¯”æ¥è¯´, UDP å°±éå¸¸ç®€å•äº†, ç›¸å¯¹äº TCP åœ¨ IP å±‚ä¹‹ä¸Šæä¾›ä¸ªå„ç§æœåŠ¡, UDP åªæ·»åŠ äº†ä¸¤é¡¹, ç«¯å£å·å’Œæ ¡éªŒ, è€Œä¸”åªæ˜¯ç®€å•åœ°æŠŠæ ¡éªŒå‡ºé”™çš„åŒ…ä¸¢æ‰.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:28:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ji-chu-socket-bian-cheng.html</guid><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>å¦‚ä½•è®©å®‰å“æ‰‹æœºæ’ä¸Šç”µæºè‡ªåŠ¨å¼€æœº</title><link>/posts/ru-he-rang-an-zhuo-shou-ji-cha-shang-dian-yuan-zi-dong-kai-ji.html</link><description>&lt;p&gt;éå¸¸ç®€å•çš„åŸç†ï¼ŒæŠŠå……ç”µç”µæ± åŠ¨ç”»æ–‡ä»¶æ›¿æ¢æˆé‡å¯å‘½ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚è¯´ï¼Œå¯¹äºçº¢ç±³ Note2ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ &lt;code&gt;/system/bin/kpoc_charger&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ›¿æ¢æˆå¦‚ä¸‹æ–‡ä»¶&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/system/bin/sh&lt;/span&gt;
/system/bin/reboot
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;ç„¶å &lt;code&gt;chmod +x /system/bin/kpoc_charger&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;http://developwear.com/blog/2014/07/03/autobootstart-android-when-charger-is-connected/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:10:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ru-he-rang-an-zhuo-shou-ji-cha-shang-dian-yuan-zi-dong-kai-ji.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>python random library</title><link>/posts/python-random-library.html</link><description>&lt;h2&gt;Basic Usage&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;random.randrange(start, stop, step)
random.randint(a, b)
random.random()

random.choice(seq)
random.shuffle(seq)
random.sample(seq, k)
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-random-library.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python pip æç®€æ•™ç¨‹</title><link>/posts/python-pip-ji-jian-jiao-cheng.html</link><description>&lt;p&gt;è®© pip ä½¿ç”¨å›½å†…çš„æº&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é˜¿é‡Œäº‘ https://mirrors.aliyun.com/pypi/simple/ &lt;/li&gt;
&lt;li&gt;ä¸­å›½ç§‘æŠ€å¤§å­¦ https://pypi.mirrors.ustc.edu.cn/simple/ &lt;/li&gt;
&lt;li&gt;è±†ç“£ http://pypi.douban.com/simple/
&lt;em&gt;â€ƒæ¸…åå¤§å­¦ https://pypi.tuna.tsinghua.edu.cn/simple/ 
&lt;/em&gt;â€ƒä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ http://pypi.mirrors.ustc.edu.cn/simple/&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install scrapy -i https://pypi.tuna.tsinghua.edu.cn/simple/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¿®æ”¹ ~/.pip/pip.conf (æ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ª)ï¼Œ å†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[global]&lt;/span&gt;
&lt;span class="na"&gt;https://pypi.tuna.tsinghua.edu.cn/simple/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ä¹‹å‰çš„ pip æ•™ç¨‹&lt;/p&gt;
&lt;h2&gt;installing packages&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;pip install &amp;lt;package-name&amp;gt;==&amp;lt;version&amp;gt;&lt;/code&gt;, version is optional&lt;/p&gt;
&lt;p&gt;To install a package from git repository:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pip install -e git+REPO&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;pip currently supports cloning over git, git+https and git+ssh:&lt;/p&gt;
&lt;p&gt;Here are the supported forms:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[-e] git+git://git.myproject.org/MyProject#egg=MyProject
[-e] git+https://git.myproject.org/MyProject#egg=MyProject
[-e] git+ssh://git.myproject.org/MyProject#egg=MyProject  # for private repo, you can only use this
[-e] git+git@git.myproject.org:MyProject#egg=MyProject

Passing branch names, a commit hash or a tag name is possible like so:
[-e] git://git.myproject.org/MyProject.git@master#egg=MyProject
[-e] git://git.myproject.org/MyProject.git@v1.0#egg=MyProject
[-e] git://git.myproject.org/MyProject.git@da39a3ee5e6b4b0d3255bfef95601890afd80709#egg=MyProject
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;if you add the &lt;code&gt;-e&lt;/code&gt;(editable) option, then you can save the version info in freeze, which is exactly what you need.&lt;/p&gt;
&lt;h2&gt;upgrade a package:&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install package-name --upgrade
pip install xxx -U
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å¿½ç•¥ç¼“å­˜&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install --on-cache-dir xxx
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;requirements file&lt;/h2&gt;
&lt;p&gt;save current dependencies to a requirement file:&lt;/p&gt;
&lt;p&gt;pip freeze &amp;gt; requirements.txt&lt;/p&gt;
&lt;p&gt;install from a requirement file&lt;/p&gt;
&lt;p&gt;pip install -r requirements.txt&lt;/p&gt;
&lt;p&gt;http://crazygit.wiseturtles.com/2018/01/08/pipenv-tour/&lt;/p&gt;
&lt;h1&gt;å¸è½½çš„æ—¶å€™åˆ é™¤æ‰€æœ‰ä¾èµ–&lt;/h1&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ pip-autoremove åŒ…&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install pip-autoremove
pip-autoremove requrests -y  # requests æœ‰ä¸¥é‡çš„å†…å­˜æ³„éœ²ï¼Œè€Œä¸”ä»£ç éå¸¸ä¸ä¼˜é›…ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æ–°å·¥å…· pipenv&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;pipenv å¤ªåƒåœ¾äº†ï¼Œå¹å¾—å¾ˆç‰›é€¼ï¼Œç»“æœåŸºæœ¬ä¸èƒ½ç”¨ã€‚ä¸çŸ¥é“ä¸ºå•¥ä¸ä½¿ç”¨å®˜æ–¹çš„ venvï¼Œè€Œè¦ä½¿ç”¨ virtualenvï¼Œç®€ç›´è„‘æ®‹ã€‚åé¢çš„æ•™ç¨‹è¯·å¿½ç•¥ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % cd repos/crawler
yifei@Yifeis-MacBook [07:14:07] [~/repos/crawler]
-&amp;gt; % pipenv --python 3
Creating a virtualenv for this projectâ€¦
Using /usr/local/bin/python3 (3.6.5) to create virtualenvâ€¦
â ‹Running virtualenv with interpreter /usr/local/bin/python3
Using base prefix &amp;#39;/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6&amp;#39;
New python executable in /Users/yifei/repos/.venv/bin/python3.6
Also creating executable in /Users/yifei/repos/.venv/bin/python
Installing setuptools, pip, wheel...done.

Virtualenv location: /Users/yifei/repos/.venv
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç›¸å…³çš„ issueï¼šhttps://github.com/pypa/pipenv/issues/70&lt;/p&gt;
&lt;p&gt;åŸæ–‡ï¼š&lt;/p&gt;
&lt;p&gt;pip æ˜¯ä¸€ä¸ªç®€å•çš„ python çš„åŒ…ç®¡ç†å·¥å…·ï¼Œç›¸æ¯”äº node çš„npm æˆ–è€… rust çš„cargo æ¥è¯´ï¼ŒåŠŸèƒ½éå¸¸å¼±ï¼Œä¸è¿‡pythonå®˜æ–¹å·²ç»å‡ºäº†ä¸€ä¸ªæ–°çš„å·¥å…·â€”â€”pipenvï¼Œç»ˆäºè·Ÿä¸Šäº†æ—¶ä»£ã€‚&lt;/p&gt;
&lt;p&gt;pipenv ç»“åˆäº†ä¹‹å‰ pip å’Œ venv/virtualenv çš„åŠŸèƒ½ï¼Œä¸å†ä½¿ç”¨ requirements.txt æ¥ç®¡ç†ã€‚&lt;/p&gt;
&lt;h1&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;ç›´æ¥å…¨å±€å®‰è£…ï¼Œä¸è¦åœ¨ venv ä¸­å®‰è£…ã€‚å»ºè®®ä½¿ç”¨ python3 çš„ pip å®‰è£…ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip(3) install pipenv
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;ä½¿ç”¨&lt;/h1&gt;
&lt;h2&gt;åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ&lt;/h2&gt;
&lt;p&gt;å¦‚æœå½“å‰ç›®å½•æ²¡æœ‰è™šæ‹Ÿç¯å¢ƒï¼Œpipenvä¼šåœ¨è¿è¡Œ pipenv install çš„æ—¶å€™è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªï¼Œä¸è¿‡ä¹Ÿå¯ä»¥æ‰‹å·¥åˆ›å»ºã€‚é¦–å…ˆè®¾å®šç¯å¢ƒå˜é‡ PIPENV_VENV_IN_PROJECTï¼Œè¿™æ ·pipenv å°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹çš„.venv ç›®å½•åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œè€Œä¸æ˜¯åœ¨ç³»ç»Ÿçš„æŸä¸ªç›®å½•ä¸­ç»Ÿä¸€åˆ›å»ºã€‚å¯ä»¥å‚è€ƒ&lt;a href="https://github.com/pypa/pipenv/issues/259"&gt;è¿™é‡Œ&lt;/a&gt;ã€‚ä½¿ç”¨ --python å‚æ•°å¯ä»¥æŒ‡å®šåˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒçš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚ 2ã€3ã€3.5 ç­‰ç­‰ã€‚å½“ç„¶å¾—æ˜¯ä½ ç³»ç»Ÿä¸­å·²ç»å®‰è£…çš„ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;-&amp;gt; % pwd
~/repos/test/

-&amp;gt; % export $PIPENV_VENV_IN_PROJECT=1

-&amp;gt; % pipenv --python 3

Creating a virtualenv for this projectâ€¦
Using /usr/local/bin/python3 (3.6.5) to create virtualenvâ€¦
â ‹Running virtualenv with interpreter /usr/local/bin/python3
Using base prefix &amp;#39;/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6&amp;#39;
New python executable in /Users/yifei/repos/test/.venv/bin/python3.6
Also creating executable in /Users/yifei/repos/test/.venv/bin/python
Installing setuptools, pip, wheel...done.

Virtualenv location: /Users/yifei/repos/test/.venv
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å®‰è£…åº“&lt;/h2&gt;
&lt;p&gt;å®‰è£…åº“å¯ä»¥ä½¿ç”¨ == æŒ‡å®šç‰ˆæœ¬ä¿¡æ¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸æŒ‡å®šã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pipenv install requests==2.13.0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æˆ–è€…ç›´æ¥ä½¿ç”¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pipenv install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;pipenv ä¼šç›´æ¥ä» requirements.txt æˆ–è€… Pipfile ä¸­å®‰è£…åŒ…ã€‚æˆ–è€…ä½¿ç”¨&lt;code&gt;-r&lt;/code&gt;æ‰‹å·¥æŒ‡å®šä¹‹å‰çš„ requirements.txt çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œpivenv install ä¼šç›´æ¥ä¿®æ”¹ Pipfileï¼Œè€Œ&lt;em&gt;ä¸éœ€è¦&lt;/em&gt;åŠ &lt;code&gt;--save&lt;/code&gt;å‚æ•°ã€‚&lt;/p&gt;
&lt;h2&gt;é”å®š&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ pipenv lock å¯ä»¥ç”Ÿæˆå½“å‰å®‰è£…çš„ç‰ˆæœ¬çš„é”å®šæ–‡ä»¶ Pipfile.lockã€‚&lt;/p&gt;
&lt;h2&gt;è¿è¡Œ&lt;/h2&gt;
&lt;p&gt;å½“è¿è¡Œè„šæœ¬çš„æ—¶å€™ç›´æ¥ä½¿ç”¨ &lt;code&gt;pipenv run python main.py&lt;/code&gt; å°±å¯ä»¥é¿å…æ‰‹å·¥å¯ç”¨ venv äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœé…ç½®äº† .env æ–‡ä»¶ï¼Œpipenv run çš„æ—¶å€™ä¹Ÿä¼šåŠ è½½é‡Œé¢çš„ç¯å¢ƒå˜é‡ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:04:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-pip-ji-jian-jiao-cheng.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­çš„å¼‚å¸¸æ€»ç»“</title><link>/posts/python-zhong-de-yi-chang-zong-jie.html</link><description>&lt;h2&gt;User defined class&lt;/h2&gt;
&lt;p&gt;for user defined exceptions, just subclass Exception&lt;/p&gt;
&lt;h2&gt;Catching Exceptions&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;except Exception as e: # SystemExit, KeyboardInterrupt, GeneratorExit is not captured
    log(&amp;#39;Reason&amp;#39;, e)    # the baseline is to record
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;å®¹æ˜“æŠ›å‡ºå¼‚å¸¸çš„åœ°æ–¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘ç»œè¯»å–ï¼Œrequests.get&lt;/li&gt;
&lt;li&gt;è°ƒç”¨å…¶ä»–å‘½ä»¤è¶…æ—¶ï¼Œsubprocess.call&lt;/li&gt;
&lt;li&gt;è¯»å–ä»–äººçš„æ•°æ®ï¼ŒIndexError&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å®¹æ˜“é˜»å¡çš„åœ°æ–¹&lt;/h3&gt;
&lt;p&gt;ç½‘ç»œ&lt;/p&gt;
&lt;h2&gt;å†…ç½®çš„å¼‚å¸¸æ ‘&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;BaseException
 +-- SystemExit
 +-- *KeyboardInterrupt*
 +-- GeneratorExit
 +-- Exception
      +-- *StopIteration*
      +-- *StandardError*
      |    +-- BufferError
      |    +-- *ArithmeticError*
      |    |    +-- FloatingPointError
      |    |    +-- OverflowError
      |    |    +-- ZeroDivisionError
      |    +-- AssertionError
      |    +-- AttributeError
      |    +-- EnvironmentError
      |    |    +-- *IOError*
      |    |    +-- OSError
      |    |         +-- WindowsError (Windows)
      |    |         +-- VMSError (VMS)
      |    +-- EOFError
      |    +-- *ImportError*
      |    +-- *LookupError*
      |    |    +-- IndexError
      |    |    +-- KeyError
      |    +-- MemoryError
      |    +-- *NameError*
      |    |    +-- UnboundLocalError
      |    +-- ReferenceError
      |    +-- RuntimeError
      |    |    +-- NotImplementedError
      |    +-- *SyntaxError*
      |    |    +-- IndentationError
      |    |         +-- TabError
      |    +-- SystemError
      |    +-- *TypeError*
      |    +-- *ValueError*
      |         +-- UnicodeError
      |              +-- UnicodeDecodeError
      |              +-- UnicodeEncodeError
      |              +-- UnicodeTranslateError
      +-- *Warning*
           +-- DeprecationWarning
           +-- PendingDeprecationWarning
           +-- RuntimeWarning
           +-- SyntaxWarning
           +-- UserWarning
           +-- FutureWarning
       +-- ImportWarning
       +-- UnicodeWarning
       +-- BytesWarning
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 03:01:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-zhong-de-yi-chang-zong-jie.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>å¦‚ä½•è®©æŠ€æœ¯åšå®¢æœ‰æ›´å¤šæµé‡</title><link>/posts/ru-he-rang-ji-zhu-bo-ke-you-geng-duo-liu-liang.html</link><description>&lt;p&gt;always have SEO in your mind when choosing what words to use&lt;/p&gt;
&lt;p&gt;åˆ†æ Why kotlin is better than whatever language you are using&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€è¡Œï¼Œæˆ‘å°±æ˜¯æ ‡é¢˜å…šï¼Œè§£é‡Šäº†æ ‡é¢˜
æè¿°äº† java
æè¿°äº† ç¬¬ä¸€å°è±¡
ä¸€äº›è§è§£
å®‰å“
æ€»ç»“&lt;/p&gt;
&lt;p&gt;æŠ•æ”¾è‡ªå·±æ–‡ç« çš„æ¸ é“ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¼€å‘è€…å¤´æ¡ï¼šç”±äºæˆªå›¾çš„æ—¶å€™æ²¡æœ‰æ–°å‘æ–‡ç« ï¼Œä¹‹å‰é‚£ç¯‡ç§’æ€æ¶æ„å®è·µå‘äº†ä¹‹ååšå®¢ 80% çš„æµé‡éƒ½æ˜¯ä»å¤´æ¡è¿‡æ¥çš„ï¼Œè€Œä¸”è´¨é‡å¾ˆé«˜ï¼Œä¸å¾—ä¸ç‚¹ä¸ªèµã€‚&lt;/li&gt;
&lt;li&gt;å¹¶å‘ç¼–ç¨‹ç½‘: å¹¶å‘ç¼–ç¨‹ç½‘æ˜¯ç”±é˜¿é‡Œå¤§ç‰›æ¸…è‹±(ä¹°äº†é‚£æœ¬ã€Šå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹å°±è¢«åœˆç²‰äº†)åˆ›åŠçš„ï¼Œå…¶ä¸­çš„æ–‡ç« è´¨é‡æ™®éè¾ƒé«˜(å¯¼è‡´ä¹Ÿä¼šæœ‰ä¸€ç‚¹å†™ä½œé—¨æ§›)ã€‚ç”±äºç½‘ç«™çš„æµé‡ä¹Ÿæ¯”è¾ƒé«˜ï¼Œåªè¦ä½ çš„æ–‡ç« è´¨é‡ä¸é”™è‚¯å®šä¼šå¾—åˆ°å¥½å¤„ã€‚&lt;/li&gt;
&lt;li&gt;æ˜é‡‘ï¼šæ˜é‡‘è¿™ä¸¤å¹´ä¹Ÿæ¯”è¾ƒç«ï¼Œæ˜¯ä¸“é—¨åšå¼€å‘è€…å†…å®¹çš„ï¼Œä¹Ÿæ˜¯ç½‘ç«™æµé‡ä¸é”™ã€‚&lt;/li&gt;
&lt;li&gt;å¼€æºä¸­å›½ï¼šå¼€æºä¸­å›½çš„åšå®¢ä¹Ÿä¸é”™ï¼Œè‡ªå·±ä¹Ÿæœ‰ä»£ç æ‰˜ç®¡ï¼Œä½†æˆ‘è¿˜æ˜¯æ›´å–œæ¬¢ç”¨ GitHubï¼Œä¸€èˆ¬ä¸Šäº†ç¼–è¾‘æ¨èéƒ½ä¼šæœ‰ä¸é”™çš„è®¿é—®é‡ã€‚&lt;/li&gt;
&lt;li&gt;V2EXï¼šå¤§åé¼é¼çš„ V ç«™ï¼Œå…¶å®å—ä¼—è¾ƒå°‘ï¼Œæ­£å› ä¸ºå¦‚æ­¤ä¹Ÿå½¢æˆäº†ç‹¬æœ‰çš„æ–‡åŒ–ï¼Œå› æ­¤ä¹Ÿæ˜¯æˆ‘æ¯å¤©æ¯”é€›(æ‘¸é±¼)çš„ç½‘ç«™ï¼Œç”±äºå—ä¼—å¤§å¤šæ˜¯å¼€å‘è€…æ‰€ä»¥ä¹Ÿèƒ½å¾—åˆ°å¾ˆå¤šæœ‰ç”¨çš„åé¦ˆã€‚&lt;/li&gt;
&lt;li&gt;å¤§ä½¬æ¨èï¼šæœ€å¿«æ·çš„æ–¹å¼å…¶å®å°±æ˜¯å£å£ç›¸ä¼ ï¼Œå…¶ä¸­å½“ç„¶æ˜¯å¤§ä½¬çš„æ•ˆç‡æœ€é«˜ã€‚ä¹‹å‰æœ‰ä¸ªçº¯æ´çš„å¾®ç¬‘ã€ç¨‹åºçŒ¿DD éƒ½æŠ•è¿‡ç¨¿ï¼Œä¹Ÿèƒ½å¸¦æ¥ä¸é”™çš„æµé‡ã€‚&lt;/li&gt;
&lt;li&gt;ç®€ä¹¦:æœ¬æ¥ä¸æƒ³æ¨èç®€ä¹¦çš„ï¼ˆä¹‹å‰çš„äº‹ä»¶ä»¥åŠç°åœ¨é¸¡æ±¤å¤ªå¤šï¼‰ï¼Œä½†æ˜¯æµé‡è¿˜å¯ä»¥ï¼Œç°åœ¨å°±çº¯ç²¹å½“åšåšå®¢å¤‡ä»½çš„å·¥å…·äº†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;å¼•æµ&lt;/h1&gt;
&lt;h2&gt;ç®€ä¹¦&lt;/h2&gt;
&lt;p&gt;ç®€ä¹¦ä¸Šä¸€äº›ä½ç«¯çš„æ•™ç¨‹ä¼¼ä¹åœ¨googleçš„ç»“æœä¸­èƒ½å¤Ÿæ’å¾—æ¯”è¾ƒé å‰çš„ä½ç½®ï¼Œæ¯”å¦‚&lt;a href="http://www.jianshu.com/p/ecf3a88d9ae1"&gt;è¿™ç¯‡&lt;/a&gt;ï¼Œç®€å•çš„åˆ©ç”¨scrapyçˆ¬å–é“¾å®¶æ•°æ®çš„æ–‡ç« ï¼Œç±»ä¼¼çš„æ–‡ç« è¿˜æœ‰å¾ˆå¤šã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 02:44:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ru-he-rang-ji-zhu-bo-ke-you-geng-duo-liu-liang.html</guid><category>åˆ›ä¸š</category><category>è¿è¥ä¸äº§å“</category></item><item><title>steal money by payed phones</title><link>/posts/steal-money-by-payed-phones.html</link><description>&lt;p&gt;https://www.arneswinnen.net/2016/07/how-i-could-steal-money-from-instagram-google-and-microsoft/&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 02:42:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/steal-money-by-payed-phones.html</guid><category>ä»–å±±ä¹‹çŸ³</category><category>åˆ›ä¸š</category></item><item><title>HTTP ç¼“å­˜ä»‹ç»</title><link>/posts/http-huan-cun-jie-shao.html</link><description>&lt;p&gt;å’Œç¼“å­˜ç›¸å…³çš„ header å…±æœ‰å¦‚ä¸‹å‡ ç§&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Pragma&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Cache-Control&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Expires&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Last-Modified&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Etag&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;If-Modified-Since&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;If-Non-Match&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Expires ç”±æœåŠ¡å™¨è¿”å›ï¼Œç”¨äºæŒ‡å®šå½“å‰é¡µé¢è¿‡æœŸæ—¶é—´ï¼Œä½¿ç”¨ç»å¯¹æ—¶é—´è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;Cache-Control æŒ‡å®šäº†ç›¸å¯¹è¿‡æœŸçš„æ—¶é—´ï¼Œç”±å½“å‰æ—¶é—´å¤šä¹…åè¿‡æœŸçš„ç§’æ•°è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Cache-Control: max-age=86400
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Last-Modified æ˜¯ç”±æœåŠ¡å™¨ç»™å‡ºäº†æ–‡æ¡£çš„è¿‡æœŸæ—¶é—´ï¼Œå½“ç¬¬äºŒæ¬¡è¯·æ±‚è¯¥æ–‡æ¡£çš„æ—¶å€™ï¼Œæµè§ˆå™¨å¯ä»¥ä½¿ç”¨ If-Modified-Since å¤´éƒ¨æŒ‡å®šè¯¥è¿‡æœŸæ—¶é—´ï¼Œå¦‚æœæ–‡æ¡£è¿˜æ²¡æœ‰è¿‡æœŸï¼Œé‚£ä¹ˆæœåŠ¡å™¨åº”è¯¥è¿”å› 304ï¼Œå¦åˆ™è¿”å› 200 å’Œæ–°æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;Etag æ˜¯ç”±æœåŠ¡å™¨ç»™å‡ºçš„æ–‡æ¡£çš„å“ˆå¸Œå€¼ï¼Œå½“ç¬¬äºŒæ¬¡è¯·æ±‚è¯¥æ–‡æ¡£çš„æ—¶å€™ï¼Œæµè§ˆå™¨å¯ä»¥ä½¿ç”¨ If-None-Match å¤´éƒ¨æŒ‡å®šè¯¥å“ˆå¸Œå€¼ï¼Œå¦‚æœæ–‡æ¡£æ²¡æœ‰å˜åŠ¨ï¼Œé‚£ä¹ˆæœåŠ¡å™¨åº”è¯¥è¿”å› 304ï¼Œå¦‚æœæœ‰å˜åŠ¨ï¼Œé‚£ä¹ˆå“ˆå¸Œå€¼ä¹Ÿå˜äº†ï¼Œåº”è¯¥è¿”å› 200 å’Œæ–°æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡º Etag ç›¸æ¯” Last-Modified æ›´å‡†ç¡®ä¸€äº›ï¼Œæ‰€ä»¥ä¸¤ä¸ªå¤´éƒ¨éƒ½æœ‰çš„å‰æä¸‹ï¼Œåº”è¯¥æ˜¯ Etag ä¼˜å…ˆã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä½¿ç”¨ä¸­ï¼Œä¸ºäº†å…¼å®¹æ€§è€ƒè™‘ï¼Œåº”è¯¥æŠŠè¿™å‡ ç§å¤´éƒ¨éƒ½ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;see: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://www.mnot.net/cache_docs/&lt;/li&gt;
&lt;li&gt;http://stackoverflow.com/questions/499966/etag-vs-header-expires&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 02:37:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/http-huan-cun-jie-shao.html</guid><category>HTTP</category><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>ç†è§£ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹</title><link>/posts/li-jie-cheng-xu-de-zhi-xing-guo-cheng.html</link><description>&lt;p&gt;æƒ³è±¡ä¸€ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªæµæ°´çº¿ï¼Œæ¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨éƒ½æ˜¯åœ¨å½“å‰å‡½æ•°æ—è¾¹æ–°å¼€äº†ä¸€ä¸ªæµæ°´çº¿ã€‚&lt;/p&gt;
&lt;p&gt;æ–°çš„è°ƒç”¨æ˜¯ä»è°ƒç”¨è€…åˆ†å‡ºçš„ä¸€æ¡å‰ï¼Œæ‰€æœ‰çš„è°ƒç”¨æ„æˆäº†ä¸€ä¸ªä»å·¦å‘å³çš„æ ˆã€‚&lt;/p&gt;
&lt;p&gt;æŠŠæ¯ä¸ªå¾ªç¯æƒ³è±¡æˆä¸€ä¸ªå¹¶è¡Œæ‰§è¡Œçš„æµæ°´çº¿&lt;/p&gt;
&lt;p&gt;æŠŠæ¯ä¸€ä¸ª if/case è¯­å¥æƒ³è±¡ä¸ºä¸€ä¸ªæµæ°´çº¿çš„ä¸€ä¸ªåˆ†å‰ç‚¹ï¼Œå½“ç„¶ä¸¤æ¡å‰å¯èƒ½æœ€åä¼šèšåˆã€‚&lt;/p&gt;
&lt;p&gt;æŠŠä¸€ä¸ªç±»å½“åšç›¸å…³çš„åŠ¨ä½œå’Œåˆ†äº«åŒä¸€ä¸ªçŠ¶æ€çš„ä¸€ä¸ªé›†åˆ&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ww2.sinaimg.cn/large/006tNbRwgy1fg35hmla6ij30j9087t94.jpg"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 01:49:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/li-jie-cheng-xu-de-zhi-xing-guo-cheng.html</guid><category>æƒ³æ³•</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­çš„åºåˆ—åŒ–åº“</title><link>/posts/python-zhong-de-xu-lie-hua-ku.html</link><description>&lt;h2&gt;basic usage&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pickle.dumps(obj)  # dumps a object to a bytes, not binary safe
pickle.loads(bytes)  # loads a object from a bytes.
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;tricks&lt;/h2&gt;
&lt;p&gt;pickling dict is stable&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;In [5]: pickle.dumps({&amp;#39;a&amp;#39;: &amp;#39;b&amp;#39;, &amp;#39;1&amp;#39;: &amp;#39;2&amp;#39;})
Out[5]: b&amp;#39;\x80\x03}q\x00(X\x01\x00\x00\x001q\x01X\x01\x00\x00\x002q\x02X\x01\x00\x00\x00aq\x03X\x01\x00\x00\x00bq\x04u.&amp;#39;

In [6]: pickle.dumps({&amp;#39;1&amp;#39;: &amp;#39;2&amp;#39;, &amp;#39;a&amp;#39;: &amp;#39;b&amp;#39;})
Out[6]: b&amp;#39;\x80\x03}q\x00(X\x01\x00\x00\x001q\x01X\x01\x00\x00\x002q\x02X\x01\x00\x00\x00aq\x03X\x01\x00\x00\x00bq\x04u.&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;json&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;json.dumps(dict,
    sort_keys=True,  # keys will be in order
)
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 01:47:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-zhong-de-xu-lie-hua-ku.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Python ä¸­çš„ bytesio/stringio</title><link>/posts/python-zhong-de-bytesiostringio.html</link><description>&lt;p&gt;Python ä¸­çš„io åŒ…æä¾›äº† BytesIO å’Œ StringIOï¼Œåˆ†åˆ«å¯ä»¥æŠŠä¸€ä¸ªå¯¹è±¡ä½œä¸ºä¸€ä¸ªå†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œæ–‡æœ¬æ–‡ä»¶ï¼Œé™¤äº†æ–‡ä»¶çš„read/write/readlineç­‰æ“ä½œå¤–ï¼Œæ”¯æŒ getvalue æ“ä½œã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;io&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BytesIO&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# äºŒè¿›åˆ¶æ–‡ä»¶åªèƒ½å†™ b&amp;#39;xxx&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getvalue&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 01:46:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/python-zhong-de-bytesiostringio.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>å‘½ä»¤è¡Œå‹ç¼©å›¾ç‰‡çš„å·¥å…·</title><link>/posts/ming-ling-xing-ya-suo-tu-pian-de-gong-ju.html</link><description>&lt;p&gt;åŠ è½½é€Ÿåº¦å¯¹äºç½‘é¡µçš„ä½“éªŒè¿˜æ˜¯å¾ˆé‡è¦çš„, è€Œæ¯ä¸ªé¡µé¢æ¯”è¾ƒè€—è´¹å¸¦å®½çš„èµ„æºå°±æ˜¯å›¾ç‰‡äº†, æ‰€ä»¥åœ¨é¡µé¢å‘å¸ƒåå¯¹å›¾åƒåšé€‚å½“çš„å‹ç¼©æ˜¯å¾ˆæœ‰å¿…è¦çš„.&lt;/p&gt;
&lt;p&gt;å¸¸ç”¨çš„å›¾ç‰‡æ ¼å¼åŸºæœ¬æœ‰ä¸‰ç§: jpg, png å’Œ gif, åˆ†åˆ«æœ‰ä¸åŒçš„å‹ç¼©å·¥å…·&lt;/p&gt;
&lt;p&gt;JPG å‹ç¼©å»ºè®®ä½¿ç”¨ jpegoptim, å®æµ‹å‹ç¼©æ¯”åœ¨40%å·¦å³, æœ€å¸¸ç”¨çš„è¯­æ³•æ˜¯&lt;/p&gt;
&lt;p&gt;&lt;code&gt;jpegoptim -p -m&amp;lt;dd&amp;gt;  &amp;lt;imagefile&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ -p æ˜¯ä¿ç•™ mtime çš„æ„æ€, ä¹Ÿå¯ä»¥ç”¨ --perserve, -m åé¢è·Ÿä¸¤ä¸ªæ•°å­—è¡¨ç¤º, å‹ç¼©çš„æ¯”ä¾‹, ä¸€èˆ¬ç”¨90å³å¯, è‚‰çœ¼æ— æ³•åˆ†è¾¨, ä¸”èƒ½å¤Ÿå‹ç¼©æ‰40%å·¦å³&lt;/p&gt;
&lt;p&gt;png å‹ç¼©æœ‰ä¸¤ä¸ªé€‰é¡¹, å¸¸è§„çš„ optipng å’Œå¦ä¸€ä¸ªæ–°ä¸€ç‚¹ pngquant, æµ‹è¯•äº†ä¸€ä¸‹, å‘ç° optipng é€Ÿåº¦æ…¢è€Œä¸”å‹ç¼©æ•ˆç‡ä½, pngquant åˆ™è¡¨ç°ç›¸å½“ä¼˜ç§€, ä½†æ˜¯éœ€è¦æ³¨æ„ pngquant æ˜¯æœ‰æŸå‹ç¼©.&lt;/p&gt;
&lt;p&gt;pngquant çš„ç”¨æ³•ä¹Ÿç®€å•ç²—æš´, ç›´æ¥ pngquant &lt;filename&gt; å°±å¥½äº†, å¦‚æœå«Œå‹ç¼©ä¸å¤Ÿå¯ä»¥ä½¿ç”¨ pngquant &lt;numColors&gt; &lt;filename&gt;. æŒ‡å®šä¸€ä¸ªè¾ƒå°‘çš„è‰²å½©æ•°.&lt;/p&gt;
&lt;p&gt;gif å›¾åƒçš„å‹ç¼©å¯ä»¥ä½¿ç”¨gifsicle&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gifsicle -O2 old.gif -o new.gif&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯, jpegoptim é»˜è®¤è¦†ç›–åŸå›¾åƒ, pngquant ä¼šç”Ÿæˆæ–°çš„å›¾åƒ, gifsicle éœ€è¦åˆ¶å®šæ–°å›¾åƒçš„åå­—.&lt;/p&gt;
&lt;p&gt;å¦‚æœéœ€è¦å¯¹ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½è¿›è¡Œä¼˜åŒ–, å¯ä»¥é…åˆ find å‘½ä»¤ä½¿ç”¨, æ¯”å¦‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;find . -name &amp;quot;*.jpg&amp;quot; -exec jpegoptim {} -m90 -p
find . -name &amp;quot;*.png&amp;quot; -exec pngquant {}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;é€šè¿‡ä»¥ä¸Šå‘½ä»¤å°±å¯ä»¥æŠŠé™ä½ä¸€äº›å›¾ç‰‡çš„ä½“ç§¯&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 01:42:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/ming-ling-xing-ya-suo-tu-pian-de-gong-ju.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>converting mp4 to gif</title><link>/posts/converting-mp4-to-gif.html</link><description>&lt;h2&gt;Converting MP4 to gif&lt;/h2&gt;
&lt;p&gt;To convert the entire video to GIF, use the following command:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ffmpeg -i small.mp4 small.gif&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;To convert just a portion of a video clip to GIF, use the following command:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ffmpeg -t 3 -ss 00:00:02 -i small.webm small-clip.gif&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The snippet above directs ffmpeg to create a GIF 3 seconds long starting at 2 seconds into the video.
The default conversion doesn't appear to be high quality, so you can configure the bitrate via another parameter:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ffmpeg -i small.mp4 -b 2048k small.gif&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;Convert GIF to Video&lt;/h2&gt;
&lt;p&gt;The command is quite simple:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ffmpeg -f gif -i animation.gif animation.mp4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You can use this same command format to convert to other video formats:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ffmpeg -f gif -i animation.gif animation.mpeg
ffmpeg -f gif -i animation.gif animation.webm
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ffmpeg and ImageMagick are awesome media utilities which you should take some time to check out if you have any questions about how to get something done!&lt;/p&gt;
&lt;h2&gt;optimize&lt;/h2&gt;
&lt;p&gt;gifsicle to scale down the image to a smaller size&lt;/p&gt;
&lt;p&gt;I used &lt;code&gt;ffmpeg -i foo.mp4 -r 5 -vf scale=270:-1 foo.gif&lt;/code&gt; , whereÂ -r 5Â cuts it to 5 frames per second, andÂ &lt;code&gt;-vf scale=270:-1&lt;/code&gt;Â scales the output to a width of 270 pixels and a height that matches the aspect ratio.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 01:40:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/converting-mp4-to-gif.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>profitable side projects on HN</title><link>/posts/profitable-side-projects-on-hn.html</link><description>&lt;h2&gt;Udemy&lt;/h2&gt;
&lt;p&gt;I made a course on Udemy on how to make complete web applications without writing code using APEX.
Link and free coupons:
https://www.udemy.com/create-web-apps-with-apex-5/?couponCod...&lt;/p&gt;
&lt;p&gt;Expenses:
$100 for a nice microphone (not necessary) but didn't want to record a bunch and have it be garbage $100 for Screenflow (to do video editing). 20 hours time (split across a couple of weekends&lt;/p&gt;
&lt;p&gt;Profit:
I've made $1405 on it so far. It is almost completely passive income.&lt;/p&gt;
&lt;p&gt;Proof:
http://i.imgur.com/sexsrzK.png?1&lt;/p&gt;
&lt;p&gt;If you know any of the topics in the Hot Topics list and can do desktop recording, maybe you should think about teaching others and making some side money while doing it. Best of all, the Udemy community is awesome. They are very supportive of each other.&lt;/p&gt;
&lt;p&gt;https://teach.udemy.com/course-creation/hot-topic-courses/&lt;/p&gt;
&lt;h2&gt;Ebay crawler&lt;/h2&gt;
&lt;p&gt;A year. I was spending way too much time on eBay, so I wrote something for myself that would scrape the web pages and use a kill list to filter out the junk. I wanted a better UI to add words to the kill list and realised I could make money via the eBay affiliate program.&lt;/p&gt;
&lt;p&gt;So I took two months off between contracts and wrote the first version of AuctionSieve - http://auctionsieve.com&lt;/p&gt;
&lt;p&gt;There was a D&amp;amp;D forum, the Acaeum where a bunch of people started using it and giving feedback.
It was making me money from day 1 but it probably took about a year to repay that 2 months of time investment.&lt;/p&gt;
&lt;p&gt;It's now been 13 years(!) and it still makes me money - not enough to live off (the payout calculations from eBay have changed several times) but a nice chunk of change. And I only have to occasionally prod it. And add the occasional new feature.&lt;/p&gt;
&lt;h2&gt;Inovices&lt;/h2&gt;
&lt;p&gt;I've worked over a year on https://www.boxfactura.com/ which is a special email service for invoices in Mexico.&lt;/p&gt;
&lt;p&gt;It has been profitable since January after quite some legwork, on the technical side as well as the sales and persuation side. &lt;/p&gt;
&lt;p&gt;reply by emilioolivares 1 day ago &lt;/p&gt;
&lt;p&gt;Hey man, I'm also from Mexico but currently live in NY. This is pretty awesome. How did you manage to get traction with small businesses? Would love to chat if you have time, my email is emilioolivares, I use Google email. &lt;/p&gt;
&lt;p&gt;reply by rsoto 1 day ago &lt;/p&gt;
&lt;p&gt;Hey, Emilio!
Sure, I'll send you an email, however, I'd like to keep the answer to your question on the public side, if you don't mind.
It has been quite a ride to get traction, mostly the first clients signed up after talking to them about their issues with their invoices and expenses--once they're interested, we begin the education process. The other sources are a mix of everything. One of our services is a platform in which our client's vendors can upload invoices so they can manage them. We get some information on several businesses, both small and big so we can begin to offer our solution. This particular product might be the best source for viral growth, as one client can introduce 10 or 20 new users on our platform.
We also have a relatively successful side project on a related field [1], which has several hundred hits daily. There's an ad there, there might be some optimization on both the ad and the landing, but we're still trying to figure that out. Finally, our focus has been towards explaining the product, as there's nothing like it on the market (actually there are, but they're small and having the same difficulties we have). Once they sign up, our onboarding process is focused on one point: send your first invoice. As we saw many of the new signups not completing this step (or the previous 2), we set up an email communication strategy for each one of the steps, with our contact information in each email. I've blogged a bit [2] about it.&lt;/p&gt;
&lt;p&gt;Now that we're sure our product is helpful for the businesses, we just started promoting heavily with a sales force.&lt;/p&gt;
&lt;p&gt;I hope that answered your question!&lt;/p&gt;
&lt;p&gt;1: http://isrmatic.com/
2: http://www.therror.com/weblog/2016/mar/como_el_email_marketi...&lt;/p&gt;
&lt;h2&gt;Ghost themes&lt;/h2&gt;
&lt;p&gt;http://www.gtheme.io/
I run GTheme.io for 2 years and now ramen profitable. Current site running with minimal management.
The site selling premium ghost.org theme.&lt;/p&gt;
&lt;p&gt;From &lt;a href="https://news.ycombinator.com/item?id=11898992"&gt;https://news.ycombinator.com/item?id=11898992&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 30 May 2017 01:19:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-30:/posts/profitable-side-projects-on-hn.html</guid><category>ä»–å±±ä¹‹çŸ³</category><category>åˆ›ä¸š</category></item><item><title>Crontab çš„è¯­æ³•å’Œä½¿ç”¨</title><link>/posts/crontab-de-yu-fa-he-shi-yong.html</link><description>&lt;p&gt;Crontab æ—¶é—´çš„è¯­æ³•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Minute Hour Day Month DoW
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¯ä¸€ä¸ªé€‰é¡¹é»˜è®¤éƒ½æ˜¯ç¬¬å‡ çš„æ„æ€&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Minute, æ¯å°æ—¶çš„ç¬¬å‡ åˆ†, å¯é€‰å€¼ 0-59&lt;/li&gt;
&lt;li&gt;Hour, æ¯å¤©çš„ç¬¬å‡ ä¸ªå°æ—¶, å¯é€‰å€¼ 0-23&lt;/li&gt;
&lt;li&gt;Day, æ¯æœˆçš„ç¬¬å‡ å¤©, å¯é€‰å€¼ 1-31&lt;/li&gt;
&lt;li&gt;Month, æ¯å¹´çš„ç¬¬å‡ ä¸ªæœˆ, å¯é€‰å€¼ 1-12&lt;/li&gt;
&lt;li&gt;DoW, æ¯å‘¨çš„ç¬¬å‡ å¤©, å¯é€‰å€¼ 0-7, 0 å’Œ 7 éƒ½ä»£è¡¨ Sunday&lt;/li&gt;
&lt;li&gt;Command, è¦æ‰§è¡Œçš„å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦å¤–:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨ * è¡¨ç¤ºæ‰€æœ‰&lt;/li&gt;
&lt;li&gt;å¯ä»¥ç”¨é€—å·åˆ†éš”æŒ‡å®šå¤šä¸ª&lt;/li&gt;
&lt;li&gt;ç”¨ &lt;code&gt;*/xx&lt;/code&gt; è¡¨ç¤ºæ¯ xx ä¸€æ¬¡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯”å¦‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;5 * * * * echo &amp;quot;hello world&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ¯å°æ—¶çš„ç¬¬äº”åˆ†é’Ÿæ‰“å° hello world&lt;/p&gt;
&lt;p&gt;æ›´å¤šåœ°ä¾‹å­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;* * * * *   æ¯åˆ†é’Ÿ
12 * * * *  æ¯å°æ—¶ç¬¬ 12 åˆ†
0,15,30,45 * * * * æ¯å°æ—¶çš„ç¬¬ 0, 15, 30, 45 åˆ†, ä¹Ÿå°±æ˜¯æ¯15åˆ†é’Ÿä¸€æ¬¡
0 4 * * *   æ¯å¤©çš„å‡Œæ™¨ 4 ç‚¹
0 4 * * 2   æ¯å‘¨äºŒçš„å‡Œæ™¨ 4 ç‚¹
*/4 2-6 * * *   2ç‚¹å’Œ6ç‚¹ä¹‹é—´æ¯ 4 åˆ†é’Ÿä¸€æ¬¡, ä¹Ÿå°±æ˜¯ 0, 4, 8...
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;crontab å‘½ä»¤&lt;/h1&gt;
&lt;p&gt;åº”è¯¥ä½¿ç”¨ crontab å‘½ä»¤æ¥ç¼–è¾‘ crontab æ–‡ä»¶, tab å°±æ˜¯ table çš„ç¼©å†™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;crontab -e # ç¼–è¾‘ crontab
crontab -l # åˆ—å‡º crontab
crontab -u # æŒ‡å®šç”¨æˆ·
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;crontab è¿˜æ”¯æŒä¸€äº›ç‰¹æ®Šè¯­æ³•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;@hourly ç›¸å½“äº 0 * * * * ä¹Ÿå°±æ˜¯æ¯å°æ—¶æ‰§è¡Œ
@daily  ç›¸å½“äº 0 0 * * * ä¹Ÿå°±æ˜¯æ¯å¤©æ‰§è¡Œ
@weekly ç›¸å½“äº 0 0 0 0 0
monthly
@yearly
@reboot at reboot
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;NOTE:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# add these line to tweak cron behavior
SHELL=/bin/bash
HOME=/
MAILTO=&amp;quot;example@digitalocean.com&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Cron è¡¨è¾¾å¼çš„å±€é™æ€§&lt;/h1&gt;
&lt;p&gt;cron è¡¨è¾¾å¼éš¾ä»¥è¡¨è¾¾ "every x" è¿™ä¸ªè¯­ä¹‰ã€‚æ¯”å¦‚è¯´æ¯éš” 9 ä¸ªå°æ—¶å¦‚ä½•ï¼Œ æ¯éš” 13 åˆ†é’Ÿå¦‚ä½•å¦‚ä½•ã€‚&lt;/p&gt;
&lt;h1&gt;cron çš„å®ç°&lt;/h1&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 15:41:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/crontab-de-yu-fa-he-shi-yong.html</guid><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>C/C++ ä¸­çš„ RAII</title><link>/posts/cc-zhong-de-raii.html</link><description>&lt;h1&gt;RAII çš„å¥½å¤„&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å¼‚å¸¸å®‰å…¨&lt;/li&gt;
&lt;li&gt;ä¿è¯åŒ¹é…&lt;/li&gt;
&lt;li&gt;é˜²æ­¢å†…å­˜æ³„éœ²&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;RAII in C&lt;/h1&gt;
&lt;p&gt;This is inherent implementation dependent, since the Standard doesn't include such a possibility. For GCC, the cleanup attribute runs a function when a variable goes out of scope:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;scoped&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;pvariable&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;variable (%d) goes out of scope&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pvariable&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;before scope&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;watched&lt;/span&gt; &lt;span class="n"&gt;__attribute__&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;cleanup&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;scoped&lt;/span&gt;&lt;span class="p"&gt;)));&lt;/span&gt;
        &lt;span class="n"&gt;watched&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;after scope&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Prints:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;before scope
variable (42) goes out of scope
after scope
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 15:36:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/cc-zhong-de-raii.html</guid><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>reading Calculas With Python</title><link>/posts/reading-calculas-with-python.html</link><description>&lt;p&gt;https://github.com/ryancheunggit/Calculus-with-Python&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 15:30:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/reading-calculas-with-python.html</guid><category>æ•°å­¦</category></item><item><title>å­¦ä¹  greasemonkey æ•™ç¨‹</title><link>/posts/xue-xi-greasemonkey-jiao-cheng.html</link><description>&lt;p&gt;GreaseMonkey/TamperMonkey å­¦ä¹ &lt;/p&gt;
&lt;h1&gt;å¤´éƒ¨å‘½ä»¤&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;@name | è„šæœ¬åå­—| &lt;/li&gt;
&lt;li&gt;@namespace|å‘½åç©ºé—´|  &lt;/li&gt;
&lt;li&gt;@version| ç‰ˆæœ¬| &lt;/li&gt;
&lt;li&gt;@author|ä½œè€…|       &lt;/li&gt;
&lt;li&gt;@description      &lt;/li&gt;
&lt;li&gt;@homepage     &lt;/li&gt;
&lt;li&gt;@icon     &lt;/li&gt;
&lt;li&gt;@updateURL        &lt;/li&gt;
&lt;li&gt;@downloadURL      &lt;/li&gt;
&lt;li&gt;@include      &lt;/li&gt;
&lt;li&gt;@exclude      &lt;/li&gt;
&lt;li&gt;@resource key url     &lt;/li&gt;
&lt;li&gt;@require  include scripts &lt;/li&gt;
&lt;li&gt;@connect  reach cross origin domains  self, current domain, localhost,  or *&lt;/li&gt;
&lt;li&gt;@run-at   when to run the script  document-start/document-body/document-end/document-idle/context-menu&lt;/li&gt;
&lt;li&gt;@grant    whitelist GM_* functions    If no @grant tag is given TM guesses the scripts needs.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;å‡½æ•°&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;GM_addStyle(css)        
GM_get/set/deleteValue      
GM_listValues()     
GM_getResourceText(name)        
GM_getResourceURL(name) get base64 encoded urI  
GM_openInTab(url)       
GM_getTab(cb)   Get a object that is persistent as long as this tab is open.    
GM_getTabs(cb)  Get all tab objects as a hash to communicate with other script instances.   
GM_setClipboard(data, info) set the clipboard   


GM_xmlhttprequest can do cross domain request
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;using it in $.ajax https://gist.github.com/yifeikong/9e93cc38297cce989ffbef5587ad2f39&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 15:23:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/xue-xi-greasemonkey-jiao-cheng.html</guid><category>å¤§å‰ç«¯</category><category>æµè§ˆå™¨æ‰©å±•</category><category>è®¡ç®—æœº</category></item><item><title>kNN algorithm</title><link>/posts/knn-algorithm.html</link><description>&lt;p&gt;kNNæ˜¯ä¸€ä¸ªæœ‰ç›‘ç£çš„åˆ†ç±»ç®—æ³•ï¼Œç›®çš„æ˜¯æŠŠç»™å®šçš„æ•°æ®çš„ç±»å‹ç¡®å®šå‡ºæ¥ã€‚å…·ä½“åšæ³•æ˜¯é€šè¿‡æŠŠç»™å®šæ•°æ®ä¸å·²çŸ¥è®­ç»ƒé›†ä¸­çš„æ•°æ®ä¹‹é—´è®¡ç®—è·ç¦»ï¼ˆæ¬§æ°è·ç¦»ï¼Œæ›¼å“ˆé¡¿è·ç¦»ã€‚ã€‚ã€‚ï¼‰æ¥æ‰¾å‡ºè·ç¦»ç»™å®šæ•°æ® X æœ€è¿‘çš„ k ä¸ªæ•°æ®ï¼Œç„¶åå–è¿™ k ä¸ªæ•°æ®ä¸­å‡ºç°æœ€å¤šçš„åˆ†ç±»ä½œä¸º X çš„åˆ†ç±»ï¼Œå¦‚æœç»™å®šæ•°æ®çš„ç»´åº¦æ˜¯ä¸¤ç»´çš„è¯ï¼Œåœ¨å¹³é¢ç¬›å¡å°”åæ ‡ç³»é‡Œè¡¨ç¤ºå‡ºæ¥å°±æ˜¯è¿™æ ·çš„&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 15:22:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/knn-algorithm.html</guid><category>è®¡ç®—æœº</category><category>æœºå™¨å­¦ä¹ </category></item><item><title>YAML è¯­è¨€å’Œ Python ä¸­çš„ä½¿ç”¨</title><link>/posts/yaml-yu-yan-he-python-zhong-de-shi-yong.html</link><description>&lt;h2&gt;Install&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install pyyaml
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Basic Example&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;yaml&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;yaml&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yaml_string&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# to python list or dict&lt;/span&gt;
&lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;yaml&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;py_object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# NOTE: unlike the json module, the method here is load/dump, not loads/dumps&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Yaml&lt;/h2&gt;
&lt;p&gt;YAML uses three dashesÂ (â€œ---â€) to separateÂ documentsÂ within aÂ stream. Three dotsÂ (Â â€œ...â€) indicate the end of a document without starting a new one, for use in communication channels.&lt;/p&gt;
&lt;p&gt;empty string in yaml is '' or "", if you have a blank entry, it will be converted to None
you don't need to quote strings in yaml&lt;/p&gt;
&lt;p&gt;for dumping, when dumping to a file, do this&lt;/p&gt;
&lt;p&gt;with open('file.yml', 'w') as f:
    yaml.dump(data, f, default_flow_style=False, allow_unicode=True)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 15:20:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/yaml-yu-yan-he-python-zhong-de-shi-yong.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Cè¯­è¨€ä¸­çš„ vargs</title><link>/posts/cyu-yan-zhong-de-vargs.html</link><description>&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;int max(int n, ...) {
    va_list arg_pointer;
    int result = INT_MIN;

    va_start(arg_pointer, n);
    for (int i = 0; i &amp;lt; n; i++) {
        int arg = va_arg(arg_pointer, int);
        if (arg &amp;gt; result)
            result = arg;
    }
    va_end(arg_pointer);

    return result;
}     
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Reference&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;http://www.cnblogs.com/chinazhangjie/archive/2012/08/18/2645475.html&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;http://wiki.jikexueyuan.com/project/c-advance/other.html&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 15:02:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/cyu-yan-zhong-de-vargs.html</guid><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>get and change android device id</title><link>/posts/get-and-change-android-device-id.html</link><description>&lt;h2&gt;get device id&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;String id = Secure.getString(getContentResolver(), Secure.ANDROID_ID);&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;set device id&lt;/h2&gt;
&lt;p&gt;As far asÂ Settings.Secure.ANDROID_IDÂ goes, this should do the trick:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;adb shell sqlite3 /data/data/com.android.providers.settings/databases/settings.db "UPDATE secure SET value='newid' WHERE name='android_id'"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;WhereÂ newidÂ is usually the 16 hex digit code (i.e. don't append "Android_" to it).
I only tried this on the emulator. I imagine a real phone would need to be rooted first.&lt;/p&gt;
&lt;h2&gt;Reference&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;http://stackoverflow.com/questions/4686263/change-the-device-id-on-an-android-emulator&lt;/li&gt;
&lt;li&gt;http://stacktips.com/tutorials/android/get-device-id-example-in-android&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 14:48:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/get-and-change-android-device-id.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>Image Hashing with Python</title><link>/posts/image-hashing-with-python.html</link><description>&lt;h2&gt;dhash&lt;/h2&gt;
&lt;p&gt;http://www.hackerfactor.com/blog/index.php?/archives/529-Kind-of-Like-That.html
http://blog.iconfinder.com/detecting-duplicate-images-using-python/&lt;/p&gt;
&lt;h2&gt;ahash&lt;/h2&gt;
&lt;p&gt;http://www.hackerfactor.com/blog/index.php?/archives/432-Looks-Like-It.html&lt;/p&gt;
&lt;h2&gt;phash&lt;/h2&gt;
&lt;p&gt;https://zh.wikipedia.org/wiki/%E7%A6%BB%E6%95%A3%E4%BD%99%E5%BC%A6%E5%8F%98%E6%8D%A2&lt;/p&gt;
&lt;h2&gt;Python Implementaion(too redundant)&lt;/h2&gt;
&lt;p&gt;https://github.com/JohannesBuchner/imagehash&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 14:44:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/image-hashing-with-python.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>è¯» Web Scraping with Python</title><link>/posts/du-web-scraping-with-python.html</link><description>&lt;h1&gt;Chapter I Introduction&lt;/h1&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆè¦å†™çˆ¬è™«ï¼Ÿ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ¯ä¸ªç½‘ç«™éƒ½åº”è¯¥æä¾› APIï¼Œç„¶è€Œè¿™æ˜¯ä¸å¯èƒ½çš„&lt;/li&gt;
&lt;li&gt;å³ä½¿æä¾›äº† APIï¼Œå¾€å¾€ä¹Ÿä¼šé™é€Ÿï¼Œä¸å¦‚è‡ªå·±æ‰¾æ¥å£&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ³¨æ„å·²çŸ¥æ¡ä»¶ï¼ˆrobots.txt å’Œ sitemap.xmlï¼‰&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;robots.txt ä¸­å¯èƒ½ä¼šæœ‰é™·é˜±&lt;/li&gt;
&lt;li&gt;sitemap ä¸­å¯èƒ½æä¾›äº†é‡è¦çš„é“¾æ¥&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;ä¼°ç®—ç½‘ç«™çš„å¤§å°&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªç®€ä¾¿æ–¹æ³•æ˜¯ä½¿ç”¨ site:example.com æŸ¥è¯¢ï¼Œç„¶è€Œè¿™ç§æ–¹æ³•å¯¹äºå¤§ç«™ä¸é€‚ç”¨&lt;/p&gt;
&lt;h2&gt;è¯†åˆ«ç½‘ç«™æ‰€ä½¿ç”¨çš„æŠ€æœ¯&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;builtwith æ¨¡å—&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install builtwith
builtwith.parse(url) # returns a dict
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;python-whois æ¨¡å—&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pip&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;whois&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;whois&lt;/span&gt;
&lt;span class="n"&gt;whois&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;whois&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;ä¸‹è½½å™¨&lt;/h2&gt;
&lt;p&gt;ä¸‹è½½å™¨éœ€è¦æä¾›çš„å‡ ä¸ªåŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é”™è¯¯é‡è¯•ï¼Œä»…å½“è¿”å›çš„é”™è¯¯ä¸º500çš„æ—¶å€™é‡è¯•ï¼Œä¸€èˆ¬400é”™è¯¯å¯è®¤ä¸ºä¸å¯æ¢å¤çš„ç½‘é¡µ&lt;/li&gt;
&lt;li&gt;ä¼ªè£… UA&lt;/li&gt;
&lt;li&gt;ç­–ç•¥
    a. çˆ¬å–ç«™ç‚¹åœ°å›¾ sitemap
    b. é€šè¿‡ ID éå†çˆ¬å–
        i. ID å¯èƒ½ä¸æ˜¯è¿ç»­çš„ï¼Œæ¯”å¦‚æŸæ¡è®°å½•è¢«åˆ é™¤äº†
        ii. ID è®¿é—®å¤±æ•ˆ n æ¬¡ä»¥åå¯ä»¥è®¤ä¸ºéå†å®Œå…¨äº†&lt;/li&gt;
&lt;li&gt;ç›¸å¯¹è¿æ¥è½¬åŒ–ï¼Œè¿™ç‚¹å¯ä»¥åˆ©ç”¨ lxml çš„ make_link_absolute å‡½æ•°&lt;/li&gt;
&lt;li&gt;å¤„ç† robots.txt å¯ä»¥åˆ©ç”¨æ ‡å‡†åº“çš„ robotsparser æ¨¡å—&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;robotsparser&lt;/span&gt;
&lt;span class="n"&gt;rp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;robotparser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RobotFileParser&lt;/span&gt;
&lt;span class="n"&gt;rp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;path_to_robots.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;rp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;can_fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;url&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="bp"&gt;True&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;æ”¯æŒä»£ç†&lt;/li&gt;
&lt;li&gt;ä¸‹è½½é™é€Ÿï¼Œç²’åº¦åº”è¯¥ç²¾ç¡®åˆ°æ¯ä¸€ä¸ªç«™ç‚¹æ¯”è¾ƒå¥½&lt;/li&gt;
&lt;li&gt;é¿å…çˆ¬è™«é™·é˜±ï¼Œå°¤å…¶æ˜¯æœ€åä¸€é¡µè‡ªèº«å¼•ç”¨è‡ªèº«çš„ä¾‹å­
   a. è®°å½•é“¾æ¥æ·±åº¦&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¾‹å­ï¼šhttps://bitbucket.org/wswp/code/src/chpter01/link_crawler3.py&lt;/p&gt;
&lt;h1&gt;Chapter II Scraping&lt;/h1&gt;
&lt;h2&gt;æŠ½å–èµ„æºçš„æ–¹å¼&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ­£åˆ™
        ä¸é€‚ç”¨äºåŒ¹é…ç½‘é¡µç»“æ„ï¼Œå› ä¸ºç½‘é¡µç»“æ„ä¸­ç©ºç™½ç­‰éƒ½æ˜¯æ— å…³ç´§è¦çš„ï¼Œè€Œå¯èƒ½ç ´åæ­£åˆ™ Structural-based
        é€‚ç”¨äºæ•°æ®æœ¬èº«ç¬¦åˆæŸç§æ¨¡å¼ï¼Œæ¯”å¦‚ IP åœ°å€ï¼Œæ¯”å¦‚æ—¥æœŸç­‰ Content-based&lt;/li&gt;
&lt;li&gt;xpath ä¸ CSS
        é€‚ç”¨äºåŒ¹é…ç½‘é¡µçš„ç»“æ„ä¿¡æ¯ Strctual-basedï¼Œlxml çš„ CSS é€‰æ‹©å™¨åœ¨å†…éƒ¨æ˜¯è½¬æ¢ä¸º xpath å®ç°çš„ï¼Œcss è¿œä¸å¦‚ xpath çµæ´»&lt;/li&gt;
&lt;li&gt;BeautifulSoupï¼Œæ…¢ï¼Œä»æ¥æ²¡æœ‰åœ¨ç”Ÿäº§ä»£ç ä¸­è§åˆ°è¿‡&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹è½½çš„ç¬¬äºŒæ­¥ï¼Œå°±æ˜¯æŠŠè·å¾—çš„ç½‘é¡µä¼ é€’ç»™ Extractor æ¥æå–å†…å®¹ï¼Œå¯ä»¥é€šè¿‡ä¼ é€’ç»™ä¸‹è½½å‡½æ•°å›è°ƒæ¥å¤„ç†ï¼Œä½†æ˜¯è¿™ç§è€¦åˆæ€§å¤ªå¼ºäº†&lt;/p&gt;
&lt;h1&gt;Chapter III Downloader Cache&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;ä¹¦ä¸­çš„ç¼“å­˜æŠŠæ‰€æœ‰ç›¸åº”éƒ½åšäº†ç¼“å­˜ï¼ŒåŒ…æ‹¬500çš„é”™è¯¯å“åº”ï¼Œå®é™…ä¸Šè¿™æ ·çš„ç›´æ¥ä¸ç¼“å­˜å¥½äº†ã€‚ã€‚&lt;/li&gt;
&lt;li&gt;ä¹¦ä¸­çš„ç£ç›˜ç¼“å­˜æŠŠ url normalize é€»è¾‘ä¹ŸåŠ åˆ°äº†è¿™é‡Œï¼Œæ„Ÿè§‰æ¯”è¾ƒæ··ä¹±&lt;/li&gt;
&lt;li&gt;æ³¨æ„ä½¿ç”¨ç£ç›˜æ–‡ä»¶ç¼“å­˜çš„è¯ä¼šå—é™äºç£ç›˜å•ç›®å½•æ–‡ä»¶çš„æ•°é‡ï¼Œå³ä½¿æ˜¯ ext4 æ–‡ä»¶ç³»ç»Ÿä¹Ÿä¸å¤§&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Chapter IV&lt;/h1&gt;
&lt;p&gt;æ‰§è¡Œä¸‹è½½æ—¶é—´ä¼°ç®—ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ï¼Œæ¯ä¸ªé“¾æ¥ä¸‹è½½éœ€è¦å¤šé•¿æ—¶é—´ï¼Œæ•´ä¸ªè¿‡ç¨‹éœ€è¦å¤šé•¿æ—¶é—´
å¤šçº¿ç¨‹çš„ä¸‹è½½ä¾‹å­ï¼Œæ‰‹å·¥æ¨¡æ‹Ÿçº¿ç¨‹æ± &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;def process_queue(q):
    pass

threads = []
while thread or crawl_queue:
    for thread in threads:
        if not threads.is_alive():            
            threads.remove(thread)
    while len(threads) &amp;lt; max_threads and crawl_queue:
        thread = threading.Thread(target=process_queue, daemon=True)
        thread.start()
        threads.append(thread)
    time.sleep(some_time)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;æ€§èƒ½çš„å¢é•¿ä¸çº¿ç¨‹å’Œè¿›ç¨‹çš„æ•°é‡å¹¶ä¸æ˜¯æˆçº¿æ€§æ¯”ä¾‹çš„ï¼Œè€Œæ˜¯å¯¹æ•°æ¯”ä¾‹ï¼Œå› ä¸ºåˆ‡æ¢è¦èŠ±è´¹ä¸€å®šçš„æ—¶é—´ï¼Œå†è€…æœ€ç»ˆæ˜¯å—é™äºå¸¦å®½çš„&lt;/p&gt;
&lt;h1&gt;Chapter V Dynamic Content&lt;/h1&gt;
&lt;h2&gt;é€†å‘æ¥å£&lt;/h2&gt;
&lt;p&gt;ä¾èµ–äº Ajax çš„ç½‘ç«™çœ‹èµ·æ¥æ›´å¤æ‚ï¼Œä½†æ˜¯å®é™…ä¸Šå› ä¸ºæ•°æ®å’Œè¡¨ç°å±‚çš„åˆ†ç¦»ä¼šæ›´ç®€å•ï¼Œä½†æ˜¯å¦‚æœé€†å‘å·¥ç¨‹ä¹Ÿä¸å¥½å¾—åˆ°é€šç”¨çš„æ–¹æ³•ï¼Œå¦‚ä½•æ„å»ºä¸€ä¸ªè¾…åŠ©å·¥å…·å‘¢ï¼Ÿè¡¨ç¤ºå‡ºç½‘é¡µä¸Šå“ªäº›åœ°æ–¹æ˜¯åŠ¨æ€åŠ è½½çš„ï¼Œåˆ—å‡º js å…¨å±€å˜é‡ï¼Œåˆ—å‡ºå¯èƒ½çš„ jsonp è¯·æ±‚&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ Ajax æ¥å£æ—¶ï¼Œå¯ä»¥åˆ©ç”¨å„ç§è¾¹ç•Œæƒ…å†µï¼Œæ¯”å¦‚æŠŠæœç´¢æ¡ä»¶ç½®ä¸ºç©ºï¼Œç½®ä¸º *ï¼Œç½®ä¸º .&lt;/p&gt;
&lt;h2&gt;æ¸²æŸ“åŠ¨æ€ç½‘é¡µ&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨Qtï¼Œä½¿ç”¨ Selenium æˆ–è€… PhantomJSï¼Œè¿™æ—¶é™„åŠ  Cookie ç­‰éƒ½æ˜¯å¾ˆä¸¥é‡çš„é—®é¢˜&lt;/p&gt;
&lt;h1&gt;Chapter VI Form Interaction&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;ç™»å½•è¡¨å•ä¸­å¾€å¾€ä¼šæœ‰éšè—çš„å‚æ•°ï¼Œæ¯”å¦‚ form_key ç”¨äºé¿å…è¡¨å•é‡å¤æäº¤ï¼Œè¿˜å¯èƒ½éœ€è¦ cookie éªŒè¯&lt;/li&gt;
&lt;li&gt;Wowï¼Œç«Ÿç„¶å¯ä»¥ç›´æ¥ä»æµè§ˆå™¨åŠ è½½ Cookieï¼Œä½¿ç”¨ browsercookie æ¨¡å—&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Chapter VII&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨æœºå™¨è¯†åˆ«éªŒè¯ç 
ä½¿ç”¨ Pillow å’Œ pytesseract è¯†åˆ«éªŒè¯ç ï¼Œä½†æ˜¯ tesseract æœ¬ä¸æ˜¯ç”¨æ¥è¯†åˆ«éªŒè¯ç çš„&lt;/p&gt;
&lt;h2&gt;ä¸€ç§é”åŒ–æ–¹æ³•&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;img.convert(&amp;#39;L&amp;#39;)
img.point(lambda x: 0 if x &amp;lt; 1 else 255, &amp;#39;l&amp;#39;)
tessact.image_to_string(img)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;è¿˜å¯ä»¥é€šè¿‡é™å®šå­—ç¬¦é›†æé«˜è¯†åˆ«ç‡&lt;/p&gt;
&lt;p&gt;è¿˜å¯ä»¥ä½¿ç”¨äººå·¥æ‰“ç å¹³å°&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 14:31:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/du-web-scraping-with-python.html</guid><category>è¯»ä¹¦ç¬”è®°</category></item><item><title>ä¸ºä»€ä¹ˆè¦å†™çˆ¬è™«ï¼Ÿ</title><link>/posts/wei-shi-yao-yao-xie-pa-chong.html</link><description>&lt;p&gt;ä¸ºä»€ä¹ˆè¦çˆ¬æ•°æ®ï¼Ÿ&lt;/p&gt;
&lt;p&gt;To quote Wikipedia&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The key element that distinguishes data scraping from regular parsing is that the output being scraped was intended for display to and &lt;em&gt;end-user&lt;/em&gt;, rather than as input to another program, and is therefore usually &lt;em&gt;neither documented nor structured&lt;/em&gt; for convenient parsing.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;çˆ¬å–æ•´ç«™æ€è·¯ï¼šä½¿ç”¨å›¾éå†ç®—æ³•&lt;/li&gt;
&lt;li&gt;çˆ¬å–æ›´æ–°æ€è·¯ï¼šæ‰¾åˆ—è¡¨é¡µï¼Œä¸æ–­åˆ·æ–°è·å¾—æ›´æ–°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚ä½•è·å¾—åˆ—è¡¨é¡µï¼Ÿ
é€šè¿‡çˆ¬å–æ•´ç«™ï¼Œé€šè¿‡æœºå™¨å­¦ä¹ ï¼ŒæŸ¥æ‰¾åˆ—è¡¨é¡µ&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 14:24:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/wei-shi-yao-yao-xie-pa-chong.html</guid><category>è®¡ç®—æœº</category><category>çˆ¬è™«</category></item><item><title>Python è¯»å†™ CSV æ–‡ä»¶</title><link>/posts/python-du-xie-csv-wen-jian.html</link><description>&lt;h2&gt;typical usage&lt;/h2&gt;
&lt;p&gt;æ³¨æ„dictwriteréœ€è¦æä¾›fieldnames&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;with open(&amp;#39;csvfile&amp;#39;, &amp;#39;wt&amp;#39;, newline=&amp;#39;&amp;#39;) as f:
    writer = csv.DictWriter(f, fieldnames=[], extrasaction=&amp;#39;ignore&amp;#39;)
    writer.writeheader()
    writer.writerow(d) # list of dict if writerows

with open(&amp;#39;csvfile&amp;#39;, &amp;#39;wt&amp;#39;, newline=&amp;#39;&amp;#39;) as f:
    writer = csv.writer(f)
    writer.writerow(l) # list of list if writerows

with open(&amp;#39;csvfile&amp;#39;, &amp;#39;rt&amp;#39;) as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 14:14:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/python-du-xie-csv-wen-jian.html</guid><category>Python</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>okhttp</title><link>/posts/okhttp.html</link><description>&lt;p&gt;Good tutorial: http://www.vogella.com/tutorials/JavaLibrary-OkHttp/article.html#creating-request-objects-for-make-network-calls&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šå¾ˆå¤šå›½äº§ROM ä¼šé™åˆ¶åº”ç”¨çš„åå°è”ç½‘ï¼Œéœ€è¦æŠŠåº”ç”¨åŠ å…¥ç™½åå•&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 14:08:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/okhttp.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>vysor.io</title><link>/posts/vysorio.html</link><description>&lt;p&gt;download from here: https://vysornuts.clockworkmod.com/download/osx, basically it's an electorn app&lt;/p&gt;
&lt;h2&gt;How it works&lt;/h2&gt;
&lt;p&gt;http://zke1ev3n.me/2016/07/02/vysor%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8AAndroid%E5%90%8C%E5%B1%8F%E6%96%B9%E6%A1%88/&lt;/p&gt;
&lt;h2&gt;How to crack it&lt;/h2&gt;
&lt;p&gt;https://carlislechan.github.io/2016/08/24/Vysor%20Pro%20%E7%A0%B4%E8%A7%A3%E6%96%B9%E6%B3%95/&lt;/p&gt;
&lt;p&gt;chrome æ’ä»¶
/Users/USERNAME/Library/Application Support/Google/Chrome/Profile 1/Extensions
uglify.js&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;e() {&lt;/span&gt;
&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;licensed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;licenseCached&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;changed to &lt;code&gt;true&lt;/code&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 13:50:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/vysorio.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>å®‰å“çš„æ–‡ä»¶ç³»ç»Ÿ</title><link>/posts/an-zhuo-de-wen-jian-xi-tong.html</link><description>&lt;p&gt;let's assume &lt;code&gt;/system&lt;/code&gt; is the rom folder&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Partition&lt;/th&gt;
&lt;th&gt;Explanation&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;/boot&lt;/td&gt;
&lt;td&gt;kernel &amp;amp; Co.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/cache&lt;/td&gt;
&lt;td&gt;app cache&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data&lt;/td&gt;
&lt;td&gt;user data partitionÂ¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/data&lt;/td&gt;
&lt;td&gt;app dataÂ¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/dev&lt;/td&gt;
&lt;td&gt;devices, virtual fs&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/mnt/asec&lt;/td&gt;
&lt;td&gt;encrypted apps (App2SD)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/mnt/emmc&lt;/td&gt;
&lt;td&gt;internal sdcardÂ³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/mnt/sdcard&lt;/td&gt;
&lt;td&gt;external sdcardÂ³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/proc&lt;/td&gt;
&lt;td&gt;process informationÂ²&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/recovery&lt;/td&gt;
&lt;td&gt;used in recovery mode&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/system&lt;/td&gt;
&lt;td&gt;system ROM (read-only)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;&lt;code&gt;/data&lt;/code&gt;Â andÂ &lt;code&gt;/data/data&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;These are in most cases two separate partitions, but there might be cases where this is handled otherwise. One thing they have in common (addÂ /cacheÂ here as well): they get wiped on aÂ factory-reset, while the other partitions are usually left untouched by that.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Directory&lt;/th&gt;
&lt;th&gt;Explanation&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;/data/anr&lt;/td&gt;
&lt;td&gt;traces from app crashes (App Not Responding)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/app&lt;/td&gt;
&lt;td&gt;.apk files of apps installed by the user&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/backup&lt;/td&gt;
&lt;td&gt;Googles Cloud-Backup stuff&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/dalvik-cache&lt;/td&gt;
&lt;td&gt;optimized versions of installed appsÂ¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/data&lt;/td&gt;
&lt;td&gt;app dataÂ²&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/local&lt;/td&gt;
&lt;td&gt;temporary files from e.g. Google PlayÂ³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/misc&lt;/td&gt;
&lt;td&gt;system configuration (WiFi, VPN, etc.)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/system&lt;/td&gt;
&lt;td&gt;more system related stuff (certs, battstat)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/tombstones&lt;/td&gt;
&lt;td&gt;more crash stuff ("core dumps")&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/data/user&lt;/td&gt;
&lt;td&gt;multi-user support, /data/user/0Â is a symlink toÂ /data/data&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;Reference&lt;/h2&gt;
&lt;p&gt;[1] http://android.stackexchange.com/questions/46926/android-folder-hierarchy
[2] http://android.stackexchange.com/questions/48393/what-kind-of-data-is-stored-in-data-user-directory&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 13:39:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/an-zhuo-de-wen-jian-xi-tong.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>cross compiling on android</title><link>/posts/cross-compiling-on-android.html</link><description>&lt;h2&gt;basic knowledge&lt;/h2&gt;
&lt;p&gt;first, we need a cross compiler, which you can download from the source or somewhere.&lt;/p&gt;
&lt;p&gt;second, when we use gcc to build stuff, actually we are implicitly linking to the stdlib of c, if we are cross compiling programs for another platform, then we need another platform's filesystem to be accessible to us. However, we only need the target's /usr directory, because that's where the header files lives in. &lt;/p&gt;
&lt;p&gt;we place target's header files in a directory called &lt;em&gt;sysroot&lt;/em&gt;, and gcc supports the argument &lt;code&gt;--sysroot&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;gcc config parameters&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;|options  | explaination                                    |
|---------|-------------------------------------------------|
|--build  |the machine which you build on                   |
|--host   |the machine which your binary will be running on |
|--target |the machine that GCC will produce code for       |

|--build |--host |--target|result |
|--------|-------|--------|-------|
|-   |-  | -      |native |
|-   |-      | x      |cross complie|
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;LDFLAGS="$LDFLAGS -m32 ?&lt;/code&gt;
ArgumentÂ &lt;code&gt;--target&lt;/code&gt;Â makes sense only when building compiler (e.g. GCC).&lt;/p&gt;
&lt;h2&gt;How to&lt;/h2&gt;
&lt;p&gt;Let's assume you have directory called ~/x-compile&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;You have your tool-chain installed, that it is the correct tool-chain and theÂ PATHÂ environment variable is correctly set, so that the cross-compiler and all other cross-tools binaries can be called from any folder.&lt;/li&gt;
&lt;li&gt;You have the sysroot installed inÂ ~/x-compile/sysroot&lt;/li&gt;
&lt;li&gt;Your code depends on a library for which you have the source code inÂ ~/x-compile/depsrc/&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;You have the source code to be cross-compiled inÂ ~/x-compile/src&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;compile you dependency lib, if your dependency lib don't need stdlib&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./configure CC=arm-linux-gnueabihf-gcc --prefix=~/x-compile/deps --host=arm-linux-gnueabihf
make
make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;if your dependency needs system libs, then you need &lt;code&gt;--sysroot&lt;/code&gt; as below&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;compile your program&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;compile python on android&lt;/h2&gt;
&lt;p&gt;åœ¨å®‰å“ä¸Šç¼–è¯‘python&lt;/p&gt;
&lt;p&gt;compiling 2.7.2&lt;/p&gt;
&lt;p&gt;https://mdqinc.com/blog/2011/09/cross-compiling-python-for-android/&lt;/p&gt;
&lt;p&gt;another tutorial&lt;/p&gt;
&lt;p&gt;http://www.srplab.com/en/files/others/compile/cross_compiling_python_for_android.html&lt;/p&gt;
&lt;p&gt;best tutorial&lt;/p&gt;
&lt;p&gt;http://joaoventura.net/blog/2014/python-android-5/&lt;/p&gt;
&lt;h2&gt;Reference&lt;/h2&gt;
&lt;p&gt;http://www.fabriziodini.eu/posts/cross_compile_tutorial/
https://landley.net/writing/docs/cross-compiling.html
http://stackoverflow.com/questions/5139403/whats-the-difference-of-configure-option-build-host-and-target  &lt;/p&gt;
&lt;p&gt;very confusing, the second answer is better&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 13:27:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/cross-compiling-on-android.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>å®‰å“çš„adbå·¥å…·ä¸å‘½ä»¤è¡Œ</title><link>/posts/an-zhuo-de-adbgong-ju-yu-ming-ling-xing.html</link><description>&lt;h1&gt;Yifei's Notes&lt;/h1&gt;
&lt;p&gt;adb is pretty unstable, it's meant for debug usage, NOT for a long-running service.&lt;/p&gt;
&lt;h1&gt;Install&lt;/h1&gt;
&lt;p&gt;install on ubuntu: &lt;code&gt;apt-get install android-tools-adb android-tools-fastboot&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;install on mac: &lt;code&gt;brew install android-platform-tools&lt;/code&gt;&lt;/p&gt;
&lt;h1&gt;Connect model&lt;/h1&gt;
&lt;p&gt;there is a server on PC called adb server, if not started, will be started on first adb client call commands. there is an adbd daemon on phone, run as not root by default.&lt;/p&gt;
&lt;h1&gt;adb devices&lt;/h1&gt;
&lt;p&gt;list all devices, give serial number for usb, and ip:port for wifi devices as adb id. if only one device, all commands are issued to that device, if many, use adb -s &lt;adb-id&gt; command to select a device.&lt;/p&gt;
&lt;h2&gt;Connect over Wifi&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;first usb adb to the device&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;second&lt;/p&gt;
&lt;p&gt;if rooted and run this on phone&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;su
setprop service.adb.tcp.port 5555
stop adbd &amp;amp;&amp;amp; start adbd
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;if not rooted and run this on computer
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;adb tcpip 5555
&lt;/pre&gt;&lt;/div&gt;


&lt;ol&gt;
&lt;li&gt;&lt;code&gt;adb connect ip:port&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;adb usb&lt;/code&gt;  # back to usb mode&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;pull/push&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;adb pull phone_path pc_path&lt;/code&gt;
&lt;code&gt;adb push pc_path phone_path&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;install/uninstall&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;adb install 
adb uninstall
adb shell pm clear PACKAGE_NAME  # clears package data
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;forward&lt;/h2&gt;
&lt;p&gt;adb forward local:port android:port&lt;/p&gt;
&lt;p&gt;adb wait-for-device&lt;/p&gt;
&lt;p&gt;read the adb help&lt;/p&gt;
&lt;h2&gt;remount&lt;/h2&gt;
&lt;p&gt;remounts the /system, /vendor (if present) and /oem (if present) partitions on the device read-write&lt;/p&gt;
&lt;p&gt;adb forward&lt;/p&gt;
&lt;p&gt;which forwards requests on a specific host port to a different port on a device&lt;/p&gt;
&lt;p&gt;&lt;code&gt;adb forward host device&lt;/code&gt;
&lt;code&gt;adb forward tcp:6100 tcp:7100&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;get running activity name&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;adb shell dumpsys activity | grep mFocusedActivity&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;pm
setprop/getprop
netcfg
screencap
screenrecord&lt;/p&gt;
&lt;p&gt;error closed&lt;/p&gt;
&lt;p&gt;å¯èƒ½æ˜¯æƒé™ä¸å¤Ÿï¼Œæ‰§è¡Œäº†næƒé™è¿‡é«˜çš„æ“ä½œï¼Œéœ€è¦é¦–å…ˆæ‰§è¡Œ adb root&lt;/p&gt;
&lt;p&gt;èƒ½ç”¨ sshï¼Œå°±ç”¨ ssh ï¼Œä¸è¦ç”¨ adb&lt;/p&gt;
&lt;h1&gt;Android Shell Command&lt;/h1&gt;
&lt;p&gt;https://github.com/jackpal/Android-Terminal-Emulator/wiki/Android-Shell-Command-Reference
http://forum.xda-developers.com/showthread.php?t=1694251 
http://forum.xda-developers.com/wiki/Guide%3aUsing_the_Terminal#SSHD
http://www.kpbird.com/2013/05/android-shell-command-pm-package-manager.html&lt;/p&gt;
&lt;p&gt;termux&lt;/p&gt;
&lt;h1&gt;32 bit adb åœ¨64ä½linuxä¸Šæ— æ³•è¿è¡Œ&lt;/h1&gt;
&lt;p&gt;The error message is no such file of directory, which is quite miss-leading&lt;/p&gt;
&lt;h1&gt;adb install å®‰è£…å¤±è´¥&lt;/h1&gt;
&lt;p&gt;apk æ²¡æœ‰æƒé™  åº”è¯¥777
apk æœ‰è¯ä¹¦ä¸ä¸€è‡´çš„ å¸è½½æ—§çš„apk&lt;/p&gt;
&lt;h1&gt;Configuator è®¾ç½® uiautomator çš„è¶…æ—¶æ—¶é—´ï¼Œå‚è§[1]&lt;/h1&gt;
&lt;p&gt;[1] https://developer.android.com/reference/android/support/test/uiautomator/Configurator.html&lt;/p&gt;
&lt;p&gt;ä»æ‰‹æœºä¸Šæ‹‰å–å·²å®‰è£…åº”ç”¨çš„apkæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;adb shell pm path com.example.someapp&lt;/p&gt;
&lt;p&gt;adb pull /data/app/com.example.someapp-2.apk&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 12:45:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/an-zhuo-de-adbgong-ju-yu-ming-ling-xing.html</guid><category>å¤§å‰ç«¯</category><category>Android</category><category>è®¡ç®—æœº</category></item><item><title>Linux å‘½ä»¤è¡Œè´¦æˆ·ç®¡ç†</title><link>/posts/linux-ming-ling-xing-zhang-hu-guan-li.html</link><description>&lt;p&gt;æ‰§è¡Œ &lt;code&gt;sudo vi /etc/suduers&lt;/code&gt;, ç„¶åè¾“å…¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;username ALL=(ALL) NOPASSWD: ALL&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;useradd -m USERNAME  # add a user
userdel USERNAME  # delete a user
passwd -e  # password expire next time user login

groups username  # view username groups
usermod -G groupname username  # add user to a group
usermod -g groupname username # set user to a group

newgrp
make newly added group work immediately without login/out
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;chsh æç¤ºè¾“å…¥å¯†ç çš„é—®é¢˜&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Changing /etc/pam.d/chsh: from:

auth       required   pam_shells.so
to

auth       sufficient   pam_shells.so
&lt;/pre&gt;&lt;/div&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 12:40:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/linux-ming-ling-xing-zhang-hu-guan-li.html</guid><category>å‘½ä»¤è¡Œ</category><category>åç«¯</category><category>è®¡ç®—æœº</category></item><item><title>TCP æ¡æ‰‹å¸¸è§è€ƒç‚¹</title><link>/posts/tcp-wo-shou-chang-jian-kao-dian.html</link><description>&lt;h1&gt;è¿æ¥å»ºç«‹&lt;/h1&gt;
&lt;p&gt;&lt;img alt="" src="https://ws3.sinaimg.cn/large/006tKfTcly1ftppcaaoz7j30i40bdgn0.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„å›¾è¯´çš„å·²ç»å¾ˆå¥½äº†ï¼Œä¸å†èµ˜è¿°ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹&lt;/h2&gt;
&lt;p&gt;è¿™ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å»ºç«‹ä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚ &lt;/p&gt;
&lt;p&gt;æ‰€è°“å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µæ˜¯è¿™æ ·äº§ç”Ÿçš„ã€‚Aå‘é€è¿æ¥è¯·æ±‚ï¼Œä½†å› è¿æ¥è¯·æ±‚æŠ¥æ–‡ä¸¢å¤±è€Œæœªæ”¶åˆ°ç¡®è®¤ï¼Œäºæ˜¯Aé‡å‘ä¸€æ¬¡è¿æ¥è¯·æ±‚ï¼ŒæˆåŠŸåå»ºç«‹äº†è¿æ¥ã€‚æ•°æ®ä¼ è¾“å®Œæ¯•åå°±é‡Šæ”¾äº†è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å‡å®šAå‘å‡ºçš„ç¬¬ä¸€ä¸ªè¯·æ±‚æŠ¥æ–‡æ®µå¹¶æœªä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œèŠ‚ç‚¹é•¿æ—¶é—´æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†Bæ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯ä»¥ä¸ºAåˆå‘äº†ä¸€æ¬¡æ–°çš„è¿æ¥è¯·æ±‚ï¼Œäºæ˜¯å‘Aå‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚å‡å¦‚ä¸é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆåªè¦Bå‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ &lt;/p&gt;
&lt;p&gt;ç”±äºAå¹¶æœªå‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼Œå› æ­¤ä¸ä¼šç†ç¬Bçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘Bå‘é€æ•°æ®ã€‚ä½†Bå´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹äº†ï¼Œå¹¶ä¸€ç›´ç­‰å¾…Aå‘æ¥æ•°æ®ï¼Œå› æ­¤ç™½ç™½æµªè´¹äº†è®¸å¤šèµ„æºã€‚ &lt;/p&gt;
&lt;p&gt;é‡‡ç”¨TCPä¸‰æ¬¡æ¡æ‰‹çš„æ–¹æ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚ä¾‹å¦‚åœ¨åˆšæ‰çš„æƒ…å†µä¸‹ï¼Œç”±äºAä¸ä¼šå‘Bçš„ç¡®è®¤å‘å‡ºç¡®è®¤ï¼Œè¿æ¥å°±ä¸ä¼šå»ºç«‹ã€‚&lt;/p&gt;
&lt;h2&gt;å¦‚æœåœ¨TCPç¬¬ä¸‰æ¬¡æ¡æ‰‹ä¸­çš„æŠ¥æ–‡æ®µä¸¢å¤±äº†ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µ?&lt;/h2&gt;
&lt;p&gt;Clientè®¤ä¸ºè¿™ä¸ªè¿æ¥å·²ç»å»ºç«‹ï¼Œå¦‚æœClientç«¯å‘Serverå†™æ•°æ®ï¼ŒServerç«¯å°†ä»¥RSTåŒ…å“åº”ï¼Œæ–¹èƒ½æ„ŸçŸ¥åˆ°Serverçš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;h1&gt;é“¾æ¥é‡Šæ”¾&lt;/h1&gt;
&lt;p&gt;&lt;img alt="" src="https://ws2.sinaimg.cn/large/006tKfTcly1ftppdqkfzij311g0rok0s.jpg"&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒTCP æ˜¯å…¨åŒå·¥çš„åè®®ï¼Œå› æ­¤é“¾æ¥å»ºç«‹ä¹‹åå°±æ²¡æœ‰å®¢æˆ·ç«¯æœåŠ¡å™¨çš„æ¦‚å¿µäº†ï¼Œä¸¤è¾¹æ˜¯å¯¹ç­‰çš„ï¼Œéƒ½å¯ä»¥é‡Šæ”¾é“¾æ¥&lt;/p&gt;
&lt;p&gt;MSSï¼ˆæœ€é•¿æŠ¥æ–‡é•¿åº¦ï¼‰, ç”±ä¸¤ç«¯çš„è¾ƒçŸ­å€¼å†³å®š, åœ¨ä»¥å¤ªç½‘ä¸­çš„å…¸å‹å€¼ä¸º1460, æ˜¯ä»¥å¤ªç½‘çš„ MTU(1500)å‡å» IP çš„å¤´éƒ¨ 40B å¾—åˆ°çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://ws1.sinaimg.cn/large/006tKfTcly1ftpt8b0upyj30f40lc765.jpg"&gt;&lt;/p&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆéœ€è¦ TIME_WAIT çŠ¶æ€&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæ˜¯å¦ä¸€ä¸ªæ¦‚å¿µ MSL, æœ€é•¿æŠ¥æ–‡ç”Ÿå‘½å‘¨æœŸ, åœ¨ BSD ç³»ç»Ÿä¸Šä¸€èˆ¬è®¾å®šä¸º30s, ä¸è¿‡å¯ä»¥é•¿åˆ° 2minã€‚TIME_WAIT çŠ¶æ€çš„æ—¶é—´è®¾å®šä¸º2MSLã€‚&lt;/p&gt;
&lt;p&gt;TIME_WAIT æ˜¯ä¸»åŠ¨å…³é—­ç«¯è¿›å…¥çš„çŠ¶æ€, å‘é€å®Œæœ€åä¸€ä¸ª ACK ä¹‹åè¿›å…¥ TIME_WAIT çŠ¶æ€ç­‰å¾… 2MSL æ‰è¿›å…¥ CLOSED çŠ¶æ€&lt;/p&gt;
&lt;p&gt;TIME_WAIT çŠ¶æ€å­˜åœ¨çš„ä¸¤ä¸ªç†ç”±:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯é åœ°å®ç° TCP å…¨åŒå·¥é“¾æ¥çš„ç»ˆæ­¢; å‡å¦‚å¯¹æ–¹æ²¡èƒ½æ”¶åˆ°æœ€åä¸€ä¸ª ACK, é‚£ä¹ˆä»–å°†ä¼šé‡æ–°å‘é€ FIN, è¿™æ—¶å€™å¦‚æœå®¢æˆ·ç«¯å·²ç»å…³é—­äº†æ˜¾ç„¶ä¸èƒ½å†æ¬¡å›å¤ ACK äº†.&lt;/li&gt;
&lt;li&gt;ä¿è¯ä¸Šä¸€ä¸ªç›¸åŒè¿æ¥çš„æ•°æ®åŒ…å·²ç»åœ¨ç½‘ç»œä¸Šæ¶ˆå¤±; å¦‚æœä¸€ä¸ªæ–°çš„é“¾æ¥å»ºç«‹åœ¨äº†åŒä¸€ä¸ªç«¯å£ä¸Š, é‚£ä¹ˆä»–å°†å¯èƒ½æ”¶åˆ°ä¸Šä¸€ä¸ªè¿›ç¨‹çš„æ•°æ®åŒ…, è¿™æ˜¯æˆ‘ä»¬ä¸ºè€è¿æ¥ä¿ç•™äº†2MSL çš„ TIME_WAIT å€¼, é‚£ä¹ˆå°±å¯ä»¥ä¿è¯åŸæœ‰çš„é“¾æ¥éƒ½ä¸å­˜åœ¨ç½‘ç»œä¸Šäº†.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;å¦‚æœæœåŠ¡ç«¯ä¸»åŠ¨å…³é—­é“¾æ¥ï¼Œä¹Ÿéœ€è¦ç­‰å¾…ä¸¤ä¸ª MSLï¼Œé‚£ä¹ˆé‡å¯æœåŠ¡å™¨æ€ä¹ˆç»‘å®šåŸæœ‰ç«¯å£ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸»åŠ¨å…³é—­é“¾æ¥ç«¯ç›¸åº”çš„ç«¯å£ä¼šåœ¨ 2 MSL å†…å¤„äº TIME-WAIT çŠ¶æ€è€Œä¸èƒ½ç”¨ã€‚å¦‚æœæ˜¯å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆé—®é¢˜ä¸å¤§ï¼Œå®¢æˆ·ç«¯ä¸€èˆ¬ä¼šé‡æ–°ä½¿ç”¨ä¸€ä¸ªæ–°çš„ç«¯å£ã€‚å¦‚æœæ˜¯åœ¨æœåŠ¡ç«¯ï¼Œå› ä¸ºæœåŠ¡ç«¯ä½¿ç”¨çš„éƒ½æ˜¯å¸¸ç”¨ç«¯å£ï¼Œä¸èƒ½æ”¹å˜ï¼Œä¹Ÿå°±æ˜¯éœ€è¦ç­‰å¾…ä¸¤ä¸ª MSL æ‰èƒ½ä½¿ç”¨åˆšæ‹¿çš„ç«¯å£ï¼Œæ¯”å¦‚ Nginx é‡å¯ï¼Œå†…æ ¸ä¼šæ˜¾ç¤ºå½“å‰ç«¯å£æ˜¯ busy çš„ï¼Œä¸èƒ½ä½¿ç”¨ï¼Œç­‰å¾… 4min æ˜¾ç„¶æ˜¯ä¸ç°å®çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å¼ºåˆ¶å¤ç”¨ç«¯å£ï¼Œåœ¨åˆ›å»º socket çš„æ—¶å€™ä½¿ç”¨ SO_REUSEADDR å°±å¯ä»¥äº†ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSO_REUSEADDR ä»…å¯¹ TIME_WAIT çŠ¶æ€æœ‰ç”¨ï¼Œå¦‚æœ socket åœ¨å…¶ä»–çŠ¶æ€ï¼Œæ˜¯ä¸èƒ½å¤ç”¨çš„ã€‚æ³¨æ„ä¸æ˜¯ SO_REUSEPORTã€‚&lt;/p&gt;
&lt;h2&gt;å¤šä¸ªè¿›ç¨‹ç»‘å®šåŒä¸€ä¸ªç«¯å£&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªåŒä¸€ä¸ªç«¯å£åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ bind æˆåŠŸï¼Œé‚£ä¹ˆ web æœåŠ¡å™¨æ˜¯å¦‚ä½•åšåˆ°å¤šè¿›ç¨‹å‘¢ï¼Ÿä¼ ç»Ÿæ–¹æ³•æ˜¯åœ¨ä¸»è¿›ç¨‹ä½¿ç”¨ listen ç„¶ååœ¨å…¶ä»–è¿›ç¨‹ä½¿ç”¨ accept æ¥å—é“¾æ¥ã€‚ä¸è¿‡è¿™æ ·ä¼šå¯¼è‡´å½“æœ‰é“¾æ¥æ¥çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½ä¼šè¢«å”¤é†’ï¼Œå½±å“æ€§èƒ½ã€‚åœ¨ 3.9 å†…æ ¸ä¹‹åï¼Œæ·»åŠ äº† SO_REUSEPORT å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ SO_REUSEPORT è®©æ¯ä¸€ä¸ªè¿›ç¨‹æœ‰å½“å•ç‹¬çš„ç›‘å¬é˜Ÿåˆ—ï¼Œè¿™æ ·å½“æœ‰é“¾æ¥æ¥çš„æ—¶å€™ï¼Œå†…æ ¸åªä¼šå”¤é†’ä¸€ä¸ªè¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h2&gt;å½“ç½‘ç»œæ–­å¼€æ—¶ï¼ŒTCP é“¾æ¥ä¼šæ–­å¼€å—ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;TCP é“¾æ¥æœ‰ keepalive çš„åŠŸèƒ½ï¼Œéœ€è¦æ‰‹åŠ¨æ‰“å¼€ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´æ²¡æœ‰äººç”¨ã€‚æ‰€ä»¥å¯ä»¥è®¤ä¸ºä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“ç‰©ç†ç½‘ç»œæ–­å¼€æ—¶çš„æ—¶å€™ï¼Œå¦‚æœä»…è€ƒè™‘ TCP å±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªé“¾æ¥æ°¸è¿œä¸ä¼šæ–­å¼€ã€‚ä¸è¿‡ä¸€èˆ¬æ¥è¯´ï¼Œé€šè¿‡å…¶ä»–å±‚é¢ä¼šçŸ¥é“è¿™ä¸ªé“¾æ¥æ–­å¼€äº†ã€‚æ¯”å¦‚è¯´ä¸€èˆ¬çš„åº”ç”¨å±‚åè®®éƒ½ä¼šæœ‰å¿ƒè·³åŒ…çš„æœºåˆ¶ï¼Œè¿™æ ·å°±å¯ä»¥çŸ¥é“é“¾æ¥æ–­å¼€äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://img-blog.csdn.net/20150907214517068"&gt;&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;https://serverfault.com/questions/329845/how-to-forcibly-close-a-socket-in-time-wait&lt;/li&gt;
&lt;li&gt;http://www.unixguide.net/network/socketfaq/4.5.shtml&lt;/li&gt;
&lt;li&gt;https://blog.csdn.net/Yaokai_AssultMaster/article/details/68951150&lt;/li&gt;
&lt;li&gt;https://www.zhihu.com/question/53672815&lt;/li&gt;
&lt;li&gt;https://blog.qiusuo.im/blog/2014/09/14/linux-so-reuseport/&lt;/li&gt;
&lt;li&gt;https://blog.csdn.net/xy010902100449/article/details/48274635&lt;/li&gt;
&lt;li&gt;https://www.nginx.com/blog/socket-sharding-nginx-release-1-9-1/&lt;/li&gt;
&lt;/ol&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 11:47:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/tcp-wo-shou-chang-jian-kao-dian.html</guid><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item><item><title>ç¬”è®°ç”Ÿæ¶¯</title><link>/posts/bi-ji-sheng-ya.html</link><description>&lt;p&gt;å†™ç¬”è®°ä¹Ÿæœ‰å‡ å¹´æ—¶é—´äº†ï¼Œæœ€å¼€å§‹è‡ªç„¶ç”¨çš„æ˜¯å¼€å±±é¼»ç¥– Evernoteï¼Œå½“æ—¶å¹¶æ²¡æœ‰ä»€ä¹ˆç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›ï¼Œå¤§æ¦‚æ˜¯çœ‹åˆ°æœ‰ä»€ä¹ˆå¥½çš„æ–‡ç« ï¼Œä¸€æ—¶æ¶ˆåŒ–ä¸äº†æˆ–è€…æƒ³ç€ä¼šå›å¤´æ¥çœ‹ï¼Œä¾¿ç”¨ Evernote Webclipper å‰ªè¾‘ä¸‹æ¥ï¼Œåˆ°æœ€åè¿™äº›ã€ç¬”è®°ã€è‡ªç„¶æ˜¯æ²¡æœ‰çœ‹è¿‡å¤šå°‘ï¼Œç¿»äº†ç¿»ï¼Œä»…å‰©ä¸‹å‡ ç¯‡è¿˜ç®—æ˜¯è‡ªå·±å†™çš„å…¶ä½™ä¾¿éƒ½åˆ äº†ã€‚&lt;/p&gt;
&lt;p&gt;åæ¥å¼€å§‹è¯»ç ”ï¼Œå›½å†…çš„ç¬”è®°è½¯ä»¶ä¹Ÿå¤šäº†èµ·æ¥ï¼Œå¬è¯´ wiz å¯¹ markdown çš„æ”¯æŒæ˜¯æœ€å¥½çš„ï¼Œåˆæ˜¯ä¸€ä¸ªå°å›¢é˜Ÿå‡ºå“ï¼Œç”šå’Œæˆ‘å¿ƒï¼Œç”¨äº†ä¸€å¹´æœ‰ä½™ï¼Œè®°ç¬”è®°ä¹Ÿä¸å¤šï¼Œç„¶è€Œæ€»æ˜¯æ„Ÿè§‰æœ‰äº›ä¸é¡ºæ‰‹ï¼Œé‚å¼ƒä¹‹&lt;/p&gt;
&lt;p&gt;è™½ç„¶ä»å¤§ä¸‰å¼€å§‹ä¾¿ç”¨ ubuntu åšä¸»åŠ›ç³»ç»Ÿï¼Œç„¶è€Œç«Ÿç›´åˆ°ç ”äºŒæ‰ç®—æ˜¯ä¹ æƒ¯ vi çš„æ“ä½œæ–¹å¼ï¼Œç”šè‡³ç”¨ç†Ÿæ‚‰ shell ç«Ÿæ˜¯ç¬¬ä¸€ä»½å·¥ä½œä¹‹åçš„äº‹ï¼Œå½“ç„¶è¿™æ˜¯åè¯äº†ã€‚ç”¨ç†Ÿäº† viï¼Œç›´æ¥ç”¨ä¸€ä¸ªå‘½ä»¤(vilog)å†™ markdown æ–‡ä»¶å¥½äº†ï¼ŒåŠå¹´æœ‰ä½™ï¼Œç®—æ˜¯æ—¥å¿—ï¼Œä¹Ÿæ˜¯ç¬”è®°å§ï¼Œå”¯ä¸€çš„ä¸æ»¡å°±æ˜¯è¡¨æ ¼å¤ªä¸æ–¹ä¾¿è¡¨è¾¾äº†ã€‚&lt;/p&gt;
&lt;p&gt;å†åæ¥ç”¨åŠå¹´æŒ£æ¥çš„å¤–å¿«ç»ˆäºæœ‰é—²é’±å¤Ÿå¾—ä¸€å¤© macï¼Œç”šå–œï¼Œç¬¬ä¸€æ¬¡æœ‰ä¸€ç§æ„‰å¿«çš„å›¾å½¢ç•Œé¢çš„ä½“éªŒï¼Œå¶å°”ä¼šåœ¨æ‰‹æœºä¸Šçœ‹çœ‹ç¬”è®°ï¼Œåˆè§‰å¾—åªåœ¨ç”µè„‘ä¸Šå†™å‡ ä¸ªæ–‡ä»¶çš„æ–¹å¼ä¸ç”šç§»åŠ¨åŒ–ï¼Œæœ‰ä¸€ç•ªè€ƒå¯Ÿï¼Œå‘ç° OneNote ç”šåˆæˆ‘æ„ï¼Œæœ€è´´å¿ƒçš„åŠŸèƒ½æ˜¯èƒ½å¤Ÿåœ¨ä¸€ä¸ªç¬”è®°çš„ä»»ä½•åœ°æ–¹ç‚¹ä¸Šä¸€ç‚¹ä¾¿å¯ä»¥åœ¨æ­¤å¤„å¼€å§‹ä¸€ä¸ªæ–°çš„æ–‡æœ¬æ¡†ï¼Œå®åœ¨æ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;p&gt;ä»ç ”äºŒå¼€å§‹ï¼Œç”¨ OneNote ä¸¤å¹´æœ‰ä½™ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯è‡ªå·±çš„ç¬”è®°ï¼Œæ„Ÿæ‚Ÿï¼Œç„¶è€Œ OneNote ä¼¼ä¹æ¸æ¸ä¹Ÿæ»¡è¶³ä¸äº†æˆ‘çš„ç”¨é€”ï¼Œä¸»è¦æœ‰ä¸‹åˆ—å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åªèƒ½åŒæ—¶æŸ¥çœ‹ä¸€ä¸ªç¬”è®°é¡µé¢ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½å¤šçª—å£&lt;/li&gt;
&lt;li&gt;ä¸èƒ½è‡ªåŠ¨ç”Ÿæˆç›®å½•&lt;/li&gt;
&lt;li&gt;åˆ†äº«å¾ˆä¸å‹å¥½&lt;/li&gt;
&lt;li&gt;ä¸å®‰å…¨ï¼Œæ¯•ç«Ÿæ˜¯åœ¨å¾®è½¯çš„æœåŠ¡å™¨ä¸Šï¼Œä¸€ä¸ªæ˜¯æ•°æ®æ³„å¯†ï¼Œä¸€ä¸ªæ˜¯æ•°æ®ä¸¢å¤±&lt;/li&gt;
&lt;li&gt;åŒä¸€ç‰‡ç¬”è®°åªèƒ½åœ¨ä¸€ä¸ªç›®å½•ä¸‹&lt;/li&gt;
&lt;li&gt;Mac ç‰ˆåŠŸèƒ½ä¸å…¨&lt;/li&gt;
&lt;li&gt;ä¸èƒ½è®¾ç½®é»˜è®¤å­—ä½“ï¼Œå­—ä½“å˜æ¥å˜å»&lt;/li&gt;
&lt;li&gt;ä¸æ”¯æŒ markdown&lt;/li&gt;
&lt;li&gt;ç»å¸¸éœ€è¦ç™»å½•&lt;/li&gt;
&lt;li&gt;æ·»åŠ é™„ä»¶ä¸èƒ½æ”¯æŒé¢„è§ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;OneNote æœ‰ä¸¤ç‚¹å¥½å¤„å¸Œæœ›ä¹Ÿèƒ½å¤Ÿä¿ç•™&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‡ªç”±çš„æ’å…¥è¡¨æ ¼å’Œå›¾ç‰‡&lt;/li&gt;
&lt;li&gt;èƒ½å¤Ÿåœ¨ä¸€ç¯‡ç¬”è®°ä¸­åŠ å…¥å¤šä¸ªæ–‡æœ¬æ¡†ï¼Œç‚¹åˆ°å“ªé‡Œå†™å“ªé‡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å°è¯•ç€è‡ªå·±å†™ç¬”è®°è½¯ä»¶, å´åˆå‘ç°å‰ç«¯ä»€ä¹ˆçš„å®åœ¨å¤ªåºæ‚, é‚æ”¾å¼ƒ.&lt;/p&gt;
&lt;p&gt;åæ¥ä¹°äº† iPad Pro 2, å‘ç°ç”¨Apple Pencil å’Œ Good Note æ‰æ˜¯ç»é…. å½“ç„¶è¿˜æ˜¯æ— æ³•å‘è¡¨åˆ†äº«&lt;/p&gt;
&lt;p&gt;æ°å¥½åœ¨è¿™ä¸¤æ—¥åœ¨å­¦ä¹  djangoï¼Œä¸å¦‚è‡ªå·±å‘å¸ƒä¸€ä¸‹ï¼Œæ‰€ä»¥å°±æœ‰äº† ynote.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 01:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/bi-ji-sheng-ya.html</guid><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>Configuring OpenWrt in TP-Link 702n</title><link>/posts/configuring-openwrt-in-tp-link-702n.html</link><description>&lt;h1&gt;å¦‚ä½•é‡ç½®ä¸€ä¸ªæŸåçš„ OpenWrt&lt;/h1&gt;
&lt;p&gt;åˆ é™¤ overlay ä¸‹çš„æ–‡ä»¶å³å¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rm -rf /overlay/*
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;ç½‘ç»œé…ç½®&lt;/h1&gt;
&lt;h3&gt;1.Assign a Password for Root&lt;/h3&gt;
&lt;p&gt;telnet 192.168.1.1
Â  Â  passwd root
Â  Â  exit&lt;/p&gt;
&lt;h3&gt;2.Interface config: &lt;code&gt;/etc/config/network&lt;/code&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Â  Â  Â  Â  config interface &amp;#39;loopback&amp;#39;
Â  Â  Â  Â  Â  Â  option ifname &amp;#39;lo&amp;#39;
Â  Â  Â  Â  Â  Â  option proto &amp;#39;static&amp;#39;
Â  Â  Â  Â  Â  Â  option ipaddr &amp;#39;127.0.0.1&amp;#39;
Â  Â  Â  Â  Â  Â  option netmask &amp;#39;255.0.0.0&amp;#39;
Â  Â  Â  Â  config interface &amp;#39;lan&amp;#39;
Â  Â  Â  Â  Â  Â  option ifname &amp;#39;eth0&amp;#39;
Â  Â  Â  Â  Â  Â  option proto &amp;#39;dhcp&amp;#39;
Â  Â  Â  Â  config interface &amp;#39;wifi&amp;#39;
Â  Â  Â  Â  Â  Â  option proto &amp;#39;static&amp;#39;
Â  Â  Â  Â  Â  Â  option ipaddr &amp;#39;172.19.1.1&amp;#39;
Â  Â  Â  Â  Â  Â  option netmask &amp;#39;255.255.255.0&amp;#39;Â 
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;3.Wireless Config: &lt;code&gt;/etc/config/wireless&lt;/code&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Â  Â  Â  Â  1) **remove to enable wifi**
Â  Â  Â  Â  Â  Â  # REMOVE THIS LINE TO ENABLE WIFI:
Â  Â  Â  Â  Â  Â  option disabled 1
Â  Â  Â  Â  2) config wifi interface
Â  Â  Â  Â  Â  Â  config wifi-iface
Â  Â  Â  Â  Â  Â  Â  Â  option device &amp;#39;radio0&amp;#39;
Â  Â  Â  Â  Â  Â  Â  Â  option network &amp;#39;wifi&amp;#39;
Â  Â  Â  Â  Â  Â  Â  Â  option mode &amp;#39;ap&amp;#39;
Â  Â  Â  Â  Â  Â  Â  Â  option ssid &amp;#39;WR703n&amp;#39;
Â  Â  Â  Â  Â  Â  Â  Â  option encryption &amp;#39;psk2&amp;#39;
Â  Â  Â  Â  Â  Â  Â  Â  option key &amp;#39;secret&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;4.DHCP Config: &lt;code&gt;/etc/config/dhcp&lt;/code&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Â  Â  Â  Â  config dhcp wifi Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  option interface Â  Â  Â  Â wifi Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  option start Â  Â 100 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  option limit Â  Â 150 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  option leasetime Â  Â  Â  Â 12h Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  config dhcp lan Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  option interface Â  Â  Â  Â lan Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  option ignore Â  1
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;5.Firewall Config: &lt;code&gt;/etc/config/firewall&lt;/code&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Â  Â  Â  Â  config defaults
Â  Â  Â  Â  Â  Â  option syn_flood 1
Â  Â  Â  Â  Â  Â  option input ACCEPT
Â  Â  Â  Â  Â  Â  option output ACCEPT
Â  Â  Â  Â  Â  Â  option forward ACCEPT
Â  Â  Â  Â  config zone
Â  Â  Â  Â  Â  Â  option name lan
Â  Â  Â  Â  Â  Â  option network &amp;#39;lan&amp;#39;
Â  Â  Â  Â  Â  Â  option input ACCEPT
Â  Â  Â  Â  Â  Â  option output ACCEPT
Â  Â  Â  Â  Â  Â  option forward ACCEPT
Â  Â  Â  Â  Â  Â  option masq 1
Â  Â  Â  Â  Â  Â  option mtu_fix 1
Â  Â  Â  Â  config zone
Â  Â  Â  Â  Â  Â  option name wifi
Â  Â  Â  Â  Â  Â  option network &amp;#39;wifi&amp;#39;
Â  Â  Â  Â  Â  Â  option input ACCEPT
Â  Â  Â  Â  Â  Â  option output ACCEPT
Â  Â  Â  Â  Â  Â  option forward ACCEPT
Â  Â  Â  Â  config forwarding
Â  Â  Â  Â  Â  Â  option src lan
Â  Â  Â  Â  Â  Â  option dest wifi
Â  Â  Â  Â  config forwarding
Â  Â  Â  Â  Â  Â  option src wifi
Â  Â  Â  Â  Â  Â  option dest lanÂ 
Â  Â  PS: to use pppoe, lan -&amp;gt; wan
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;6.Reboot&lt;/h3&gt;
&lt;h2&gt;2.Mount Exteral Drive and Extroot(pivot root)&lt;/h2&gt;
&lt;h3&gt;1.Add USB support&lt;/h3&gt;
&lt;p&gt;opkg update &amp;amp;&amp;amp; opkg install kmod-usb2
Â  Â  Â  Â  insmod ehci-hcd
Â  Â  Â  Â  opkg install kmod-usb-storage block-mount kmod-fs-ext4
Â  Â Â &lt;/p&gt;
&lt;h3&gt;2.Copy the Entire &lt;code&gt;/&lt;/code&gt; to USB Storage&lt;/h3&gt;
&lt;p&gt;mkdir -p /mnt/sda1
Â  Â  Â  Â  mount /dev/sda1 /mnt/sda1
Â  Â  Â  Â  mkdir -p /tmp/cproot
Â  Â  Â  Â  mount --bind / /tmp/cproot
Â  Â  Â  Â  tar -C /tmp/cproot -cvf - . | tar -C /mnt/sda1 -xf -
Â  Â  Â  Â  umount /tmp/cproot
Â  Â  Â  Â  umount /mnt/sda1&lt;/p&gt;
&lt;h3&gt;2.Edit &lt;code&gt;/etc/config/fstab&lt;/code&gt; file&lt;/h3&gt;
&lt;p&gt;config mount
Â  Â  Â  Â  Â  Â  option target / Â # this is curcial
Â  Â  Â  Â  Â  Â  option device /dev/sda1
Â  Â  Â  Â  Â  Â  option fstype ext4
Â  Â  Â  Â  Â  Â  option options rw,sync
Â  Â  Â  Â  Â  Â  option enabled 1 #remeber to change this
Â  Â  Â  Â  Â  Â  option enabled_fsck 0Â 
3.(Necessary only if you are not extrooting) Opkg to Exteral Drive&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;1.Edit &lt;code&gt;/etc/opkg.conf&lt;/code&gt; file&lt;/h3&gt;
&lt;p&gt;dest usb /mnt/usb&lt;/p&gt;
&lt;h3&gt;2.Edit &lt;code&gt;/etc/profile&lt;/code&gt; file&lt;/h3&gt;
&lt;p&gt;export USB=/mnt/usb
Â  Â  Â  Â  # it's crucial to make customized bin preceeds system ones
Â  Â  Â  Â  export PATH=$USB/usr/bin:$USB/usr/sbin:$PATH
Â  Â  Â  Â  export LD_LIBRARY_PATH=$USB/lib:$USB/usr/lib&lt;/p&gt;
&lt;h3&gt;3.Remeber to use&lt;/h3&gt;
&lt;p&gt;opkg isntall &lt;package&gt; -d usb&lt;/p&gt;
&lt;h3&gt;4.fix&lt;/h3&gt;
&lt;p&gt;run linkmaker to link /etc to /mnt/usb/etc
!!!!!!!!!!!!!!!!!!!!!below is down on extroot!!!!!!!!!!!!!!!!!!!!!!!&lt;/p&gt;
&lt;h1&gt;å®‰è£… Python&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;opkg install python
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;TODO: ä¸çŸ¥é“èƒ½å¦äº¤å‰ç¼–è¯‘ä¸€ä¸ª micropython&lt;/p&gt;
&lt;h2&gt;5.Samba configuration&lt;/h2&gt;
&lt;p&gt;1.Install Samba
Â  Â  Â  Â  opkg install samba36-server
Â  Â  2.mkdir ~/share
Â  Â  Â  chmod 777 ~/share
Â  Â  3.Share Level Share
Â  Â  Â  Â  1. Edit &lt;code&gt;/etc.config/samba&lt;/code&gt; file
Â  Â  Â  Â  config samba
Â  Â  Â  Â  Â  Â  option 'name' Â  Â  Â  Â  Â  Â  Â  Â  Â  'OpenWrt'
Â  Â  Â  Â  Â  Â  option 'workgroup' Â  Â  Â  Â  Â  Â  Â 'WORKGROUP'
Â  Â  Â  Â  Â  Â  option 'description' Â  Â  Â  Â  Â  Â 'OpenWrt'
Â  Â  Â  Â  Â  Â  option 'homes' Â  Â  Â  Â  Â  Â  Â  Â  Â '0' # disable ~ dir sharing
Â  Â  Â  Â  config sambashare
Â  Â  Â  Â  Â  Â  option name Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  share
Â  Â  Â  Â  Â  Â  option path Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  /root/share
Â  Â  Â  Â  Â  Â  option read_only Â  Â  Â  Â  Â  Â  Â  Â no # enable write
Â  Â  Â  Â  Â  Â  option guest_ok Â  Â  Â  Â  Â  Â  Â  Â  yes # enable no passwd visit
Â  Â  Â  Â  Â  Â  option create_mask Â  Â  Â  Â  Â  Â  Â 0777
Â  Â  Â  Â  Â  Â  option dir_mask Â  Â  Â  Â  Â  Â  Â  Â  0777
Â  Â  Â  Â  2. change security = user to security = share in /etc/samba/smb.conf.template
Â  Â Â 
Â  Â  4./etc/init.d/samba enable &amp;amp;&amp;amp; /etc/init.d/samba start&lt;/p&gt;
&lt;h1&gt;å…å¯†ç ç™»å½•&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;scp ~/.ssh/id_rsa.pub root@ow:/etc/dropbear/authorized_keys
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;æ›´æ”¹ banner&lt;/h1&gt;
&lt;p&gt;ç¼–è¾‘ /etc/banner å³å¯&lt;/p&gt;
&lt;h2&gt;8.SSH Proxy&lt;/h2&gt;
&lt;p&gt;1.install openssh and autossh
Â  Â  Â  Â  mv /usr/bin/ssh /usr/bin/ssh.dropbear
Â  Â  Â  Â  mv /usr/bin/scp /usr/bin/scp/dropbear
Â  Â  Â  Â  opkg install openssh-client autossh&lt;/p&gt;
&lt;h1&gt;ç¦ç”¨ luci&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/etc/init.d/uhttpd disable
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;10.Install Camera&lt;/h2&gt;
&lt;p&gt;1.install video support
Â  Â  Â  Â  opkg install kmod-video-core kmod-video-uvc mjpg-streamer fswebcam
Â  Â  2.Using fswebcam
Â  Â  Â  Â  fswebcam capture.jpg -r 640x480
Â  Â  3.Using mjpg-streamer&lt;/p&gt;
&lt;h2&gt;11.Static DHCP leases&lt;/h2&gt;
&lt;p&gt;1.vi /etc/config/dhcp
Â  Â  Â  http://wiki.openwrt.org/doc/uci/dhcp#static.leases&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 01:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/configuring-openwrt-in-tp-link-702n.html</guid><category>IoT</category><category>è®¡ç®—æœº</category></item><item><title>Cè¯­è¨€ä¸­çš„ setjmp/longjmp</title><link>/posts/cyu-yan-zhong-de-setjmplongjmp.html</link><description>&lt;p&gt;é¦–å…ˆåæ§½ä¸€ä¸‹è¿™ä¸ªç¼©å†™, å¥½å¥½åœ° jump å•è¯æ‰å››ä¸ªå­—æ¯ä¸ç”¨, éè¦ç¼©å†™æˆ jmp ä¸‰ä¸ªå­—æ¯, æ¯æ¬¡éƒ½æ‰“é”™, è›‹ç–¼&lt;/p&gt;
&lt;p&gt;åœ¨ C ä¸­ï¼Œgoto è¯­å¥æ˜¯ä¸èƒ½è·¨è¶Šå‡½æ•°çš„ï¼Œè€Œæ‰§è¡Œè¿™ç±»è·³è½¬åŠŸèƒ½çš„æ˜¯ &lt;code&gt;setjmp&lt;/code&gt; å’Œ &lt;code&gt;longjmp&lt;/code&gt; å®ã€‚è¿™ä¸¤ä¸ªå®å¯¹äºå¤„ç†å‘ç”Ÿåœ¨æ·±å±‚åµŒå¥—å‡½æ•°è°ƒç”¨ä¸­çš„å‡ºé”™æƒ…å†µæ˜¯éå¸¸æœ‰ç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å³ä¸ºï¼šéå±€éƒ¨è·³è½¬ã€‚éå±€éƒ¨æŒ‡çš„æ˜¯ï¼Œè¿™ä¸æ˜¯ç”±æ™®é€š C è¯­è¨€ goto è¯­å¥åœ¨ä¸€ä¸ªå‡½æ•°å†…å®æ–½çš„è·³è½¬ï¼Œè€Œæ˜¯åœ¨æ ˆä¸Šè·³è¿‡è‹¥å¹²è°ƒç”¨å¸§ï¼Œè¿”å›åˆ°å½“å‰å‡½æ•°è°ƒç”¨è·¯å¾„çš„æŸä¸ªå‡½æ•°ä¸­ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;#include &amp;amp;lt;setjmp.h&amp;amp;gt;
int  setjmp (jmp_buf env) ;  /*è®¾ç½®è°ƒè½¬ç‚¹*/
void longjmp (jmp_buf env,  int val) ;  /*è·³è½¬*/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;setjmp&lt;/code&gt; å‚æ•° env çš„ç±»å‹æ˜¯ä¸€ä¸ªç‰¹æ®Šç±»å‹ &lt;code&gt;jmp_buf&lt;/code&gt;ã€‚è¿™ä¸€æ•°æ®ç±»å‹æ˜¯æŸç§å½¢å¼çš„æ•°ç»„ï¼Œå…¶ä¸­å­˜æ”¾ åœ¨è°ƒç”¨ &lt;code&gt;longjmp&lt;/code&gt; æ—¶èƒ½ç”¨æ¥æ¢å¤æ ˆçŠ¶æ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚å› ä¸ºéœ€åœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­å¼•ç”¨ env å˜é‡ï¼Œæ‰€ä»¥åº”è¯¥å°† env å˜é‡å®šä¹‰ä¸ºå…¨å±€å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;longjmp&lt;/code&gt; å‚æ•° valï¼Œå®ƒå°†æˆä¸ºä» setjmp å¤„è¿”å›çš„å€¼ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;#include &amp;amp;lt;stdio.h&amp;amp;gt;  
#include &amp;amp;lt;setjmp.h&amp;amp;gt;  
static jmp_buf buf;  
void second(void){  
    printf(&amp;quot;second\n&amp;quot;);  
    longjmp(buf,1);              
    // è·³å›setjmpçš„è°ƒç”¨å¤„ä½¿å¾—setjmpè¿”å›å€¼ä¸º1  
}  
void first(void) {  
    second();  
    printf(&amp;quot;first\n&amp;quot;);            
    // ä¸å¯èƒ½æ‰§è¡Œåˆ°æ­¤è¡Œ  
}  
int main(){     
    if (!setjmp(buf)) {  
        // è¿›å…¥æ­¤è¡Œå‰ï¼Œsetjmpè¿”å›0  
        first();  
    } else {     
        // å½“longjmpè·³è½¬å›ï¼Œsetjmpè¿”å›1ï¼Œå› æ­¤è¿›å…¥æ­¤è¡Œ  
        printf(&amp;quot;main\n&amp;quot;);  
    }  
    return 0;  
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ç›´æ¥è°ƒç”¨ setjmp æ—¶ï¼Œè¿”å›å€¼ä¸º 0ï¼Œè¿™ä¸€èˆ¬ç”¨äºåˆå§‹åŒ–ï¼ˆè®¾ç½®è·³è½¬ç‚¹æ—¶ï¼‰ã€‚ä»¥åå†è°ƒç”¨ longjmp å®æ—¶ç”¨ env å˜é‡è¿›è¡Œè·³è½¬ã€‚ç¨‹åºä¼šè‡ªåŠ¨è·³è½¬åˆ° setjmp å®çš„è¿”å›è¯­å¥å¤„ï¼Œæ­¤æ—¶ setjmp çš„è¿”å›å€¼ä¸ºé 0ï¼Œç”± longjmp çš„ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šã€‚
ä¸€èˆ¬åœ°ï¼Œå® &lt;code&gt;setjmp&lt;/code&gt; å’Œ &lt;code&gt;longjmp&lt;/code&gt; æ˜¯æˆå¯¹ä½¿ç”¨çš„ï¼Œè¿™æ ·ç¨‹åºæµç¨‹å¯ä»¥ä»ä¸€ä¸ªæ·±å±‚åµŒå¥—çš„å‡½æ•°ä¸­è¿”å›ã€‚&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 01:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/cyu-yan-zhong-de-setjmplongjmp.html</guid><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>Cè¯­è¨€ä¸­å·²ç»åºŸå¼ƒçš„å‡½æ•°</title><link>/posts/cyu-yan-zhong-yi-jing-fei-qi-de-han-shu.html</link><description>&lt;p&gt;ç”±äºå®‰å…¨æ€§åŸå› ï¼ŒC æ ‡å‡†åº“ä¸­çš„ä¸å°‘å‡½æ•°å·²ç»è¢«åºŸå¼ƒäº†ï¼ŒåŒæ—¶å¢åŠ äº†å¯¹åº”çš„æ›¿æ¢å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sprintf --&amp;gt; snprintf
gets --&amp;gt; fgets
strcat --&amp;gt; strncat
strcpy --&amp;gt; strncpy
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;strtok&lt;/code&gt;å‡½æ•°ç”¨äºåˆ†è§£å­—ç¬¦ä¸²ï¼Œéœ€è¦ä¸€ä¸ªå˜é‡ä¿å­˜å†…éƒ¨åˆ†è§£è¿›åº¦
&lt;code&gt;strtok_r&lt;/code&gt;æ˜¯å®ƒçš„å¯é‡å…¥ç‰ˆæœ¬&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 01:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/cyu-yan-zhong-yi-jing-fei-qi-de-han-shu.html</guid><category>C è¯­è¨€</category><category>ç¼–ç¨‹è¯­è¨€</category><category>è®¡ç®—æœº</category></item><item><title>å¦‚ä½•åˆ©ç”¨ç¢ç‰‡æ—¶é—´</title><link>/posts/ru-he-li-yong-sui-pian-shi-jian.html</link><description>&lt;ol&gt;
&lt;li&gt;æ­‡ä¸€ä¼š&lt;/li&gt;
&lt;li&gt;æŠŠä¸‹ä¸€ä»¶äº‹æå‰å¼€å§‹åšï¼Œä¸é€‚ç”¨äºåœ°é“ä¸Šï¼Œä¸€ä¸ªäººåƒé¥­ç­‰æ—¶é—´&lt;/li&gt;
&lt;li&gt;å’ŒåŒå­¦èŠèŠå¤©&lt;/li&gt;
&lt;li&gt;å›é¡¾ä¸€ä¸‹ä»Šå¤©å¹²äº†ä»€ä¹ˆï¼Œæˆ–è€…å‡†å¤‡ä¸€ä¸‹æ¥ä¸‹æ¥çš„é‡è¦äº‹æƒ…&lt;/li&gt;
&lt;li&gt;CoCï¼ŒBoomBeach&lt;/li&gt;
&lt;li&gt;å¤ä¹ ä¸€äº›çŸ­å°çš„ä¸œè¥¿ï¼Œå‡½æ•°å‚è€ƒä¹‹ç±»3&lt;/li&gt;
&lt;li&gt;èƒŒå•è¯&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸€å®šä¸è¦å»åšå¤§å—æ—¶é—´æ‰èƒ½åšçš„äº‹ï¼Œä¸€å®šä¸èƒ½å»ç»™æ¥ä¸‹æ¥çš„å¤§å—æ—¶é—´æŒ–å‘&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 01:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/ru-he-li-yong-sui-pian-shi-jian.html</guid><category>åæ€ä¸æ€»ç»“</category></item><item><title>vim goto ä¸å†å²å¯¼èˆª</title><link>/posts/vim-goto-yu-li-shi-dao-hang.html</link><description>&lt;p&gt;Vim command of g&lt;key&gt;
Â &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gd  æœ¬åœ°å®šä¹‰
gD  å…¨å±€å£°æ˜
g*  æœç´¢
g#  åå‘æœç´¢
gf  æ‰“å¼€æ–‡ä»¶
g]  è·³åˆ°tagå®šä¹‰çš„åœ°æ–¹
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;Ctrl-O&lt;/code&gt; to go back to files&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Ctrl-I&lt;/code&gt; to go to new files&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Mon, 29 May 2017 01:09:00 +0800</pubDate><guid isPermaLink="false">tag:None,2017-05-29:/posts/vim-goto-yu-li-shi-dao-hang.html</guid><category>vim</category><category>è®¡ç®—æœº</category><category>é€šç”¨å·¥å…·</category></item><item><title>RSS å’Œ Atom åè®®è¯¦è§£å’Œä¸è¶³</title><link>/posts/rss-he-atom-xie-yi-xiang-jie-he-bu-zu.html</link><description>&lt;h1&gt;å…³äºCDATA&lt;/h1&gt;
&lt;p&gt;CDATAÂ stands forÂ Character DataÂ and it means that the data in between these strings includes data thatÂ couldÂ be interpreted as XML markup, but should not be.&lt;/p&gt;
&lt;p&gt;So we could use CDATA to smuggle some HTML into the XML document, so that the HTML doesn't confuse the XML document structure, and then use XSLT later to pull it out and spit it into a HTML document that is being output.
Â 
&lt;em&gt;In short, you don't have to escape all the &amp;lt; and &amp;amp; in CDATA section&lt;/em&gt;
Â &lt;/p&gt;
&lt;h1&gt;RSS 2.0&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;rss&lt;/span&gt; &lt;span class="na"&gt;version=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;2.0&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;channel&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Example Feed&lt;span class="nt"&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Insert witty or insightful remark here&lt;span class="nt"&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;link&amp;gt;&lt;/span&gt;http://example.org/&lt;span class="nt"&gt;&amp;lt;/link&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;lastBuildDate&amp;gt;&lt;/span&gt;Sat, 13 Dec 2003 18:30:02 GMT&lt;span class="nt"&gt;&amp;lt;/lastBuildDate&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;managingEditor&amp;gt;&lt;/span&gt;johndoe@example.com (John Doe)&lt;span class="nt"&gt;&amp;lt;/managingEditor&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;item&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Atom-Powered Robots Run Amok&lt;span class="nt"&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;link&amp;gt;&lt;/span&gt;http://example.org/2003/12/13/atom03&lt;span class="nt"&gt;&amp;lt;/link&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;pubDate&amp;gt;&lt;/span&gt;Sat, 13 Dec 2003 18:30:02 GMT&lt;span class="nt"&gt;&amp;lt;/pubDate&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Some text.&lt;span class="nt"&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;source&amp;gt;&lt;/span&gt;Shit News&lt;span class="nt"&gt;&amp;lt;/source&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;/item&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;item&amp;gt;&lt;/span&gt;...&lt;span class="nt"&gt;&amp;lt;/item&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;/channel&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/rss&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;RSS åè®®çš„ä¸€äº›ä¸è¶³å’Œæ”¹è¿›æ–¹å‘&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ²¡æœ‰æ ‡è¯†æ–‡ç« é‡è¦åº¦çš„å­—æ®µ&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰é€”å¾„æŠŠè®¢é˜…æ•°é‡ç­‰ä¿¡æ¯åé¦ˆç»™ RSS æä¾›æ–¹&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰å“ç‰Œç‰¹æ€§&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰æœºå™¨æ¨è&lt;/li&gt;
&lt;li&gt;å¦‚æœèƒ½å¤ŸæŠŠ RSS åŒ…è£…æˆåƒæ˜¯ Amazon Prime é‚£æ ·çš„æœåŠ¡ï¼Œç”¨æˆ·å¯èƒ½ä¼šå¾ˆæ„¿æ„ä»˜é’±&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å®é™…ä¸Šæ–‡ç« çš„å¢åˆ æ”¹æŸ¥æ˜¯ä¸€å¥—ç»„åˆæ“ä½œï¼Œè€Œåªä½¿ç”¨ä¸€ä¸ª RSS ä½œä¸ºåˆ—è¡¨æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ï¼Œå¿…ç„¶è¦æ‹“å±•ã€‚&lt;/p&gt;
&lt;p&gt;ç°ä»£çš„ RSS é˜…è¯»å™¨éœ€è¦åšä¸‰ä¸ªæ–¹é¢&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸€ä¸ªç¤¾åŒº&lt;/li&gt;
&lt;li&gt;èƒ½å¤ŸæŠŠæ‰€æœ‰æœåŠ¡éƒ½æä¾›RSSï¼ŒåŒ…æ‹¬ä¸æä¾›RSSçš„ç«™ç‚¹&lt;/li&gt;
&lt;li&gt;è¯„è®ºæœåŠ¡&lt;/li&gt;
&lt;li&gt;è½¬ç ã€‚æœ‰çš„ RSS åªæä¾›äº†æ–‡ç« çš„æ‘˜è¦ï¼Œæœ‰çš„ RSS æœ‰å®æ•ˆæ€§ï¼Œæœ‰çš„ RSS æœ‰è‡ªå·±çš„å­—ä½“&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;Atom 1.0&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;feed&lt;/span&gt; &lt;span class="na"&gt;xmlns=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.w3.org/2005/Atom&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Example Feed&lt;span class="nt"&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;subtitle&amp;gt;&lt;/span&gt;Insert witty or insightful remark here&lt;span class="nt"&gt;&amp;lt;/subtitle&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;link&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://example.org/&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;updated&amp;gt;&lt;/span&gt;2003-12-13T18:30:02Z&lt;span class="nt"&gt;&amp;lt;/updated&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;author&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;name&amp;gt;&lt;/span&gt;John Doe&lt;span class="nt"&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;email&amp;gt;&lt;/span&gt;johndoe@example.com&lt;span class="nt"&gt;&amp;lt;/email&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;/author&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;id&amp;gt;&lt;/span&gt;urn:uuid:60a76c80-d399-11d9-b93C-0003939e0af6&lt;span class="nt"&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
Â 
Â Â Â  &lt;span class="nt"&gt;&amp;lt;entry&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Atom-Powered Robots Run Amok&lt;span class="nt"&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;link&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://example.org/2003/12/13/atom03&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;id&amp;gt;&lt;/span&gt;urn:uuid:1225c695-cfb8-4ebb-aaaa-80da344efa6a&lt;span class="nt"&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;updated&amp;gt;&lt;/span&gt;2003-12-13T18:30:02Z&lt;span class="nt"&gt;&amp;lt;/updated&amp;gt;&lt;/span&gt;
Â Â Â Â Â Â Â  &lt;span class="nt"&gt;&amp;lt;summary&amp;gt;&lt;/span&gt;Some text.&lt;span class="nt"&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;
Â Â Â  &lt;span class="nt"&gt;&amp;lt;/entry&amp;gt;&lt;/span&gt;
Â 
&lt;span class="nt"&gt;&amp;lt;/feed&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;reference&lt;/h1&gt;
&lt;p&gt;[1] http://www.intertwingly.net/wiki/pie/Rss20AndAtom10Compared&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Yifei Kong</dc:creator><pubDate>Tue, 27 Dec 2016 11:35:00 +0800</pubDate><guid isPermaLink="false">tag:None,2016-12-27:/posts/rss-he-atom-xie-yi-xiang-jie-he-bu-zu.html</guid><category>è®¡ç®—æœº</category><category>ç½‘ç»œ</category></item></channel></rss>